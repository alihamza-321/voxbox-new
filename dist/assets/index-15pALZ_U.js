var zj=Object.defineProperty;var Hj=(e,t,n)=>t in e?zj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var rp=(e,t,n)=>Hj(e,typeof t!="symbol"?t+"":t,n);function Qj(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const a in r)if(a!=="default"&&!(a in e)){const o=Object.getOwnPropertyDescriptor(r,a);o&&Object.defineProperty(e,a,o.get?o:{enumerable:!0,get:()=>r[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();function qx(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Yx={exports:{}},Hc={},Jx={exports:{}},Pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ki=Symbol.for("react.element"),Gj=Symbol.for("react.portal"),qj=Symbol.for("react.fragment"),Yj=Symbol.for("react.strict_mode"),Jj=Symbol.for("react.profiler"),Kj=Symbol.for("react.provider"),Xj=Symbol.for("react.context"),Zj=Symbol.for("react.forward_ref"),eS=Symbol.for("react.suspense"),tS=Symbol.for("react.memo"),sS=Symbol.for("react.lazy"),ap=Symbol.iterator;function nS(e){return e===null||typeof e!="object"?null:(e=ap&&e[ap]||e["@@iterator"],typeof e=="function"?e:null)}var Kx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xx=Object.assign,Zx={};function Po(e,t,n){this.props=e,this.context=t,this.refs=Zx,this.updater=n||Kx}Po.prototype.isReactComponent={};Po.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Po.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function ev(){}ev.prototype=Po.prototype;function ff(e,t,n){this.props=e,this.context=t,this.refs=Zx,this.updater=n||Kx}var hf=ff.prototype=new ev;hf.constructor=ff;Xx(hf,Po.prototype);hf.isPureReactComponent=!0;var op=Array.isArray,tv=Object.prototype.hasOwnProperty,pf={current:null},sv={key:!0,ref:!0,__self:!0,__source:!0};function nv(e,t,n){var r,a={},o=null,l=null;if(t!=null)for(r in t.ref!==void 0&&(l=t.ref),t.key!==void 0&&(o=""+t.key),t)tv.call(t,r)&&!sv.hasOwnProperty(r)&&(a[r]=t[r]);var c=arguments.length-2;if(c===1)a.children=n;else if(1<c){for(var u=Array(c),d=0;d<c;d++)u[d]=arguments[d+2];a.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps,c)a[r]===void 0&&(a[r]=c[r]);return{$$typeof:Ki,type:e,key:o,ref:l,props:a,_owner:pf.current}}function rS(e,t){return{$$typeof:Ki,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function gf(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ki}function aS(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var ip=/\/+/g;function Uu(e,t){return typeof e=="object"&&e!==null&&e.key!=null?aS(""+e.key):t.toString(36)}function _l(e,t,n,r,a){var o=typeof e;(o==="undefined"||o==="boolean")&&(e=null);var l=!1;if(e===null)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case Ki:case Gj:l=!0}}if(l)return l=e,a=a(l),e=r===""?"."+Uu(l,0):r,op(a)?(n="",e!=null&&(n=e.replace(ip,"$&/")+"/"),_l(a,t,n,"",function(d){return d})):a!=null&&(gf(a)&&(a=rS(a,n+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(ip,"$&/")+"/")+e)),t.push(a)),1;if(l=0,r=r===""?".":r+":",op(e))for(var c=0;c<e.length;c++){o=e[c];var u=r+Uu(o,c);l+=_l(o,t,n,u,a)}else if(u=nS(e),typeof u=="function")for(e=u.call(e),c=0;!(o=e.next()).done;)o=o.value,u=r+Uu(o,c++),l+=_l(o,t,n,u,a);else if(o==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function cl(e,t,n){if(e==null)return e;var r=[],a=0;return _l(e,r,"","",function(o){return t.call(n,o,a++)}),r}function oS(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $s={current:null},Ll={transition:null},iS={ReactCurrentDispatcher:$s,ReactCurrentBatchConfig:Ll,ReactCurrentOwner:pf};function rv(){throw Error("act(...) is not supported in production builds of React.")}Pt.Children={map:cl,forEach:function(e,t,n){cl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return cl(e,function(){t++}),t},toArray:function(e){return cl(e,function(t){return t})||[]},only:function(e){if(!gf(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Pt.Component=Po;Pt.Fragment=qj;Pt.Profiler=Jj;Pt.PureComponent=ff;Pt.StrictMode=Yj;Pt.Suspense=eS;Pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iS;Pt.act=rv;Pt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Xx({},e.props),a=e.key,o=e.ref,l=e._owner;if(t!=null){if(t.ref!==void 0&&(o=t.ref,l=pf.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(u in t)tv.call(t,u)&&!sv.hasOwnProperty(u)&&(r[u]=t[u]===void 0&&c!==void 0?c[u]:t[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){c=Array(u);for(var d=0;d<u;d++)c[d]=arguments[d+2];r.children=c}return{$$typeof:Ki,type:e.type,key:a,ref:o,props:r,_owner:l}};Pt.createContext=function(e){return e={$$typeof:Xj,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Kj,_context:e},e.Consumer=e};Pt.createElement=nv;Pt.createFactory=function(e){var t=nv.bind(null,e);return t.type=e,t};Pt.createRef=function(){return{current:null}};Pt.forwardRef=function(e){return{$$typeof:Zj,render:e}};Pt.isValidElement=gf;Pt.lazy=function(e){return{$$typeof:sS,_payload:{_status:-1,_result:e},_init:oS}};Pt.memo=function(e,t){return{$$typeof:tS,type:e,compare:t===void 0?null:t}};Pt.startTransition=function(e){var t=Ll.transition;Ll.transition={};try{e()}finally{Ll.transition=t}};Pt.unstable_act=rv;Pt.useCallback=function(e,t){return $s.current.useCallback(e,t)};Pt.useContext=function(e){return $s.current.useContext(e)};Pt.useDebugValue=function(){};Pt.useDeferredValue=function(e){return $s.current.useDeferredValue(e)};Pt.useEffect=function(e,t){return $s.current.useEffect(e,t)};Pt.useId=function(){return $s.current.useId()};Pt.useImperativeHandle=function(e,t,n){return $s.current.useImperativeHandle(e,t,n)};Pt.useInsertionEffect=function(e,t){return $s.current.useInsertionEffect(e,t)};Pt.useLayoutEffect=function(e,t){return $s.current.useLayoutEffect(e,t)};Pt.useMemo=function(e,t){return $s.current.useMemo(e,t)};Pt.useReducer=function(e,t,n){return $s.current.useReducer(e,t,n)};Pt.useRef=function(e){return $s.current.useRef(e)};Pt.useState=function(e){return $s.current.useState(e)};Pt.useSyncExternalStore=function(e,t,n){return $s.current.useSyncExternalStore(e,t,n)};Pt.useTransition=function(){return $s.current.useTransition()};Pt.version="18.3.1";Jx.exports=Pt;var i=Jx.exports;const _e=qx(i),Qc=Qj({__proto__:null,default:_e},[i]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lS=i,cS=Symbol.for("react.element"),uS=Symbol.for("react.fragment"),dS=Object.prototype.hasOwnProperty,mS=lS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fS={key:!0,ref:!0,__self:!0,__source:!0};function av(e,t,n){var r,a={},o=null,l=null;n!==void 0&&(o=""+n),t.key!==void 0&&(o=""+t.key),t.ref!==void 0&&(l=t.ref);for(r in t)dS.call(t,r)&&!fS.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)a[r]===void 0&&(a[r]=t[r]);return{$$typeof:cS,type:e,key:o,ref:l,props:a,_owner:mS.current}}Hc.Fragment=uS;Hc.jsx=av;Hc.jsxs=av;Yx.exports=Hc;var s=Yx.exports,ov={exports:{}},sn={},iv={exports:{}},lv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(A,E){var R=A.length;A.push(E);e:for(;0<R;){var L=R-1>>>1,I=A[L];if(0<a(I,E))A[L]=E,A[R]=I,R=L;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var E=A[0],R=A.pop();if(R!==E){A[0]=R;e:for(var L=0,I=A.length,_=I>>>1;L<_;){var $=2*(L+1)-1,F=A[$],M=$+1,T=A[M];if(0>a(F,R))M<I&&0>a(T,F)?(A[L]=T,A[M]=R,L=M):(A[L]=F,A[$]=R,L=$);else if(M<I&&0>a(T,R))A[L]=T,A[M]=R,L=M;else break e}}return E}function a(A,E){var R=A.sortIndex-E.sortIndex;return R!==0?R:A.id-E.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;e.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var u=[],d=[],g=1,m=null,p=3,f=!1,w=!1,h=!1,v=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(A){for(var E=n(d);E!==null;){if(E.callback===null)r(d);else if(E.startTime<=A)r(d),E.sortIndex=E.expirationTime,t(u,E);else break;E=n(d)}}function N(A){if(h=!1,b(A),!w)if(n(u)!==null)w=!0,G(S);else{var E=n(d);E!==null&&q(N,E.startTime-A)}}function S(A,E){w=!1,h&&(h=!1,x(C),C=-1),f=!0;var R=p;try{for(b(E),m=n(u);m!==null&&(!(m.expirationTime>E)||A&&!U());){var L=m.callback;if(typeof L=="function"){m.callback=null,p=m.priorityLevel;var I=L(m.expirationTime<=E);E=e.unstable_now(),typeof I=="function"?m.callback=I:m===n(u)&&r(u),b(E)}else r(u);m=n(u)}if(m!==null)var _=!0;else{var $=n(d);$!==null&&q(N,$.startTime-E),_=!1}return _}finally{m=null,p=R,f=!1}}var j=!1,k=null,C=-1,W=5,B=-1;function U(){return!(e.unstable_now()-B<W)}function Q(){if(k!==null){var A=e.unstable_now();B=A;var E=!0;try{E=k(!0,A)}finally{E?V():(j=!1,k=null)}}else j=!1}var V;if(typeof y=="function")V=function(){y(Q)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,K=P.port2;P.port1.onmessage=Q,V=function(){K.postMessage(null)}}else V=function(){v(Q,0)};function G(A){k=A,j||(j=!0,V())}function q(A,E){C=v(function(){A(e.unstable_now())},E)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(A){A.callback=null},e.unstable_continueExecution=function(){w||f||(w=!0,G(S))},e.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):W=0<A?Math.floor(1e3/A):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(u)},e.unstable_next=function(A){switch(p){case 1:case 2:case 3:var E=3;break;default:E=p}var R=p;p=E;try{return A()}finally{p=R}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(A,E){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var R=p;p=A;try{return E()}finally{p=R}},e.unstable_scheduleCallback=function(A,E,R){var L=e.unstable_now();switch(typeof R=="object"&&R!==null?(R=R.delay,R=typeof R=="number"&&0<R?L+R:L):R=L,A){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=R+I,A={id:g++,callback:E,priorityLevel:A,startTime:R,expirationTime:I,sortIndex:-1},R>L?(A.sortIndex=R,t(d,A),n(u)===null&&A===n(d)&&(h?(x(C),C=-1):h=!0,q(N,R-L))):(A.sortIndex=I,t(u,A),w||f||(w=!0,G(S))),A},e.unstable_shouldYield=U,e.unstable_wrapCallback=function(A){var E=p;return function(){var R=p;p=E;try{return A.apply(this,arguments)}finally{p=R}}}})(lv);iv.exports=lv;var hS=iv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pS=i,tn=hS;function Be(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var cv=new Set,wi={};function Ca(e,t){co(e,t),co(e+"Capture",t)}function co(e,t){for(wi[e]=t,e=0;e<t.length;e++)cv.add(t[e])}var ar=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zd=Object.prototype.hasOwnProperty,gS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,lp={},cp={};function xS(e){return zd.call(cp,e)?!0:zd.call(lp,e)?!1:gS.test(e)?cp[e]=!0:(lp[e]=!0,!1)}function vS(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function yS(e,t,n,r){if(t===null||typeof t>"u"||vS(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ds(e,t,n,r,a,o,l){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=l}var Ss={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ss[e]=new Ds(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ss[t]=new Ds(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ss[e]=new Ds(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ss[e]=new Ds(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ss[e]=new Ds(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ss[e]=new Ds(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ss[e]=new Ds(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ss[e]=new Ds(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ss[e]=new Ds(e,5,!1,e.toLowerCase(),null,!1,!1)});var xf=/[\-:]([a-z])/g;function vf(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(xf,vf);Ss[t]=new Ds(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(xf,vf);Ss[t]=new Ds(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(xf,vf);Ss[t]=new Ds(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ss[e]=new Ds(e,1,!1,e.toLowerCase(),null,!1,!1)});Ss.xlinkHref=new Ds("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ss[e]=new Ds(e,1,!1,e.toLowerCase(),null,!0,!0)});function yf(e,t,n,r){var a=Ss.hasOwnProperty(t)?Ss[t]:null;(a!==null?a.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(yS(t,n,a,r)&&(n=null),r||a===null?xS(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=n===null?a.type===3?!1:"":n:(t=a.attributeName,r=a.attributeNamespace,n===null?e.removeAttribute(t):(a=a.type,n=a===3||a===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var dr=pS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ul=Symbol.for("react.element"),Ba=Symbol.for("react.portal"),Wa=Symbol.for("react.fragment"),wf=Symbol.for("react.strict_mode"),Hd=Symbol.for("react.profiler"),uv=Symbol.for("react.provider"),dv=Symbol.for("react.context"),bf=Symbol.for("react.forward_ref"),Qd=Symbol.for("react.suspense"),Gd=Symbol.for("react.suspense_list"),Nf=Symbol.for("react.memo"),Pr=Symbol.for("react.lazy"),mv=Symbol.for("react.offscreen"),up=Symbol.iterator;function Oo(e){return e===null||typeof e!="object"?null:(e=up&&e[up]||e["@@iterator"],typeof e=="function"?e:null)}var is=Object.assign,zu;function Zo(e){if(zu===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);zu=t&&t[1]||""}return`
`+zu+e}var Hu=!1;function Qu(e,t){if(!e||Hu)return"";Hu=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var a=d.stack.split(`
`),o=r.stack.split(`
`),l=a.length-1,c=o.length-1;1<=l&&0<=c&&a[l]!==o[c];)c--;for(;1<=l&&0<=c;l--,c--)if(a[l]!==o[c]){if(l!==1||c!==1)do if(l--,c--,0>c||a[l]!==o[c]){var u=`
`+a[l].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}while(1<=l&&0<=c);break}}}finally{Hu=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Zo(e):""}function wS(e){switch(e.tag){case 5:return Zo(e.type);case 16:return Zo("Lazy");case 13:return Zo("Suspense");case 19:return Zo("SuspenseList");case 0:case 2:case 15:return e=Qu(e.type,!1),e;case 11:return e=Qu(e.type.render,!1),e;case 1:return e=Qu(e.type,!0),e;default:return""}}function qd(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Wa:return"Fragment";case Ba:return"Portal";case Hd:return"Profiler";case wf:return"StrictMode";case Qd:return"Suspense";case Gd:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case dv:return(e.displayName||"Context")+".Consumer";case uv:return(e._context.displayName||"Context")+".Provider";case bf:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Nf:return t=e.displayName||null,t!==null?t:qd(e.type)||"Memo";case Pr:t=e._payload,e=e._init;try{return qd(e(t))}catch{}}return null}function bS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qd(t);case 8:return t===wf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Wr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fv(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function NS(e){var t=fv(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(l){r=""+l,o.call(this,l)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function dl(e){e._valueTracker||(e._valueTracker=NS(e))}function hv(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=fv(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function rc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Yd(e,t){var n=t.checked;return is({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function dp(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Wr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function pv(e,t){t=t.checked,t!=null&&yf(e,"checked",t,!1)}function Jd(e,t){pv(e,t);var n=Wr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Kd(e,t.type,n):t.hasOwnProperty("defaultValue")&&Kd(e,t.type,Wr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function mp(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Kd(e,t,n){(t!=="number"||rc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ei=Array.isArray;function Za(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Wr(n),t=null,a=0;a<e.length;a++){if(e[a].value===n){e[a].selected=!0,r&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Xd(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Be(91));return is({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function fp(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Be(92));if(ei(n)){if(1<n.length)throw Error(Be(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Wr(n)}}function gv(e,t){var n=Wr(t.value),r=Wr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function hp(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function xv(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Zd(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?xv(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var ml,vv=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,a){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(ml=ml||document.createElement("div"),ml.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ml.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function bi(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ii={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jS=["Webkit","ms","Moz","O"];Object.keys(ii).forEach(function(e){jS.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ii[t]=ii[e]})});function yv(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ii.hasOwnProperty(e)&&ii[e]?(""+t).trim():t+"px"}function wv(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,a=yv(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}var SS=is({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function em(e,t){if(t){if(SS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Be(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Be(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Be(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Be(62))}}function tm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sm=null;function jf(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var nm=null,eo=null,to=null;function pp(e){if(e=el(e)){if(typeof nm!="function")throw Error(Be(280));var t=e.stateNode;t&&(t=Kc(t),nm(e.stateNode,e.type,t))}}function bv(e){eo?to?to.push(e):to=[e]:eo=e}function Nv(){if(eo){var e=eo,t=to;if(to=eo=null,pp(e),t)for(e=0;e<t.length;e++)pp(t[e])}}function jv(e,t){return e(t)}function Sv(){}var Gu=!1;function kv(e,t,n){if(Gu)return e(t,n);Gu=!0;try{return jv(e,t,n)}finally{Gu=!1,(eo!==null||to!==null)&&(Sv(),Nv())}}function Ni(e,t){var n=e.stateNode;if(n===null)return null;var r=Kc(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Be(231,t,typeof n));return n}var rm=!1;if(ar)try{var Fo={};Object.defineProperty(Fo,"passive",{get:function(){rm=!0}}),window.addEventListener("test",Fo,Fo),window.removeEventListener("test",Fo,Fo)}catch{rm=!1}function kS(e,t,n,r,a,o,l,c,u){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(g){this.onError(g)}}var li=!1,ac=null,oc=!1,am=null,PS={onError:function(e){li=!0,ac=e}};function AS(e,t,n,r,a,o,l,c,u){li=!1,ac=null,kS.apply(PS,arguments)}function CS(e,t,n,r,a,o,l,c,u){if(AS.apply(this,arguments),li){if(li){var d=ac;li=!1,ac=null}else throw Error(Be(198));oc||(oc=!0,am=d)}}function Ea(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Pv(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gp(e){if(Ea(e)!==e)throw Error(Be(188))}function ES(e){var t=e.alternate;if(!t){if(t=Ea(e),t===null)throw Error(Be(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var o=a.alternate;if(o===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return gp(a),e;if(o===r)return gp(a),t;o=o.sibling}throw Error(Be(188))}if(n.return!==r.return)n=a,r=o;else{for(var l=!1,c=a.child;c;){if(c===n){l=!0,n=a,r=o;break}if(c===r){l=!0,r=a,n=o;break}c=c.sibling}if(!l){for(c=o.child;c;){if(c===n){l=!0,n=o,r=a;break}if(c===r){l=!0,r=o,n=a;break}c=c.sibling}if(!l)throw Error(Be(189))}}if(n.alternate!==r)throw Error(Be(190))}if(n.tag!==3)throw Error(Be(188));return n.stateNode.current===n?e:t}function Av(e){return e=ES(e),e!==null?Cv(e):null}function Cv(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Cv(e);if(t!==null)return t;e=e.sibling}return null}var Ev=tn.unstable_scheduleCallback,xp=tn.unstable_cancelCallback,IS=tn.unstable_shouldYield,TS=tn.unstable_requestPaint,ds=tn.unstable_now,RS=tn.unstable_getCurrentPriorityLevel,Sf=tn.unstable_ImmediatePriority,Iv=tn.unstable_UserBlockingPriority,ic=tn.unstable_NormalPriority,MS=tn.unstable_LowPriority,Tv=tn.unstable_IdlePriority,Gc=null,Vn=null;function $S(e){if(Vn&&typeof Vn.onCommitFiberRoot=="function")try{Vn.onCommitFiberRoot(Gc,e,void 0,(e.current.flags&128)===128)}catch{}}var Nn=Math.clz32?Math.clz32:FS,DS=Math.log,OS=Math.LN2;function FS(e){return e>>>=0,e===0?32:31-(DS(e)/OS|0)|0}var fl=64,hl=4194304;function ti(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function lc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,a=e.suspendedLanes,o=e.pingedLanes,l=n&268435455;if(l!==0){var c=l&~a;c!==0?r=ti(c):(o&=l,o!==0&&(r=ti(o)))}else l=n&~a,l!==0?r=ti(l):o!==0&&(r=ti(o));if(r===0)return 0;if(t!==0&&t!==r&&!(t&a)&&(a=r&-r,o=t&-t,a>=o||a===16&&(o&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Nn(t),a=1<<n,r|=e[n],t&=~a;return r}function _S(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function LS(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,o=e.pendingLanes;0<o;){var l=31-Nn(o),c=1<<l,u=a[l];u===-1?(!(c&n)||c&r)&&(a[l]=_S(c,t)):u<=t&&(e.expiredLanes|=c),o&=~c}}function om(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Rv(){var e=fl;return fl<<=1,!(fl&4194240)&&(fl=64),e}function qu(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Xi(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Nn(t),e[t]=n}function VS(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-Nn(n),o=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~o}}function kf(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Nn(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var Ut=0;function Mv(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var $v,Pf,Dv,Ov,Fv,im=!1,pl=[],Mr=null,$r=null,Dr=null,ji=new Map,Si=new Map,Cr=[],BS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vp(e,t){switch(e){case"focusin":case"focusout":Mr=null;break;case"dragenter":case"dragleave":$r=null;break;case"mouseover":case"mouseout":Dr=null;break;case"pointerover":case"pointerout":ji.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Si.delete(t.pointerId)}}function _o(e,t,n,r,a,o){return e===null||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[a]},t!==null&&(t=el(t),t!==null&&Pf(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function WS(e,t,n,r,a){switch(t){case"focusin":return Mr=_o(Mr,e,t,n,r,a),!0;case"dragenter":return $r=_o($r,e,t,n,r,a),!0;case"mouseover":return Dr=_o(Dr,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return ji.set(o,_o(ji.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,Si.set(o,_o(Si.get(o)||null,e,t,n,r,a)),!0}return!1}function _v(e){var t=ua(e.target);if(t!==null){var n=Ea(t);if(n!==null){if(t=n.tag,t===13){if(t=Pv(n),t!==null){e.blockedOn=t,Fv(e.priority,function(){Dv(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Vl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=lm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);sm=r,n.target.dispatchEvent(r),sm=null}else return t=el(n),t!==null&&Pf(t),e.blockedOn=n,!1;t.shift()}return!0}function yp(e,t,n){Vl(e)&&n.delete(t)}function US(){im=!1,Mr!==null&&Vl(Mr)&&(Mr=null),$r!==null&&Vl($r)&&($r=null),Dr!==null&&Vl(Dr)&&(Dr=null),ji.forEach(yp),Si.forEach(yp)}function Lo(e,t){e.blockedOn===t&&(e.blockedOn=null,im||(im=!0,tn.unstable_scheduleCallback(tn.unstable_NormalPriority,US)))}function ki(e){function t(a){return Lo(a,e)}if(0<pl.length){Lo(pl[0],e);for(var n=1;n<pl.length;n++){var r=pl[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Mr!==null&&Lo(Mr,e),$r!==null&&Lo($r,e),Dr!==null&&Lo(Dr,e),ji.forEach(t),Si.forEach(t),n=0;n<Cr.length;n++)r=Cr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<Cr.length&&(n=Cr[0],n.blockedOn===null);)_v(n),n.blockedOn===null&&Cr.shift()}var so=dr.ReactCurrentBatchConfig,cc=!0;function zS(e,t,n,r){var a=Ut,o=so.transition;so.transition=null;try{Ut=1,Af(e,t,n,r)}finally{Ut=a,so.transition=o}}function HS(e,t,n,r){var a=Ut,o=so.transition;so.transition=null;try{Ut=4,Af(e,t,n,r)}finally{Ut=a,so.transition=o}}function Af(e,t,n,r){if(cc){var a=lm(e,t,n,r);if(a===null)rd(e,t,r,uc,n),vp(e,r);else if(WS(a,e,t,n,r))r.stopPropagation();else if(vp(e,r),t&4&&-1<BS.indexOf(e)){for(;a!==null;){var o=el(a);if(o!==null&&$v(o),o=lm(e,t,n,r),o===null&&rd(e,t,r,uc,n),o===a)break;a=o}a!==null&&r.stopPropagation()}else rd(e,t,r,null,n)}}var uc=null;function lm(e,t,n,r){if(uc=null,e=jf(r),e=ua(e),e!==null)if(t=Ea(e),t===null)e=null;else if(n=t.tag,n===13){if(e=Pv(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return uc=e,null}function Lv(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(RS()){case Sf:return 1;case Iv:return 4;case ic:case MS:return 16;case Tv:return 536870912;default:return 16}default:return 16}}var Ir=null,Cf=null,Bl=null;function Vv(){if(Bl)return Bl;var e,t=Cf,n=t.length,r,a="value"in Ir?Ir.value:Ir.textContent,o=a.length;for(e=0;e<n&&t[e]===a[e];e++);var l=n-e;for(r=1;r<=l&&t[n-r]===a[o-r];r++);return Bl=a.slice(e,1<r?1-r:void 0)}function Wl(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function gl(){return!0}function wp(){return!1}function nn(e){function t(n,r,a,o,l){this._reactName=n,this._targetInst=a,this.type=r,this.nativeEvent=o,this.target=l,this.currentTarget=null;for(var c in e)e.hasOwnProperty(c)&&(n=e[c],this[c]=n?n(o):o[c]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?gl:wp,this.isPropagationStopped=wp,this}return is(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gl)},persist:function(){},isPersistent:gl}),t}var Ao={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ef=nn(Ao),Zi=is({},Ao,{view:0,detail:0}),QS=nn(Zi),Yu,Ju,Vo,qc=is({},Zi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:If,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vo&&(Vo&&e.type==="mousemove"?(Yu=e.screenX-Vo.screenX,Ju=e.screenY-Vo.screenY):Ju=Yu=0,Vo=e),Yu)},movementY:function(e){return"movementY"in e?e.movementY:Ju}}),bp=nn(qc),GS=is({},qc,{dataTransfer:0}),qS=nn(GS),YS=is({},Zi,{relatedTarget:0}),Ku=nn(YS),JS=is({},Ao,{animationName:0,elapsedTime:0,pseudoElement:0}),KS=nn(JS),XS=is({},Ao,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ZS=nn(XS),e1=is({},Ao,{data:0}),Np=nn(e1),t1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},n1={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function r1(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=n1[e])?!!t[e]:!1}function If(){return r1}var a1=is({},Zi,{key:function(e){if(e.key){var t=t1[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Wl(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?s1[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:If,charCode:function(e){return e.type==="keypress"?Wl(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Wl(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),o1=nn(a1),i1=is({},qc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jp=nn(i1),l1=is({},Zi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:If}),c1=nn(l1),u1=is({},Ao,{propertyName:0,elapsedTime:0,pseudoElement:0}),d1=nn(u1),m1=is({},qc,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),f1=nn(m1),h1=[9,13,27,32],Tf=ar&&"CompositionEvent"in window,ci=null;ar&&"documentMode"in document&&(ci=document.documentMode);var p1=ar&&"TextEvent"in window&&!ci,Bv=ar&&(!Tf||ci&&8<ci&&11>=ci),Sp=" ",kp=!1;function Wv(e,t){switch(e){case"keyup":return h1.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Uv(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ua=!1;function g1(e,t){switch(e){case"compositionend":return Uv(t);case"keypress":return t.which!==32?null:(kp=!0,Sp);case"textInput":return e=t.data,e===Sp&&kp?null:e;default:return null}}function x1(e,t){if(Ua)return e==="compositionend"||!Tf&&Wv(e,t)?(e=Vv(),Bl=Cf=Ir=null,Ua=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Bv&&t.locale!=="ko"?null:t.data;default:return null}}var v1={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pp(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!v1[e.type]:t==="textarea"}function zv(e,t,n,r){bv(r),t=dc(t,"onChange"),0<t.length&&(n=new Ef("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ui=null,Pi=null;function y1(e){ty(e,0)}function Yc(e){var t=Qa(e);if(hv(t))return e}function w1(e,t){if(e==="change")return t}var Hv=!1;if(ar){var Xu;if(ar){var Zu="oninput"in document;if(!Zu){var Ap=document.createElement("div");Ap.setAttribute("oninput","return;"),Zu=typeof Ap.oninput=="function"}Xu=Zu}else Xu=!1;Hv=Xu&&(!document.documentMode||9<document.documentMode)}function Cp(){ui&&(ui.detachEvent("onpropertychange",Qv),Pi=ui=null)}function Qv(e){if(e.propertyName==="value"&&Yc(Pi)){var t=[];zv(t,Pi,e,jf(e)),kv(y1,t)}}function b1(e,t,n){e==="focusin"?(Cp(),ui=t,Pi=n,ui.attachEvent("onpropertychange",Qv)):e==="focusout"&&Cp()}function N1(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Yc(Pi)}function j1(e,t){if(e==="click")return Yc(t)}function S1(e,t){if(e==="input"||e==="change")return Yc(t)}function k1(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kn=typeof Object.is=="function"?Object.is:k1;function Ai(e,t){if(kn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!zd.call(t,a)||!kn(e[a],t[a]))return!1}return!0}function Ep(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ip(e,t){var n=Ep(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ep(n)}}function Gv(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Gv(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function qv(){for(var e=window,t=rc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=rc(e.document)}return t}function Rf(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function P1(e){var t=qv(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Gv(n.ownerDocument.documentElement,n)){if(r!==null&&Rf(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=n.textContent.length,o=Math.min(r.start,a);r=r.end===void 0?o:Math.min(r.end,a),!e.extend&&o>r&&(a=r,r=o,o=a),a=Ip(n,o);var l=Ip(n,r);a&&l&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),o>r?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var A1=ar&&"documentMode"in document&&11>=document.documentMode,za=null,cm=null,di=null,um=!1;function Tp(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;um||za==null||za!==rc(r)||(r=za,"selectionStart"in r&&Rf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),di&&Ai(di,r)||(di=r,r=dc(cm,"onSelect"),0<r.length&&(t=new Ef("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=za)))}function xl(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ha={animationend:xl("Animation","AnimationEnd"),animationiteration:xl("Animation","AnimationIteration"),animationstart:xl("Animation","AnimationStart"),transitionend:xl("Transition","TransitionEnd")},ed={},Yv={};ar&&(Yv=document.createElement("div").style,"AnimationEvent"in window||(delete Ha.animationend.animation,delete Ha.animationiteration.animation,delete Ha.animationstart.animation),"TransitionEvent"in window||delete Ha.transitionend.transition);function Jc(e){if(ed[e])return ed[e];if(!Ha[e])return e;var t=Ha[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Yv)return ed[e]=t[n];return e}var Jv=Jc("animationend"),Kv=Jc("animationiteration"),Xv=Jc("animationstart"),Zv=Jc("transitionend"),ey=new Map,Rp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yr(e,t){ey.set(e,t),Ca(t,[e])}for(var td=0;td<Rp.length;td++){var sd=Rp[td],C1=sd.toLowerCase(),E1=sd[0].toUpperCase()+sd.slice(1);Yr(C1,"on"+E1)}Yr(Jv,"onAnimationEnd");Yr(Kv,"onAnimationIteration");Yr(Xv,"onAnimationStart");Yr("dblclick","onDoubleClick");Yr("focusin","onFocus");Yr("focusout","onBlur");Yr(Zv,"onTransitionEnd");co("onMouseEnter",["mouseout","mouseover"]);co("onMouseLeave",["mouseout","mouseover"]);co("onPointerEnter",["pointerout","pointerover"]);co("onPointerLeave",["pointerout","pointerover"]);Ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ca("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var si="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I1=new Set("cancel close invalid load scroll toggle".split(" ").concat(si));function Mp(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,CS(r,t,void 0,e),e.currentTarget=null}function ty(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var l=r.length-1;0<=l;l--){var c=r[l],u=c.instance,d=c.currentTarget;if(c=c.listener,u!==o&&a.isPropagationStopped())break e;Mp(a,c,d),o=u}else for(l=0;l<r.length;l++){if(c=r[l],u=c.instance,d=c.currentTarget,c=c.listener,u!==o&&a.isPropagationStopped())break e;Mp(a,c,d),o=u}}}if(oc)throw e=am,oc=!1,am=null,e}function es(e,t){var n=t[pm];n===void 0&&(n=t[pm]=new Set);var r=e+"__bubble";n.has(r)||(sy(t,e,2,!1),n.add(r))}function nd(e,t,n){var r=0;t&&(r|=4),sy(n,e,r,t)}var vl="_reactListening"+Math.random().toString(36).slice(2);function Ci(e){if(!e[vl]){e[vl]=!0,cv.forEach(function(n){n!=="selectionchange"&&(I1.has(n)||nd(n,!1,e),nd(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[vl]||(t[vl]=!0,nd("selectionchange",!1,t))}}function sy(e,t,n,r){switch(Lv(t)){case 1:var a=zS;break;case 4:a=HS;break;default:a=Af}n=a.bind(null,t,n,e),a=void 0,!rm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),r?a!==void 0?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):a!==void 0?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function rd(e,t,n,r,a){var o=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var c=r.stateNode.containerInfo;if(c===a||c.nodeType===8&&c.parentNode===a)break;if(l===4)for(l=r.return;l!==null;){var u=l.tag;if((u===3||u===4)&&(u=l.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;l=l.return}for(;c!==null;){if(l=ua(c),l===null)return;if(u=l.tag,u===5||u===6){r=o=l;continue e}c=c.parentNode}}r=r.return}kv(function(){var d=o,g=jf(n),m=[];e:{var p=ey.get(e);if(p!==void 0){var f=Ef,w=e;switch(e){case"keypress":if(Wl(n)===0)break e;case"keydown":case"keyup":f=o1;break;case"focusin":w="focus",f=Ku;break;case"focusout":w="blur",f=Ku;break;case"beforeblur":case"afterblur":f=Ku;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=bp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=qS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=c1;break;case Jv:case Kv:case Xv:f=KS;break;case Zv:f=d1;break;case"scroll":f=QS;break;case"wheel":f=f1;break;case"copy":case"cut":case"paste":f=ZS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=jp}var h=(t&4)!==0,v=!h&&e==="scroll",x=h?p!==null?p+"Capture":null:p;h=[];for(var y=d,b;y!==null;){b=y;var N=b.stateNode;if(b.tag===5&&N!==null&&(b=N,x!==null&&(N=Ni(y,x),N!=null&&h.push(Ei(y,N,b)))),v)break;y=y.return}0<h.length&&(p=new f(p,w,null,n,g),m.push({event:p,listeners:h}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",f=e==="mouseout"||e==="pointerout",p&&n!==sm&&(w=n.relatedTarget||n.fromElement)&&(ua(w)||w[or]))break e;if((f||p)&&(p=g.window===g?g:(p=g.ownerDocument)?p.defaultView||p.parentWindow:window,f?(w=n.relatedTarget||n.toElement,f=d,w=w?ua(w):null,w!==null&&(v=Ea(w),w!==v||w.tag!==5&&w.tag!==6)&&(w=null)):(f=null,w=d),f!==w)){if(h=bp,N="onMouseLeave",x="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(h=jp,N="onPointerLeave",x="onPointerEnter",y="pointer"),v=f==null?p:Qa(f),b=w==null?p:Qa(w),p=new h(N,y+"leave",f,n,g),p.target=v,p.relatedTarget=b,N=null,ua(g)===d&&(h=new h(x,y+"enter",w,n,g),h.target=b,h.relatedTarget=v,N=h),v=N,f&&w)t:{for(h=f,x=w,y=0,b=h;b;b=Ma(b))y++;for(b=0,N=x;N;N=Ma(N))b++;for(;0<y-b;)h=Ma(h),y--;for(;0<b-y;)x=Ma(x),b--;for(;y--;){if(h===x||x!==null&&h===x.alternate)break t;h=Ma(h),x=Ma(x)}h=null}else h=null;f!==null&&$p(m,p,f,h,!1),w!==null&&v!==null&&$p(m,v,w,h,!0)}}e:{if(p=d?Qa(d):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var S=w1;else if(Pp(p))if(Hv)S=S1;else{S=N1;var j=b1}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(S=j1);if(S&&(S=S(e,d))){zv(m,S,n,g);break e}j&&j(e,p,d),e==="focusout"&&(j=p._wrapperState)&&j.controlled&&p.type==="number"&&Kd(p,"number",p.value)}switch(j=d?Qa(d):window,e){case"focusin":(Pp(j)||j.contentEditable==="true")&&(za=j,cm=d,di=null);break;case"focusout":di=cm=za=null;break;case"mousedown":um=!0;break;case"contextmenu":case"mouseup":case"dragend":um=!1,Tp(m,n,g);break;case"selectionchange":if(A1)break;case"keydown":case"keyup":Tp(m,n,g)}var k;if(Tf)e:{switch(e){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Ua?Wv(e,n)&&(C="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(Bv&&n.locale!=="ko"&&(Ua||C!=="onCompositionStart"?C==="onCompositionEnd"&&Ua&&(k=Vv()):(Ir=g,Cf="value"in Ir?Ir.value:Ir.textContent,Ua=!0)),j=dc(d,C),0<j.length&&(C=new Np(C,e,null,n,g),m.push({event:C,listeners:j}),k?C.data=k:(k=Uv(n),k!==null&&(C.data=k)))),(k=p1?g1(e,n):x1(e,n))&&(d=dc(d,"onBeforeInput"),0<d.length&&(g=new Np("onBeforeInput","beforeinput",null,n,g),m.push({event:g,listeners:d}),g.data=k))}ty(m,t)})}function Ei(e,t,n){return{instance:e,listener:t,currentTarget:n}}function dc(e,t){for(var n=t+"Capture",r=[];e!==null;){var a=e,o=a.stateNode;a.tag===5&&o!==null&&(a=o,o=Ni(e,n),o!=null&&r.unshift(Ei(e,o,a)),o=Ni(e,t),o!=null&&r.push(Ei(e,o,a))),e=e.return}return r}function Ma(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function $p(e,t,n,r,a){for(var o=t._reactName,l=[];n!==null&&n!==r;){var c=n,u=c.alternate,d=c.stateNode;if(u!==null&&u===r)break;c.tag===5&&d!==null&&(c=d,a?(u=Ni(n,o),u!=null&&l.unshift(Ei(n,u,c))):a||(u=Ni(n,o),u!=null&&l.push(Ei(n,u,c)))),n=n.return}l.length!==0&&e.push({event:t,listeners:l})}var T1=/\r\n?/g,R1=/\u0000|\uFFFD/g;function Dp(e){return(typeof e=="string"?e:""+e).replace(T1,`
`).replace(R1,"")}function yl(e,t,n){if(t=Dp(t),Dp(e)!==t&&n)throw Error(Be(425))}function mc(){}var dm=null,mm=null;function fm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var hm=typeof setTimeout=="function"?setTimeout:void 0,M1=typeof clearTimeout=="function"?clearTimeout:void 0,Op=typeof Promise=="function"?Promise:void 0,$1=typeof queueMicrotask=="function"?queueMicrotask:typeof Op<"u"?function(e){return Op.resolve(null).then(e).catch(D1)}:hm;function D1(e){setTimeout(function(){throw e})}function ad(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&a.nodeType===8)if(n=a.data,n==="/$"){if(r===0){e.removeChild(a),ki(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=a}while(n);ki(t)}function Or(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Fp(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Co=Math.random().toString(36).slice(2),Fn="__reactFiber$"+Co,Ii="__reactProps$"+Co,or="__reactContainer$"+Co,pm="__reactEvents$"+Co,O1="__reactListeners$"+Co,F1="__reactHandles$"+Co;function ua(e){var t=e[Fn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[or]||n[Fn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Fp(e);e!==null;){if(n=e[Fn])return n;e=Fp(e)}return t}e=n,n=e.parentNode}return null}function el(e){return e=e[Fn]||e[or],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Qa(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Be(33))}function Kc(e){return e[Ii]||null}var gm=[],Ga=-1;function Jr(e){return{current:e}}function ss(e){0>Ga||(e.current=gm[Ga],gm[Ga]=null,Ga--)}function Jt(e,t){Ga++,gm[Ga]=e.current,e.current=t}var Ur={},Is=Jr(Ur),zs=Jr(!1),xa=Ur;function uo(e,t){var n=e.type.contextTypes;if(!n)return Ur;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a={},o;for(o in n)a[o]=t[o];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Hs(e){return e=e.childContextTypes,e!=null}function fc(){ss(zs),ss(Is)}function _p(e,t,n){if(Is.current!==Ur)throw Error(Be(168));Jt(Is,t),Jt(zs,n)}function ny(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var a in r)if(!(a in t))throw Error(Be(108,bS(e)||"Unknown",a));return is({},n,r)}function hc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ur,xa=Is.current,Jt(Is,e),Jt(zs,zs.current),!0}function Lp(e,t,n){var r=e.stateNode;if(!r)throw Error(Be(169));n?(e=ny(e,t,xa),r.__reactInternalMemoizedMergedChildContext=e,ss(zs),ss(Is),Jt(Is,e)):ss(zs),Jt(zs,n)}var er=null,Xc=!1,od=!1;function ry(e){er===null?er=[e]:er.push(e)}function _1(e){Xc=!0,ry(e)}function Kr(){if(!od&&er!==null){od=!0;var e=0,t=Ut;try{var n=er;for(Ut=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}er=null,Xc=!1}catch(a){throw er!==null&&(er=er.slice(e+1)),Ev(Sf,Kr),a}finally{Ut=t,od=!1}}return null}var qa=[],Ya=0,pc=null,gc=0,rn=[],an=0,va=null,sr=1,nr="";function aa(e,t){qa[Ya++]=gc,qa[Ya++]=pc,pc=e,gc=t}function ay(e,t,n){rn[an++]=sr,rn[an++]=nr,rn[an++]=va,va=e;var r=sr;e=nr;var a=32-Nn(r)-1;r&=~(1<<a),n+=1;var o=32-Nn(t)+a;if(30<o){var l=a-a%5;o=(r&(1<<l)-1).toString(32),r>>=l,a-=l,sr=1<<32-Nn(t)+a|n<<a|r,nr=o+e}else sr=1<<o|n<<a|r,nr=e}function Mf(e){e.return!==null&&(aa(e,1),ay(e,1,0))}function $f(e){for(;e===pc;)pc=qa[--Ya],qa[Ya]=null,gc=qa[--Ya],qa[Ya]=null;for(;e===va;)va=rn[--an],rn[an]=null,nr=rn[--an],rn[an]=null,sr=rn[--an],rn[an]=null}var Xs=null,Ks=null,rs=!1,bn=null;function oy(e,t){var n=on(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Vp(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Xs=e,Ks=Or(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Xs=e,Ks=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=va!==null?{id:sr,overflow:nr}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=on(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Xs=e,Ks=null,!0):!1;default:return!1}}function xm(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vm(e){if(rs){var t=Ks;if(t){var n=t;if(!Vp(e,t)){if(xm(e))throw Error(Be(418));t=Or(n.nextSibling);var r=Xs;t&&Vp(e,t)?oy(r,n):(e.flags=e.flags&-4097|2,rs=!1,Xs=e)}}else{if(xm(e))throw Error(Be(418));e.flags=e.flags&-4097|2,rs=!1,Xs=e}}}function Bp(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Xs=e}function wl(e){if(e!==Xs)return!1;if(!rs)return Bp(e),rs=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!fm(e.type,e.memoizedProps)),t&&(t=Ks)){if(xm(e))throw iy(),Error(Be(418));for(;t;)oy(e,t),t=Or(t.nextSibling)}if(Bp(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Be(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ks=Or(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ks=null}}else Ks=Xs?Or(e.stateNode.nextSibling):null;return!0}function iy(){for(var e=Ks;e;)e=Or(e.nextSibling)}function mo(){Ks=Xs=null,rs=!1}function Df(e){bn===null?bn=[e]:bn.push(e)}var L1=dr.ReactCurrentBatchConfig;function Bo(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Be(309));var r=n.stateNode}if(!r)throw Error(Be(147,e));var a=r,o=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===o?t.ref:(t=function(l){var c=a.refs;l===null?delete c[o]:c[o]=l},t._stringRef=o,t)}if(typeof e!="string")throw Error(Be(284));if(!n._owner)throw Error(Be(290,e))}return e}function bl(e,t){throw e=Object.prototype.toString.call(t),Error(Be(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Wp(e){var t=e._init;return t(e._payload)}function ly(e){function t(x,y){if(e){var b=x.deletions;b===null?(x.deletions=[y],x.flags|=16):b.push(y)}}function n(x,y){if(!e)return null;for(;y!==null;)t(x,y),y=y.sibling;return null}function r(x,y){for(x=new Map;y!==null;)y.key!==null?x.set(y.key,y):x.set(y.index,y),y=y.sibling;return x}function a(x,y){return x=Vr(x,y),x.index=0,x.sibling=null,x}function o(x,y,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<y?(x.flags|=2,y):b):(x.flags|=2,y)):(x.flags|=1048576,y)}function l(x){return e&&x.alternate===null&&(x.flags|=2),x}function c(x,y,b,N){return y===null||y.tag!==6?(y=fd(b,x.mode,N),y.return=x,y):(y=a(y,b),y.return=x,y)}function u(x,y,b,N){var S=b.type;return S===Wa?g(x,y,b.props.children,N,b.key):y!==null&&(y.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Pr&&Wp(S)===y.type)?(N=a(y,b.props),N.ref=Bo(x,y,b),N.return=x,N):(N=Yl(b.type,b.key,b.props,null,x.mode,N),N.ref=Bo(x,y,b),N.return=x,N)}function d(x,y,b,N){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=hd(b,x.mode,N),y.return=x,y):(y=a(y,b.children||[]),y.return=x,y)}function g(x,y,b,N,S){return y===null||y.tag!==7?(y=pa(b,x.mode,N,S),y.return=x,y):(y=a(y,b),y.return=x,y)}function m(x,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=fd(""+y,x.mode,b),y.return=x,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ul:return b=Yl(y.type,y.key,y.props,null,x.mode,b),b.ref=Bo(x,null,y),b.return=x,b;case Ba:return y=hd(y,x.mode,b),y.return=x,y;case Pr:var N=y._init;return m(x,N(y._payload),b)}if(ei(y)||Oo(y))return y=pa(y,x.mode,b,null),y.return=x,y;bl(x,y)}return null}function p(x,y,b,N){var S=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return S!==null?null:c(x,y,""+b,N);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ul:return b.key===S?u(x,y,b,N):null;case Ba:return b.key===S?d(x,y,b,N):null;case Pr:return S=b._init,p(x,y,S(b._payload),N)}if(ei(b)||Oo(b))return S!==null?null:g(x,y,b,N,null);bl(x,b)}return null}function f(x,y,b,N,S){if(typeof N=="string"&&N!==""||typeof N=="number")return x=x.get(b)||null,c(y,x,""+N,S);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case ul:return x=x.get(N.key===null?b:N.key)||null,u(y,x,N,S);case Ba:return x=x.get(N.key===null?b:N.key)||null,d(y,x,N,S);case Pr:var j=N._init;return f(x,y,b,j(N._payload),S)}if(ei(N)||Oo(N))return x=x.get(b)||null,g(y,x,N,S,null);bl(y,N)}return null}function w(x,y,b,N){for(var S=null,j=null,k=y,C=y=0,W=null;k!==null&&C<b.length;C++){k.index>C?(W=k,k=null):W=k.sibling;var B=p(x,k,b[C],N);if(B===null){k===null&&(k=W);break}e&&k&&B.alternate===null&&t(x,k),y=o(B,y,C),j===null?S=B:j.sibling=B,j=B,k=W}if(C===b.length)return n(x,k),rs&&aa(x,C),S;if(k===null){for(;C<b.length;C++)k=m(x,b[C],N),k!==null&&(y=o(k,y,C),j===null?S=k:j.sibling=k,j=k);return rs&&aa(x,C),S}for(k=r(x,k);C<b.length;C++)W=f(k,x,C,b[C],N),W!==null&&(e&&W.alternate!==null&&k.delete(W.key===null?C:W.key),y=o(W,y,C),j===null?S=W:j.sibling=W,j=W);return e&&k.forEach(function(U){return t(x,U)}),rs&&aa(x,C),S}function h(x,y,b,N){var S=Oo(b);if(typeof S!="function")throw Error(Be(150));if(b=S.call(b),b==null)throw Error(Be(151));for(var j=S=null,k=y,C=y=0,W=null,B=b.next();k!==null&&!B.done;C++,B=b.next()){k.index>C?(W=k,k=null):W=k.sibling;var U=p(x,k,B.value,N);if(U===null){k===null&&(k=W);break}e&&k&&U.alternate===null&&t(x,k),y=o(U,y,C),j===null?S=U:j.sibling=U,j=U,k=W}if(B.done)return n(x,k),rs&&aa(x,C),S;if(k===null){for(;!B.done;C++,B=b.next())B=m(x,B.value,N),B!==null&&(y=o(B,y,C),j===null?S=B:j.sibling=B,j=B);return rs&&aa(x,C),S}for(k=r(x,k);!B.done;C++,B=b.next())B=f(k,x,C,B.value,N),B!==null&&(e&&B.alternate!==null&&k.delete(B.key===null?C:B.key),y=o(B,y,C),j===null?S=B:j.sibling=B,j=B);return e&&k.forEach(function(Q){return t(x,Q)}),rs&&aa(x,C),S}function v(x,y,b,N){if(typeof b=="object"&&b!==null&&b.type===Wa&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case ul:e:{for(var S=b.key,j=y;j!==null;){if(j.key===S){if(S=b.type,S===Wa){if(j.tag===7){n(x,j.sibling),y=a(j,b.props.children),y.return=x,x=y;break e}}else if(j.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===Pr&&Wp(S)===j.type){n(x,j.sibling),y=a(j,b.props),y.ref=Bo(x,j,b),y.return=x,x=y;break e}n(x,j);break}else t(x,j);j=j.sibling}b.type===Wa?(y=pa(b.props.children,x.mode,N,b.key),y.return=x,x=y):(N=Yl(b.type,b.key,b.props,null,x.mode,N),N.ref=Bo(x,y,b),N.return=x,x=N)}return l(x);case Ba:e:{for(j=b.key;y!==null;){if(y.key===j)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(x,y.sibling),y=a(y,b.children||[]),y.return=x,x=y;break e}else{n(x,y);break}else t(x,y);y=y.sibling}y=hd(b,x.mode,N),y.return=x,x=y}return l(x);case Pr:return j=b._init,v(x,y,j(b._payload),N)}if(ei(b))return w(x,y,b,N);if(Oo(b))return h(x,y,b,N);bl(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(x,y.sibling),y=a(y,b),y.return=x,x=y):(n(x,y),y=fd(b,x.mode,N),y.return=x,x=y),l(x)):n(x,y)}return v}var fo=ly(!0),cy=ly(!1),xc=Jr(null),vc=null,Ja=null,Of=null;function Ff(){Of=Ja=vc=null}function _f(e){var t=xc.current;ss(xc),e._currentValue=t}function ym(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function no(e,t){vc=e,Of=Ja=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Us=!0),e.firstContext=null)}function dn(e){var t=e._currentValue;if(Of!==e)if(e={context:e,memoizedValue:t,next:null},Ja===null){if(vc===null)throw Error(Be(308));Ja=e,vc.dependencies={lanes:0,firstContext:e}}else Ja=Ja.next=e;return t}var da=null;function Lf(e){da===null?da=[e]:da.push(e)}function uy(e,t,n,r){var a=t.interleaved;return a===null?(n.next=n,Lf(t)):(n.next=a.next,a.next=n),t.interleaved=n,ir(e,r)}function ir(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Ar=!1;function Vf(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dy(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function rr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ot&2){var a=r.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),r.pending=t,ir(e,n)}return a=r.interleaved,a===null?(t.next=t,Lf(r)):(t.next=a.next,a.next=t),r.interleaved=t,ir(e,n)}function Ul(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,kf(e,n)}}function Up(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var a=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?a=o=l:o=o.next=l,n=n.next}while(n!==null);o===null?a=o=t:o=o.next=t}else a=o=t;n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yc(e,t,n,r){var a=e.updateQueue;Ar=!1;var o=a.firstBaseUpdate,l=a.lastBaseUpdate,c=a.shared.pending;if(c!==null){a.shared.pending=null;var u=c,d=u.next;u.next=null,l===null?o=d:l.next=d,l=u;var g=e.alternate;g!==null&&(g=g.updateQueue,c=g.lastBaseUpdate,c!==l&&(c===null?g.firstBaseUpdate=d:c.next=d,g.lastBaseUpdate=u))}if(o!==null){var m=a.baseState;l=0,g=d=u=null,c=o;do{var p=c.lane,f=c.eventTime;if((r&p)===p){g!==null&&(g=g.next={eventTime:f,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var w=e,h=c;switch(p=t,f=n,h.tag){case 1:if(w=h.payload,typeof w=="function"){m=w.call(f,m,p);break e}m=w;break e;case 3:w.flags=w.flags&-65537|128;case 0:if(w=h.payload,p=typeof w=="function"?w.call(f,m,p):w,p==null)break e;m=is({},m,p);break e;case 2:Ar=!0}}c.callback!==null&&c.lane!==0&&(e.flags|=64,p=a.effects,p===null?a.effects=[c]:p.push(c))}else f={eventTime:f,lane:p,tag:c.tag,payload:c.payload,callback:c.callback,next:null},g===null?(d=g=f,u=m):g=g.next=f,l|=p;if(c=c.next,c===null){if(c=a.shared.pending,c===null)break;p=c,c=p.next,p.next=null,a.lastBaseUpdate=p,a.shared.pending=null}}while(!0);if(g===null&&(u=m),a.baseState=u,a.firstBaseUpdate=d,a.lastBaseUpdate=g,t=a.shared.interleaved,t!==null){a=t;do l|=a.lane,a=a.next;while(a!==t)}else o===null&&(a.shared.lanes=0);wa|=l,e.lanes=l,e.memoizedState=m}}function zp(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(a!==null){if(r.callback=null,r=n,typeof a!="function")throw Error(Be(191,a));a.call(r)}}}var tl={},Bn=Jr(tl),Ti=Jr(tl),Ri=Jr(tl);function ma(e){if(e===tl)throw Error(Be(174));return e}function Bf(e,t){switch(Jt(Ri,t),Jt(Ti,e),Jt(Bn,tl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Zd(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Zd(t,e)}ss(Bn),Jt(Bn,t)}function ho(){ss(Bn),ss(Ti),ss(Ri)}function my(e){ma(Ri.current);var t=ma(Bn.current),n=Zd(t,e.type);t!==n&&(Jt(Ti,e),Jt(Bn,n))}function Wf(e){Ti.current===e&&(ss(Bn),ss(Ti))}var as=Jr(0);function wc(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var id=[];function Uf(){for(var e=0;e<id.length;e++)id[e]._workInProgressVersionPrimary=null;id.length=0}var zl=dr.ReactCurrentDispatcher,ld=dr.ReactCurrentBatchConfig,ya=0,os=null,vs=null,ws=null,bc=!1,mi=!1,Mi=0,V1=0;function Ps(){throw Error(Be(321))}function zf(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!kn(e[n],t[n]))return!1;return!0}function Hf(e,t,n,r,a,o){if(ya=o,os=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,zl.current=e===null||e.memoizedState===null?z1:H1,e=n(r,a),mi){o=0;do{if(mi=!1,Mi=0,25<=o)throw Error(Be(301));o+=1,ws=vs=null,t.updateQueue=null,zl.current=Q1,e=n(r,a)}while(mi)}if(zl.current=Nc,t=vs!==null&&vs.next!==null,ya=0,ws=vs=os=null,bc=!1,t)throw Error(Be(300));return e}function Qf(){var e=Mi!==0;return Mi=0,e}function On(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ws===null?os.memoizedState=ws=e:ws=ws.next=e,ws}function mn(){if(vs===null){var e=os.alternate;e=e!==null?e.memoizedState:null}else e=vs.next;var t=ws===null?os.memoizedState:ws.next;if(t!==null)ws=t,vs=e;else{if(e===null)throw Error(Be(310));vs=e,e={memoizedState:vs.memoizedState,baseState:vs.baseState,baseQueue:vs.baseQueue,queue:vs.queue,next:null},ws===null?os.memoizedState=ws=e:ws=ws.next=e}return ws}function $i(e,t){return typeof t=="function"?t(e):t}function cd(e){var t=mn(),n=t.queue;if(n===null)throw Error(Be(311));n.lastRenderedReducer=e;var r=vs,a=r.baseQueue,o=n.pending;if(o!==null){if(a!==null){var l=a.next;a.next=o.next,o.next=l}r.baseQueue=a=o,n.pending=null}if(a!==null){o=a.next,r=r.baseState;var c=l=null,u=null,d=o;do{var g=d.lane;if((ya&g)===g)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var m={lane:g,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(c=u=m,l=r):u=u.next=m,os.lanes|=g,wa|=g}d=d.next}while(d!==null&&d!==o);u===null?l=r:u.next=c,kn(r,t.memoizedState)||(Us=!0),t.memoizedState=r,t.baseState=l,t.baseQueue=u,n.lastRenderedState=r}if(e=n.interleaved,e!==null){a=e;do o=a.lane,os.lanes|=o,wa|=o,a=a.next;while(a!==e)}else a===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function ud(e){var t=mn(),n=t.queue;if(n===null)throw Error(Be(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(a!==null){n.pending=null;var l=a=a.next;do o=e(o,l.action),l=l.next;while(l!==a);kn(o,t.memoizedState)||(Us=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function fy(){}function hy(e,t){var n=os,r=mn(),a=t(),o=!kn(r.memoizedState,a);if(o&&(r.memoizedState=a,Us=!0),r=r.queue,Gf(xy.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||ws!==null&&ws.memoizedState.tag&1){if(n.flags|=2048,Di(9,gy.bind(null,n,r,a,t),void 0,null),bs===null)throw Error(Be(349));ya&30||py(n,t,a)}return a}function py(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=os.updateQueue,t===null?(t={lastEffect:null,stores:null},os.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function gy(e,t,n,r){t.value=n,t.getSnapshot=r,vy(t)&&yy(e)}function xy(e,t,n){return n(function(){vy(t)&&yy(e)})}function vy(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!kn(e,n)}catch{return!0}}function yy(e){var t=ir(e,1);t!==null&&jn(t,e,1,-1)}function Hp(e){var t=On();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$i,lastRenderedState:e},t.queue=e,e=e.dispatch=U1.bind(null,os,e),[t.memoizedState,e]}function Di(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=os.updateQueue,t===null?(t={lastEffect:null,stores:null},os.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function wy(){return mn().memoizedState}function Hl(e,t,n,r){var a=On();os.flags|=e,a.memoizedState=Di(1|t,n,void 0,r===void 0?null:r)}function Zc(e,t,n,r){var a=mn();r=r===void 0?null:r;var o=void 0;if(vs!==null){var l=vs.memoizedState;if(o=l.destroy,r!==null&&zf(r,l.deps)){a.memoizedState=Di(t,n,o,r);return}}os.flags|=e,a.memoizedState=Di(1|t,n,o,r)}function Qp(e,t){return Hl(8390656,8,e,t)}function Gf(e,t){return Zc(2048,8,e,t)}function by(e,t){return Zc(4,2,e,t)}function Ny(e,t){return Zc(4,4,e,t)}function jy(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Sy(e,t,n){return n=n!=null?n.concat([e]):null,Zc(4,4,jy.bind(null,t,e),n)}function qf(){}function ky(e,t){var n=mn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Py(e,t){var n=mn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&zf(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ay(e,t,n){return ya&21?(kn(n,t)||(n=Rv(),os.lanes|=n,wa|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Us=!0),e.memoizedState=n)}function B1(e,t){var n=Ut;Ut=n!==0&&4>n?n:4,e(!0);var r=ld.transition;ld.transition={};try{e(!1),t()}finally{Ut=n,ld.transition=r}}function Cy(){return mn().memoizedState}function W1(e,t,n){var r=Lr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ey(e))Iy(t,n);else if(n=uy(e,t,n,r),n!==null){var a=Ms();jn(n,e,r,a),Ty(n,t,r)}}function U1(e,t,n){var r=Lr(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ey(e))Iy(t,a);else{var o=e.alternate;if(e.lanes===0&&(o===null||o.lanes===0)&&(o=t.lastRenderedReducer,o!==null))try{var l=t.lastRenderedState,c=o(l,n);if(a.hasEagerState=!0,a.eagerState=c,kn(c,l)){var u=t.interleaved;u===null?(a.next=a,Lf(t)):(a.next=u.next,u.next=a),t.interleaved=a;return}}catch{}finally{}n=uy(e,t,a,r),n!==null&&(a=Ms(),jn(n,e,r,a),Ty(n,t,r))}}function Ey(e){var t=e.alternate;return e===os||t!==null&&t===os}function Iy(e,t){mi=bc=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ty(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,kf(e,n)}}var Nc={readContext:dn,useCallback:Ps,useContext:Ps,useEffect:Ps,useImperativeHandle:Ps,useInsertionEffect:Ps,useLayoutEffect:Ps,useMemo:Ps,useReducer:Ps,useRef:Ps,useState:Ps,useDebugValue:Ps,useDeferredValue:Ps,useTransition:Ps,useMutableSource:Ps,useSyncExternalStore:Ps,useId:Ps,unstable_isNewReconciler:!1},z1={readContext:dn,useCallback:function(e,t){return On().memoizedState=[e,t===void 0?null:t],e},useContext:dn,useEffect:Qp,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Hl(4194308,4,jy.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Hl(4194308,4,e,t)},useInsertionEffect:function(e,t){return Hl(4,2,e,t)},useMemo:function(e,t){var n=On();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=On();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=W1.bind(null,os,e),[r.memoizedState,e]},useRef:function(e){var t=On();return e={current:e},t.memoizedState=e},useState:Hp,useDebugValue:qf,useDeferredValue:function(e){return On().memoizedState=e},useTransition:function(){var e=Hp(!1),t=e[0];return e=B1.bind(null,e[1]),On().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=os,a=On();if(rs){if(n===void 0)throw Error(Be(407));n=n()}else{if(n=t(),bs===null)throw Error(Be(349));ya&30||py(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,Qp(xy.bind(null,r,o,e),[e]),r.flags|=2048,Di(9,gy.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=On(),t=bs.identifierPrefix;if(rs){var n=nr,r=sr;n=(r&~(1<<32-Nn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Mi++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=V1++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},H1={readContext:dn,useCallback:ky,useContext:dn,useEffect:Gf,useImperativeHandle:Sy,useInsertionEffect:by,useLayoutEffect:Ny,useMemo:Py,useReducer:cd,useRef:wy,useState:function(){return cd($i)},useDebugValue:qf,useDeferredValue:function(e){var t=mn();return Ay(t,vs.memoizedState,e)},useTransition:function(){var e=cd($i)[0],t=mn().memoizedState;return[e,t]},useMutableSource:fy,useSyncExternalStore:hy,useId:Cy,unstable_isNewReconciler:!1},Q1={readContext:dn,useCallback:ky,useContext:dn,useEffect:Gf,useImperativeHandle:Sy,useInsertionEffect:by,useLayoutEffect:Ny,useMemo:Py,useReducer:ud,useRef:wy,useState:function(){return ud($i)},useDebugValue:qf,useDeferredValue:function(e){var t=mn();return vs===null?t.memoizedState=e:Ay(t,vs.memoizedState,e)},useTransition:function(){var e=ud($i)[0],t=mn().memoizedState;return[e,t]},useMutableSource:fy,useSyncExternalStore:hy,useId:Cy,unstable_isNewReconciler:!1};function yn(e,t){if(e&&e.defaultProps){t=is({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wm(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:is({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var eu={isMounted:function(e){return(e=e._reactInternals)?Ea(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ms(),a=Lr(e),o=rr(r,a);o.payload=t,n!=null&&(o.callback=n),t=Fr(e,o,a),t!==null&&(jn(t,e,a,r),Ul(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ms(),a=Lr(e),o=rr(r,a);o.tag=1,o.payload=t,n!=null&&(o.callback=n),t=Fr(e,o,a),t!==null&&(jn(t,e,a,r),Ul(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ms(),r=Lr(e),a=rr(n,r);a.tag=2,t!=null&&(a.callback=t),t=Fr(e,a,r),t!==null&&(jn(t,e,r,n),Ul(t,e,r))}};function Gp(e,t,n,r,a,o,l){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,o,l):t.prototype&&t.prototype.isPureReactComponent?!Ai(n,r)||!Ai(a,o):!0}function Ry(e,t,n){var r=!1,a=Ur,o=t.contextType;return typeof o=="object"&&o!==null?o=dn(o):(a=Hs(t)?xa:Is.current,r=t.contextTypes,o=(r=r!=null)?uo(e,a):Ur),t=new t(n,o),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=eu,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function qp(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&eu.enqueueReplaceState(t,t.state,null)}function bm(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs={},Vf(e);var o=t.contextType;typeof o=="object"&&o!==null?a.context=dn(o):(o=Hs(t)?xa:Is.current,a.context=uo(e,o)),a.state=e.memoizedState,o=t.getDerivedStateFromProps,typeof o=="function"&&(wm(e,t,o,n),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&eu.enqueueReplaceState(a,a.state,null),yc(e,n,a,r),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function po(e,t){try{var n="",r=t;do n+=wS(r),r=r.return;while(r);var a=n}catch(o){a=`
Error generating stack: `+o.message+`
`+o.stack}return{value:e,source:t,stack:a,digest:null}}function dd(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function Nm(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var G1=typeof WeakMap=="function"?WeakMap:Map;function My(e,t,n){n=rr(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Sc||(Sc=!0,Rm=r),Nm(e,t)},n}function $y(e,t,n){n=rr(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){Nm(e,t)}}var o=e.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Nm(e,t),typeof r!="function"&&(_r===null?_r=new Set([this]):_r.add(this));var l=t.stack;this.componentDidCatch(t.value,{componentStack:l!==null?l:""})}),n}function Yp(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new G1;var a=new Set;r.set(t,a)}else a=r.get(t),a===void 0&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=ik.bind(null,e,t,n),t.then(e,e))}function Jp(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Kp(e,t,n,r,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=rr(-1,1),t.tag=2,Fr(n,t,1))),n.lanes|=1),e)}var q1=dr.ReactCurrentOwner,Us=!1;function Rs(e,t,n,r){t.child=e===null?cy(t,null,n,r):fo(t,e.child,n,r)}function Xp(e,t,n,r,a){n=n.render;var o=t.ref;return no(t,a),r=Hf(e,t,n,r,o,a),n=Qf(),e!==null&&!Us?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,lr(e,t,a)):(rs&&n&&Mf(t),t.flags|=1,Rs(e,t,r,a),t.child)}function Zp(e,t,n,r,a){if(e===null){var o=n.type;return typeof o=="function"&&!sh(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=o,Dy(e,t,o,r,a)):(e=Yl(n.type,null,r,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(o=e.child,!(e.lanes&a)){var l=o.memoizedProps;if(n=n.compare,n=n!==null?n:Ai,n(l,r)&&e.ref===t.ref)return lr(e,t,a)}return t.flags|=1,e=Vr(o,r),e.ref=t.ref,e.return=t,t.child=e}function Dy(e,t,n,r,a){if(e!==null){var o=e.memoizedProps;if(Ai(o,r)&&e.ref===t.ref)if(Us=!1,t.pendingProps=r=o,(e.lanes&a)!==0)e.flags&131072&&(Us=!0);else return t.lanes=e.lanes,lr(e,t,a)}return jm(e,t,n,r,a)}function Oy(e,t,n){var r=t.pendingProps,a=r.children,o=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(Xa,Ys),Ys|=n;else{if(!(n&1073741824))return e=o!==null?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Jt(Xa,Ys),Ys|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Jt(Xa,Ys),Ys|=r}else o!==null?(r=o.baseLanes|n,t.memoizedState=null):r=n,Jt(Xa,Ys),Ys|=r;return Rs(e,t,a,n),t.child}function Fy(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function jm(e,t,n,r,a){var o=Hs(n)?xa:Is.current;return o=uo(t,o),no(t,a),n=Hf(e,t,n,r,o,a),r=Qf(),e!==null&&!Us?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,lr(e,t,a)):(rs&&r&&Mf(t),t.flags|=1,Rs(e,t,n,a),t.child)}function eg(e,t,n,r,a){if(Hs(n)){var o=!0;hc(t)}else o=!1;if(no(t,a),t.stateNode===null)Ql(e,t),Ry(t,n,r),bm(t,n,r,a),r=!0;else if(e===null){var l=t.stateNode,c=t.memoizedProps;l.props=c;var u=l.context,d=n.contextType;typeof d=="object"&&d!==null?d=dn(d):(d=Hs(n)?xa:Is.current,d=uo(t,d));var g=n.getDerivedStateFromProps,m=typeof g=="function"||typeof l.getSnapshotBeforeUpdate=="function";m||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==r||u!==d)&&qp(t,l,r,d),Ar=!1;var p=t.memoizedState;l.state=p,yc(t,r,l,a),u=t.memoizedState,c!==r||p!==u||zs.current||Ar?(typeof g=="function"&&(wm(t,n,g,r),u=t.memoizedState),(c=Ar||Gp(t,n,c,r,p,u,d))?(m||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(t.flags|=4194308)):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),l.props=r,l.state=u,l.context=d,r=c):(typeof l.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{l=t.stateNode,dy(e,t),c=t.memoizedProps,d=t.type===t.elementType?c:yn(t.type,c),l.props=d,m=t.pendingProps,p=l.context,u=n.contextType,typeof u=="object"&&u!==null?u=dn(u):(u=Hs(n)?xa:Is.current,u=uo(t,u));var f=n.getDerivedStateFromProps;(g=typeof f=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(c!==m||p!==u)&&qp(t,l,r,u),Ar=!1,p=t.memoizedState,l.state=p,yc(t,r,l,a);var w=t.memoizedState;c!==m||p!==w||zs.current||Ar?(typeof f=="function"&&(wm(t,n,f,r),w=t.memoizedState),(d=Ar||Gp(t,n,d,r,p,w,u)||!1)?(g||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,w,u),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,w,u)),typeof l.componentDidUpdate=="function"&&(t.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=w),l.props=r,l.state=w,l.context=u,r=d):(typeof l.componentDidUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||c===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Sm(e,t,n,r,o,a)}function Sm(e,t,n,r,a,o){Fy(e,t);var l=(t.flags&128)!==0;if(!r&&!l)return a&&Lp(t,n,!1),lr(e,t,o);r=t.stateNode,q1.current=t;var c=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&l?(t.child=fo(t,e.child,null,o),t.child=fo(t,null,c,o)):Rs(e,t,c,o),t.memoizedState=r.state,a&&Lp(t,n,!0),t.child}function _y(e){var t=e.stateNode;t.pendingContext?_p(e,t.pendingContext,t.pendingContext!==t.context):t.context&&_p(e,t.context,!1),Bf(e,t.containerInfo)}function tg(e,t,n,r,a){return mo(),Df(a),t.flags|=256,Rs(e,t,n,r),t.child}var km={dehydrated:null,treeContext:null,retryLane:0};function Pm(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ly(e,t,n){var r=t.pendingProps,a=as.current,o=!1,l=(t.flags&128)!==0,c;if((c=l)||(c=e!==null&&e.memoizedState===null?!1:(a&2)!==0),c?(o=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Jt(as,a&1),e===null)return vm(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(l=r.children,e=r.fallback,o?(r=t.mode,o=t.child,l={mode:"hidden",children:l},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=l):o=nu(l,r,0,null),e=pa(e,r,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Pm(n),t.memoizedState=km,e):Yf(t,l));if(a=e.memoizedState,a!==null&&(c=a.dehydrated,c!==null))return Y1(e,t,l,r,c,a,n);if(o){o=r.fallback,l=t.mode,a=e.child,c=a.sibling;var u={mode:"hidden",children:r.children};return!(l&1)&&t.child!==a?(r=t.child,r.childLanes=0,r.pendingProps=u,t.deletions=null):(r=Vr(a,u),r.subtreeFlags=a.subtreeFlags&14680064),c!==null?o=Vr(c,o):(o=pa(o,l,n,null),o.flags|=2),o.return=t,r.return=t,r.sibling=o,t.child=r,r=o,o=t.child,l=e.child.memoizedState,l=l===null?Pm(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=km,r}return o=e.child,e=o.sibling,r=Vr(o,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Yf(e,t){return t=nu({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Nl(e,t,n,r){return r!==null&&Df(r),fo(t,e.child,null,n),e=Yf(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Y1(e,t,n,r,a,o,l){if(n)return t.flags&256?(t.flags&=-257,r=dd(Error(Be(422))),Nl(e,t,l,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=nu({mode:"visible",children:r.children},a,0,null),o=pa(o,a,l,null),o.flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,t.mode&1&&fo(t,e.child,null,l),t.child.memoizedState=Pm(l),t.memoizedState=km,o);if(!(t.mode&1))return Nl(e,t,l,null);if(a.data==="$!"){if(r=a.nextSibling&&a.nextSibling.dataset,r)var c=r.dgst;return r=c,o=Error(Be(419)),r=dd(o,r,void 0),Nl(e,t,l,r)}if(c=(l&e.childLanes)!==0,Us||c){if(r=bs,r!==null){switch(l&-l){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(r.suspendedLanes|l)?0:a,a!==0&&a!==o.retryLane&&(o.retryLane=a,ir(e,a),jn(r,e,a,-1))}return th(),r=dd(Error(Be(421))),Nl(e,t,l,r)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=lk.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,Ks=Or(a.nextSibling),Xs=t,rs=!0,bn=null,e!==null&&(rn[an++]=sr,rn[an++]=nr,rn[an++]=va,sr=e.id,nr=e.overflow,va=t),t=Yf(t,r.children),t.flags|=4096,t)}function sg(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ym(e.return,t,n)}function md(e,t,n,r,a){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a)}function Vy(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(Rs(e,t,r.children,n),r=as.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&sg(e,n,t);else if(e.tag===19)sg(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Jt(as,r),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;n!==null;)e=n.alternate,e!==null&&wc(e)===null&&(a=n),n=n.sibling;n=a,n===null?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),md(t,!1,a,n,o);break;case"backwards":for(n=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&wc(e)===null){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}md(t,!0,n,null,o);break;case"together":md(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ql(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function lr(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),wa|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Be(153));if(t.child!==null){for(e=t.child,n=Vr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Vr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function J1(e,t,n){switch(t.tag){case 3:_y(t),mo();break;case 5:my(t);break;case 1:Hs(t.type)&&hc(t);break;case 4:Bf(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Jt(xc,r._currentValue),r._currentValue=a;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Jt(as,as.current&1),t.flags|=128,null):n&t.child.childLanes?Ly(e,t,n):(Jt(as,as.current&1),e=lr(e,t,n),e!==null?e.sibling:null);Jt(as,as.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Vy(e,t,n);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Jt(as,as.current),r)break;return null;case 22:case 23:return t.lanes=0,Oy(e,t,n)}return lr(e,t,n)}var By,Am,Wy,Uy;By=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Am=function(){};Wy=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,ma(Bn.current);var o=null;switch(n){case"input":a=Yd(e,a),r=Yd(e,r),o=[];break;case"select":a=is({},a,{value:void 0}),r=is({},r,{value:void 0}),o=[];break;case"textarea":a=Xd(e,a),r=Xd(e,r),o=[];break;default:typeof a.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=mc)}em(n,r);var l;n=null;for(d in a)if(!r.hasOwnProperty(d)&&a.hasOwnProperty(d)&&a[d]!=null)if(d==="style"){var c=a[d];for(l in c)c.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(wi.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var u=r[d];if(c=a!=null?a[d]:void 0,r.hasOwnProperty(d)&&u!==c&&(u!=null||c!=null))if(d==="style")if(c){for(l in c)!c.hasOwnProperty(l)||u&&u.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in u)u.hasOwnProperty(l)&&c[l]!==u[l]&&(n||(n={}),n[l]=u[l])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,c=c?c.__html:void 0,u!=null&&c!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(wi.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&es("scroll",e),o||c===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(t.updateQueue=d)&&(t.flags|=4)}};Uy=function(e,t,n,r){n!==r&&(t.flags|=4)};function Wo(e,t){if(!rs)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function As(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags&14680064,r|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function K1(e,t,n){var r=t.pendingProps;switch($f(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return As(t),null;case 1:return Hs(t.type)&&fc(),As(t),null;case 3:return r=t.stateNode,ho(),ss(zs),ss(Is),Uf(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(wl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bn!==null&&(Dm(bn),bn=null))),Am(e,t),As(t),null;case 5:Wf(t);var a=ma(Ri.current);if(n=t.type,e!==null&&t.stateNode!=null)Wy(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Be(166));return As(t),null}if(e=ma(Bn.current),wl(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[Fn]=t,r[Ii]=o,e=(t.mode&1)!==0,n){case"dialog":es("cancel",r),es("close",r);break;case"iframe":case"object":case"embed":es("load",r);break;case"video":case"audio":for(a=0;a<si.length;a++)es(si[a],r);break;case"source":es("error",r);break;case"img":case"image":case"link":es("error",r),es("load",r);break;case"details":es("toggle",r);break;case"input":dp(r,o),es("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},es("invalid",r);break;case"textarea":fp(r,o),es("invalid",r)}em(n,o),a=null;for(var l in o)if(o.hasOwnProperty(l)){var c=o[l];l==="children"?typeof c=="string"?r.textContent!==c&&(o.suppressHydrationWarning!==!0&&yl(r.textContent,c,e),a=["children",c]):typeof c=="number"&&r.textContent!==""+c&&(o.suppressHydrationWarning!==!0&&yl(r.textContent,c,e),a=["children",""+c]):wi.hasOwnProperty(l)&&c!=null&&l==="onScroll"&&es("scroll",r)}switch(n){case"input":dl(r),mp(r,o,!0);break;case"textarea":dl(r),hp(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=mc)}r=a,t.updateQueue=r,r!==null&&(t.flags|=4)}else{l=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=xv(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=l.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),n==="select"&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[Fn]=t,e[Ii]=r,By(e,t,!1,!1),t.stateNode=e;e:{switch(l=tm(n,r),n){case"dialog":es("cancel",e),es("close",e),a=r;break;case"iframe":case"object":case"embed":es("load",e),a=r;break;case"video":case"audio":for(a=0;a<si.length;a++)es(si[a],e);a=r;break;case"source":es("error",e),a=r;break;case"img":case"image":case"link":es("error",e),es("load",e),a=r;break;case"details":es("toggle",e),a=r;break;case"input":dp(e,r),a=Yd(e,r),es("invalid",e);break;case"option":a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=is({},r,{value:void 0}),es("invalid",e);break;case"textarea":fp(e,r),a=Xd(e,r),es("invalid",e);break;default:a=r}em(n,a),c=a;for(o in c)if(c.hasOwnProperty(o)){var u=c[o];o==="style"?wv(e,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&vv(e,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&bi(e,u):typeof u=="number"&&bi(e,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(wi.hasOwnProperty(o)?u!=null&&o==="onScroll"&&es("scroll",e):u!=null&&yf(e,o,u,l))}switch(n){case"input":dl(e),mp(e,r,!1);break;case"textarea":dl(e),hp(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Wr(r.value));break;case"select":e.multiple=!!r.multiple,o=r.value,o!=null?Za(e,!!r.multiple,o,!1):r.defaultValue!=null&&Za(e,!!r.multiple,r.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=mc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return As(t),null;case 6:if(e&&t.stateNode!=null)Uy(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Be(166));if(n=ma(Ri.current),ma(Bn.current),wl(t)){if(r=t.stateNode,n=t.memoizedProps,r[Fn]=t,(o=r.nodeValue!==n)&&(e=Xs,e!==null))switch(e.tag){case 3:yl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&yl(r.nodeValue,n,(e.mode&1)!==0)}o&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Fn]=t,t.stateNode=r}return As(t),null;case 13:if(ss(as),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rs&&Ks!==null&&t.mode&1&&!(t.flags&128))iy(),mo(),t.flags|=98560,o=!1;else if(o=wl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!o)throw Error(Be(318));if(o=t.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(Be(317));o[Fn]=t}else mo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;As(t),o=!1}else bn!==null&&(Dm(bn),bn=null),o=!0;if(!o)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||as.current&1?ys===0&&(ys=3):th())),t.updateQueue!==null&&(t.flags|=4),As(t),null);case 4:return ho(),Am(e,t),e===null&&Ci(t.stateNode.containerInfo),As(t),null;case 10:return _f(t.type._context),As(t),null;case 17:return Hs(t.type)&&fc(),As(t),null;case 19:if(ss(as),o=t.memoizedState,o===null)return As(t),null;if(r=(t.flags&128)!==0,l=o.rendering,l===null)if(r)Wo(o,!1);else{if(ys!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(l=wc(e),l!==null){for(t.flags|=128,Wo(o,!1),r=l.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)o=n,e=r,o.flags&=14680066,l=o.alternate,l===null?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Jt(as,as.current&1|2),t.child}e=e.sibling}o.tail!==null&&ds()>go&&(t.flags|=128,r=!0,Wo(o,!1),t.lanes=4194304)}else{if(!r)if(e=wc(l),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Wo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!l.alternate&&!rs)return As(t),null}else 2*ds()-o.renderingStartTime>go&&n!==1073741824&&(t.flags|=128,r=!0,Wo(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(n=o.last,n!==null?n.sibling=l:t.child=l,o.last=l)}return o.tail!==null?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=ds(),t.sibling=null,n=as.current,Jt(as,r?n&1|2:n&1),t):(As(t),null);case 22:case 23:return eh(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Ys&1073741824&&(As(t),t.subtreeFlags&6&&(t.flags|=8192)):As(t),null;case 24:return null;case 25:return null}throw Error(Be(156,t.tag))}function X1(e,t){switch($f(t),t.tag){case 1:return Hs(t.type)&&fc(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ho(),ss(zs),ss(Is),Uf(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Wf(t),null;case 13:if(ss(as),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Be(340));mo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ss(as),null;case 4:return ho(),null;case 10:return _f(t.type._context),null;case 22:case 23:return eh(),null;case 24:return null;default:return null}}var jl=!1,Cs=!1,Z1=typeof WeakSet=="function"?WeakSet:Set,et=null;function Ka(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){cs(e,t,r)}else n.current=null}function Cm(e,t,n){try{n()}catch(r){cs(e,t,r)}}var ng=!1;function ek(e,t){if(dm=cc,e=qv(),Rf(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var l=0,c=-1,u=-1,d=0,g=0,m=e,p=null;t:for(;;){for(var f;m!==n||a!==0&&m.nodeType!==3||(c=l+a),m!==o||r!==0&&m.nodeType!==3||(u=l+r),m.nodeType===3&&(l+=m.nodeValue.length),(f=m.firstChild)!==null;)p=m,m=f;for(;;){if(m===e)break t;if(p===n&&++d===a&&(c=l),p===o&&++g===r&&(u=l),(f=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=f}n=c===-1||u===-1?null:{start:c,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(mm={focusedElem:e,selectionRange:n},cc=!1,et=t;et!==null;)if(t=et,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,et=e;else for(;et!==null;){t=et;try{var w=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(w!==null){var h=w.memoizedProps,v=w.memoizedState,x=t.stateNode,y=x.getSnapshotBeforeUpdate(t.elementType===t.type?h:yn(t.type,h),v);x.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch(N){cs(t,t.return,N)}if(e=t.sibling,e!==null){e.return=t.return,et=e;break}et=t.return}return w=ng,ng=!1,w}function fi(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var o=a.destroy;a.destroy=void 0,o!==void 0&&Cm(t,n,o)}a=a.next}while(a!==r)}}function tu(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Em(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function zy(e){var t=e.alternate;t!==null&&(e.alternate=null,zy(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Fn],delete t[Ii],delete t[pm],delete t[O1],delete t[F1])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Hy(e){return e.tag===5||e.tag===3||e.tag===4}function rg(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Hy(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Im(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=mc));else if(r!==4&&(e=e.child,e!==null))for(Im(e,t,n),e=e.sibling;e!==null;)Im(e,t,n),e=e.sibling}function Tm(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Tm(e,t,n),e=e.sibling;e!==null;)Tm(e,t,n),e=e.sibling}var Ns=null,wn=!1;function wr(e,t,n){for(n=n.child;n!==null;)Qy(e,t,n),n=n.sibling}function Qy(e,t,n){if(Vn&&typeof Vn.onCommitFiberUnmount=="function")try{Vn.onCommitFiberUnmount(Gc,n)}catch{}switch(n.tag){case 5:Cs||Ka(n,t);case 6:var r=Ns,a=wn;Ns=null,wr(e,t,n),Ns=r,wn=a,Ns!==null&&(wn?(e=Ns,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ns.removeChild(n.stateNode));break;case 18:Ns!==null&&(wn?(e=Ns,n=n.stateNode,e.nodeType===8?ad(e.parentNode,n):e.nodeType===1&&ad(e,n),ki(e)):ad(Ns,n.stateNode));break;case 4:r=Ns,a=wn,Ns=n.stateNode.containerInfo,wn=!0,wr(e,t,n),Ns=r,wn=a;break;case 0:case 11:case 14:case 15:if(!Cs&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){a=r=r.next;do{var o=a,l=o.destroy;o=o.tag,l!==void 0&&(o&2||o&4)&&Cm(n,t,l),a=a.next}while(a!==r)}wr(e,t,n);break;case 1:if(!Cs&&(Ka(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(c){cs(n,t,c)}wr(e,t,n);break;case 21:wr(e,t,n);break;case 22:n.mode&1?(Cs=(r=Cs)||n.memoizedState!==null,wr(e,t,n),Cs=r):wr(e,t,n);break;default:wr(e,t,n)}}function ag(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Z1),t.forEach(function(r){var a=ck.bind(null,e,r);n.has(r)||(n.add(r),r.then(a,a))})}}function pn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,l=t,c=l;e:for(;c!==null;){switch(c.tag){case 5:Ns=c.stateNode,wn=!1;break e;case 3:Ns=c.stateNode.containerInfo,wn=!0;break e;case 4:Ns=c.stateNode.containerInfo,wn=!0;break e}c=c.return}if(Ns===null)throw Error(Be(160));Qy(o,l,a),Ns=null,wn=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(d){cs(a,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Gy(t,e),t=t.sibling}function Gy(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pn(t,e),$n(e),r&4){try{fi(3,e,e.return),tu(3,e)}catch(h){cs(e,e.return,h)}try{fi(5,e,e.return)}catch(h){cs(e,e.return,h)}}break;case 1:pn(t,e),$n(e),r&512&&n!==null&&Ka(n,n.return);break;case 5:if(pn(t,e),$n(e),r&512&&n!==null&&Ka(n,n.return),e.flags&32){var a=e.stateNode;try{bi(a,"")}catch(h){cs(e,e.return,h)}}if(r&4&&(a=e.stateNode,a!=null)){var o=e.memoizedProps,l=n!==null?n.memoizedProps:o,c=e.type,u=e.updateQueue;if(e.updateQueue=null,u!==null)try{c==="input"&&o.type==="radio"&&o.name!=null&&pv(a,o),tm(c,l);var d=tm(c,o);for(l=0;l<u.length;l+=2){var g=u[l],m=u[l+1];g==="style"?wv(a,m):g==="dangerouslySetInnerHTML"?vv(a,m):g==="children"?bi(a,m):yf(a,g,m,d)}switch(c){case"input":Jd(a,o);break;case"textarea":gv(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?Za(a,!!o.multiple,f,!1):p!==!!o.multiple&&(o.defaultValue!=null?Za(a,!!o.multiple,o.defaultValue,!0):Za(a,!!o.multiple,o.multiple?[]:"",!1))}a[Ii]=o}catch(h){cs(e,e.return,h)}}break;case 6:if(pn(t,e),$n(e),r&4){if(e.stateNode===null)throw Error(Be(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(h){cs(e,e.return,h)}}break;case 3:if(pn(t,e),$n(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ki(t.containerInfo)}catch(h){cs(e,e.return,h)}break;case 4:pn(t,e),$n(e);break;case 13:pn(t,e),$n(e),a=e.child,a.flags&8192&&(o=a.memoizedState!==null,a.stateNode.isHidden=o,!o||a.alternate!==null&&a.alternate.memoizedState!==null||(Xf=ds())),r&4&&ag(e);break;case 22:if(g=n!==null&&n.memoizedState!==null,e.mode&1?(Cs=(d=Cs)||g,pn(t,e),Cs=d):pn(t,e),$n(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!g&&e.mode&1)for(et=e,g=e.child;g!==null;){for(m=et=g;et!==null;){switch(p=et,f=p.child,p.tag){case 0:case 11:case 14:case 15:fi(4,p,p.return);break;case 1:Ka(p,p.return);var w=p.stateNode;if(typeof w.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,w.props=t.memoizedProps,w.state=t.memoizedState,w.componentWillUnmount()}catch(h){cs(r,n,h)}}break;case 5:Ka(p,p.return);break;case 22:if(p.memoizedState!==null){ig(m);continue}}f!==null?(f.return=p,et=f):ig(m)}g=g.sibling}e:for(g=null,m=e;;){if(m.tag===5){if(g===null){g=m;try{a=m.stateNode,d?(o=a.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(c=m.stateNode,u=m.memoizedProps.style,l=u!=null&&u.hasOwnProperty("display")?u.display:null,c.style.display=yv("display",l))}catch(h){cs(e,e.return,h)}}}else if(m.tag===6){if(g===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(h){cs(e,e.return,h)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;g===m&&(g=null),m=m.return}g===m&&(g=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:pn(t,e),$n(e),r&4&&ag(e);break;case 21:break;default:pn(t,e),$n(e)}}function $n(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Hy(n)){var r=n;break e}n=n.return}throw Error(Be(160))}switch(r.tag){case 5:var a=r.stateNode;r.flags&32&&(bi(a,""),r.flags&=-33);var o=rg(e);Tm(e,o,a);break;case 3:case 4:var l=r.stateNode.containerInfo,c=rg(e);Im(e,c,l);break;default:throw Error(Be(161))}}catch(u){cs(e,e.return,u)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function tk(e,t,n){et=e,qy(e)}function qy(e,t,n){for(var r=(e.mode&1)!==0;et!==null;){var a=et,o=a.child;if(a.tag===22&&r){var l=a.memoizedState!==null||jl;if(!l){var c=a.alternate,u=c!==null&&c.memoizedState!==null||Cs;c=jl;var d=Cs;if(jl=l,(Cs=u)&&!d)for(et=a;et!==null;)l=et,u=l.child,l.tag===22&&l.memoizedState!==null?lg(a):u!==null?(u.return=l,et=u):lg(a);for(;o!==null;)et=o,qy(o),o=o.sibling;et=a,jl=c,Cs=d}og(e)}else a.subtreeFlags&8772&&o!==null?(o.return=a,et=o):og(e)}}function og(e){for(;et!==null;){var t=et;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Cs||tu(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Cs)if(n===null)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:yn(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;o!==null&&zp(t,o,r);break;case 3:var l=t.updateQueue;if(l!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}zp(t,l,n)}break;case 5:var c=t.stateNode;if(n===null&&t.flags&4){n=c;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var g=d.memoizedState;if(g!==null){var m=g.dehydrated;m!==null&&ki(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Cs||t.flags&512&&Em(t)}catch(p){cs(t,t.return,p)}}if(t===e){et=null;break}if(n=t.sibling,n!==null){n.return=t.return,et=n;break}et=t.return}}function ig(e){for(;et!==null;){var t=et;if(t===e){et=null;break}var n=t.sibling;if(n!==null){n.return=t.return,et=n;break}et=t.return}}function lg(e){for(;et!==null;){var t=et;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{tu(4,t)}catch(u){cs(t,n,u)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var a=t.return;try{r.componentDidMount()}catch(u){cs(t,a,u)}}var o=t.return;try{Em(t)}catch(u){cs(t,o,u)}break;case 5:var l=t.return;try{Em(t)}catch(u){cs(t,l,u)}}}catch(u){cs(t,t.return,u)}if(t===e){et=null;break}var c=t.sibling;if(c!==null){c.return=t.return,et=c;break}et=t.return}}var sk=Math.ceil,jc=dr.ReactCurrentDispatcher,Jf=dr.ReactCurrentOwner,cn=dr.ReactCurrentBatchConfig,Ot=0,bs=null,hs=null,js=0,Ys=0,Xa=Jr(0),ys=0,Oi=null,wa=0,su=0,Kf=0,hi=null,Ws=null,Xf=0,go=1/0,Zn=null,Sc=!1,Rm=null,_r=null,Sl=!1,Tr=null,kc=0,pi=0,Mm=null,Gl=-1,ql=0;function Ms(){return Ot&6?ds():Gl!==-1?Gl:Gl=ds()}function Lr(e){return e.mode&1?Ot&2&&js!==0?js&-js:L1.transition!==null?(ql===0&&(ql=Rv()),ql):(e=Ut,e!==0||(e=window.event,e=e===void 0?16:Lv(e.type)),e):1}function jn(e,t,n,r){if(50<pi)throw pi=0,Mm=null,Error(Be(185));Xi(e,n,r),(!(Ot&2)||e!==bs)&&(e===bs&&(!(Ot&2)&&(su|=n),ys===4&&Er(e,js)),Qs(e,r),n===1&&Ot===0&&!(t.mode&1)&&(go=ds()+500,Xc&&Kr()))}function Qs(e,t){var n=e.callbackNode;LS(e,t);var r=lc(e,e===bs?js:0);if(r===0)n!==null&&xp(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&xp(n),t===1)e.tag===0?_1(cg.bind(null,e)):ry(cg.bind(null,e)),$1(function(){!(Ot&6)&&Kr()}),n=null;else{switch(Mv(r)){case 1:n=Sf;break;case 4:n=Iv;break;case 16:n=ic;break;case 536870912:n=Tv;break;default:n=ic}n=sw(n,Yy.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Yy(e,t){if(Gl=-1,ql=0,Ot&6)throw Error(Be(327));var n=e.callbackNode;if(ro()&&e.callbackNode!==n)return null;var r=lc(e,e===bs?js:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Pc(e,r);else{t=r;var a=Ot;Ot|=2;var o=Ky();(bs!==e||js!==t)&&(Zn=null,go=ds()+500,ha(e,t));do try{ak();break}catch(c){Jy(e,c)}while(!0);Ff(),jc.current=o,Ot=a,hs!==null?t=0:(bs=null,js=0,t=ys)}if(t!==0){if(t===2&&(a=om(e),a!==0&&(r=a,t=$m(e,a))),t===1)throw n=Oi,ha(e,0),Er(e,r),Qs(e,ds()),n;if(t===6)Er(e,r);else{if(a=e.current.alternate,!(r&30)&&!nk(a)&&(t=Pc(e,r),t===2&&(o=om(e),o!==0&&(r=o,t=$m(e,o))),t===1))throw n=Oi,ha(e,0),Er(e,r),Qs(e,ds()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(Be(345));case 2:oa(e,Ws,Zn);break;case 3:if(Er(e,r),(r&130023424)===r&&(t=Xf+500-ds(),10<t)){if(lc(e,0)!==0)break;if(a=e.suspendedLanes,(a&r)!==r){Ms(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=hm(oa.bind(null,e,Ws,Zn),t);break}oa(e,Ws,Zn);break;case 4:if(Er(e,r),(r&4194240)===r)break;for(t=e.eventTimes,a=-1;0<r;){var l=31-Nn(r);o=1<<l,l=t[l],l>a&&(a=l),r&=~o}if(r=a,r=ds()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*sk(r/1960))-r,10<r){e.timeoutHandle=hm(oa.bind(null,e,Ws,Zn),r);break}oa(e,Ws,Zn);break;case 5:oa(e,Ws,Zn);break;default:throw Error(Be(329))}}}return Qs(e,ds()),e.callbackNode===n?Yy.bind(null,e):null}function $m(e,t){var n=hi;return e.current.memoizedState.isDehydrated&&(ha(e,t).flags|=256),e=Pc(e,t),e!==2&&(t=Ws,Ws=n,t!==null&&Dm(t)),e}function Dm(e){Ws===null?Ws=e:Ws.push.apply(Ws,e)}function nk(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var a=n[r],o=a.getSnapshot;a=a.value;try{if(!kn(o(),a))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Er(e,t){for(t&=~Kf,t&=~su,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Nn(t),r=1<<n;e[n]=-1,t&=~r}}function cg(e){if(Ot&6)throw Error(Be(327));ro();var t=lc(e,0);if(!(t&1))return Qs(e,ds()),null;var n=Pc(e,t);if(e.tag!==0&&n===2){var r=om(e);r!==0&&(t=r,n=$m(e,r))}if(n===1)throw n=Oi,ha(e,0),Er(e,t),Qs(e,ds()),n;if(n===6)throw Error(Be(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,oa(e,Ws,Zn),Qs(e,ds()),null}function Zf(e,t){var n=Ot;Ot|=1;try{return e(t)}finally{Ot=n,Ot===0&&(go=ds()+500,Xc&&Kr())}}function ba(e){Tr!==null&&Tr.tag===0&&!(Ot&6)&&ro();var t=Ot;Ot|=1;var n=cn.transition,r=Ut;try{if(cn.transition=null,Ut=1,e)return e()}finally{Ut=r,cn.transition=n,Ot=t,!(Ot&6)&&Kr()}}function eh(){Ys=Xa.current,ss(Xa)}function ha(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,M1(n)),hs!==null)for(n=hs.return;n!==null;){var r=n;switch($f(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&fc();break;case 3:ho(),ss(zs),ss(Is),Uf();break;case 5:Wf(r);break;case 4:ho();break;case 13:ss(as);break;case 19:ss(as);break;case 10:_f(r.type._context);break;case 22:case 23:eh()}n=n.return}if(bs=e,hs=e=Vr(e.current,null),js=Ys=t,ys=0,Oi=null,Kf=su=wa=0,Ws=hi=null,da!==null){for(t=0;t<da.length;t++)if(n=da[t],r=n.interleaved,r!==null){n.interleaved=null;var a=r.next,o=n.pending;if(o!==null){var l=o.next;o.next=a,r.next=l}n.pending=r}da=null}return e}function Jy(e,t){do{var n=hs;try{if(Ff(),zl.current=Nc,bc){for(var r=os.memoizedState;r!==null;){var a=r.queue;a!==null&&(a.pending=null),r=r.next}bc=!1}if(ya=0,ws=vs=os=null,mi=!1,Mi=0,Jf.current=null,n===null||n.return===null){ys=1,Oi=t,hs=null;break}e:{var o=e,l=n.return,c=n,u=t;if(t=js,c.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,g=c,m=g.tag;if(!(g.mode&1)&&(m===0||m===11||m===15)){var p=g.alternate;p?(g.updateQueue=p.updateQueue,g.memoizedState=p.memoizedState,g.lanes=p.lanes):(g.updateQueue=null,g.memoizedState=null)}var f=Jp(l);if(f!==null){f.flags&=-257,Kp(f,l,c,o,t),f.mode&1&&Yp(o,d,t),t=f,u=d;var w=t.updateQueue;if(w===null){var h=new Set;h.add(u),t.updateQueue=h}else w.add(u);break e}else{if(!(t&1)){Yp(o,d,t),th();break e}u=Error(Be(426))}}else if(rs&&c.mode&1){var v=Jp(l);if(v!==null){!(v.flags&65536)&&(v.flags|=256),Kp(v,l,c,o,t),Df(po(u,c));break e}}o=u=po(u,c),ys!==4&&(ys=2),hi===null?hi=[o]:hi.push(o),o=l;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var x=My(o,u,t);Up(o,x);break e;case 1:c=u;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(_r===null||!_r.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t;var N=$y(o,c,t);Up(o,N);break e}}o=o.return}while(o!==null)}Zy(n)}catch(S){t=S,hs===n&&n!==null&&(hs=n=n.return);continue}break}while(!0)}function Ky(){var e=jc.current;return jc.current=Nc,e===null?Nc:e}function th(){(ys===0||ys===3||ys===2)&&(ys=4),bs===null||!(wa&268435455)&&!(su&268435455)||Er(bs,js)}function Pc(e,t){var n=Ot;Ot|=2;var r=Ky();(bs!==e||js!==t)&&(Zn=null,ha(e,t));do try{rk();break}catch(a){Jy(e,a)}while(!0);if(Ff(),Ot=n,jc.current=r,hs!==null)throw Error(Be(261));return bs=null,js=0,ys}function rk(){for(;hs!==null;)Xy(hs)}function ak(){for(;hs!==null&&!IS();)Xy(hs)}function Xy(e){var t=tw(e.alternate,e,Ys);e.memoizedProps=e.pendingProps,t===null?Zy(e):hs=t,Jf.current=null}function Zy(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=X1(n,t),n!==null){n.flags&=32767,hs=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{ys=6,hs=null;return}}else if(n=K1(n,t,Ys),n!==null){hs=n;return}if(t=t.sibling,t!==null){hs=t;return}hs=t=e}while(t!==null);ys===0&&(ys=5)}function oa(e,t,n){var r=Ut,a=cn.transition;try{cn.transition=null,Ut=1,ok(e,t,n,r)}finally{cn.transition=a,Ut=r}return null}function ok(e,t,n,r){do ro();while(Tr!==null);if(Ot&6)throw Error(Be(327));n=e.finishedWork;var a=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Be(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(VS(e,o),e===bs&&(hs=bs=null,js=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Sl||(Sl=!0,sw(ic,function(){return ro(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=cn.transition,cn.transition=null;var l=Ut;Ut=1;var c=Ot;Ot|=4,Jf.current=null,ek(e,n),Gy(n,e),P1(mm),cc=!!dm,mm=dm=null,e.current=n,tk(n),TS(),Ot=c,Ut=l,cn.transition=o}else e.current=n;if(Sl&&(Sl=!1,Tr=e,kc=a),o=e.pendingLanes,o===0&&(_r=null),$S(n.stateNode),Qs(e,ds()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)a=t[n],r(a.value,{componentStack:a.stack,digest:a.digest});if(Sc)throw Sc=!1,e=Rm,Rm=null,e;return kc&1&&e.tag!==0&&ro(),o=e.pendingLanes,o&1?e===Mm?pi++:(pi=0,Mm=e):pi=0,Kr(),null}function ro(){if(Tr!==null){var e=Mv(kc),t=cn.transition,n=Ut;try{if(cn.transition=null,Ut=16>e?16:e,Tr===null)var r=!1;else{if(e=Tr,Tr=null,kc=0,Ot&6)throw Error(Be(331));var a=Ot;for(Ot|=4,et=e.current;et!==null;){var o=et,l=o.child;if(et.flags&16){var c=o.deletions;if(c!==null){for(var u=0;u<c.length;u++){var d=c[u];for(et=d;et!==null;){var g=et;switch(g.tag){case 0:case 11:case 15:fi(8,g,o)}var m=g.child;if(m!==null)m.return=g,et=m;else for(;et!==null;){g=et;var p=g.sibling,f=g.return;if(zy(g),g===d){et=null;break}if(p!==null){p.return=f,et=p;break}et=f}}}var w=o.alternate;if(w!==null){var h=w.child;if(h!==null){w.child=null;do{var v=h.sibling;h.sibling=null,h=v}while(h!==null)}}et=o}}if(o.subtreeFlags&2064&&l!==null)l.return=o,et=l;else e:for(;et!==null;){if(o=et,o.flags&2048)switch(o.tag){case 0:case 11:case 15:fi(9,o,o.return)}var x=o.sibling;if(x!==null){x.return=o.return,et=x;break e}et=o.return}}var y=e.current;for(et=y;et!==null;){l=et;var b=l.child;if(l.subtreeFlags&2064&&b!==null)b.return=l,et=b;else e:for(l=y;et!==null;){if(c=et,c.flags&2048)try{switch(c.tag){case 0:case 11:case 15:tu(9,c)}}catch(S){cs(c,c.return,S)}if(c===l){et=null;break e}var N=c.sibling;if(N!==null){N.return=c.return,et=N;break e}et=c.return}}if(Ot=a,Kr(),Vn&&typeof Vn.onPostCommitFiberRoot=="function")try{Vn.onPostCommitFiberRoot(Gc,e)}catch{}r=!0}return r}finally{Ut=n,cn.transition=t}}return!1}function ug(e,t,n){t=po(n,t),t=My(e,t,1),e=Fr(e,t,1),t=Ms(),e!==null&&(Xi(e,1,t),Qs(e,t))}function cs(e,t,n){if(e.tag===3)ug(e,e,n);else for(;t!==null;){if(t.tag===3){ug(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_r===null||!_r.has(r))){e=po(n,e),e=$y(t,e,1),t=Fr(t,e,1),e=Ms(),t!==null&&(Xi(t,1,e),Qs(t,e));break}}t=t.return}}function ik(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ms(),e.pingedLanes|=e.suspendedLanes&n,bs===e&&(js&n)===n&&(ys===4||ys===3&&(js&130023424)===js&&500>ds()-Xf?ha(e,0):Kf|=n),Qs(e,t)}function ew(e,t){t===0&&(e.mode&1?(t=hl,hl<<=1,!(hl&130023424)&&(hl=4194304)):t=1);var n=Ms();e=ir(e,t),e!==null&&(Xi(e,t,n),Qs(e,n))}function lk(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),ew(e,n)}function ck(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Be(314))}r!==null&&r.delete(t),ew(e,n)}var tw;tw=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||zs.current)Us=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Us=!1,J1(e,t,n);Us=!!(e.flags&131072)}else Us=!1,rs&&t.flags&1048576&&ay(t,gc,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ql(e,t),e=t.pendingProps;var a=uo(t,Is.current);no(t,n),a=Hf(null,t,r,e,a,n);var o=Qf();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Hs(r)?(o=!0,hc(t)):o=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Vf(t),a.updater=eu,t.stateNode=a,a._reactInternals=t,bm(t,r,e,n),t=Sm(null,t,r,!0,o,n)):(t.tag=0,rs&&o&&Mf(t),Rs(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ql(e,t),e=t.pendingProps,a=r._init,r=a(r._payload),t.type=r,a=t.tag=dk(r),e=yn(r,e),a){case 0:t=jm(null,t,r,e,n);break e;case 1:t=eg(null,t,r,e,n);break e;case 11:t=Xp(null,t,r,e,n);break e;case 14:t=Zp(null,t,r,yn(r.type,e),n);break e}throw Error(Be(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:yn(r,a),jm(e,t,r,a,n);case 1:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:yn(r,a),eg(e,t,r,a,n);case 3:e:{if(_y(t),e===null)throw Error(Be(387));r=t.pendingProps,o=t.memoizedState,a=o.element,dy(e,t),yc(t,r,null,n);var l=t.memoizedState;if(r=l.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){a=po(Error(Be(423)),t),t=tg(e,t,r,n,a);break e}else if(r!==a){a=po(Error(Be(424)),t),t=tg(e,t,r,n,a);break e}else for(Ks=Or(t.stateNode.containerInfo.firstChild),Xs=t,rs=!0,bn=null,n=cy(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(mo(),r===a){t=lr(e,t,n);break e}Rs(e,t,r,n)}t=t.child}return t;case 5:return my(t),e===null&&vm(t),r=t.type,a=t.pendingProps,o=e!==null?e.memoizedProps:null,l=a.children,fm(r,a)?l=null:o!==null&&fm(r,o)&&(t.flags|=32),Fy(e,t),Rs(e,t,l,n),t.child;case 6:return e===null&&vm(t),null;case 13:return Ly(e,t,n);case 4:return Bf(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=fo(t,null,r,n):Rs(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:yn(r,a),Xp(e,t,r,a,n);case 7:return Rs(e,t,t.pendingProps,n),t.child;case 8:return Rs(e,t,t.pendingProps.children,n),t.child;case 12:return Rs(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,l=a.value,Jt(xc,r._currentValue),r._currentValue=l,o!==null)if(kn(o.value,l)){if(o.children===a.children&&!zs.current){t=lr(e,t,n);break e}}else for(o=t.child,o!==null&&(o.return=t);o!==null;){var c=o.dependencies;if(c!==null){l=o.child;for(var u=c.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=rr(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var g=d.pending;g===null?u.next=u:(u.next=g.next,g.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),ym(o.return,n,t),c.lanes|=n;break}u=u.next}}else if(o.tag===10)l=o.type===t.type?null:o.child;else if(o.tag===18){if(l=o.return,l===null)throw Error(Be(341));l.lanes|=n,c=l.alternate,c!==null&&(c.lanes|=n),ym(l,n,t),l=o.sibling}else l=o.child;if(l!==null)l.return=o;else for(l=o;l!==null;){if(l===t){l=null;break}if(o=l.sibling,o!==null){o.return=l.return,l=o;break}l=l.return}o=l}Rs(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,no(t,n),a=dn(a),r=r(a),t.flags|=1,Rs(e,t,r,n),t.child;case 14:return r=t.type,a=yn(r,t.pendingProps),a=yn(r.type,a),Zp(e,t,r,a,n);case 15:return Dy(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:yn(r,a),Ql(e,t),t.tag=1,Hs(r)?(e=!0,hc(t)):e=!1,no(t,n),Ry(t,r,a),bm(t,r,a,n),Sm(null,t,r,!0,e,n);case 19:return Vy(e,t,n);case 22:return Oy(e,t,n)}throw Error(Be(156,t.tag))};function sw(e,t){return Ev(e,t)}function uk(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(e,t,n,r){return new uk(e,t,n,r)}function sh(e){return e=e.prototype,!(!e||!e.isReactComponent)}function dk(e){if(typeof e=="function")return sh(e)?1:0;if(e!=null){if(e=e.$$typeof,e===bf)return 11;if(e===Nf)return 14}return 2}function Vr(e,t){var n=e.alternate;return n===null?(n=on(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Yl(e,t,n,r,a,o){var l=2;if(r=e,typeof e=="function")sh(e)&&(l=1);else if(typeof e=="string")l=5;else e:switch(e){case Wa:return pa(n.children,a,o,t);case wf:l=8,a|=8;break;case Hd:return e=on(12,n,t,a|2),e.elementType=Hd,e.lanes=o,e;case Qd:return e=on(13,n,t,a),e.elementType=Qd,e.lanes=o,e;case Gd:return e=on(19,n,t,a),e.elementType=Gd,e.lanes=o,e;case mv:return nu(n,a,o,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case uv:l=10;break e;case dv:l=9;break e;case bf:l=11;break e;case Nf:l=14;break e;case Pr:l=16,r=null;break e}throw Error(Be(130,e==null?e:typeof e,""))}return t=on(l,n,t,a),t.elementType=e,t.type=r,t.lanes=o,t}function pa(e,t,n,r){return e=on(7,e,r,t),e.lanes=n,e}function nu(e,t,n,r){return e=on(22,e,r,t),e.elementType=mv,e.lanes=n,e.stateNode={isHidden:!1},e}function fd(e,t,n){return e=on(6,e,null,t),e.lanes=n,e}function hd(e,t,n){return t=on(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mk(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qu(0),this.expirationTimes=qu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qu(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function nh(e,t,n,r,a,o,l,c,u){return e=new mk(e,t,n,c,u),t===1?(t=1,o===!0&&(t|=8)):t=0,o=on(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vf(o),e}function fk(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ba,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function nw(e){if(!e)return Ur;e=e._reactInternals;e:{if(Ea(e)!==e||e.tag!==1)throw Error(Be(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Hs(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Be(171))}if(e.tag===1){var n=e.type;if(Hs(n))return ny(e,n,t)}return t}function rw(e,t,n,r,a,o,l,c,u){return e=nh(n,r,!0,e,a,o,l,c,u),e.context=nw(null),n=e.current,r=Ms(),a=Lr(n),o=rr(r,a),o.callback=t??null,Fr(n,o,a),e.current.lanes=a,Xi(e,a,r),Qs(e,r),e}function ru(e,t,n,r){var a=t.current,o=Ms(),l=Lr(a);return n=nw(n),t.context===null?t.context=n:t.pendingContext=n,t=rr(o,l),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Fr(a,t,l),e!==null&&(jn(e,a,l,o),Ul(e,a,l)),l}function Ac(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function dg(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function rh(e,t){dg(e,t),(e=e.alternate)&&dg(e,t)}function hk(){return null}var aw=typeof reportError=="function"?reportError:function(e){console.error(e)};function ah(e){this._internalRoot=e}au.prototype.render=ah.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Be(409));ru(e,t,null,null)};au.prototype.unmount=ah.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;ba(function(){ru(null,e,null,null)}),t[or]=null}};function au(e){this._internalRoot=e}au.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ov();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Cr.length&&t!==0&&t<Cr[n].priority;n++);Cr.splice(n,0,e),n===0&&_v(e)}};function oh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ou(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function mg(){}function pk(e,t,n,r,a){if(a){if(typeof r=="function"){var o=r;r=function(){var d=Ac(l);o.call(d)}}var l=rw(t,r,e,0,null,!1,!1,"",mg);return e._reactRootContainer=l,e[or]=l.current,Ci(e.nodeType===8?e.parentNode:e),ba(),l}for(;a=e.lastChild;)e.removeChild(a);if(typeof r=="function"){var c=r;r=function(){var d=Ac(u);c.call(d)}}var u=nh(e,0,!1,null,null,!1,!1,"",mg);return e._reactRootContainer=u,e[or]=u.current,Ci(e.nodeType===8?e.parentNode:e),ba(function(){ru(t,u,n,r)}),u}function iu(e,t,n,r,a){var o=n._reactRootContainer;if(o){var l=o;if(typeof a=="function"){var c=a;a=function(){var u=Ac(l);c.call(u)}}ru(t,l,e,a)}else l=pk(n,t,e,a,r);return Ac(l)}$v=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ti(t.pendingLanes);n!==0&&(kf(t,n|1),Qs(t,ds()),!(Ot&6)&&(go=ds()+500,Kr()))}break;case 13:ba(function(){var r=ir(e,1);if(r!==null){var a=Ms();jn(r,e,1,a)}}),rh(e,1)}};Pf=function(e){if(e.tag===13){var t=ir(e,134217728);if(t!==null){var n=Ms();jn(t,e,134217728,n)}rh(e,134217728)}};Dv=function(e){if(e.tag===13){var t=Lr(e),n=ir(e,t);if(n!==null){var r=Ms();jn(n,e,t,r)}rh(e,t)}};Ov=function(){return Ut};Fv=function(e,t){var n=Ut;try{return Ut=e,t()}finally{Ut=n}};nm=function(e,t,n){switch(t){case"input":if(Jd(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=Kc(r);if(!a)throw Error(Be(90));hv(r),Jd(r,a)}}}break;case"textarea":gv(e,n);break;case"select":t=n.value,t!=null&&Za(e,!!n.multiple,t,!1)}};jv=Zf;Sv=ba;var gk={usingClientEntryPoint:!1,Events:[el,Qa,Kc,bv,Nv,Zf]},Uo={findFiberByHostInstance:ua,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},xk={bundleType:Uo.bundleType,version:Uo.version,rendererPackageName:Uo.rendererPackageName,rendererConfig:Uo.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:dr.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Av(e),e===null?null:e.stateNode},findFiberByHostInstance:Uo.findFiberByHostInstance||hk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var kl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!kl.isDisabled&&kl.supportsFiber)try{Gc=kl.inject(xk),Vn=kl}catch{}}sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gk;sn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oh(t))throw Error(Be(200));return fk(e,t,null,n)};sn.createRoot=function(e,t){if(!oh(e))throw Error(Be(299));var n=!1,r="",a=aw;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=nh(e,1,!1,null,null,n,!1,r,a),e[or]=t.current,Ci(e.nodeType===8?e.parentNode:e),new ah(t)};sn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Be(188)):(e=Object.keys(e).join(","),Error(Be(268,e)));return e=Av(t),e=e===null?null:e.stateNode,e};sn.flushSync=function(e){return ba(e)};sn.hydrate=function(e,t,n){if(!ou(t))throw Error(Be(200));return iu(null,e,t,!0,n)};sn.hydrateRoot=function(e,t,n){if(!oh(e))throw Error(Be(405));var r=n!=null&&n.hydratedSources||null,a=!1,o="",l=aw;if(n!=null&&(n.unstable_strictMode===!0&&(a=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),t=rw(t,null,e,1,n??null,a,!1,o,l),e[or]=t.current,Ci(e),r)for(e=0;e<r.length;e++)n=r[e],a=n._getVersion,a=a(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new au(t)};sn.render=function(e,t,n){if(!ou(t))throw Error(Be(200));return iu(null,e,t,!1,n)};sn.unmountComponentAtNode=function(e){if(!ou(e))throw Error(Be(40));return e._reactRootContainer?(ba(function(){iu(null,null,e,!1,function(){e._reactRootContainer=null,e[or]=null})}),!0):!1};sn.unstable_batchedUpdates=Zf;sn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ou(n))throw Error(Be(200));if(e==null||e._reactInternals===void 0)throw Error(Be(38));return iu(e,t,n,!1,r)};sn.version="18.3.1-next-f1338f8080-20240426";function ow(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ow)}catch(e){console.error(e)}}ow(),ov.exports=sn;var Eo=ov.exports;const iw=qx(Eo);var lw,fg=Eo;lw=fg.createRoot,fg.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Fi(){return Fi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Fi.apply(this,arguments)}var Rr;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Rr||(Rr={}));const hg="popstate";function vk(e){e===void 0&&(e={});function t(r,a){let{pathname:o,search:l,hash:c}=r.location;return Om("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Cc(a)}return wk(t,n,null,e)}function ms(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function cw(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function yk(){return Math.random().toString(36).substr(2,8)}function pg(e,t){return{usr:e.state,key:e.key,idx:t}}function Om(e,t,n,r){return n===void 0&&(n=null),Fi({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Io(t):t,{state:n,key:t&&t.key||r||yk()})}function Cc(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Io(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function wk(e,t,n,r){r===void 0&&(r={});let{window:a=document.defaultView,v5Compat:o=!1}=r,l=a.history,c=Rr.Pop,u=null,d=g();d==null&&(d=0,l.replaceState(Fi({},l.state,{idx:d}),""));function g(){return(l.state||{idx:null}).idx}function m(){c=Rr.Pop;let v=g(),x=v==null?null:v-d;d=v,u&&u({action:c,location:h.location,delta:x})}function p(v,x){c=Rr.Push;let y=Om(h.location,v,x);d=g()+1;let b=pg(y,d),N=h.createHref(y);try{l.pushState(b,"",N)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;a.location.assign(N)}o&&u&&u({action:c,location:h.location,delta:1})}function f(v,x){c=Rr.Replace;let y=Om(h.location,v,x);d=g();let b=pg(y,d),N=h.createHref(y);l.replaceState(b,"",N),o&&u&&u({action:c,location:h.location,delta:0})}function w(v){let x=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof v=="string"?v:Cc(v);return y=y.replace(/ $/,"%20"),ms(x,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,x)}let h={get action(){return c},get location(){return e(a,l)},listen(v){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(hg,m),u=v,()=>{a.removeEventListener(hg,m),u=null}},createHref(v){return t(a,v)},createURL:w,encodeLocation(v){let x=w(v);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:f,go(v){return l.go(v)}};return h}var gg;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(gg||(gg={}));function bk(e,t,n){return n===void 0&&(n="/"),Nk(e,t,n)}function Nk(e,t,n,r){let a=typeof t=="string"?Io(t):t,o=ih(a.pathname||"/",n);if(o==null)return null;let l=uw(e);jk(l);let c=null;for(let u=0;c==null&&u<l.length;++u){let d=Dk(o);c=Rk(l[u],d)}return c}function uw(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let a=(o,l,c)=>{let u={relativePath:c===void 0?o.path||"":c,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};u.relativePath.startsWith("/")&&(ms(u.relativePath.startsWith(r),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(r.length));let d=Br([r,u.relativePath]),g=n.concat(u);o.children&&o.children.length>0&&(ms(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),uw(o.children,t,g,d)),!(o.path==null&&!o.index)&&t.push({path:d,score:Ik(d,o.index),routesMeta:g})};return e.forEach((o,l)=>{var c;if(o.path===""||!((c=o.path)!=null&&c.includes("?")))a(o,l);else for(let u of dw(o.path))a(o,l,u)}),t}function dw(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let l=dw(r.join("/")),c=[];return c.push(...l.map(u=>u===""?o:[o,u].join("/"))),a&&c.push(...l),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function jk(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:Tk(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Sk=/^:[\w-]+$/,kk=3,Pk=2,Ak=1,Ck=10,Ek=-2,xg=e=>e==="*";function Ik(e,t){let n=e.split("/"),r=n.length;return n.some(xg)&&(r+=Ek),t&&(r+=Pk),n.filter(a=>!xg(a)).reduce((a,o)=>a+(Sk.test(o)?kk:o===""?Ak:Ck),r)}function Tk(e,t){return e.length===t.length&&e.slice(0,-1).every((r,a)=>r===t[a])?e[e.length-1]-t[t.length-1]:0}function Rk(e,t,n){let{routesMeta:r}=e,a={},o="/",l=[];for(let c=0;c<r.length;++c){let u=r[c],d=c===r.length-1,g=o==="/"?t:t.slice(o.length)||"/",m=Mk({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},g),p=u.route;if(!m)return null;Object.assign(a,m.params),l.push({params:a,pathname:Br([o,m.pathname]),pathnameBase:Lk(Br([o,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(o=Br([o,m.pathnameBase]))}return l}function Mk(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=$k(e.path,e.caseSensitive,e.end),a=t.match(n);if(!a)return null;let o=a[0],l=o.replace(/(.)\/+$/,"$1"),c=a.slice(1);return{params:r.reduce((d,g,m)=>{let{paramName:p,isOptional:f}=g;if(p==="*"){let h=c[m]||"";l=o.slice(0,o.length-h.length).replace(/(.)\/+$/,"$1")}const w=c[m];return f&&!w?d[p]=void 0:d[p]=(w||"").replace(/%2F/g,"/"),d},{}),pathname:o,pathnameBase:l,pattern:e}}function $k(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),cw(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,u)=>(r.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),r]}function Dk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return cw(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function ih(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function Ok(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:a=""}=typeof e=="string"?Io(e):e;return{pathname:n?n.startsWith("/")?n:Fk(n,t):t,search:Vk(r),hash:Bk(a)}}function Fk(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function pd(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _k(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function lh(e,t){let n=_k(e);return t?n.map((r,a)=>a===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function ch(e,t,n,r){r===void 0&&(r=!1);let a;typeof e=="string"?a=Io(e):(a=Fi({},e),ms(!a.pathname||!a.pathname.includes("?"),pd("?","pathname","search",a)),ms(!a.pathname||!a.pathname.includes("#"),pd("#","pathname","hash",a)),ms(!a.search||!a.search.includes("#"),pd("#","search","hash",a)));let o=e===""||a.pathname==="",l=o?"/":a.pathname,c;if(l==null)c=n;else{let m=t.length-1;if(!r&&l.startsWith("..")){let p=l.split("/");for(;p[0]==="..";)p.shift(),m-=1;a.pathname=p.join("/")}c=m>=0?t[m]:"/"}let u=Ok(a,c),d=l&&l!=="/"&&l.endsWith("/"),g=(o||l===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||g)&&(u.pathname+="/"),u}const Br=e=>e.join("/").replace(/\/\/+/g,"/"),Lk=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Vk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Bk=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Wk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const mw=["post","put","patch","delete"];new Set(mw);const Uk=["get",...mw];new Set(Uk);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _i(){return _i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_i.apply(this,arguments)}const uh=i.createContext(null),zk=i.createContext(null),Xr=i.createContext(null),lu=i.createContext(null),mr=i.createContext({outlet:null,matches:[],isDataRoute:!1}),fw=i.createContext(null);function Hk(e,t){let{relative:n}=t===void 0?{}:t;To()||ms(!1);let{basename:r,navigator:a}=i.useContext(Xr),{hash:o,pathname:l,search:c}=pw(e,{relative:n}),u=l;return r!=="/"&&(u=l==="/"?r:Br([r,l])),a.createHref({pathname:u,search:c,hash:o})}function To(){return i.useContext(lu)!=null}function En(){return To()||ms(!1),i.useContext(lu).location}function hw(e){i.useContext(Xr).static||i.useLayoutEffect(e)}function Lt(){let{isDataRoute:e}=i.useContext(mr);return e?o2():Qk()}function Qk(){To()||ms(!1);let e=i.useContext(uh),{basename:t,future:n,navigator:r}=i.useContext(Xr),{matches:a}=i.useContext(mr),{pathname:o}=En(),l=JSON.stringify(lh(a,n.v7_relativeSplatPath)),c=i.useRef(!1);return hw(()=>{c.current=!0}),i.useCallback(function(d,g){if(g===void 0&&(g={}),!c.current)return;if(typeof d=="number"){r.go(d);return}let m=ch(d,JSON.parse(l),o,g.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Br([t,m.pathname])),(g.replace?r.replace:r.push)(m,g.state,g)},[t,r,l,o,e])}const Gk=i.createContext(null);function qk(e){let t=i.useContext(mr).outlet;return t&&i.createElement(Gk.Provider,{value:e},t)}function pw(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=i.useContext(Xr),{matches:a}=i.useContext(mr),{pathname:o}=En(),l=JSON.stringify(lh(a,r.v7_relativeSplatPath));return i.useMemo(()=>ch(e,JSON.parse(l),o,n==="path"),[e,l,o,n])}function Yk(e,t){return Jk(e,t)}function Jk(e,t,n,r){To()||ms(!1);let{navigator:a}=i.useContext(Xr),{matches:o}=i.useContext(mr),l=o[o.length-1],c=l?l.params:{};l&&l.pathname;let u=l?l.pathnameBase:"/";l&&l.route;let d=En(),g;if(t){var m;let v=typeof t=="string"?Io(t):t;u==="/"||(m=v.pathname)!=null&&m.startsWith(u)||ms(!1),g=v}else g=d;let p=g.pathname||"/",f=p;if(u!=="/"){let v=u.replace(/^\//,"").split("/");f="/"+p.replace(/^\//,"").split("/").slice(v.length).join("/")}let w=bk(e,{pathname:f}),h=t2(w&&w.map(v=>Object.assign({},v,{params:Object.assign({},c,v.params),pathname:Br([u,a.encodeLocation?a.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?u:Br([u,a.encodeLocation?a.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r);return t&&h?i.createElement(lu.Provider,{value:{location:_i({pathname:"/",search:"",hash:"",state:null,key:"default"},g),navigationType:Rr.Pop}},h):h}function Kk(){let e=a2(),t=Wk(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return i.createElement(i.Fragment,null,i.createElement("h2",null,"Unexpected Application Error!"),i.createElement("h3",{style:{fontStyle:"italic"}},t),n?i.createElement("pre",{style:a},n):null,null)}const Xk=i.createElement(Kk,null);class Zk extends i.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?i.createElement(mr.Provider,{value:this.props.routeContext},i.createElement(fw.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function e2(e){let{routeContext:t,match:n,children:r}=e,a=i.useContext(uh);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),i.createElement(mr.Provider,{value:t},r)}function t2(e,t,n,r){var a;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var o;if(!n)return null;if(n.errors)e=n.matches;else if((o=r)!=null&&o.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let l=e,c=(a=n)==null?void 0:a.errors;if(c!=null){let g=l.findIndex(m=>m.route.id&&(c==null?void 0:c[m.route.id])!==void 0);g>=0||ms(!1),l=l.slice(0,Math.min(l.length,g+1))}let u=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let g=0;g<l.length;g++){let m=l[g];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(d=g),m.route.id){let{loaderData:p,errors:f}=n,w=m.route.loader&&p[m.route.id]===void 0&&(!f||f[m.route.id]===void 0);if(m.route.lazy||w){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}return l.reduceRight((g,m,p)=>{let f,w=!1,h=null,v=null;n&&(f=c&&m.route.id?c[m.route.id]:void 0,h=m.route.errorElement||Xk,u&&(d<0&&p===0?(i2("route-fallback"),w=!0,v=null):d===p&&(w=!0,v=m.route.hydrateFallbackElement||null)));let x=t.concat(l.slice(0,p+1)),y=()=>{let b;return f?b=h:w?b=v:m.route.Component?b=i.createElement(m.route.Component,null):m.route.element?b=m.route.element:b=g,i.createElement(e2,{match:m,routeContext:{outlet:g,matches:x,isDataRoute:n!=null},children:b})};return n&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?i.createElement(Zk,{location:n.location,revalidation:n.revalidation,component:h,error:f,children:y(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):y()},null)}var gw=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(gw||{}),xw=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(xw||{});function s2(e){let t=i.useContext(uh);return t||ms(!1),t}function n2(e){let t=i.useContext(zk);return t||ms(!1),t}function r2(e){let t=i.useContext(mr);return t||ms(!1),t}function vw(e){let t=r2(),n=t.matches[t.matches.length-1];return n.route.id||ms(!1),n.route.id}function a2(){var e;let t=i.useContext(fw),n=n2(),r=vw();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function o2(){let{router:e}=s2(gw.UseNavigateStable),t=vw(xw.UseNavigateStable),n=i.useRef(!1);return hw(()=>{n.current=!0}),i.useCallback(function(a,o){o===void 0&&(o={}),n.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,_i({fromRouteId:t},o)))},[e,t])}const vg={};function i2(e,t,n){vg[e]||(vg[e]=!0)}function l2(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function c2(e){let{to:t,replace:n,state:r,relative:a}=e;To()||ms(!1);let{future:o,static:l}=i.useContext(Xr),{matches:c}=i.useContext(mr),{pathname:u}=En(),d=Lt(),g=ch(t,lh(c,o.v7_relativeSplatPath),u,a==="path"),m=JSON.stringify(g);return i.useEffect(()=>d(JSON.parse(m),{replace:n,state:r,relative:a}),[d,m,a,n,r]),null}function u2(e){return qk(e.context)}function jt(e){ms(!1)}function d2(e){let{basename:t="/",children:n=null,location:r,navigationType:a=Rr.Pop,navigator:o,static:l=!1,future:c}=e;To()&&ms(!1);let u=t.replace(/^\/*/,"/"),d=i.useMemo(()=>({basename:u,navigator:o,static:l,future:_i({v7_relativeSplatPath:!1},c)}),[u,c,o,l]);typeof r=="string"&&(r=Io(r));let{pathname:g="/",search:m="",hash:p="",state:f=null,key:w="default"}=r,h=i.useMemo(()=>{let v=ih(g,u);return v==null?null:{location:{pathname:v,search:m,hash:p,state:f,key:w},navigationType:a}},[u,g,m,p,f,w,a]);return h==null?null:i.createElement(Xr.Provider,{value:d},i.createElement(lu.Provider,{children:n,value:h}))}function m2(e){let{children:t,location:n}=e;return Yk(Fm(t),n)}new Promise(()=>{});function Fm(e,t){t===void 0&&(t=[]);let n=[];return i.Children.forEach(e,(r,a)=>{if(!i.isValidElement(r))return;let o=[...t,a];if(r.type===i.Fragment){n.push.apply(n,Fm(r.props.children,o));return}r.type!==jt&&ms(!1),!r.props.index||!r.props.children||ms(!1);let l={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Fm(r.props.children,o)),n.push(l)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _m(){return _m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_m.apply(this,arguments)}function f2(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,o;for(o=0;o<r.length;o++)a=r[o],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function h2(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function p2(e,t){return e.button===0&&(!t||t==="_self")&&!h2(e)}function Lm(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(a=>[n,a]):[[n,r]])},[]))}function g2(e,t){let n=Lm(e);return t&&t.forEach((r,a)=>{n.has(a)||t.getAll(a).forEach(o=>{n.append(a,o)})}),n}const x2=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],v2="6";try{window.__reactRouterVersion=v2}catch{}const y2="startTransition",yg=Qc[y2];function w2(e){let{basename:t,children:n,future:r,window:a}=e,o=i.useRef();o.current==null&&(o.current=vk({window:a,v5Compat:!0}));let l=o.current,[c,u]=i.useState({action:l.action,location:l.location}),{v7_startTransition:d}=r||{},g=i.useCallback(m=>{d&&yg?yg(()=>u(m)):u(m)},[u,d]);return i.useLayoutEffect(()=>l.listen(g),[l,g]),i.useEffect(()=>l2(r),[r]),i.createElement(d2,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const b2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",N2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,St=i.forwardRef(function(t,n){let{onClick:r,relative:a,reloadDocument:o,replace:l,state:c,target:u,to:d,preventScrollReset:g,viewTransition:m}=t,p=f2(t,x2),{basename:f}=i.useContext(Xr),w,h=!1;if(typeof d=="string"&&N2.test(d)&&(w=d,b2))try{let b=new URL(window.location.href),N=d.startsWith("//")?new URL(b.protocol+d):new URL(d),S=ih(N.pathname,f);N.origin===b.origin&&S!=null?d=S+N.search+N.hash:h=!0}catch{}let v=Hk(d,{relative:a}),x=j2(d,{replace:l,state:c,target:u,preventScrollReset:g,relative:a,viewTransition:m});function y(b){r&&r(b),b.defaultPrevented||x(b)}return i.createElement("a",_m({},p,{href:w||v,onClick:h||o?r:y,ref:n,target:u}))});var wg;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(wg||(wg={}));var bg;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(bg||(bg={}));function j2(e,t){let{target:n,replace:r,state:a,preventScrollReset:o,relative:l,viewTransition:c}=t===void 0?{}:t,u=Lt(),d=En(),g=pw(e,{relative:l});return i.useCallback(m=>{if(p2(m,n)){m.preventDefault();let p=r!==void 0?r:Cc(d)===Cc(g);u(e,{replace:p,state:a,preventScrollReset:o,relative:l,viewTransition:c})}},[d,u,g,r,a,n,e,o,l,c])}function cu(e){let t=i.useRef(Lm(e)),n=i.useRef(!1),r=En(),a=i.useMemo(()=>g2(r.search,n.current?null:t.current),[r.search]),o=Lt(),l=i.useCallback((c,u)=>{const d=Lm(typeof c=="function"?c(a):c);n.current=!0,o("?"+d,u)},[o,a]);return[a,l]}const S2="modulepreload",k2=function(e){return"/"+e},Ng={},tr=function(t,n,r){let a=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));a=Promise.allSettled(n.map(u=>{if(u=k2(u),u in Ng)return;Ng[u]=!0;const d=u.endsWith(".css"),g=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${g}`))return;const m=document.createElement("link");if(m.rel=d?"stylesheet":S2,d||(m.as="script"),m.crossOrigin="",m.href=u,c&&m.setAttribute("nonce",c),document.head.appendChild(m),d)return new Promise((p,f)=>{m.addEventListener("load",p),m.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return a.then(l=>{for(const c of l||[])c.status==="rejected"&&o(c.reason);return t().catch(o)})};function P2(){const e=window.location.hostname,t=window.location.protocol;return e!=="localhost"&&e!=="127.0.0.1"?`${t}//${e}:3000/api/v1`:"http://localhost:3000/api/v1"}const Fe=P2();class Oe{static getAuthHeaders(){const t=localStorage.getItem("accessToken");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}static async register(t){try{console.log("AuthService: Attempting registration to:",`${Fe}/auth/register`),console.log("AuthService: Registration data:",{...t,password:"***"});const n=await fetch(`${Fe}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log("AuthService: Response status:",n.status),console.log("AuthService: Response ok:",n.ok),!n.ok){const o=await n.json().catch(()=>({message:"Registration failed"}));throw console.error("AuthService: Error response:",o),new Error(o.message||"Registration failed")}const r=await n.json();console.log("AuthService: Registration successful, full response:",r);const a=r.data||r;if(console.log("AuthService: Registration data structure:",{hasAccessToken:!!a.access_token,hasRefreshToken:!!a.refresh_token,hasUser:!!a.user,userKeys:a.user?Object.keys(a.user):[]}),!a.access_token)throw console.error("AuthService: Missing access_token in response"),new Error("Invalid response: missing access token");if(!a.refresh_token)throw console.error("AuthService: Missing refresh_token in response"),new Error("Invalid response: missing refresh token");if(!a.user)throw console.error("AuthService: Missing user in response"),new Error("Invalid response: missing user data");return localStorage.setItem("accessToken",a.access_token),localStorage.setItem("refreshToken",a.refresh_token),localStorage.setItem("user",JSON.stringify(a.user)),console.log("AuthService: Tokens stored in localStorage"),{user:a.user,accessToken:a.access_token,refreshToken:a.refresh_token}}catch(n){throw console.error("AuthService: Error during registration:",n),n}}static async login(t){try{console.log("AuthService: Attempting login to:",`${Fe}/auth/login`),console.log("AuthService: Login data:",t);const n=await fetch(`${Fe}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(console.log("AuthService: Response status:",n.status),console.log("AuthService: Response ok:",n.ok),!n.ok){const o=await n.json().catch(()=>({message:"Login failed"}));throw console.error("AuthService: Error response:",o),new Error(o.message||"Login failed")}const r=await n.json();console.log("AuthService: Login successful, full response:",r);const a=r.data||r;if(console.log("AuthService: Login data structure:",{hasAccessToken:!!a.access_token,hasRefreshToken:!!a.refresh_token,hasUser:!!a.user,userKeys:a.user?Object.keys(a.user):[]}),!a.access_token)throw console.error("AuthService: Missing access_token in response"),new Error("Invalid response: missing access token");if(!a.refresh_token)throw console.error("AuthService: Missing refresh_token in response"),new Error("Invalid response: missing refresh token");if(!a.user)throw console.error("AuthService: Missing user in response"),new Error("Invalid response: missing user data");return localStorage.setItem("accessToken",a.access_token),localStorage.setItem("refreshToken",a.refresh_token),localStorage.setItem("user",JSON.stringify(a.user)),console.log("AuthService: Tokens stored in localStorage"),{user:a.user,accessToken:a.access_token,refreshToken:a.refresh_token}}catch(n){throw console.error("AuthService: Error during login:",n),n}}static async logout(){try{const t=localStorage.getItem("refreshToken");t&&await fetch(`${Fe}/auth/logout`,{method:"POST",headers:this.getAuthHeaders(),body:JSON.stringify({refresh_token:t})})}catch(t){console.error("Error during logout:",t)}finally{localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken"),localStorage.removeItem("user"),localStorage.removeItem("ava-session-state"),localStorage.removeItem("ava-chat-session"),localStorage.removeItem("currentWorkspace"),localStorage.removeItem("hasCompletedPayment")}}static async refreshToken(){return this.refreshPromise?this.refreshPromise:(this.refreshPromise=(async()=>{try{const t=localStorage.getItem("refreshToken");if(!t)throw new Error("No refresh token available");const n=await fetch(`${Fe}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh_token:t})});if(!n.ok){const o=await n.json().catch(()=>({message:"Token refresh failed"}));throw new Error(o.message||"Token refresh failed")}const r=await n.json(),a=r.data||r;if(!a.access_token)throw new Error("Invalid refresh response: missing access token");if(!a.refresh_token)throw new Error("Invalid refresh response: missing refresh token");return localStorage.setItem("accessToken",a.access_token),localStorage.setItem("refreshToken",a.refresh_token),a.user&&localStorage.setItem("user",JSON.stringify(a.user)),{user:a.user||this.getCurrentUser(),accessToken:a.access_token,refreshToken:a.refresh_token}}catch(t){throw console.error("Error refreshing token:",t),this.logout(),t}finally{this.refreshPromise=null}})(),this.refreshPromise)}static getCurrentUser(){try{const t=localStorage.getItem("user");return t?JSON.parse(t):null}catch(t){return console.error("Error getting current user:",t),null}}static getAccessToken(){return localStorage.getItem("accessToken")}static isAuthenticated(){const t=this.getAccessToken(),n=this.getCurrentUser();return!!(t&&n)}static getTokenExpiration(t){try{return JSON.parse(atob(t.split(".")[1])).exp||null}catch(n){return console.error("Error decoding token:",n),null}}static shouldRefreshToken(){const t=this.getAccessToken();if(!t)return!1;const n=this.getTokenExpiration(t);if(!n)return!0;const r=Math.floor(Date.now()/1e3);return n-r<300}static async ensureValidToken(){if(this.shouldRefreshToken())try{console.log(" Token expiring soon, refreshing proactively..."),await this.refreshToken()}catch(t){console.error(" Proactive token refresh failed:",t)}}static async makeAuthenticatedRequest(t,n={}){await this.ensureValidToken();const r=this.getAccessToken();if(!r)throw new Error("No access token available");let a=await fetch(t,{...n,headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`,...n.headers}});if(a.status===401)try{console.log(" Token expired, refreshing..."),await this.refreshToken();const o=this.getAccessToken();if(!o)throw new Error("Failed to get new token after refresh");a=await fetch(t,{...n,headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`,...n.headers}})}catch(o){throw console.error(" Token refresh failed:",o),this.logout(),window.location.pathname!=="/login"&&(window.location.href="/login"),o}return a}static async forgotPassword(t){try{console.log("AuthService: Requesting password reset for:",t);const n=await fetch(`${Fe}/auth/forgot-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t})});if(console.log("AuthService: Response status:",n.status),!n.ok){const r=await n.json().catch(()=>({message:"Failed to send reset email"}));throw console.error("AuthService: Error response:",r),new Error(r.message||"Failed to send reset email")}console.log("AuthService: Password reset email sent successfully")}catch(n){throw console.error("AuthService: Error during forgot password:",n),n}}static async resetPassword(t,n){try{console.log("AuthService: Resetting password with token");const r=await fetch(`${Fe}/auth/reset-password`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:t,password:n})});if(console.log("AuthService: Response status:",r.status),!r.ok){const a=await r.json().catch(()=>({message:"Failed to reset password"}));throw console.error("AuthService: Error response:",a),new Error(a.message||"Failed to reset password. The link may have expired.")}console.log("AuthService: Password reset successfully")}catch(r){throw console.error("AuthService: Error during password reset:",r),r}}}rp(Oe,"refreshPromise",null);const jg=e=>{let t;const n=new Set,r=(d,g)=>{const m=typeof d=="function"?d(t):d;if(!Object.is(m,t)){const p=t;t=g??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(f=>f(t,p))}},a=()=>t,c={setState:r,getState:a,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d))},u=t=e(r,a,c);return c},A2=e=>e?jg(e):jg,C2=e=>e;function E2(e,t=C2){const n=_e.useSyncExternalStore(e.subscribe,_e.useCallback(()=>t(e.getState()),[e,t]),_e.useCallback(()=>t(e.getInitialState()),[e,t]));return _e.useDebugValue(n),n}const I2=e=>{const t=A2(e),n=r=>E2(t,r);return Object.assign(n,t),n},uu=e=>I2;function yw(e,t){let n;try{n=e()}catch{return}return{getItem:a=>{var o;const l=u=>u===null?null:JSON.parse(u,void 0),c=(o=n.getItem(a))!=null?o:null;return c instanceof Promise?c.then(l):l(c)},setItem:(a,o)=>n.setItem(a,JSON.stringify(o,void 0)),removeItem:a=>n.removeItem(a)}}const Vm=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return Vm(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Vm(r)(n)}}}},T2=(e,t)=>(n,r,a)=>{let o={storage:yw(()=>localStorage),partialize:h=>h,version:0,merge:(h,v)=>({...v,...h}),...t},l=!1;const c=new Set,u=new Set;let d=o.storage;if(!d)return e((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),n(...h)},r,a);const g=()=>{const h=o.partialize({...r()});return d.setItem(o.name,{state:h,version:o.version})},m=a.setState;a.setState=(h,v)=>(m(h,v),g());const p=e((...h)=>(n(...h),g()),r,a);a.getInitialState=()=>p;let f;const w=()=>{var h,v;if(!d)return;l=!1,c.forEach(y=>{var b;return y((b=r())!=null?b:p)});const x=((v=o.onRehydrateStorage)==null?void 0:v.call(o,(h=r())!=null?h:p))||void 0;return Vm(d.getItem.bind(d))(o.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==o.version){if(o.migrate){const b=o.migrate(y.state,y.version);return b instanceof Promise?b.then(N=>[!0,N]):[!0,b]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var b;const[N,S]=y;if(f=o.merge(S,(b=r())!=null?b:p),n(f,!0),N)return g()}).then(()=>{x==null||x(f,void 0),f=r(),l=!0,u.forEach(y=>y(f))}).catch(y=>{x==null||x(void 0,y)})};return a.persist={setOptions:h=>{o={...o,...h},h.storage&&(d=h.storage)},clearStorage:()=>{d==null||d.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>w(),hasHydrated:()=>l,onHydrate:h=>(c.add(h),()=>{c.delete(h)}),onFinishHydration:h=>(u.add(h),()=>{u.delete(h)})},o.skipHydration||w(),f||p},du=T2,R2=(e,t)=>{if(!e)return Object.keys(t).length===0;const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const a of n)if(!Object.prototype.hasOwnProperty.call(t,a)||!Object.is(e[a],t[a]))return!1;return!0},Li=uu()(du(e=>({states:{},updateFormState:(t,n)=>{e(r=>{const a=r.states[t]??{formValues:{},scrollPosition:0,updatedAt:Date.now()},o={...a.formValues,...n};return R2(a.formValues,o)?r:{states:{...r.states,[t]:{...a,formValues:o,updatedAt:Date.now()}}}})},setScrollPosition:(t,n)=>{e(r=>{const a=r.states[t]??{formValues:{},scrollPosition:0,updatedAt:Date.now()};return Math.abs(a.scrollPosition-n)<1?r:{states:{...r.states,[t]:{...a,scrollPosition:n,updatedAt:Date.now()}}}})},clearState:t=>e(n=>{if(!n.states[t])return n;const r={...n.states};return delete r[t],{states:r}}),clearAll:()=>e({states:{}})}),{name:"amplifier-state",partialize:e=>e})),M2=()=>{Li.getState().clearAll()},ww=i.createContext(void 0),$2=({children:e})=>{const[t,n]=i.useState(null),[r,a]=i.useState(!0);i.useEffect(()=>{(async()=>{try{const p=Oe.getCurrentUser();if(Oe.isAuthenticated()&&p)n(p);else if(Oe.getAccessToken())try{await Oe.refreshToken();const h=Oe.getCurrentUser();n(h)}catch{await Oe.logout(),n(null)}}catch(p){console.error("Error initializing auth:",p),n(null)}finally{a(!1)}})();const m=setInterval(()=>{Oe.isAuthenticated()&&Oe.shouldRefreshToken()&&Oe.refreshToken().catch(p=>{console.error("Periodic token refresh failed:",p)})},10*60*1e3);return()=>clearInterval(m)},[]);const d={user:t,isLoading:r,isAuthenticated:!!t,login:async g=>{try{console.log("AuthContext: Starting login process"),a(!0);const m=await Oe.login(g);console.log("AuthContext: Login successful, setting user:",m.user),n(m.user),console.log("AuthContext: User state updated")}catch(m){throw console.error("AuthContext: Login error:",m),m}finally{a(!1)}},register:async g=>{try{a(!0);const m=await Oe.register(g);n(m.user)}catch(m){throw console.error("Registration error:",m),m}finally{a(!1)}},logout:async()=>{try{a(!0);let g=!1;if(t)try{const{PaymentService:m}=await tr(async()=>{const{PaymentService:f}=await Promise.resolve().then(()=>Mu);return{PaymentService:f}},void 0),p=await m.getUserSubscription(t.id);g=!!(p!=null&&p.hasSubscription)}catch(m){console.error("Logout subscription check failed:",m)}if(!g&&typeof window<"u")try{g=localStorage.getItem("hasCompletedPayment")==="true"}catch(m){console.error("Logout payment fallback check failed:",m)}typeof window<"u"&&(g?(sessionStorage.setItem("forceDashboardRedirect","true"),sessionStorage.setItem("redirectAfterLogin","/dashboard")):(sessionStorage.removeItem("forceDashboardRedirect"),sessionStorage.removeItem("redirectAfterLogin"))),M2(),await Oe.logout(),n(null)}catch(g){console.error("Logout error:",g),n(null)}finally{a(!1)}},refreshToken:async()=>{try{const g=await Oe.refreshToken();n(g.user)}catch(g){throw console.error("Token refresh error:",g),n(null),g}}};return s.jsx(ww.Provider,{value:d,children:e})},fr=()=>{const e=i.useContext(ww);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e};class Vi{static async createWorkspace(t){try{console.log("WorkspaceService: Creating workspace"),console.log("WorkspaceService: Data:",t);const n=await Oe.makeAuthenticatedRequest(`${Fe}/workspaces`,{method:"POST",body:JSON.stringify(t)});if(console.log("WorkspaceService: Response status:",n.status),console.log("WorkspaceService: Response ok:",n.ok),!n.ok){const o=await n.json();throw console.error("WorkspaceService: Error response:",o),new Error(o.message||`HTTP error! status: ${n.status}`)}const r=await n.json();console.log("WorkspaceService: Workspace created, full response:",r);const a=r.data||r;return console.log("WorkspaceService: Workspace data:",a),a}catch(n){throw console.error("WorkspaceService: Error creating workspace:",n),n}}static async getWorkspaces(){try{console.log("WorkspaceService: Fetching workspaces");const t=await Oe.makeAuthenticatedRequest(`${Fe}/workspaces`,{method:"GET"});if(console.log("WorkspaceService: Response status:",t.status),console.log("WorkspaceService: Response ok:",t.ok),!t.ok){const a=await t.json();throw console.error("WorkspaceService: Error response:",a),new Error(a.message||`HTTP error! status: ${t.status}`)}const n=await t.json();console.log("WorkspaceService: Workspaces fetched, full response:",n);const r=n.data||n;return console.log("WorkspaceService: Workspaces data:",r),r}catch(t){throw console.error("WorkspaceService: Error fetching workspaces:",t),t}}static async getWorkspace(t){try{console.log("WorkspaceService: Fetching workspace:",t);const n=await Oe.makeAuthenticatedRequest(`${Fe}/workspaces/${t}`,{method:"GET"});if(console.log("WorkspaceService: Response status:",n.status),console.log("WorkspaceService: Response ok:",n.ok),!n.ok){const o=await n.json();throw console.error("WorkspaceService: Error response:",o),new Error(o.message||`HTTP error! status: ${n.status}`)}const r=await n.json();console.log("WorkspaceService: Workspace fetched, full response:",r);const a=r.data||r;return console.log("WorkspaceService: Workspace data:",a),a}catch(n){throw console.error("WorkspaceService: Error fetching workspace:",n),n}}static async updateWorkspace(t,n){try{console.log("WorkspaceService: Updating workspace:",t),console.log("WorkspaceService: Data:",n);const r=await Oe.makeAuthenticatedRequest(`${Fe}/workspaces/${t}`,{method:"PUT",body:JSON.stringify(n)});if(console.log("WorkspaceService: Response status:",r.status),console.log("WorkspaceService: Response ok:",r.ok),!r.ok){const l=await r.json();throw console.error("WorkspaceService: Error response:",l),new Error(l.message||`HTTP error! status: ${r.status}`)}const a=await r.json();console.log("WorkspaceService: Workspace updated, full response:",a);const o=a.data||a;return console.log("WorkspaceService: Workspace data:",o),o}catch(r){throw console.error("WorkspaceService: Error updating workspace:",r),r}}static async deleteWorkspace(t){try{console.log("WorkspaceService: Deleting workspace:",t);const n=await Oe.makeAuthenticatedRequest(`${Fe}/workspaces/${t}`,{method:"DELETE"});if(console.log("WorkspaceService: Response status:",n.status),console.log("WorkspaceService: Response ok:",n.ok),!n.ok){const r=await n.json();throw console.error("WorkspaceService: Error response:",r),new Error(r.message||`HTTP error! status: ${n.status}`)}console.log("WorkspaceService: Workspace deleted successfully")}catch(n){throw console.error("WorkspaceService: Error deleting workspace:",n),n}}}const Sg=uu()(du(e=>({currentWorkspace:null,workspaces:[],isLoading:!0,setCurrentWorkspace:t=>{console.log(" Zustand: Setting current workspace:",t==null?void 0:t.name,t==null?void 0:t.id),e({currentWorkspace:t})},setWorkspaces:t=>{console.log(" Zustand: Setting workspaces:",t.length),e({workspaces:t})},setLoading:t=>{e({isLoading:t})},addWorkspace:t=>{e(n=>n.workspaces.some(a=>a.id===t.id||a.name===t.name)?(console.log(" Zustand: Workspace already exists, not adding duplicate:",t.name),n):(console.log(" Zustand: Adding new workspace:",t.name),{workspaces:[...n.workspaces,t],currentWorkspace:t}))},clearWorkspaces:()=>{e({currentWorkspace:null,workspaces:[],isLoading:!1})}}),{name:"workspace-storage",partialize:e=>({currentWorkspace:e.currentWorkspace})})),bw=i.createContext(void 0),D2=({children:e})=>{const{user:t}=fr(),n=i.useRef(!1),{currentWorkspace:r,workspaces:a,isLoading:o,setCurrentWorkspace:l,setWorkspaces:c,setLoading:u,addWorkspace:d,clearWorkspaces:g}=Sg(),m=i.useCallback(()=>{var x,y;try{const N=localStorage.getItem("workspace-storage");if(N){const S=JSON.parse(N),j=(x=S==null?void 0:S.state)==null?void 0:x.currentWorkspace;if(j!=null&&j.id)return console.log(" Found persisted workspace in localStorage:",j.id,j.name),{id:j.id,workspace:j};if((y=S==null?void 0:S.currentWorkspace)!=null&&y.id)return console.log(" Found persisted workspace (fallback format):",S.currentWorkspace.id),{id:S.currentWorkspace.id,workspace:S.currentWorkspace}}console.log(" No persisted workspace found in localStorage")}catch(b){console.error("Failed to read persisted workspace from localStorage:",b)}return null},[]),p=i.useCallback(async()=>{if(!t){c([]),l(null),u(!1),n.current=!1,g();return}if(n.current){console.log(" Workspaces already loaded, skipping duplicate load");return}try{u(!0),n.current=!0,console.log(" WorkspaceContext - Loading workspaces from API...");const x=m(),y=x==null?void 0:x.id;x!=null&&x.workspace&&y&&(console.log(" Setting persisted workspace immediately from localStorage:",x.workspace.name),l(x.workspace)),console.log(" Persisted workspace ID from localStorage:",y);const b=await Vi.getWorkspaces();if(console.log(" WorkspaceContext - Workspaces loaded:",b.length),console.log(" Workspace IDs:",b.map(N=>({id:N.id,name:N.name}))),c(b),y){const N=b.find(S=>S.id===y);if(N){console.log(" RESTORING persisted workspace from API:",N.name,"ID:",N.id),l(N),u(!1);return}else console.log(" Persisted workspace not found in API (may have been deleted):",y),l(null)}!y&&b.length>0?(console.log(" No persisted workspace found - using first available workspace (first load)"),l(b[0])):y&&b.length>0&&(console.log(" Persisted workspace deleted - switching to first available workspace"),l(b[0]))}catch(x){console.error("Error loading workspaces:",x),c([]),n.current=!1}finally{u(!1);const x=Sg.getState().currentWorkspace;console.log(" WorkspaceContext - Loading completed. Final workspace:",x==null?void 0:x.name,"ID:",x==null?void 0:x.id)}},[t,l,c,u,g,m]),f=i.useCallback(async()=>{n.current=!1,await p()},[p]),w=i.useCallback(x=>{console.log(" WorkspaceContext - Setting current workspace via context:",x.name,x.id),l(x)},[l]),h=i.useCallback(x=>{d(x)},[d]);i.useEffect(()=>{t&&(n.current=!1,p())},[t,p]);const v={currentWorkspace:r,workspaces:a,isLoading:o,setCurrentWorkspace:w,refreshWorkspaces:f,addWorkspace:h};return s.jsx(bw.Provider,{value:v,children:e})},ls=()=>{const e=i.useContext(bw);if(e===void 0)throw new Error("useWorkspace must be used within a WorkspaceProvider");return e},zt=({children:e})=>{const{isAuthenticated:t,isLoading:n}=fr(),r=En();return n?s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),s.jsx("p",{className:"text-white/80",children:"Loading..."})]})}):t?s.jsx(s.Fragment,{children:e}):(typeof window<"u"&&(sessionStorage.getItem("forceDashboardRedirect")==="true"?sessionStorage.setItem("redirectAfterLogin","/dashboard"):sessionStorage.setItem("redirectAfterLogin",r.pathname+r.search)),s.jsx(c2,{to:"/login",state:{from:r},replace:!0}))};function kg(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function hr(...e){return t=>{let n=!1;const r=e.map(a=>{const o=kg(a,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let a=0;a<r.length;a++){const o=r[a];typeof o=="function"?o():kg(e[a],null)}}}}function _t(...e){return i.useCallback(hr(...e),e)}var O2=Symbol.for("react.lazy"),Ec=Qc[" use ".trim().toString()];function F2(e){return typeof e=="object"&&e!==null&&"then"in e}function Nw(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===O2&&"_payload"in e&&F2(e._payload)}function dh(e){const t=L2(e),n=i.forwardRef((r,a)=>{let{children:o,...l}=r;Nw(o)&&typeof Ec=="function"&&(o=Ec(o._payload));const c=i.Children.toArray(o),u=c.find(B2);if(u){const d=u.props.children,g=c.map(m=>m===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:m);return s.jsx(t,{...l,ref:a,children:i.isValidElement(d)?i.cloneElement(d,void 0,g):null})}return s.jsx(t,{...l,ref:a,children:o})});return n.displayName=`${e}.Slot`,n}var _2=dh("Slot");function L2(e){const t=i.forwardRef((n,r)=>{let{children:a,...o}=n;if(Nw(a)&&typeof Ec=="function"&&(a=Ec(a._payload)),i.isValidElement(a)){const l=U2(a),c=W2(o,a.props);return a.type!==i.Fragment&&(c.ref=r?hr(r,l):l),i.cloneElement(a,c)}return i.Children.count(a)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var V2=Symbol("radix.slottable");function B2(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===V2}function W2(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...c)=>{const u=o(...c);return a(...c),u}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function U2(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function jw(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=jw(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Sw(){for(var e,t,n=0,r="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=jw(e))&&(r&&(r+=" "),r+=t);return r}const Pg=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,Ag=Sw,mh=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return Ag(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:a,defaultVariants:o}=t,l=Object.keys(a).map(d=>{const g=n==null?void 0:n[d],m=o==null?void 0:o[d];if(g===null)return null;const p=Pg(g)||Pg(m);return a[d][p]}),c=n&&Object.entries(n).reduce((d,g)=>{let[m,p]=g;return p===void 0||(d[m]=p),d},{}),u=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((d,g)=>{let{class:m,className:p,...f}=g;return Object.entries(f).every(w=>{let[h,v]=w;return Array.isArray(v)?v.includes({...o,...c}[h]):{...o,...c}[h]===v})?[...d,m,p]:d},[]);return Ag(e,l,u,n==null?void 0:n.class,n==null?void 0:n.className)},fh="-",z2=e=>{const t=Q2(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:l=>{const c=l.split(fh);return c[0]===""&&c.length!==1&&c.shift(),kw(c,t)||H2(l)},getConflictingClassGroupIds:(l,c)=>{const u=n[l]||[];return c&&r[l]?[...u,...r[l]]:u}}},kw=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),a=r?kw(e.slice(1),r):void 0;if(a)return a;if(t.validators.length===0)return;const o=e.join(fh);return(l=t.validators.find(({validator:c})=>c(o)))==null?void 0:l.classGroupId},Cg=/^\[(.+)\]$/,H2=e=>{if(Cg.test(e)){const t=Cg.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Q2=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return q2(Object.entries(e.classGroups),n).forEach(([o,l])=>{Bm(l,r,o,t)}),r},Bm=(e,t,n,r)=>{e.forEach(a=>{if(typeof a=="string"){const o=a===""?t:Eg(t,a);o.classGroupId=n;return}if(typeof a=="function"){if(G2(a)){Bm(a(r),t,n,r);return}t.validators.push({validator:a,classGroupId:n});return}Object.entries(a).forEach(([o,l])=>{Bm(l,Eg(t,o),n,r)})})},Eg=(e,t)=>{let n=e;return t.split(fh).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},G2=e=>e.isThemeGetter,q2=(e,t)=>t?e.map(([n,r])=>{const a=r.map(o=>typeof o=="string"?t+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([l,c])=>[t+l,c])):o);return[n,a]}):e,Y2=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const a=(o,l)=>{n.set(o,l),t++,t>e&&(t=0,r=n,n=new Map)};return{get(o){let l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return a(o,l),l},set(o,l){n.has(o)?n.set(o,l):a(o,l)}}},Pw="!",J2=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,a=t[0],o=t.length,l=c=>{const u=[];let d=0,g=0,m;for(let v=0;v<c.length;v++){let x=c[v];if(d===0){if(x===a&&(r||c.slice(v,v+o)===t)){u.push(c.slice(g,v)),g=v+o;continue}if(x==="/"){m=v;continue}}x==="["?d++:x==="]"&&d--}const p=u.length===0?c:c.substring(g),f=p.startsWith(Pw),w=f?p.substring(1):p,h=m&&m>g?m-g:void 0;return{modifiers:u,hasImportantModifier:f,baseClassName:w,maybePostfixModifierPosition:h}};return n?c=>n({className:c,parseClassName:l}):l},K2=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},X2=e=>({cache:Y2(e.cacheSize),parseClassName:J2(e),...z2(e)}),Z2=/\s+/,eP=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:a}=t,o=[],l=e.trim().split(Z2);let c="";for(let u=l.length-1;u>=0;u-=1){const d=l[u],{modifiers:g,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:f}=n(d);let w=!!f,h=r(w?p.substring(0,f):p);if(!h){if(!w){c=d+(c.length>0?" "+c:c);continue}if(h=r(p),!h){c=d+(c.length>0?" "+c:c);continue}w=!1}const v=K2(g).join(":"),x=m?v+Pw:v,y=x+h;if(o.includes(y))continue;o.push(y);const b=a(h,w);for(let N=0;N<b.length;++N){const S=b[N];o.push(x+S)}c=d+(c.length>0?" "+c:c)}return c};function tP(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=Aw(t))&&(r&&(r+=" "),r+=n);return r}const Aw=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=Aw(e[r]))&&(n&&(n+=" "),n+=t);return n};function sP(e,...t){let n,r,a,o=l;function l(u){const d=t.reduce((g,m)=>m(g),e());return n=X2(d),r=n.cache.get,a=n.cache.set,o=c,c(u)}function c(u){const d=r(u);if(d)return d;const g=eP(u,n);return a(u,g),g}return function(){return o(tP.apply(null,arguments))}}const Zt=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},Cw=/^\[(?:([a-z-]+):)?(.+)\]$/i,nP=/^\d+\/\d+$/,rP=new Set(["px","full","screen"]),aP=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,oP=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iP=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,lP=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,cP=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Jn=e=>ao(e)||rP.has(e)||nP.test(e),br=e=>Ro(e,"length",xP),ao=e=>!!e&&!Number.isNaN(Number(e)),gd=e=>Ro(e,"number",ao),zo=e=>!!e&&Number.isInteger(Number(e)),uP=e=>e.endsWith("%")&&ao(e.slice(0,-1)),Nt=e=>Cw.test(e),Nr=e=>aP.test(e),dP=new Set(["length","size","percentage"]),mP=e=>Ro(e,dP,Ew),fP=e=>Ro(e,"position",Ew),hP=new Set(["image","url"]),pP=e=>Ro(e,hP,yP),gP=e=>Ro(e,"",vP),Ho=()=>!0,Ro=(e,t,n)=>{const r=Cw.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},xP=e=>oP.test(e)&&!iP.test(e),Ew=()=>!1,vP=e=>lP.test(e),yP=e=>cP.test(e),wP=()=>{const e=Zt("colors"),t=Zt("spacing"),n=Zt("blur"),r=Zt("brightness"),a=Zt("borderColor"),o=Zt("borderRadius"),l=Zt("borderSpacing"),c=Zt("borderWidth"),u=Zt("contrast"),d=Zt("grayscale"),g=Zt("hueRotate"),m=Zt("invert"),p=Zt("gap"),f=Zt("gradientColorStops"),w=Zt("gradientColorStopPositions"),h=Zt("inset"),v=Zt("margin"),x=Zt("opacity"),y=Zt("padding"),b=Zt("saturate"),N=Zt("scale"),S=Zt("sepia"),j=Zt("skew"),k=Zt("space"),C=Zt("translate"),W=()=>["auto","contain","none"],B=()=>["auto","hidden","clip","visible","scroll"],U=()=>["auto",Nt,t],Q=()=>[Nt,t],V=()=>["",Jn,br],P=()=>["auto",ao,Nt],K=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],G=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],E=()=>["","0",Nt],R=()=>["auto","avoid","all","avoid-page","page","left","right","column"],L=()=>[ao,Nt];return{cacheSize:500,separator:":",theme:{colors:[Ho],spacing:[Jn,br],blur:["none","",Nr,Nt],brightness:L(),borderColor:[e],borderRadius:["none","","full",Nr,Nt],borderSpacing:Q(),borderWidth:V(),contrast:L(),grayscale:E(),hueRotate:L(),invert:E(),gap:Q(),gradientColorStops:[e],gradientColorStopPositions:[uP,br],inset:U(),margin:U(),opacity:L(),padding:Q(),saturate:L(),scale:L(),sepia:E(),skew:L(),space:Q(),translate:Q()},classGroups:{aspect:[{aspect:["auto","square","video",Nt]}],container:["container"],columns:[{columns:[Nr]}],"break-after":[{"break-after":R()}],"break-before":[{"break-before":R()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...K(),Nt]}],overflow:[{overflow:B()}],"overflow-x":[{"overflow-x":B()}],"overflow-y":[{"overflow-y":B()}],overscroll:[{overscroll:W()}],"overscroll-x":[{"overscroll-x":W()}],"overscroll-y":[{"overscroll-y":W()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[h]}],"inset-x":[{"inset-x":[h]}],"inset-y":[{"inset-y":[h]}],start:[{start:[h]}],end:[{end:[h]}],top:[{top:[h]}],right:[{right:[h]}],bottom:[{bottom:[h]}],left:[{left:[h]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",zo,Nt]}],basis:[{basis:U()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Nt]}],grow:[{grow:E()}],shrink:[{shrink:E()}],order:[{order:["first","last","none",zo,Nt]}],"grid-cols":[{"grid-cols":[Ho]}],"col-start-end":[{col:["auto",{span:["full",zo,Nt]},Nt]}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":[Ho]}],"row-start-end":[{row:["auto",{span:[zo,Nt]},Nt]}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Nt]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Nt]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Nt,t]}],"min-w":[{"min-w":[Nt,t,"min","max","fit"]}],"max-w":[{"max-w":[Nt,t,"none","full","min","max","fit","prose",{screen:[Nr]},Nr]}],h:[{h:[Nt,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Nt,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Nt,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Nt,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Nr,br]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",gd]}],"font-family":[{font:[Ho]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Nt]}],"line-clamp":[{"line-clamp":["none",ao,gd]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Jn,Nt]}],"list-image":[{"list-image":["none",Nt]}],"list-style-type":[{list:["none","disc","decimal",Nt]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...G(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Jn,br]}],"underline-offset":[{"underline-offset":["auto",Jn,Nt]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:Q()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Nt]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Nt]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...K(),fP]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",mP]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},pP]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[w]}],"gradient-via-pos":[{via:[w]}],"gradient-to-pos":[{to:[w]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...G(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:G()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...G()]}],"outline-offset":[{"outline-offset":[Jn,Nt]}],"outline-w":[{outline:[Jn,br]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:V()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Jn,br]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Nr,gP]}],"shadow-color":[{shadow:[Ho]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",Nr,Nt]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[g]}],invert:[{invert:[m]}],saturate:[{saturate:[b]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[g]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Nt]}],duration:[{duration:L()}],ease:[{ease:["linear","in","out","in-out",Nt]}],delay:[{delay:L()}],animate:[{animate:["none","spin","ping","pulse","bounce",Nt]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[zo,Nt]}],"translate-x":[{"translate-x":[C]}],"translate-y":[{"translate-y":[C]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Nt]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Nt]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":Q()}],"scroll-mx":[{"scroll-mx":Q()}],"scroll-my":[{"scroll-my":Q()}],"scroll-ms":[{"scroll-ms":Q()}],"scroll-me":[{"scroll-me":Q()}],"scroll-mt":[{"scroll-mt":Q()}],"scroll-mr":[{"scroll-mr":Q()}],"scroll-mb":[{"scroll-mb":Q()}],"scroll-ml":[{"scroll-ml":Q()}],"scroll-p":[{"scroll-p":Q()}],"scroll-px":[{"scroll-px":Q()}],"scroll-py":[{"scroll-py":Q()}],"scroll-ps":[{"scroll-ps":Q()}],"scroll-pe":[{"scroll-pe":Q()}],"scroll-pt":[{"scroll-pt":Q()}],"scroll-pr":[{"scroll-pr":Q()}],"scroll-pb":[{"scroll-pb":Q()}],"scroll-pl":[{"scroll-pl":Q()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Nt]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Jn,br,gd]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},bP=sP(wP);function it(...e){return bP(Sw(e))}const hh=mh("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Ie=i.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...a},o)=>{const l=r?_2:"button";return s.jsx(l,{className:it(hh({variant:t,size:n,className:e})),ref:o,...a})});Ie.displayName="Button";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Iw=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var jP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=i.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:l,...c},u)=>i.createElement("svg",{ref:u,...jP,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:Iw("lucide",a),...c},[...l.map(([d,g])=>i.createElement(d,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=(e,t)=>{const n=i.forwardRef(({className:r,...a},o)=>i.createElement(SP,{ref:o,iconNode:t,className:Iw(`lucide-${NP(e)}`,r),...a}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=nt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=nt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kP=nt("BookMarked",[["path",{d:"M10 2v8l3-3 3 3V2",key:"sqw3rj"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=nt("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ic=nt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mu=nt("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=nt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=nt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=nt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=nt("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tw=nt("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hn=nt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=nt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wm=nt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bi=nt("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=nt("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=nt("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=nt("Clapperboard",[["path",{d:"M20.2 6 3 11l-.9-2.4c-.3-1.1.3-2.2 1.3-2.5l13.5-4c1.1-.3 2.2.3 2.5 1.3Z",key:"1tn4o7"}],["path",{d:"m6.2 5.3 3.1 3.9",key:"iuk76l"}],["path",{d:"m12.4 3.4 3.1 4",key:"6hsd6n"}],["path",{d:"M3 11h18v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2Z",key:"ltgou9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=nt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=nt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MP=nt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=nt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=nt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tg=nt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=nt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $P=nt("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DP=nt("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=nt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=nt("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=nt("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=nt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pr=nt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LP=nt("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=nt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Um=nt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rw=nt("Magnet",[["path",{d:"m6 15-4-4 6.75-6.77a7.79 7.79 0 0 1 11 11L13 22l-4-4 6.39-6.36a2.14 2.14 0 0 0-3-3L6 15",key:"1i3lhw"}],["path",{d:"m5 8 4 4",key:"j6kj7e"}],["path",{d:"m12 15 4 4",key:"lnac28"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=nt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VP=nt("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mw=nt("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $w=nt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=nt("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=nt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zm=nt("Newspaper",[["path",{d:"M4 22h16a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v16a2 2 0 0 1-2 2Zm0 0a2 2 0 0 1-2-2v-9c0-1.1.9-2 2-2h2",key:"7pis2x"}],["path",{d:"M18 14h-8",key:"sponae"}],["path",{d:"M15 18h-5",key:"95g1m2"}],["path",{d:"M10 6h8v4h-8V6Z",key:"smlsk5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ow=nt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BP=nt("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WP=nt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=nt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UP=nt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fu=nt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hu=nt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=nt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zP=nt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=nt("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fw=nt("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HP=nt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=nt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QP=nt("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zr=nt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GP=nt("UsersRound",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=nt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qP=nt("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=nt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tc=nt("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),sl="/assets/logo-white-7CHNZiiE.png";function ot(e,t,{checkForDefaultPrevented:n=!0}={}){return function(a){if(e==null||e(a),n===!1||!a.defaultPrevented)return t==null?void 0:t(a)}}function YP(e,t){const n=i.createContext(t),r=o=>{const{children:l,...c}=o,u=i.useMemo(()=>c,Object.values(c));return s.jsx(n.Provider,{value:u,children:l})};r.displayName=e+"Provider";function a(o){const l=i.useContext(n);if(l)return l;if(t!==void 0)return t;throw new Error(`\`${o}\` must be used within \`${e}\``)}return[r,a]}function Qn(e,t=[]){let n=[];function r(o,l){const c=i.createContext(l),u=n.length;n=[...n,l];const d=m=>{var x;const{scope:p,children:f,...w}=m,h=((x=p==null?void 0:p[e])==null?void 0:x[u])||c,v=i.useMemo(()=>w,Object.values(w));return s.jsx(h.Provider,{value:v,children:f})};d.displayName=o+"Provider";function g(m,p){var h;const f=((h=p==null?void 0:p[e])==null?void 0:h[u])||c,w=i.useContext(f);if(w)return w;if(l!==void 0)return l;throw new Error(`\`${m}\` must be used within \`${o}\``)}return[d,g]}const a=()=>{const o=n.map(l=>i.createContext(l));return function(c){const u=(c==null?void 0:c[e])||o;return i.useMemo(()=>({[`__scope${e}`]:{...c,[e]:u}}),[c,u])}};return a.scopeName=e,[r,JP(a,...t)]}function JP(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const l=r.reduce((c,{useScope:u,scopeName:d})=>{const m=u(o)[`__scope${d}`];return{...c,...m}},{});return i.useMemo(()=>({[`__scope${t.scopeName}`]:l}),[l])}};return n.scopeName=t.scopeName,n}var ks=globalThis!=null&&globalThis.document?i.useLayoutEffect:()=>{},KP=Qc[" useInsertionEffect ".trim().toString()]||ks;function Hr({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[a,o,l]=XP({defaultProp:t,onChange:n}),c=e!==void 0,u=c?e:a;{const g=i.useRef(e!==void 0);i.useEffect(()=>{const m=g.current;m!==c&&console.warn(`${r} is changing from ${m?"controlled":"uncontrolled"} to ${c?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),g.current=c},[c,r])}const d=i.useCallback(g=>{var m;if(c){const p=ZP(g)?g(e):g;p!==e&&((m=l.current)==null||m.call(l,p))}else o(g)},[c,e,o,l]);return[u,d]}function XP({defaultProp:e,onChange:t}){const[n,r]=i.useState(e),a=i.useRef(n),o=i.useRef(t);return KP(()=>{o.current=t},[t]),i.useEffect(()=>{var l;a.current!==n&&((l=o.current)==null||l.call(o,n),a.current=n)},[n,a]),[n,r,o]}function ZP(e){return typeof e=="function"}function eA(e){const t=tA(e),n=i.forwardRef((r,a)=>{const{children:o,...l}=r,c=i.Children.toArray(o),u=c.find(nA);if(u){const d=u.props.children,g=c.map(m=>m===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:m);return s.jsx(t,{...l,ref:a,children:i.isValidElement(d)?i.cloneElement(d,void 0,g):null})}return s.jsx(t,{...l,ref:a,children:o})});return n.displayName=`${e}.Slot`,n}function tA(e){const t=i.forwardRef((n,r)=>{const{children:a,...o}=n;if(i.isValidElement(a)){const l=aA(a),c=rA(o,a.props);return a.type!==i.Fragment&&(c.ref=r?hr(r,l):l),i.cloneElement(a,c)}return i.Children.count(a)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var sA=Symbol("radix.slottable");function nA(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===sA}function rA(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...c)=>{const u=o(...c);return a(...c),u}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function aA(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var oA=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],kt=oA.reduce((e,t)=>{const n=eA(`Primitive.${t}`),r=i.forwardRef((a,o)=>{const{asChild:l,...c}=a,u=l?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(u,{...c,ref:o})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function Lw(e,t){e&&Eo.flushSync(()=>e.dispatchEvent(t))}function Mg(e){const t=iA(e),n=i.forwardRef((r,a)=>{const{children:o,...l}=r,c=i.Children.toArray(o),u=c.find(cA);if(u){const d=u.props.children,g=c.map(m=>m===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:m);return s.jsx(t,{...l,ref:a,children:i.isValidElement(d)?i.cloneElement(d,void 0,g):null})}return s.jsx(t,{...l,ref:a,children:o})});return n.displayName=`${e}.Slot`,n}function iA(e){const t=i.forwardRef((n,r)=>{const{children:a,...o}=n;if(i.isValidElement(a)){const l=dA(a),c=uA(o,a.props);return a.type!==i.Fragment&&(c.ref=r?hr(r,l):l),i.cloneElement(a,c)}return i.Children.count(a)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var lA=Symbol("radix.slottable");function cA(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===lA}function uA(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...c)=>{const u=o(...c);return a(...c),u}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function dA(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function pu(e){const t=e+"CollectionProvider",[n,r]=Qn(t),[a,o]=n(t,{collectionRef:{current:null},itemMap:new Map}),l=h=>{const{scope:v,children:x}=h,y=_e.useRef(null),b=_e.useRef(new Map).current;return s.jsx(a,{scope:v,itemMap:b,collectionRef:y,children:x})};l.displayName=t;const c=e+"CollectionSlot",u=Mg(c),d=_e.forwardRef((h,v)=>{const{scope:x,children:y}=h,b=o(c,x),N=_t(v,b.collectionRef);return s.jsx(u,{ref:N,children:y})});d.displayName=c;const g=e+"CollectionItemSlot",m="data-radix-collection-item",p=Mg(g),f=_e.forwardRef((h,v)=>{const{scope:x,children:y,...b}=h,N=_e.useRef(null),S=_t(v,N),j=o(g,x);return _e.useEffect(()=>(j.itemMap.set(N,{ref:N,...b}),()=>void j.itemMap.delete(N))),s.jsx(p,{[m]:"",ref:S,children:y})});f.displayName=g;function w(h){const v=o(e+"CollectionConsumer",h);return _e.useCallback(()=>{const y=v.collectionRef.current;if(!y)return[];const b=Array.from(y.querySelectorAll(`[${m}]`));return Array.from(v.itemMap.values()).sort((j,k)=>b.indexOf(j.ref.current)-b.indexOf(k.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:l,Slot:d,ItemSlot:f},w,r]}var mA=i.createContext(void 0);function gu(e){const t=i.useContext(mA);return e||t||"ltr"}function Un(e){const t=i.useRef(e);return i.useEffect(()=>{t.current=e}),i.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function fA(e,t=globalThis==null?void 0:globalThis.document){const n=Un(e);i.useEffect(()=>{const r=a=>{a.key==="Escape"&&n(a)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var hA="DismissableLayer",Qm="dismissableLayer.update",pA="dismissableLayer.pointerDownOutside",gA="dismissableLayer.focusOutside",$g,Vw=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),xu=i.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:a,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...u}=e,d=i.useContext(Vw),[g,m]=i.useState(null),p=(g==null?void 0:g.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=i.useState({}),w=_t(t,k=>m(k)),h=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),x=h.indexOf(v),y=g?h.indexOf(g):-1,b=d.layersWithOutsidePointerEventsDisabled.size>0,N=y>=x,S=yA(k=>{const C=k.target,W=[...d.branches].some(B=>B.contains(C));!N||W||(a==null||a(k),l==null||l(k),k.defaultPrevented||c==null||c())},p),j=wA(k=>{const C=k.target;[...d.branches].some(B=>B.contains(C))||(o==null||o(k),l==null||l(k),k.defaultPrevented||c==null||c())},p);return fA(k=>{y===d.layers.size-1&&(r==null||r(k),!k.defaultPrevented&&c&&(k.preventDefault(),c()))},p),i.useEffect(()=>{if(g)return n&&(d.layersWithOutsidePointerEventsDisabled.size===0&&($g=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(g)),d.layers.add(g),Dg(),()=>{n&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=$g)}},[g,p,n,d]),i.useEffect(()=>()=>{g&&(d.layers.delete(g),d.layersWithOutsidePointerEventsDisabled.delete(g),Dg())},[g,d]),i.useEffect(()=>{const k=()=>f({});return document.addEventListener(Qm,k),()=>document.removeEventListener(Qm,k)},[]),s.jsx(kt.div,{...u,ref:w,style:{pointerEvents:b?N?"auto":"none":void 0,...e.style},onFocusCapture:ot(e.onFocusCapture,j.onFocusCapture),onBlurCapture:ot(e.onBlurCapture,j.onBlurCapture),onPointerDownCapture:ot(e.onPointerDownCapture,S.onPointerDownCapture)})});xu.displayName=hA;var xA="DismissableLayerBranch",vA=i.forwardRef((e,t)=>{const n=i.useContext(Vw),r=i.useRef(null),a=_t(t,r);return i.useEffect(()=>{const o=r.current;if(o)return n.branches.add(o),()=>{n.branches.delete(o)}},[n.branches]),s.jsx(kt.div,{...e,ref:a})});vA.displayName=xA;function yA(e,t=globalThis==null?void 0:globalThis.document){const n=Un(e),r=i.useRef(!1),a=i.useRef(()=>{});return i.useEffect(()=>{const o=c=>{if(c.target&&!r.current){let u=function(){Bw(pA,n,d,{discrete:!0})};const d={originalEvent:c};c.pointerType==="touch"?(t.removeEventListener("click",a.current),a.current=u,t.addEventListener("click",a.current,{once:!0})):u()}else t.removeEventListener("click",a.current);r.current=!1},l=window.setTimeout(()=>{t.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(l),t.removeEventListener("pointerdown",o),t.removeEventListener("click",a.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function wA(e,t=globalThis==null?void 0:globalThis.document){const n=Un(e),r=i.useRef(!1);return i.useEffect(()=>{const a=o=>{o.target&&!r.current&&Bw(gA,n,{originalEvent:o},{discrete:!1})};return t.addEventListener("focusin",a),()=>t.removeEventListener("focusin",a)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Dg(){const e=new CustomEvent(Qm);document.dispatchEvent(e)}function Bw(e,t,n,{discrete:r}){const a=n.originalEvent.target,o=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&a.addEventListener(e,t,{once:!0}),r?Lw(a,o):a.dispatchEvent(o)}var xd=0;function yh(){i.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??Og()),document.body.insertAdjacentElement("beforeend",e[1]??Og()),xd++,()=>{xd===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),xd--}},[])}function Og(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var vd="focusScope.autoFocusOnMount",yd="focusScope.autoFocusOnUnmount",Fg={bubbles:!1,cancelable:!0},bA="FocusScope",vu=i.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:a,onUnmountAutoFocus:o,...l}=e,[c,u]=i.useState(null),d=Un(a),g=Un(o),m=i.useRef(null),p=_t(t,h=>u(h)),f=i.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;i.useEffect(()=>{if(r){let h=function(b){if(f.paused||!c)return;const N=b.target;c.contains(N)?m.current=N:kr(m.current,{select:!0})},v=function(b){if(f.paused||!c)return;const N=b.relatedTarget;N!==null&&(c.contains(N)||kr(m.current,{select:!0}))},x=function(b){if(document.activeElement===document.body)for(const S of b)S.removedNodes.length>0&&kr(c)};document.addEventListener("focusin",h),document.addEventListener("focusout",v);const y=new MutationObserver(x);return c&&y.observe(c,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",h),document.removeEventListener("focusout",v),y.disconnect()}}},[r,c,f.paused]),i.useEffect(()=>{if(c){Lg.add(f);const h=document.activeElement;if(!c.contains(h)){const x=new CustomEvent(vd,Fg);c.addEventListener(vd,d),c.dispatchEvent(x),x.defaultPrevented||(NA(AA(Ww(c)),{select:!0}),document.activeElement===h&&kr(c))}return()=>{c.removeEventListener(vd,d),setTimeout(()=>{const x=new CustomEvent(yd,Fg);c.addEventListener(yd,g),c.dispatchEvent(x),x.defaultPrevented||kr(h??document.body,{select:!0}),c.removeEventListener(yd,g),Lg.remove(f)},0)}}},[c,d,g,f]);const w=i.useCallback(h=>{if(!n&&!r||f.paused)return;const v=h.key==="Tab"&&!h.altKey&&!h.ctrlKey&&!h.metaKey,x=document.activeElement;if(v&&x){const y=h.currentTarget,[b,N]=jA(y);b&&N?!h.shiftKey&&x===N?(h.preventDefault(),n&&kr(b,{select:!0})):h.shiftKey&&x===b&&(h.preventDefault(),n&&kr(N,{select:!0})):x===y&&h.preventDefault()}},[n,r,f.paused]);return s.jsx(kt.div,{tabIndex:-1,...l,ref:p,onKeyDown:w})});vu.displayName=bA;function NA(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(kr(r,{select:t}),document.activeElement!==n)return}function jA(e){const t=Ww(e),n=_g(t,e),r=_g(t.reverse(),e);return[n,r]}function Ww(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function _g(e,t){for(const n of e)if(!SA(n,{upTo:t}))return n}function SA(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function kA(e){return e instanceof HTMLInputElement&&"select"in e}function kr(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&kA(e)&&t&&e.select()}}var Lg=PA();function PA(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Vg(e,t),e.unshift(t)},remove(t){var n;e=Vg(e,t),(n=e[0])==null||n.resume()}}}function Vg(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function AA(e){return e.filter(t=>t.tagName!=="A")}var CA=Qc[" useId ".trim().toString()]||(()=>{}),EA=0;function Sn(e){const[t,n]=i.useState(CA());return ks(()=>{n(r=>r??String(EA++))},[e]),t?`radix-${t}`:""}const IA=["top","right","bottom","left"],Qr=Math.min,Js=Math.max,Rc=Math.round,Pl=Math.floor,Wn=e=>({x:e,y:e}),TA={left:"right",right:"left",bottom:"top",top:"bottom"},RA={start:"end",end:"start"};function Gm(e,t,n){return Js(e,Qr(t,n))}function cr(e,t){return typeof e=="function"?e(t):e}function ur(e){return e.split("-")[0]}function Mo(e){return e.split("-")[1]}function wh(e){return e==="x"?"y":"x"}function bh(e){return e==="y"?"height":"width"}const MA=new Set(["top","bottom"]);function Ln(e){return MA.has(ur(e))?"y":"x"}function Nh(e){return wh(Ln(e))}function $A(e,t,n){n===void 0&&(n=!1);const r=Mo(e),a=Nh(e),o=bh(a);let l=a==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[o]>t.floating[o]&&(l=Mc(l)),[l,Mc(l)]}function DA(e){const t=Mc(e);return[qm(e),t,qm(t)]}function qm(e){return e.replace(/start|end/g,t=>RA[t])}const Bg=["left","right"],Wg=["right","left"],OA=["top","bottom"],FA=["bottom","top"];function _A(e,t,n){switch(e){case"top":case"bottom":return n?t?Wg:Bg:t?Bg:Wg;case"left":case"right":return t?OA:FA;default:return[]}}function LA(e,t,n,r){const a=Mo(e);let o=_A(ur(e),n==="start",r);return a&&(o=o.map(l=>l+"-"+a),t&&(o=o.concat(o.map(qm)))),o}function Mc(e){return e.replace(/left|right|bottom|top/g,t=>TA[t])}function VA(e){return{top:0,right:0,bottom:0,left:0,...e}}function Uw(e){return typeof e!="number"?VA(e):{top:e,right:e,bottom:e,left:e}}function $c(e){const{x:t,y:n,width:r,height:a}=e;return{width:r,height:a,top:n,left:t,right:t+r,bottom:n+a,x:t,y:n}}function Ug(e,t,n){let{reference:r,floating:a}=e;const o=Ln(t),l=Nh(t),c=bh(l),u=ur(t),d=o==="y",g=r.x+r.width/2-a.width/2,m=r.y+r.height/2-a.height/2,p=r[c]/2-a[c]/2;let f;switch(u){case"top":f={x:g,y:r.y-a.height};break;case"bottom":f={x:g,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:m};break;case"left":f={x:r.x-a.width,y:m};break;default:f={x:r.x,y:r.y}}switch(Mo(t)){case"start":f[l]-=p*(n&&d?-1:1);break;case"end":f[l]+=p*(n&&d?-1:1);break}return f}const BA=async(e,t,n)=>{const{placement:r="bottom",strategy:a="absolute",middleware:o=[],platform:l}=n,c=o.filter(Boolean),u=await(l.isRTL==null?void 0:l.isRTL(t));let d=await l.getElementRects({reference:e,floating:t,strategy:a}),{x:g,y:m}=Ug(d,r,u),p=r,f={},w=0;for(let h=0;h<c.length;h++){const{name:v,fn:x}=c[h],{x:y,y:b,data:N,reset:S}=await x({x:g,y:m,initialPlacement:r,placement:p,strategy:a,middlewareData:f,rects:d,platform:l,elements:{reference:e,floating:t}});g=y??g,m=b??m,f={...f,[v]:{...f[v],...N}},S&&w<=50&&(w++,typeof S=="object"&&(S.placement&&(p=S.placement),S.rects&&(d=S.rects===!0?await l.getElementRects({reference:e,floating:t,strategy:a}):S.rects),{x:g,y:m}=Ug(d,p,u)),h=-1)}return{x:g,y:m,placement:p,strategy:a,middlewareData:f}};async function Ui(e,t){var n;t===void 0&&(t={});const{x:r,y:a,platform:o,rects:l,elements:c,strategy:u}=e,{boundary:d="clippingAncestors",rootBoundary:g="viewport",elementContext:m="floating",altBoundary:p=!1,padding:f=0}=cr(t,e),w=Uw(f),v=c[p?m==="floating"?"reference":"floating":m],x=$c(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(v)))==null||n?v:v.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(c.floating)),boundary:d,rootBoundary:g,strategy:u})),y=m==="floating"?{x:r,y:a,width:l.floating.width,height:l.floating.height}:l.reference,b=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c.floating)),N=await(o.isElement==null?void 0:o.isElement(b))?await(o.getScale==null?void 0:o.getScale(b))||{x:1,y:1}:{x:1,y:1},S=$c(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:c,rect:y,offsetParent:b,strategy:u}):y);return{top:(x.top-S.top+w.top)/N.y,bottom:(S.bottom-x.bottom+w.bottom)/N.y,left:(x.left-S.left+w.left)/N.x,right:(S.right-x.right+w.right)/N.x}}const WA=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:a,rects:o,platform:l,elements:c,middlewareData:u}=t,{element:d,padding:g=0}=cr(e,t)||{};if(d==null)return{};const m=Uw(g),p={x:n,y:r},f=Nh(a),w=bh(f),h=await l.getDimensions(d),v=f==="y",x=v?"top":"left",y=v?"bottom":"right",b=v?"clientHeight":"clientWidth",N=o.reference[w]+o.reference[f]-p[f]-o.floating[w],S=p[f]-o.reference[f],j=await(l.getOffsetParent==null?void 0:l.getOffsetParent(d));let k=j?j[b]:0;(!k||!await(l.isElement==null?void 0:l.isElement(j)))&&(k=c.floating[b]||o.floating[w]);const C=N/2-S/2,W=k/2-h[w]/2-1,B=Qr(m[x],W),U=Qr(m[y],W),Q=B,V=k-h[w]-U,P=k/2-h[w]/2+C,K=Gm(Q,P,V),G=!u.arrow&&Mo(a)!=null&&P!==K&&o.reference[w]/2-(P<Q?B:U)-h[w]/2<0,q=G?P<Q?P-Q:P-V:0;return{[f]:p[f]+q,data:{[f]:K,centerOffset:P-K-q,...G&&{alignmentOffset:q}},reset:G}}}),UA=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:a,middlewareData:o,rects:l,initialPlacement:c,platform:u,elements:d}=t,{mainAxis:g=!0,crossAxis:m=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:h=!0,...v}=cr(e,t);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const x=ur(a),y=Ln(c),b=ur(c)===c,N=await(u.isRTL==null?void 0:u.isRTL(d.floating)),S=p||(b||!h?[Mc(c)]:DA(c)),j=w!=="none";!p&&j&&S.push(...LA(c,h,w,N));const k=[c,...S],C=await Ui(t,v),W=[];let B=((r=o.flip)==null?void 0:r.overflows)||[];if(g&&W.push(C[x]),m){const P=$A(a,l,N);W.push(C[P[0]],C[P[1]])}if(B=[...B,{placement:a,overflows:W}],!W.every(P=>P<=0)){var U,Q;const P=(((U=o.flip)==null?void 0:U.index)||0)+1,K=k[P];if(K&&(!(m==="alignment"?y!==Ln(K):!1)||B.every(A=>Ln(A.placement)===y?A.overflows[0]>0:!0)))return{data:{index:P,overflows:B},reset:{placement:K}};let G=(Q=B.filter(q=>q.overflows[0]<=0).sort((q,A)=>q.overflows[1]-A.overflows[1])[0])==null?void 0:Q.placement;if(!G)switch(f){case"bestFit":{var V;const q=(V=B.filter(A=>{if(j){const E=Ln(A.placement);return E===y||E==="y"}return!0}).map(A=>[A.placement,A.overflows.filter(E=>E>0).reduce((E,R)=>E+R,0)]).sort((A,E)=>A[1]-E[1])[0])==null?void 0:V[0];q&&(G=q);break}case"initialPlacement":G=c;break}if(a!==G)return{reset:{placement:G}}}return{}}}};function zg(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function Hg(e){return IA.some(t=>e[t]>=0)}const zA=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...a}=cr(e,t);switch(r){case"referenceHidden":{const o=await Ui(t,{...a,elementContext:"reference"}),l=zg(o,n.reference);return{data:{referenceHiddenOffsets:l,referenceHidden:Hg(l)}}}case"escaped":{const o=await Ui(t,{...a,altBoundary:!0}),l=zg(o,n.floating);return{data:{escapedOffsets:l,escaped:Hg(l)}}}default:return{}}}}},zw=new Set(["left","top"]);async function HA(e,t){const{placement:n,platform:r,elements:a}=e,o=await(r.isRTL==null?void 0:r.isRTL(a.floating)),l=ur(n),c=Mo(n),u=Ln(n)==="y",d=zw.has(l)?-1:1,g=o&&u?-1:1,m=cr(t,e);let{mainAxis:p,crossAxis:f,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return c&&typeof w=="number"&&(f=c==="end"?w*-1:w),u?{x:f*g,y:p*d}:{x:p*d,y:f*g}}const QA=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:a,y:o,placement:l,middlewareData:c}=t,u=await HA(t,e);return l===((n=c.offset)==null?void 0:n.placement)&&(r=c.arrow)!=null&&r.alignmentOffset?{}:{x:a+u.x,y:o+u.y,data:{...u,placement:l}}}}},GA=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:a}=t,{mainAxis:o=!0,crossAxis:l=!1,limiter:c={fn:v=>{let{x,y}=v;return{x,y}}},...u}=cr(e,t),d={x:n,y:r},g=await Ui(t,u),m=Ln(ur(a)),p=wh(m);let f=d[p],w=d[m];if(o){const v=p==="y"?"top":"left",x=p==="y"?"bottom":"right",y=f+g[v],b=f-g[x];f=Gm(y,f,b)}if(l){const v=m==="y"?"top":"left",x=m==="y"?"bottom":"right",y=w+g[v],b=w-g[x];w=Gm(y,w,b)}const h=c.fn({...t,[p]:f,[m]:w});return{...h,data:{x:h.x-n,y:h.y-r,enabled:{[p]:o,[m]:l}}}}}},qA=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:a,rects:o,middlewareData:l}=t,{offset:c=0,mainAxis:u=!0,crossAxis:d=!0}=cr(e,t),g={x:n,y:r},m=Ln(a),p=wh(m);let f=g[p],w=g[m];const h=cr(c,t),v=typeof h=="number"?{mainAxis:h,crossAxis:0}:{mainAxis:0,crossAxis:0,...h};if(u){const b=p==="y"?"height":"width",N=o.reference[p]-o.floating[b]+v.mainAxis,S=o.reference[p]+o.reference[b]-v.mainAxis;f<N?f=N:f>S&&(f=S)}if(d){var x,y;const b=p==="y"?"width":"height",N=zw.has(ur(a)),S=o.reference[m]-o.floating[b]+(N&&((x=l.offset)==null?void 0:x[m])||0)+(N?0:v.crossAxis),j=o.reference[m]+o.reference[b]+(N?0:((y=l.offset)==null?void 0:y[m])||0)-(N?v.crossAxis:0);w<S?w=S:w>j&&(w=j)}return{[p]:f,[m]:w}}}},YA=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:a,rects:o,platform:l,elements:c}=t,{apply:u=()=>{},...d}=cr(e,t),g=await Ui(t,d),m=ur(a),p=Mo(a),f=Ln(a)==="y",{width:w,height:h}=o.floating;let v,x;m==="top"||m==="bottom"?(v=m,x=p===(await(l.isRTL==null?void 0:l.isRTL(c.floating))?"start":"end")?"left":"right"):(x=m,v=p==="end"?"top":"bottom");const y=h-g.top-g.bottom,b=w-g.left-g.right,N=Qr(h-g[v],y),S=Qr(w-g[x],b),j=!t.middlewareData.shift;let k=N,C=S;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(C=b),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(k=y),j&&!p){const B=Js(g.left,0),U=Js(g.right,0),Q=Js(g.top,0),V=Js(g.bottom,0);f?C=w-2*(B!==0||U!==0?B+U:Js(g.left,g.right)):k=h-2*(Q!==0||V!==0?Q+V:Js(g.top,g.bottom))}await u({...t,availableWidth:C,availableHeight:k});const W=await l.getDimensions(c.floating);return w!==W.width||h!==W.height?{reset:{rects:!0}}:{}}}};function yu(){return typeof window<"u"}function $o(e){return Hw(e)?(e.nodeName||"").toLowerCase():"#document"}function en(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Gn(e){var t;return(t=(Hw(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function Hw(e){return yu()?e instanceof Node||e instanceof en(e).Node:!1}function An(e){return yu()?e instanceof Element||e instanceof en(e).Element:!1}function zn(e){return yu()?e instanceof HTMLElement||e instanceof en(e).HTMLElement:!1}function Qg(e){return!yu()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof en(e).ShadowRoot}const JA=new Set(["inline","contents"]);function nl(e){const{overflow:t,overflowX:n,overflowY:r,display:a}=Cn(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!JA.has(a)}const KA=new Set(["table","td","th"]);function XA(e){return KA.has($o(e))}const ZA=[":popover-open",":modal"];function wu(e){return ZA.some(t=>{try{return e.matches(t)}catch{return!1}})}const eC=["transform","translate","scale","rotate","perspective"],tC=["transform","translate","scale","rotate","perspective","filter"],sC=["paint","layout","strict","content"];function jh(e){const t=Sh(),n=An(e)?Cn(e):e;return eC.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||tC.some(r=>(n.willChange||"").includes(r))||sC.some(r=>(n.contain||"").includes(r))}function nC(e){let t=Gr(e);for(;zn(t)&&!vo(t);){if(jh(t))return t;if(wu(t))return null;t=Gr(t)}return null}function Sh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const rC=new Set(["html","body","#document"]);function vo(e){return rC.has($o(e))}function Cn(e){return en(e).getComputedStyle(e)}function bu(e){return An(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Gr(e){if($o(e)==="html")return e;const t=e.assignedSlot||e.parentNode||Qg(e)&&e.host||Gn(e);return Qg(t)?t.host:t}function Qw(e){const t=Gr(e);return vo(t)?e.ownerDocument?e.ownerDocument.body:e.body:zn(t)&&nl(t)?t:Qw(t)}function zi(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const a=Qw(e),o=a===((r=e.ownerDocument)==null?void 0:r.body),l=en(a);if(o){const c=Ym(l);return t.concat(l,l.visualViewport||[],nl(a)?a:[],c&&n?zi(c):[])}return t.concat(a,zi(a,[],n))}function Ym(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function Gw(e){const t=Cn(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const a=zn(e),o=a?e.offsetWidth:n,l=a?e.offsetHeight:r,c=Rc(n)!==o||Rc(r)!==l;return c&&(n=o,r=l),{width:n,height:r,$:c}}function kh(e){return An(e)?e:e.contextElement}function oo(e){const t=kh(e);if(!zn(t))return Wn(1);const n=t.getBoundingClientRect(),{width:r,height:a,$:o}=Gw(t);let l=(o?Rc(n.width):n.width)/r,c=(o?Rc(n.height):n.height)/a;return(!l||!Number.isFinite(l))&&(l=1),(!c||!Number.isFinite(c))&&(c=1),{x:l,y:c}}const aC=Wn(0);function qw(e){const t=en(e);return!Sh()||!t.visualViewport?aC:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function oC(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==en(e)?!1:t}function ja(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const a=e.getBoundingClientRect(),o=kh(e);let l=Wn(1);t&&(r?An(r)&&(l=oo(r)):l=oo(e));const c=oC(o,n,r)?qw(o):Wn(0);let u=(a.left+c.x)/l.x,d=(a.top+c.y)/l.y,g=a.width/l.x,m=a.height/l.y;if(o){const p=en(o),f=r&&An(r)?en(r):r;let w=p,h=Ym(w);for(;h&&r&&f!==w;){const v=oo(h),x=h.getBoundingClientRect(),y=Cn(h),b=x.left+(h.clientLeft+parseFloat(y.paddingLeft))*v.x,N=x.top+(h.clientTop+parseFloat(y.paddingTop))*v.y;u*=v.x,d*=v.y,g*=v.x,m*=v.y,u+=b,d+=N,w=en(h),h=Ym(w)}}return $c({width:g,height:m,x:u,y:d})}function Nu(e,t){const n=bu(e).scrollLeft;return t?t.left+n:ja(Gn(e)).left+n}function Yw(e,t){const n=e.getBoundingClientRect(),r=n.left+t.scrollLeft-Nu(e,n),a=n.top+t.scrollTop;return{x:r,y:a}}function iC(e){let{elements:t,rect:n,offsetParent:r,strategy:a}=e;const o=a==="fixed",l=Gn(r),c=t?wu(t.floating):!1;if(r===l||c&&o)return n;let u={scrollLeft:0,scrollTop:0},d=Wn(1);const g=Wn(0),m=zn(r);if((m||!m&&!o)&&(($o(r)!=="body"||nl(l))&&(u=bu(r)),zn(r))){const f=ja(r);d=oo(r),g.x=f.x+r.clientLeft,g.y=f.y+r.clientTop}const p=l&&!m&&!o?Yw(l,u):Wn(0);return{width:n.width*d.x,height:n.height*d.y,x:n.x*d.x-u.scrollLeft*d.x+g.x+p.x,y:n.y*d.y-u.scrollTop*d.y+g.y+p.y}}function lC(e){return Array.from(e.getClientRects())}function cC(e){const t=Gn(e),n=bu(e),r=e.ownerDocument.body,a=Js(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),o=Js(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let l=-n.scrollLeft+Nu(e);const c=-n.scrollTop;return Cn(r).direction==="rtl"&&(l+=Js(t.clientWidth,r.clientWidth)-a),{width:a,height:o,x:l,y:c}}const Gg=25;function uC(e,t){const n=en(e),r=Gn(e),a=n.visualViewport;let o=r.clientWidth,l=r.clientHeight,c=0,u=0;if(a){o=a.width,l=a.height;const g=Sh();(!g||g&&t==="fixed")&&(c=a.offsetLeft,u=a.offsetTop)}const d=Nu(r);if(d<=0){const g=r.ownerDocument,m=g.body,p=getComputedStyle(m),f=g.compatMode==="CSS1Compat"&&parseFloat(p.marginLeft)+parseFloat(p.marginRight)||0,w=Math.abs(r.clientWidth-m.clientWidth-f);w<=Gg&&(o-=w)}else d<=Gg&&(o+=d);return{width:o,height:l,x:c,y:u}}const dC=new Set(["absolute","fixed"]);function mC(e,t){const n=ja(e,!0,t==="fixed"),r=n.top+e.clientTop,a=n.left+e.clientLeft,o=zn(e)?oo(e):Wn(1),l=e.clientWidth*o.x,c=e.clientHeight*o.y,u=a*o.x,d=r*o.y;return{width:l,height:c,x:u,y:d}}function qg(e,t,n){let r;if(t==="viewport")r=uC(e,n);else if(t==="document")r=cC(Gn(e));else if(An(t))r=mC(t,n);else{const a=qw(e);r={x:t.x-a.x,y:t.y-a.y,width:t.width,height:t.height}}return $c(r)}function Jw(e,t){const n=Gr(e);return n===t||!An(n)||vo(n)?!1:Cn(n).position==="fixed"||Jw(n,t)}function fC(e,t){const n=t.get(e);if(n)return n;let r=zi(e,[],!1).filter(c=>An(c)&&$o(c)!=="body"),a=null;const o=Cn(e).position==="fixed";let l=o?Gr(e):e;for(;An(l)&&!vo(l);){const c=Cn(l),u=jh(l);!u&&c.position==="fixed"&&(a=null),(o?!u&&!a:!u&&c.position==="static"&&!!a&&dC.has(a.position)||nl(l)&&!u&&Jw(e,l))?r=r.filter(g=>g!==l):a=c,l=Gr(l)}return t.set(e,r),r}function hC(e){let{element:t,boundary:n,rootBoundary:r,strategy:a}=e;const l=[...n==="clippingAncestors"?wu(t)?[]:fC(t,this._c):[].concat(n),r],c=l[0],u=l.reduce((d,g)=>{const m=qg(t,g,a);return d.top=Js(m.top,d.top),d.right=Qr(m.right,d.right),d.bottom=Qr(m.bottom,d.bottom),d.left=Js(m.left,d.left),d},qg(t,c,a));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function pC(e){const{width:t,height:n}=Gw(e);return{width:t,height:n}}function gC(e,t,n){const r=zn(t),a=Gn(t),o=n==="fixed",l=ja(e,!0,o,t);let c={scrollLeft:0,scrollTop:0};const u=Wn(0);function d(){u.x=Nu(a)}if(r||!r&&!o)if(($o(t)!=="body"||nl(a))&&(c=bu(t)),r){const f=ja(t,!0,o,t);u.x=f.x+t.clientLeft,u.y=f.y+t.clientTop}else a&&d();o&&!r&&a&&d();const g=a&&!r&&!o?Yw(a,c):Wn(0),m=l.left+c.scrollLeft-u.x-g.x,p=l.top+c.scrollTop-u.y-g.y;return{x:m,y:p,width:l.width,height:l.height}}function wd(e){return Cn(e).position==="static"}function Yg(e,t){if(!zn(e)||Cn(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Gn(e)===n&&(n=n.ownerDocument.body),n}function Kw(e,t){const n=en(e);if(wu(e))return n;if(!zn(e)){let a=Gr(e);for(;a&&!vo(a);){if(An(a)&&!wd(a))return a;a=Gr(a)}return n}let r=Yg(e,t);for(;r&&XA(r)&&wd(r);)r=Yg(r,t);return r&&vo(r)&&wd(r)&&!jh(r)?n:r||nC(e)||n}const xC=async function(e){const t=this.getOffsetParent||Kw,n=this.getDimensions,r=await n(e.floating);return{reference:gC(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function vC(e){return Cn(e).direction==="rtl"}const yC={convertOffsetParentRelativeRectToViewportRelativeRect:iC,getDocumentElement:Gn,getClippingRect:hC,getOffsetParent:Kw,getElementRects:xC,getClientRects:lC,getDimensions:pC,getScale:oo,isElement:An,isRTL:vC};function Xw(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function wC(e,t){let n=null,r;const a=Gn(e);function o(){var c;clearTimeout(r),(c=n)==null||c.disconnect(),n=null}function l(c,u){c===void 0&&(c=!1),u===void 0&&(u=1),o();const d=e.getBoundingClientRect(),{left:g,top:m,width:p,height:f}=d;if(c||t(),!p||!f)return;const w=Pl(m),h=Pl(a.clientWidth-(g+p)),v=Pl(a.clientHeight-(m+f)),x=Pl(g),b={rootMargin:-w+"px "+-h+"px "+-v+"px "+-x+"px",threshold:Js(0,Qr(1,u))||1};let N=!0;function S(j){const k=j[0].intersectionRatio;if(k!==u){if(!N)return l();k?l(!1,k):r=setTimeout(()=>{l(!1,1e-7)},1e3)}k===1&&!Xw(d,e.getBoundingClientRect())&&l(),N=!1}try{n=new IntersectionObserver(S,{...b,root:a.ownerDocument})}catch{n=new IntersectionObserver(S,b)}n.observe(e)}return l(!0),o}function bC(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:a=!0,ancestorResize:o=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:c=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=kh(e),g=a||o?[...d?zi(d):[],...zi(t)]:[];g.forEach(x=>{a&&x.addEventListener("scroll",n,{passive:!0}),o&&x.addEventListener("resize",n)});const m=d&&c?wC(d,n):null;let p=-1,f=null;l&&(f=new ResizeObserver(x=>{let[y]=x;y&&y.target===d&&f&&(f.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(t)})),n()}),d&&!u&&f.observe(d),f.observe(t));let w,h=u?ja(e):null;u&&v();function v(){const x=ja(e);h&&!Xw(h,x)&&n(),h=x,w=requestAnimationFrame(v)}return n(),()=>{var x;g.forEach(y=>{a&&y.removeEventListener("scroll",n),o&&y.removeEventListener("resize",n)}),m==null||m(),(x=f)==null||x.disconnect(),f=null,u&&cancelAnimationFrame(w)}}const NC=QA,jC=GA,SC=UA,kC=YA,PC=zA,Jg=WA,AC=qA,CC=(e,t,n)=>{const r=new Map,a={platform:yC,...n},o={...a.platform,_c:r};return BA(e,t,{...a,platform:o})};var EC=typeof document<"u",IC=function(){},Jl=EC?i.useLayoutEffect:IC;function Dc(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,a;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!Dc(e[r],t[r]))return!1;return!0}if(a=Object.keys(e),n=a.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,a[r]))return!1;for(r=n;r--!==0;){const o=a[r];if(!(o==="_owner"&&e.$$typeof)&&!Dc(e[o],t[o]))return!1}return!0}return e!==e&&t!==t}function Zw(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Kg(e,t){const n=Zw(e);return Math.round(t*n)/n}function bd(e){const t=i.useRef(e);return Jl(()=>{t.current=e}),t}function TC(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:a,elements:{reference:o,floating:l}={},transform:c=!0,whileElementsMounted:u,open:d}=e,[g,m]=i.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[p,f]=i.useState(r);Dc(p,r)||f(r);const[w,h]=i.useState(null),[v,x]=i.useState(null),y=i.useCallback(A=>{A!==j.current&&(j.current=A,h(A))},[]),b=i.useCallback(A=>{A!==k.current&&(k.current=A,x(A))},[]),N=o||w,S=l||v,j=i.useRef(null),k=i.useRef(null),C=i.useRef(g),W=u!=null,B=bd(u),U=bd(a),Q=bd(d),V=i.useCallback(()=>{if(!j.current||!k.current)return;const A={placement:t,strategy:n,middleware:p};U.current&&(A.platform=U.current),CC(j.current,k.current,A).then(E=>{const R={...E,isPositioned:Q.current!==!1};P.current&&!Dc(C.current,R)&&(C.current=R,Eo.flushSync(()=>{m(R)}))})},[p,t,n,U,Q]);Jl(()=>{d===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,m(A=>({...A,isPositioned:!1})))},[d]);const P=i.useRef(!1);Jl(()=>(P.current=!0,()=>{P.current=!1}),[]),Jl(()=>{if(N&&(j.current=N),S&&(k.current=S),N&&S){if(B.current)return B.current(N,S,V);V()}},[N,S,V,B,W]);const K=i.useMemo(()=>({reference:j,floating:k,setReference:y,setFloating:b}),[y,b]),G=i.useMemo(()=>({reference:N,floating:S}),[N,S]),q=i.useMemo(()=>{const A={position:n,left:0,top:0};if(!G.floating)return A;const E=Kg(G.floating,g.x),R=Kg(G.floating,g.y);return c?{...A,transform:"translate("+E+"px, "+R+"px)",...Zw(G.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:E,top:R}},[n,c,G.floating,g.x,g.y]);return i.useMemo(()=>({...g,update:V,refs:K,elements:G,floatingStyles:q}),[g,V,K,G,q])}const RC=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:a}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?Jg({element:r.current,padding:a}).fn(n):{}:r?Jg({element:r,padding:a}).fn(n):{}}}},MC=(e,t)=>({...NC(e),options:[e,t]}),$C=(e,t)=>({...jC(e),options:[e,t]}),DC=(e,t)=>({...AC(e),options:[e,t]}),OC=(e,t)=>({...SC(e),options:[e,t]}),FC=(e,t)=>({...kC(e),options:[e,t]}),_C=(e,t)=>({...PC(e),options:[e,t]}),LC=(e,t)=>({...RC(e),options:[e,t]});var VC="Arrow",eb=i.forwardRef((e,t)=>{const{children:n,width:r=10,height:a=5,...o}=e;return s.jsx(kt.svg,{...o,ref:t,width:r,height:a,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:s.jsx("polygon",{points:"0,0 30,0 15,10"})})});eb.displayName=VC;var BC=eb;function WC(e){const[t,n]=i.useState(void 0);return ks(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(a=>{if(!Array.isArray(a)||!a.length)return;const o=a[0];let l,c;if("borderBoxSize"in o){const u=o.borderBoxSize,d=Array.isArray(u)?u[0]:u;l=d.inlineSize,c=d.blockSize}else l=e.offsetWidth,c=e.offsetHeight;n({width:l,height:c})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var Ph="Popper",[tb,ju]=Qn(Ph),[UC,sb]=tb(Ph),nb=e=>{const{__scopePopper:t,children:n}=e,[r,a]=i.useState(null);return s.jsx(UC,{scope:t,anchor:r,onAnchorChange:a,children:n})};nb.displayName=Ph;var rb="PopperAnchor",ab=i.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...a}=e,o=sb(rb,n),l=i.useRef(null),c=_t(t,l),u=i.useRef(null);return i.useEffect(()=>{const d=u.current;u.current=(r==null?void 0:r.current)||l.current,d!==u.current&&o.onAnchorChange(u.current)}),r?null:s.jsx(kt.div,{...a,ref:c})});ab.displayName=rb;var Ah="PopperContent",[zC,HC]=tb(Ah),ob=i.forwardRef((e,t)=>{var T,ie,Z,le,oe,z;const{__scopePopper:n,side:r="bottom",sideOffset:a=0,align:o="center",alignOffset:l=0,arrowPadding:c=0,avoidCollisions:u=!0,collisionBoundary:d=[],collisionPadding:g=0,sticky:m="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:w,...h}=e,v=sb(Ah,n),[x,y]=i.useState(null),b=_t(t,ee=>y(ee)),[N,S]=i.useState(null),j=WC(N),k=(j==null?void 0:j.width)??0,C=(j==null?void 0:j.height)??0,W=r+(o!=="center"?"-"+o:""),B=typeof g=="number"?g:{top:0,right:0,bottom:0,left:0,...g},U=Array.isArray(d)?d:[d],Q=U.length>0,V={padding:B,boundary:U.filter(GC),altBoundary:Q},{refs:P,floatingStyles:K,placement:G,isPositioned:q,middlewareData:A}=TC({strategy:"fixed",placement:W,whileElementsMounted:(...ee)=>bC(...ee,{animationFrame:f==="always"}),elements:{reference:v.anchor},middleware:[MC({mainAxis:a+C,alignmentAxis:l}),u&&$C({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?DC():void 0,...V}),u&&OC({...V}),FC({...V,apply:({elements:ee,rects:ne,availableWidth:me,availableHeight:ve})=>{const{width:D,height:ue}=ne.reference,O=ee.floating.style;O.setProperty("--radix-popper-available-width",`${me}px`),O.setProperty("--radix-popper-available-height",`${ve}px`),O.setProperty("--radix-popper-anchor-width",`${D}px`),O.setProperty("--radix-popper-anchor-height",`${ue}px`)}}),N&&LC({element:N,padding:c}),qC({arrowWidth:k,arrowHeight:C}),p&&_C({strategy:"referenceHidden",...V})]}),[E,R]=cb(G),L=Un(w);ks(()=>{q&&(L==null||L())},[q,L]);const I=(T=A.arrow)==null?void 0:T.x,_=(ie=A.arrow)==null?void 0:ie.y,$=((Z=A.arrow)==null?void 0:Z.centerOffset)!==0,[F,M]=i.useState();return ks(()=>{x&&M(window.getComputedStyle(x).zIndex)},[x]),s.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:q?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:F,"--radix-popper-transform-origin":[(le=A.transformOrigin)==null?void 0:le.x,(oe=A.transformOrigin)==null?void 0:oe.y].join(" "),...((z=A.hide)==null?void 0:z.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:s.jsx(zC,{scope:n,placedSide:E,onArrowChange:S,arrowX:I,arrowY:_,shouldHideArrow:$,children:s.jsx(kt.div,{"data-side":E,"data-align":R,...h,ref:b,style:{...h.style,animation:q?void 0:"none"}})})})});ob.displayName=Ah;var ib="PopperArrow",QC={top:"bottom",right:"left",bottom:"top",left:"right"},lb=i.forwardRef(function(t,n){const{__scopePopper:r,...a}=t,o=HC(ib,r),l=QC[o.placedSide];return s.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[l]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:s.jsx(BC,{...a,ref:n,style:{...a.style,display:"block"}})})});lb.displayName=ib;function GC(e){return e!==null}var qC=e=>({name:"transformOrigin",options:e,fn(t){var v,x,y;const{placement:n,rects:r,middlewareData:a}=t,l=((v=a.arrow)==null?void 0:v.centerOffset)!==0,c=l?0:e.arrowWidth,u=l?0:e.arrowHeight,[d,g]=cb(n),m={start:"0%",center:"50%",end:"100%"}[g],p=(((x=a.arrow)==null?void 0:x.x)??0)+c/2,f=(((y=a.arrow)==null?void 0:y.y)??0)+u/2;let w="",h="";return d==="bottom"?(w=l?m:`${p}px`,h=`${-u}px`):d==="top"?(w=l?m:`${p}px`,h=`${r.floating.height+u}px`):d==="right"?(w=`${-u}px`,h=l?m:`${f}px`):d==="left"&&(w=`${r.floating.width+u}px`,h=l?m:`${f}px`),{data:{x:w,y:h}}}});function cb(e){const[t,n="center"]=e.split("-");return[t,n]}var ub=nb,db=ab,mb=ob,fb=lb,YC="Portal",Su=i.forwardRef((e,t)=>{var c;const{container:n,...r}=e,[a,o]=i.useState(!1);ks(()=>o(!0),[]);const l=n||a&&((c=globalThis==null?void 0:globalThis.document)==null?void 0:c.body);return l?iw.createPortal(s.jsx(kt.div,{...r,ref:t}),l):null});Su.displayName=YC;function JC(e,t){return i.useReducer((n,r)=>t[n][r]??n,e)}var gr=e=>{const{present:t,children:n}=e,r=KC(t),a=typeof n=="function"?n({present:r.isPresent}):i.Children.only(n),o=_t(r.ref,XC(a));return typeof n=="function"||r.isPresent?i.cloneElement(a,{ref:o}):null};gr.displayName="Presence";function KC(e){const[t,n]=i.useState(),r=i.useRef(null),a=i.useRef(e),o=i.useRef("none"),l=e?"mounted":"unmounted",[c,u]=JC(l,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return i.useEffect(()=>{const d=Al(r.current);o.current=c==="mounted"?d:"none"},[c]),ks(()=>{const d=r.current,g=a.current;if(g!==e){const p=o.current,f=Al(d);e?u("MOUNT"):f==="none"||(d==null?void 0:d.display)==="none"?u("UNMOUNT"):u(g&&p!==f?"ANIMATION_OUT":"UNMOUNT"),a.current=e}},[e,u]),ks(()=>{if(t){let d;const g=t.ownerDocument.defaultView??window,m=f=>{const h=Al(r.current).includes(CSS.escape(f.animationName));if(f.target===t&&h&&(u("ANIMATION_END"),!a.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",d=g.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},p=f=>{f.target===t&&(o.current=Al(r.current))};return t.addEventListener("animationstart",p),t.addEventListener("animationcancel",m),t.addEventListener("animationend",m),()=>{g.clearTimeout(d),t.removeEventListener("animationstart",p),t.removeEventListener("animationcancel",m),t.removeEventListener("animationend",m)}}else u("ANIMATION_END")},[t,u]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:i.useCallback(d=>{r.current=d?getComputedStyle(d):null,n(d)},[])}}function Al(e){return(e==null?void 0:e.animationName)||"none"}function XC(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Nd="rovingFocusGroup.onEntryFocus",ZC={bubbles:!1,cancelable:!0},rl="RovingFocusGroup",[Jm,hb,eE]=pu(rl),[tE,pb]=Qn(rl,[eE]),[sE,nE]=tE(rl),gb=i.forwardRef((e,t)=>s.jsx(Jm.Provider,{scope:e.__scopeRovingFocusGroup,children:s.jsx(Jm.Slot,{scope:e.__scopeRovingFocusGroup,children:s.jsx(rE,{...e,ref:t})})}));gb.displayName=rl;var rE=i.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:a=!1,dir:o,currentTabStopId:l,defaultCurrentTabStopId:c,onCurrentTabStopIdChange:u,onEntryFocus:d,preventScrollOnEntryFocus:g=!1,...m}=e,p=i.useRef(null),f=_t(t,p),w=gu(o),[h,v]=Hr({prop:l,defaultProp:c??null,onChange:u,caller:rl}),[x,y]=i.useState(!1),b=Un(d),N=hb(n),S=i.useRef(!1),[j,k]=i.useState(0);return i.useEffect(()=>{const C=p.current;if(C)return C.addEventListener(Nd,b),()=>C.removeEventListener(Nd,b)},[b]),s.jsx(sE,{scope:n,orientation:r,dir:w,loop:a,currentTabStopId:h,onItemFocus:i.useCallback(C=>v(C),[v]),onItemShiftTab:i.useCallback(()=>y(!0),[]),onFocusableItemAdd:i.useCallback(()=>k(C=>C+1),[]),onFocusableItemRemove:i.useCallback(()=>k(C=>C-1),[]),children:s.jsx(kt.div,{tabIndex:x||j===0?-1:0,"data-orientation":r,...m,ref:f,style:{outline:"none",...e.style},onMouseDown:ot(e.onMouseDown,()=>{S.current=!0}),onFocus:ot(e.onFocus,C=>{const W=!S.current;if(C.target===C.currentTarget&&W&&!x){const B=new CustomEvent(Nd,ZC);if(C.currentTarget.dispatchEvent(B),!B.defaultPrevented){const U=N().filter(G=>G.focusable),Q=U.find(G=>G.active),V=U.find(G=>G.id===h),K=[Q,V,...U].filter(Boolean).map(G=>G.ref.current);yb(K,g)}}S.current=!1}),onBlur:ot(e.onBlur,()=>y(!1))})})}),xb="RovingFocusGroupItem",vb=i.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:a=!1,tabStopId:o,children:l,...c}=e,u=Sn(),d=o||u,g=nE(xb,n),m=g.currentTabStopId===d,p=hb(n),{onFocusableItemAdd:f,onFocusableItemRemove:w,currentTabStopId:h}=g;return i.useEffect(()=>{if(r)return f(),()=>w()},[r,f,w]),s.jsx(Jm.ItemSlot,{scope:n,id:d,focusable:r,active:a,children:s.jsx(kt.span,{tabIndex:m?0:-1,"data-orientation":g.orientation,...c,ref:t,onMouseDown:ot(e.onMouseDown,v=>{r?g.onItemFocus(d):v.preventDefault()}),onFocus:ot(e.onFocus,()=>g.onItemFocus(d)),onKeyDown:ot(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){g.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=iE(v,g.orientation,g.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let b=p().filter(N=>N.focusable).map(N=>N.ref.current);if(x==="last")b.reverse();else if(x==="prev"||x==="next"){x==="prev"&&b.reverse();const N=b.indexOf(v.currentTarget);b=g.loop?lE(b,N+1):b.slice(N+1)}setTimeout(()=>yb(b))}}),children:typeof l=="function"?l({isCurrentTabStop:m,hasTabStop:h!=null}):l})})});vb.displayName=xb;var aE={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function oE(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function iE(e,t,n){const r=oE(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return aE[r]}function yb(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function lE(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var cE=gb,uE=vb;function dE(e){const t=mE(e),n=i.forwardRef((r,a)=>{const{children:o,...l}=r,c=i.Children.toArray(o),u=c.find(hE);if(u){const d=u.props.children,g=c.map(m=>m===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:m);return s.jsx(t,{...l,ref:a,children:i.isValidElement(d)?i.cloneElement(d,void 0,g):null})}return s.jsx(t,{...l,ref:a,children:o})});return n.displayName=`${e}.Slot`,n}function mE(e){const t=i.forwardRef((n,r)=>{const{children:a,...o}=n;if(i.isValidElement(a)){const l=gE(a),c=pE(o,a.props);return a.type!==i.Fragment&&(c.ref=r?hr(r,l):l),i.cloneElement(a,c)}return i.Children.count(a)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var fE=Symbol("radix.slottable");function hE(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===fE}function pE(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...c)=>{const u=o(...c);return a(...c),u}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function gE(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var xE=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},$a=new WeakMap,Cl=new WeakMap,El={},jd=0,wb=function(e){return e&&(e.host||wb(e.parentNode))},vE=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=wb(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},yE=function(e,t,n,r){var a=vE(t,Array.isArray(e)?e:[e]);El[n]||(El[n]=new WeakMap);var o=El[n],l=[],c=new Set,u=new Set(a),d=function(m){!m||c.has(m)||(c.add(m),d(m.parentNode))};a.forEach(d);var g=function(m){!m||u.has(m)||Array.prototype.forEach.call(m.children,function(p){if(c.has(p))g(p);else try{var f=p.getAttribute(r),w=f!==null&&f!=="false",h=($a.get(p)||0)+1,v=(o.get(p)||0)+1;$a.set(p,h),o.set(p,v),l.push(p),h===1&&w&&Cl.set(p,!0),v===1&&p.setAttribute(n,"true"),w||p.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",p,x)}})};return g(t),c.clear(),jd++,function(){l.forEach(function(m){var p=$a.get(m)-1,f=o.get(m)-1;$a.set(m,p),o.set(m,f),p||(Cl.has(m)||m.removeAttribute(r),Cl.delete(m)),f||m.removeAttribute(n)}),jd--,jd||($a=new WeakMap,$a=new WeakMap,Cl=new WeakMap,El={})}},Ch=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=xE(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live], script"))),yE(r,a,n,"aria-hidden")):function(){return null}},_n=function(){return _n=Object.assign||function(t){for(var n,r=1,a=arguments.length;r<a;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_n.apply(this,arguments)};function bb(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]]);return n}function wE(e,t,n){if(n||arguments.length===2)for(var r=0,a=t.length,o;r<a;r++)(o||!(r in t))&&(o||(o=Array.prototype.slice.call(t,0,r)),o[r]=t[r]);return e.concat(o||Array.prototype.slice.call(t))}var Kl="right-scroll-bar-position",Xl="width-before-scroll-bar",bE="with-scroll-bars-hidden",NE="--removed-body-scroll-bar-size";function Sd(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function jE(e,t){var n=i.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var a=n.value;a!==r&&(n.value=r,n.callback(r,a))}}}})[0];return n.callback=t,n.facade}var SE=typeof window<"u"?i.useLayoutEffect:i.useEffect,Xg=new WeakMap;function kE(e,t){var n=jE(null,function(r){return e.forEach(function(a){return Sd(a,r)})});return SE(function(){var r=Xg.get(n);if(r){var a=new Set(r),o=new Set(e),l=n.current;a.forEach(function(c){o.has(c)||Sd(c,null)}),o.forEach(function(c){a.has(c)||Sd(c,l)})}Xg.set(n,e)},[e]),n}function PE(e){return e}function AE(e,t){t===void 0&&(t=PE);var n=[],r=!1,a={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(o){var l=t(o,r);return n.push(l),function(){n=n.filter(function(c){return c!==l})}},assignSyncMedium:function(o){for(r=!0;n.length;){var l=n;n=[],l.forEach(o)}n={push:function(c){return o(c)},filter:function(){return n}}},assignMedium:function(o){r=!0;var l=[];if(n.length){var c=n;n=[],c.forEach(o),l=n}var u=function(){var g=l;l=[],g.forEach(o)},d=function(){return Promise.resolve().then(u)};d(),n={push:function(g){l.push(g),d()},filter:function(g){return l=l.filter(g),n}}}};return a}function CE(e){e===void 0&&(e={});var t=AE(null);return t.options=_n({async:!0,ssr:!1},e),t}var Nb=function(e){var t=e.sideCar,n=bb(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return i.createElement(r,_n({},n))};Nb.isSideCarExport=!0;function EE(e,t){return e.useMedium(t),Nb}var jb=CE(),kd=function(){},ku=i.forwardRef(function(e,t){var n=i.useRef(null),r=i.useState({onScrollCapture:kd,onWheelCapture:kd,onTouchMoveCapture:kd}),a=r[0],o=r[1],l=e.forwardProps,c=e.children,u=e.className,d=e.removeScrollBar,g=e.enabled,m=e.shards,p=e.sideCar,f=e.noRelative,w=e.noIsolation,h=e.inert,v=e.allowPinchZoom,x=e.as,y=x===void 0?"div":x,b=e.gapMode,N=bb(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),S=p,j=kE([n,t]),k=_n(_n({},N),a);return i.createElement(i.Fragment,null,g&&i.createElement(S,{sideCar:jb,removeScrollBar:d,shards:m,noRelative:f,noIsolation:w,inert:h,setCallbacks:o,allowPinchZoom:!!v,lockRef:n,gapMode:b}),l?i.cloneElement(i.Children.only(c),_n(_n({},k),{ref:j})):i.createElement(y,_n({},k,{className:u,ref:j}),c))});ku.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};ku.classNames={fullWidth:Xl,zeroRight:Kl};var IE=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function TE(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=IE();return t&&e.setAttribute("nonce",t),e}function RE(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function ME(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var $E=function(){var e=0,t=null;return{add:function(n){e==0&&(t=TE())&&(RE(t,n),ME(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},DE=function(){var e=$E();return function(t,n){i.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Sb=function(){var e=DE(),t=function(n){var r=n.styles,a=n.dynamic;return e(r,a),null};return t},OE={left:0,top:0,right:0,gap:0},Pd=function(e){return parseInt(e||"",10)||0},FE=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],a=t[e==="padding"?"paddingRight":"marginRight"];return[Pd(n),Pd(r),Pd(a)]},_E=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return OE;var t=FE(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},LE=Sb(),io="data-scroll-locked",VE=function(e,t,n,r){var a=e.left,o=e.top,l=e.right,c=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(bE,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(c,"px ").concat(r,`;
  }
  body[`).concat(io,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(a,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(l,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(c,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(c,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Kl,` {
    right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Xl,` {
    margin-right: `).concat(c,"px ").concat(r,`;
  }
  
  .`).concat(Kl," .").concat(Kl,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Xl," .").concat(Xl,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(io,`] {
    `).concat(NE,": ").concat(c,`px;
  }
`)},Zg=function(){var e=parseInt(document.body.getAttribute(io)||"0",10);return isFinite(e)?e:0},BE=function(){i.useEffect(function(){return document.body.setAttribute(io,(Zg()+1).toString()),function(){var e=Zg()-1;e<=0?document.body.removeAttribute(io):document.body.setAttribute(io,e.toString())}},[])},WE=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,a=r===void 0?"margin":r;BE();var o=i.useMemo(function(){return _E(a)},[a]);return i.createElement(LE,{styles:VE(o,!t,a,n?"":"!important")})},Km=!1;if(typeof window<"u")try{var Il=Object.defineProperty({},"passive",{get:function(){return Km=!0,!0}});window.addEventListener("test",Il,Il),window.removeEventListener("test",Il,Il)}catch{Km=!1}var Da=Km?{passive:!1}:!1,UE=function(e){return e.tagName==="TEXTAREA"},kb=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!UE(e)&&n[t]==="visible")},zE=function(e){return kb(e,"overflowY")},HE=function(e){return kb(e,"overflowX")},ex=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var a=Pb(e,r);if(a){var o=Ab(e,r),l=o[1],c=o[2];if(l>c)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},QE=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},GE=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Pb=function(e,t){return e==="v"?zE(t):HE(t)},Ab=function(e,t){return e==="v"?QE(t):GE(t)},qE=function(e,t){return e==="h"&&t==="rtl"?-1:1},YE=function(e,t,n,r,a){var o=qE(e,window.getComputedStyle(t).direction),l=o*r,c=n.target,u=t.contains(c),d=!1,g=l>0,m=0,p=0;do{if(!c)break;var f=Ab(e,c),w=f[0],h=f[1],v=f[2],x=h-v-o*w;(w||x)&&Pb(e,c)&&(m+=x,p+=w);var y=c.parentNode;c=y&&y.nodeType===Node.DOCUMENT_FRAGMENT_NODE?y.host:y}while(!u&&c!==document.body||u&&(t.contains(c)||t===c));return(g&&Math.abs(m)<1||!g&&Math.abs(p)<1)&&(d=!0),d},Tl=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},tx=function(e){return[e.deltaX,e.deltaY]},sx=function(e){return e&&"current"in e?e.current:e},JE=function(e,t){return e[0]===t[0]&&e[1]===t[1]},KE=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},XE=0,Oa=[];function ZE(e){var t=i.useRef([]),n=i.useRef([0,0]),r=i.useRef(),a=i.useState(XE++)[0],o=i.useState(Sb)[0],l=i.useRef(e);i.useEffect(function(){l.current=e},[e]),i.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(a));var h=wE([e.lockRef.current],(e.shards||[]).map(sx),!0).filter(Boolean);return h.forEach(function(v){return v.classList.add("allow-interactivity-".concat(a))}),function(){document.body.classList.remove("block-interactivity-".concat(a)),h.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(a))})}}},[e.inert,e.lockRef.current,e.shards]);var c=i.useCallback(function(h,v){if("touches"in h&&h.touches.length===2||h.type==="wheel"&&h.ctrlKey)return!l.current.allowPinchZoom;var x=Tl(h),y=n.current,b="deltaX"in h?h.deltaX:y[0]-x[0],N="deltaY"in h?h.deltaY:y[1]-x[1],S,j=h.target,k=Math.abs(b)>Math.abs(N)?"h":"v";if("touches"in h&&k==="h"&&j.type==="range")return!1;var C=ex(k,j);if(!C)return!0;if(C?S=k:(S=k==="v"?"h":"v",C=ex(k,j)),!C)return!1;if(!r.current&&"changedTouches"in h&&(b||N)&&(r.current=S),!S)return!0;var W=r.current||S;return YE(W,v,h,W==="h"?b:N)},[]),u=i.useCallback(function(h){var v=h;if(!(!Oa.length||Oa[Oa.length-1]!==o)){var x="deltaY"in v?tx(v):Tl(v),y=t.current.filter(function(S){return S.name===v.type&&(S.target===v.target||v.target===S.shadowParent)&&JE(S.delta,x)})[0];if(y&&y.should){v.cancelable&&v.preventDefault();return}if(!y){var b=(l.current.shards||[]).map(sx).filter(Boolean).filter(function(S){return S.contains(v.target)}),N=b.length>0?c(v,b[0]):!l.current.noIsolation;N&&v.cancelable&&v.preventDefault()}}},[]),d=i.useCallback(function(h,v,x,y){var b={name:h,delta:v,target:x,should:y,shadowParent:eI(x)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(N){return N!==b})},1)},[]),g=i.useCallback(function(h){n.current=Tl(h),r.current=void 0},[]),m=i.useCallback(function(h){d(h.type,tx(h),h.target,c(h,e.lockRef.current))},[]),p=i.useCallback(function(h){d(h.type,Tl(h),h.target,c(h,e.lockRef.current))},[]);i.useEffect(function(){return Oa.push(o),e.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:p}),document.addEventListener("wheel",u,Da),document.addEventListener("touchmove",u,Da),document.addEventListener("touchstart",g,Da),function(){Oa=Oa.filter(function(h){return h!==o}),document.removeEventListener("wheel",u,Da),document.removeEventListener("touchmove",u,Da),document.removeEventListener("touchstart",g,Da)}},[]);var f=e.removeScrollBar,w=e.inert;return i.createElement(i.Fragment,null,w?i.createElement(o,{styles:KE(a)}):null,f?i.createElement(WE,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function eI(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const tI=EE(jb,ZE);var Pu=i.forwardRef(function(e,t){return i.createElement(ku,_n({},e,{ref:t,sideCar:tI}))});Pu.classNames=ku.classNames;var Xm=["Enter"," "],sI=["ArrowDown","PageUp","Home"],Cb=["ArrowUp","PageDown","End"],nI=[...sI,...Cb],rI={ltr:[...Xm,"ArrowRight"],rtl:[...Xm,"ArrowLeft"]},aI={ltr:["ArrowLeft"],rtl:["ArrowRight"]},al="Menu",[Hi,oI,iI]=pu(al),[Ia,Eb]=Qn(al,[iI,ju,pb]),Au=ju(),Ib=pb(),[lI,Ta]=Ia(al),[cI,ol]=Ia(al),Tb=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:a,onOpenChange:o,modal:l=!0}=e,c=Au(t),[u,d]=i.useState(null),g=i.useRef(!1),m=Un(o),p=gu(a);return i.useEffect(()=>{const f=()=>{g.current=!0,document.addEventListener("pointerdown",w,{capture:!0,once:!0}),document.addEventListener("pointermove",w,{capture:!0,once:!0})},w=()=>g.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",w,{capture:!0}),document.removeEventListener("pointermove",w,{capture:!0})}},[]),s.jsx(ub,{...c,children:s.jsx(lI,{scope:t,open:n,onOpenChange:m,content:u,onContentChange:d,children:s.jsx(cI,{scope:t,onClose:i.useCallback(()=>m(!1),[m]),isUsingKeyboardRef:g,dir:p,modal:l,children:r})})})};Tb.displayName=al;var uI="MenuAnchor",Eh=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Au(n);return s.jsx(db,{...a,...r,ref:t})});Eh.displayName=uI;var Ih="MenuPortal",[dI,Rb]=Ia(Ih,{forceMount:void 0}),Mb=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:a}=e,o=Ta(Ih,t);return s.jsx(dI,{scope:t,forceMount:n,children:s.jsx(gr,{present:n||o.open,children:s.jsx(Su,{asChild:!0,container:a,children:r})})})};Mb.displayName=Ih;var un="MenuContent",[mI,Th]=Ia(un),$b=i.forwardRef((e,t)=>{const n=Rb(un,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=Ta(un,e.__scopeMenu),l=ol(un,e.__scopeMenu);return s.jsx(Hi.Provider,{scope:e.__scopeMenu,children:s.jsx(gr,{present:r||o.open,children:s.jsx(Hi.Slot,{scope:e.__scopeMenu,children:l.modal?s.jsx(fI,{...a,ref:t}):s.jsx(hI,{...a,ref:t})})})})}),fI=i.forwardRef((e,t)=>{const n=Ta(un,e.__scopeMenu),r=i.useRef(null),a=_t(t,r);return i.useEffect(()=>{const o=r.current;if(o)return Ch(o)},[]),s.jsx(Rh,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ot(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),hI=i.forwardRef((e,t)=>{const n=Ta(un,e.__scopeMenu);return s.jsx(Rh,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),pI=dE("MenuContent.ScrollLock"),Rh=i.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:a,onOpenAutoFocus:o,onCloseAutoFocus:l,disableOutsidePointerEvents:c,onEntryFocus:u,onEscapeKeyDown:d,onPointerDownOutside:g,onFocusOutside:m,onInteractOutside:p,onDismiss:f,disableOutsideScroll:w,...h}=e,v=Ta(un,n),x=ol(un,n),y=Au(n),b=Ib(n),N=oI(n),[S,j]=i.useState(null),k=i.useRef(null),C=_t(t,k,v.onContentChange),W=i.useRef(0),B=i.useRef(""),U=i.useRef(0),Q=i.useRef(null),V=i.useRef("right"),P=i.useRef(0),K=w?Pu:i.Fragment,G=w?{as:pI,allowPinchZoom:!0}:void 0,q=E=>{var T,ie;const R=B.current+E,L=N().filter(Z=>!Z.disabled),I=document.activeElement,_=(T=L.find(Z=>Z.ref.current===I))==null?void 0:T.textValue,$=L.map(Z=>Z.textValue),F=AI($,R,_),M=(ie=L.find(Z=>Z.textValue===F))==null?void 0:ie.ref.current;(function Z(le){B.current=le,window.clearTimeout(W.current),le!==""&&(W.current=window.setTimeout(()=>Z(""),1e3))})(R),M&&setTimeout(()=>M.focus())};i.useEffect(()=>()=>window.clearTimeout(W.current),[]),yh();const A=i.useCallback(E=>{var L,I;return V.current===((L=Q.current)==null?void 0:L.side)&&EI(E,(I=Q.current)==null?void 0:I.area)},[]);return s.jsx(mI,{scope:n,searchRef:B,onItemEnter:i.useCallback(E=>{A(E)&&E.preventDefault()},[A]),onItemLeave:i.useCallback(E=>{var R;A(E)||((R=k.current)==null||R.focus(),j(null))},[A]),onTriggerLeave:i.useCallback(E=>{A(E)&&E.preventDefault()},[A]),pointerGraceTimerRef:U,onPointerGraceIntentChange:i.useCallback(E=>{Q.current=E},[]),children:s.jsx(K,{...G,children:s.jsx(vu,{asChild:!0,trapped:a,onMountAutoFocus:ot(o,E=>{var R;E.preventDefault(),(R=k.current)==null||R.focus({preventScroll:!0})}),onUnmountAutoFocus:l,children:s.jsx(xu,{asChild:!0,disableOutsidePointerEvents:c,onEscapeKeyDown:d,onPointerDownOutside:g,onFocusOutside:m,onInteractOutside:p,onDismiss:f,children:s.jsx(cE,{asChild:!0,...b,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:S,onCurrentTabStopIdChange:j,onEntryFocus:ot(u,E=>{x.isUsingKeyboardRef.current||E.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(mb,{role:"menu","aria-orientation":"vertical","data-state":Jb(v.open),"data-radix-menu-content":"",dir:x.dir,...y,...h,ref:C,style:{outline:"none",...h.style},onKeyDown:ot(h.onKeyDown,E=>{const L=E.target.closest("[data-radix-menu-content]")===E.currentTarget,I=E.ctrlKey||E.altKey||E.metaKey,_=E.key.length===1;L&&(E.key==="Tab"&&E.preventDefault(),!I&&_&&q(E.key));const $=k.current;if(E.target!==$||!nI.includes(E.key))return;E.preventDefault();const M=N().filter(T=>!T.disabled).map(T=>T.ref.current);Cb.includes(E.key)&&M.reverse(),kI(M)}),onBlur:ot(e.onBlur,E=>{E.currentTarget.contains(E.target)||(window.clearTimeout(W.current),B.current="")}),onPointerMove:ot(e.onPointerMove,Qi(E=>{const R=E.target,L=P.current!==E.clientX;if(E.currentTarget.contains(R)&&L){const I=E.clientX>P.current?"right":"left";V.current=I,P.current=E.clientX}}))})})})})})})});$b.displayName=un;var gI="MenuGroup",Mh=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return s.jsx(kt.div,{role:"group",...r,ref:t})});Mh.displayName=gI;var xI="MenuLabel",Db=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return s.jsx(kt.div,{...r,ref:t})});Db.displayName=xI;var Oc="MenuItem",nx="menu.itemSelect",Cu=i.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...a}=e,o=i.useRef(null),l=ol(Oc,e.__scopeMenu),c=Th(Oc,e.__scopeMenu),u=_t(t,o),d=i.useRef(!1),g=()=>{const m=o.current;if(!n&&m){const p=new CustomEvent(nx,{bubbles:!0,cancelable:!0});m.addEventListener(nx,f=>r==null?void 0:r(f),{once:!0}),Lw(m,p),p.defaultPrevented?d.current=!1:l.onClose()}};return s.jsx(Ob,{...a,ref:u,disabled:n,onClick:ot(e.onClick,g),onPointerDown:m=>{var p;(p=e.onPointerDown)==null||p.call(e,m),d.current=!0},onPointerUp:ot(e.onPointerUp,m=>{var p;d.current||(p=m.currentTarget)==null||p.click()}),onKeyDown:ot(e.onKeyDown,m=>{const p=c.searchRef.current!=="";n||p&&m.key===" "||Xm.includes(m.key)&&(m.currentTarget.click(),m.preventDefault())})})});Cu.displayName=Oc;var Ob=i.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:a,...o}=e,l=Th(Oc,n),c=Ib(n),u=i.useRef(null),d=_t(t,u),[g,m]=i.useState(!1),[p,f]=i.useState("");return i.useEffect(()=>{const w=u.current;w&&f((w.textContent??"").trim())},[o.children]),s.jsx(Hi.ItemSlot,{scope:n,disabled:r,textValue:a??p,children:s.jsx(uE,{asChild:!0,...c,focusable:!r,children:s.jsx(kt.div,{role:"menuitem","data-highlighted":g?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...o,ref:d,onPointerMove:ot(e.onPointerMove,Qi(w=>{r?l.onItemLeave(w):(l.onItemEnter(w),w.defaultPrevented||w.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ot(e.onPointerLeave,Qi(w=>l.onItemLeave(w))),onFocus:ot(e.onFocus,()=>m(!0)),onBlur:ot(e.onBlur,()=>m(!1))})})})}),vI="MenuCheckboxItem",Fb=i.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...a}=e;return s.jsx(Wb,{scope:e.__scopeMenu,checked:n,children:s.jsx(Cu,{role:"menuitemcheckbox","aria-checked":Fc(n)?"mixed":n,...a,ref:t,"data-state":Dh(n),onSelect:ot(a.onSelect,()=>r==null?void 0:r(Fc(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Fb.displayName=vI;var _b="MenuRadioGroup",[yI,wI]=Ia(_b,{value:void 0,onValueChange:()=>{}}),Lb=i.forwardRef((e,t)=>{const{value:n,onValueChange:r,...a}=e,o=Un(r);return s.jsx(yI,{scope:e.__scopeMenu,value:n,onValueChange:o,children:s.jsx(Mh,{...a,ref:t})})});Lb.displayName=_b;var Vb="MenuRadioItem",Bb=i.forwardRef((e,t)=>{const{value:n,...r}=e,a=wI(Vb,e.__scopeMenu),o=n===a.value;return s.jsx(Wb,{scope:e.__scopeMenu,checked:o,children:s.jsx(Cu,{role:"menuitemradio","aria-checked":o,...r,ref:t,"data-state":Dh(o),onSelect:ot(r.onSelect,()=>{var l;return(l=a.onValueChange)==null?void 0:l.call(a,n)},{checkForDefaultPrevented:!1})})})});Bb.displayName=Vb;var $h="MenuItemIndicator",[Wb,bI]=Ia($h,{checked:!1}),Ub=i.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...a}=e,o=bI($h,n);return s.jsx(gr,{present:r||Fc(o.checked)||o.checked===!0,children:s.jsx(kt.span,{...a,ref:t,"data-state":Dh(o.checked)})})});Ub.displayName=$h;var NI="MenuSeparator",zb=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return s.jsx(kt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});zb.displayName=NI;var jI="MenuArrow",Hb=i.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,a=Au(n);return s.jsx(fb,{...a,...r,ref:t})});Hb.displayName=jI;var SI="MenuSub",[zD,Qb]=Ia(SI),ni="MenuSubTrigger",Gb=i.forwardRef((e,t)=>{const n=Ta(ni,e.__scopeMenu),r=ol(ni,e.__scopeMenu),a=Qb(ni,e.__scopeMenu),o=Th(ni,e.__scopeMenu),l=i.useRef(null),{pointerGraceTimerRef:c,onPointerGraceIntentChange:u}=o,d={__scopeMenu:e.__scopeMenu},g=i.useCallback(()=>{l.current&&window.clearTimeout(l.current),l.current=null},[]);return i.useEffect(()=>g,[g]),i.useEffect(()=>{const m=c.current;return()=>{window.clearTimeout(m),u(null)}},[c,u]),s.jsx(Eh,{asChild:!0,...d,children:s.jsx(Ob,{id:a.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":a.contentId,"data-state":Jb(n.open),...e,ref:hr(t,a.onTriggerChange),onClick:m=>{var p;(p=e.onClick)==null||p.call(e,m),!(e.disabled||m.defaultPrevented)&&(m.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ot(e.onPointerMove,Qi(m=>{o.onItemEnter(m),!m.defaultPrevented&&!e.disabled&&!n.open&&!l.current&&(o.onPointerGraceIntentChange(null),l.current=window.setTimeout(()=>{n.onOpenChange(!0),g()},100))})),onPointerLeave:ot(e.onPointerLeave,Qi(m=>{var f,w;g();const p=(f=n.content)==null?void 0:f.getBoundingClientRect();if(p){const h=(w=n.content)==null?void 0:w.dataset.side,v=h==="right",x=v?-5:5,y=p[v?"left":"right"],b=p[v?"right":"left"];o.onPointerGraceIntentChange({area:[{x:m.clientX+x,y:m.clientY},{x:y,y:p.top},{x:b,y:p.top},{x:b,y:p.bottom},{x:y,y:p.bottom}],side:h}),window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(m),m.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:ot(e.onKeyDown,m=>{var f;const p=o.searchRef.current!=="";e.disabled||p&&m.key===" "||rI[r.dir].includes(m.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),m.preventDefault())})})})});Gb.displayName=ni;var qb="MenuSubContent",Yb=i.forwardRef((e,t)=>{const n=Rb(un,e.__scopeMenu),{forceMount:r=n.forceMount,...a}=e,o=Ta(un,e.__scopeMenu),l=ol(un,e.__scopeMenu),c=Qb(qb,e.__scopeMenu),u=i.useRef(null),d=_t(t,u);return s.jsx(Hi.Provider,{scope:e.__scopeMenu,children:s.jsx(gr,{present:r||o.open,children:s.jsx(Hi.Slot,{scope:e.__scopeMenu,children:s.jsx(Rh,{id:c.contentId,"aria-labelledby":c.triggerId,...a,ref:d,align:"start",side:l.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:g=>{var m;l.isUsingKeyboardRef.current&&((m=u.current)==null||m.focus()),g.preventDefault()},onCloseAutoFocus:g=>g.preventDefault(),onFocusOutside:ot(e.onFocusOutside,g=>{g.target!==c.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:ot(e.onEscapeKeyDown,g=>{l.onClose(),g.preventDefault()}),onKeyDown:ot(e.onKeyDown,g=>{var f;const m=g.currentTarget.contains(g.target),p=aI[l.dir].includes(g.key);m&&p&&(o.onOpenChange(!1),(f=c.trigger)==null||f.focus(),g.preventDefault())})})})})})});Yb.displayName=qb;function Jb(e){return e?"open":"closed"}function Fc(e){return e==="indeterminate"}function Dh(e){return Fc(e)?"indeterminate":e?"checked":"unchecked"}function kI(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function PI(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function AI(e,t,n){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let l=PI(e,Math.max(o,0));a.length===1&&(l=l.filter(d=>d!==n));const u=l.find(d=>d.toLowerCase().startsWith(a.toLowerCase()));return u!==n?u:void 0}function CI(e,t){const{x:n,y:r}=e;let a=!1;for(let o=0,l=t.length-1;o<t.length;l=o++){const c=t[o],u=t[l],d=c.x,g=c.y,m=u.x,p=u.y;g>r!=p>r&&n<(m-d)*(r-g)/(p-g)+d&&(a=!a)}return a}function EI(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return CI(n,t)}function Qi(e){return t=>t.pointerType==="mouse"?e(t):void 0}var II=Tb,TI=Eh,RI=Mb,MI=$b,$I=Mh,DI=Db,OI=Cu,FI=Fb,_I=Lb,LI=Bb,VI=Ub,BI=zb,WI=Hb,UI=Gb,zI=Yb,Eu="DropdownMenu",[HI]=Qn(Eu,[Eb]),Fs=Eb(),[QI,Kb]=HI(Eu),Xb=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:a,defaultOpen:o,onOpenChange:l,modal:c=!0}=e,u=Fs(t),d=i.useRef(null),[g,m]=Hr({prop:a,defaultProp:o??!1,onChange:l,caller:Eu});return s.jsx(QI,{scope:t,triggerId:Sn(),triggerRef:d,contentId:Sn(),open:g,onOpenChange:m,onOpenToggle:i.useCallback(()=>m(p=>!p),[m]),modal:c,children:s.jsx(II,{...u,open:g,onOpenChange:m,dir:r,modal:c,children:n})})};Xb.displayName=Eu;var Zb="DropdownMenuTrigger",e0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...a}=e,o=Kb(Zb,n),l=Fs(n);return s.jsx(TI,{asChild:!0,...l,children:s.jsx(kt.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...a,ref:hr(t,o.triggerRef),onPointerDown:ot(e.onPointerDown,c=>{!r&&c.button===0&&c.ctrlKey===!1&&(o.onOpenToggle(),o.open||c.preventDefault())}),onKeyDown:ot(e.onKeyDown,c=>{r||(["Enter"," "].includes(c.key)&&o.onOpenToggle(),c.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(c.key)&&c.preventDefault())})})})});e0.displayName=Zb;var GI="DropdownMenuPortal",t0=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Fs(t);return s.jsx(RI,{...r,...n})};t0.displayName=GI;var s0="DropdownMenuContent",n0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Kb(s0,n),o=Fs(n),l=i.useRef(!1);return s.jsx(MI,{id:a.contentId,"aria-labelledby":a.triggerId,...o,...r,ref:t,onCloseAutoFocus:ot(e.onCloseAutoFocus,c=>{var u;l.current||(u=a.triggerRef.current)==null||u.focus(),l.current=!1,c.preventDefault()}),onInteractOutside:ot(e.onInteractOutside,c=>{const u=c.detail.originalEvent,d=u.button===0&&u.ctrlKey===!0,g=u.button===2||d;(!a.modal||g)&&(l.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});n0.displayName=s0;var qI="DropdownMenuGroup",YI=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx($I,{...a,...r,ref:t})});YI.displayName=qI;var JI="DropdownMenuLabel",r0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(DI,{...a,...r,ref:t})});r0.displayName=JI;var KI="DropdownMenuItem",a0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(OI,{...a,...r,ref:t})});a0.displayName=KI;var XI="DropdownMenuCheckboxItem",o0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(FI,{...a,...r,ref:t})});o0.displayName=XI;var ZI="DropdownMenuRadioGroup",eT=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(_I,{...a,...r,ref:t})});eT.displayName=ZI;var tT="DropdownMenuRadioItem",i0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(LI,{...a,...r,ref:t})});i0.displayName=tT;var sT="DropdownMenuItemIndicator",l0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(VI,{...a,...r,ref:t})});l0.displayName=sT;var nT="DropdownMenuSeparator",c0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(BI,{...a,...r,ref:t})});c0.displayName=nT;var rT="DropdownMenuArrow",aT=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(WI,{...a,...r,ref:t})});aT.displayName=rT;var oT="DropdownMenuSubTrigger",u0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(UI,{...a,...r,ref:t})});u0.displayName=oT;var iT="DropdownMenuSubContent",d0=i.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,a=Fs(n);return s.jsx(zI,{...a,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});d0.displayName=iT;var lT=Xb,cT=e0,uT=t0,m0=n0,f0=r0,h0=a0,p0=o0,g0=i0,x0=l0,v0=c0,y0=u0,w0=d0;const rx=lT,ax=cT,dT=i.forwardRef(({className:e,inset:t,children:n,...r},a)=>s.jsxs(y0,{ref:a,className:it("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...r,children:[n,s.jsx(Tw,{className:"ml-auto h-4 w-4"})]}));dT.displayName=y0.displayName;const mT=i.forwardRef(({className:e,...t},n)=>s.jsx(w0,{ref:n,className:it("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));mT.displayName=w0.displayName;const Zm=i.forwardRef(({className:e,sideOffset:t=4,...n},r)=>s.jsx(uT,{children:s.jsx(m0,{ref:r,sideOffset:t,className:it("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));Zm.displayName=m0.displayName;const Xn=i.forwardRef(({className:e,inset:t,...n},r)=>s.jsx(h0,{ref:r,className:it("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));Xn.displayName=h0.displayName;const fT=i.forwardRef(({className:e,children:t,checked:n,...r},a)=>s.jsxs(p0,{ref:a,className:it("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(x0,{children:s.jsx(ns,{className:"h-4 w-4"})})}),t]}));fT.displayName=p0.displayName;const hT=i.forwardRef(({className:e,children:t,...n},r)=>s.jsxs(g0,{ref:r,className:it("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(x0,{children:s.jsx(EP,{className:"h-2 w-2 fill-current"})})}),t]}));hT.displayName=g0.displayName;const ef=i.forwardRef(({className:e,inset:t,...n},r)=>s.jsx(f0,{ref:r,className:it("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));ef.displayName=f0.displayName;const ri=i.forwardRef(({className:e,...t},n)=>s.jsx(v0,{ref:n,className:it("-mx-1 my-1 h-px bg-muted",e),...t}));ri.displayName=v0.displayName;const pT=mh("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function b0({className:e,variant:t,...n}){return s.jsx("div",{className:it(pT({variant:t}),e),...n})}const gT=({status:e})=>{const n=(r=>{switch(r){case"active":return{label:"Active",variant:"default",className:"bg-green-100 text-green-800 border-green-200"};case"trial":return{label:"Trial",variant:"secondary",className:"bg-blue-100 text-blue-800 border-blue-200"};case"past_due":return{label:"Past Due",variant:"destructive",className:"bg-red-100 text-red-800 border-red-200"};case"suspended":return{label:"Suspended",variant:"destructive",className:"bg-red-100 text-red-800 border-red-200"};case"grace_period":return{label:"Grace Period",variant:"secondary",className:"bg-yellow-100 text-yellow-800 border-yellow-200"};default:return{label:"Unknown",variant:"secondary",className:"bg-gray-100 text-gray-800 border-gray-200"}}})(e);return s.jsx(b0,{variant:n.variant,className:n.className,children:n.label})};function xT(e){const t=vT(e),n=i.forwardRef((r,a)=>{const{children:o,...l}=r,c=i.Children.toArray(o),u=c.find(wT);if(u){const d=u.props.children,g=c.map(m=>m===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:m);return s.jsx(t,{...l,ref:a,children:i.isValidElement(d)?i.cloneElement(d,void 0,g):null})}return s.jsx(t,{...l,ref:a,children:o})});return n.displayName=`${e}.Slot`,n}function vT(e){const t=i.forwardRef((n,r)=>{const{children:a,...o}=n;if(i.isValidElement(a)){const l=NT(a),c=bT(o,a.props);return a.type!==i.Fragment&&(c.ref=r?hr(r,l):l),i.cloneElement(a,c)}return i.Children.count(a)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var yT=Symbol("radix.slottable");function wT(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===yT}function bT(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...c)=>{const u=o(...c);return a(...c),u}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function NT(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Iu="Dialog",[N0,j0]=Qn(Iu),[jT,In]=N0(Iu),S0=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:a,onOpenChange:o,modal:l=!0}=e,c=i.useRef(null),u=i.useRef(null),[d,g]=Hr({prop:r,defaultProp:a??!1,onChange:o,caller:Iu});return s.jsx(jT,{scope:t,triggerRef:c,contentRef:u,contentId:Sn(),titleId:Sn(),descriptionId:Sn(),open:d,onOpenChange:g,onOpenToggle:i.useCallback(()=>g(m=>!m),[g]),modal:l,children:n})};S0.displayName=Iu;var k0="DialogTrigger",P0=i.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=In(k0,n),o=_t(t,a.triggerRef);return s.jsx(kt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":_h(a.open),...r,ref:o,onClick:ot(e.onClick,a.onOpenToggle)})});P0.displayName=k0;var Oh="DialogPortal",[ST,A0]=N0(Oh,{forceMount:void 0}),C0=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:a}=e,o=In(Oh,t);return s.jsx(ST,{scope:t,forceMount:n,children:i.Children.map(r,l=>s.jsx(gr,{present:n||o.open,children:s.jsx(Su,{asChild:!0,container:a,children:l})}))})};C0.displayName=Oh;var _c="DialogOverlay",E0=i.forwardRef((e,t)=>{const n=A0(_c,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=In(_c,e.__scopeDialog);return o.modal?s.jsx(gr,{present:r||o.open,children:s.jsx(PT,{...a,ref:t})}):null});E0.displayName=_c;var kT=xT("DialogOverlay.RemoveScroll"),PT=i.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=In(_c,n);return s.jsx(Pu,{as:kT,allowPinchZoom:!0,shards:[a.contentRef],children:s.jsx(kt.div,{"data-state":_h(a.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Sa="DialogContent",I0=i.forwardRef((e,t)=>{const n=A0(Sa,e.__scopeDialog),{forceMount:r=n.forceMount,...a}=e,o=In(Sa,e.__scopeDialog);return s.jsx(gr,{present:r||o.open,children:o.modal?s.jsx(AT,{...a,ref:t}):s.jsx(CT,{...a,ref:t})})});I0.displayName=Sa;var AT=i.forwardRef((e,t)=>{const n=In(Sa,e.__scopeDialog),r=i.useRef(null),a=_t(t,n.contentRef,r);return i.useEffect(()=>{const o=r.current;if(o)return Ch(o)},[]),s.jsx(T0,{...e,ref:a,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ot(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:ot(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0;(l.button===2||c)&&o.preventDefault()}),onFocusOutside:ot(e.onFocusOutside,o=>o.preventDefault())})}),CT=i.forwardRef((e,t)=>{const n=In(Sa,e.__scopeDialog),r=i.useRef(!1),a=i.useRef(!1);return s.jsx(T0,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{var l,c;(l=e.onCloseAutoFocus)==null||l.call(e,o),o.defaultPrevented||(r.current||(c=n.triggerRef.current)==null||c.focus(),o.preventDefault()),r.current=!1,a.current=!1},onInteractOutside:o=>{var u,d;(u=e.onInteractOutside)==null||u.call(e,o),o.defaultPrevented||(r.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const l=o.target;((d=n.triggerRef.current)==null?void 0:d.contains(l))&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),T0=i.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:a,onCloseAutoFocus:o,...l}=e,c=In(Sa,n),u=i.useRef(null),d=_t(t,u);return yh(),s.jsxs(s.Fragment,{children:[s.jsx(vu,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:a,onUnmountAutoFocus:o,children:s.jsx(xu,{role:"dialog",id:c.contentId,"aria-describedby":c.descriptionId,"aria-labelledby":c.titleId,"data-state":_h(c.open),...l,ref:d,onDismiss:()=>c.onOpenChange(!1)})}),s.jsxs(s.Fragment,{children:[s.jsx(IT,{titleId:c.titleId}),s.jsx(RT,{contentRef:u,descriptionId:c.descriptionId})]})]})}),Fh="DialogTitle",R0=i.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=In(Fh,n);return s.jsx(kt.h2,{id:a.titleId,...r,ref:t})});R0.displayName=Fh;var M0="DialogDescription",$0=i.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=In(M0,n);return s.jsx(kt.p,{id:a.descriptionId,...r,ref:t})});$0.displayName=M0;var D0="DialogClose",O0=i.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,a=In(D0,n);return s.jsx(kt.button,{type:"button",...r,ref:t,onClick:ot(e.onClick,()=>a.onOpenChange(!1))})});O0.displayName=D0;function _h(e){return e?"open":"closed"}var F0="DialogTitleWarning",[ET,_0]=YP(F0,{contentName:Sa,titleName:Fh,docsSlug:"dialog"}),IT=({titleId:e})=>{const t=_0(F0),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return i.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},TT="DialogDescriptionWarning",RT=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${_0(TT).contentName}}.`;return i.useEffect(()=>{var o;const a=(o=e.current)==null?void 0:o.getAttribute("aria-describedby");t&&a&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},L0=S0,MT=P0,V0=C0,Lh=E0,Vh=I0,Bh=R0,Wh=$0,Uh=O0,$T=Symbol("radix.slottable");function DT(e){const t=({children:n})=>s.jsx(s.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=$T,t}var B0="AlertDialog",[OT]=Qn(B0,[j0]),xr=j0(),W0=e=>{const{__scopeAlertDialog:t,...n}=e,r=xr(t);return s.jsx(L0,{...r,...n,modal:!0})};W0.displayName=B0;var FT="AlertDialogTrigger",U0=i.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xr(n);return s.jsx(MT,{...a,...r,ref:t})});U0.displayName=FT;var _T="AlertDialogPortal",z0=e=>{const{__scopeAlertDialog:t,...n}=e,r=xr(t);return s.jsx(V0,{...r,...n})};z0.displayName=_T;var LT="AlertDialogOverlay",H0=i.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xr(n);return s.jsx(Lh,{...a,...r,ref:t})});H0.displayName=LT;var lo="AlertDialogContent",[VT,BT]=OT(lo),WT=DT("AlertDialogContent"),Q0=i.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...a}=e,o=xr(n),l=i.useRef(null),c=_t(t,l),u=i.useRef(null);return s.jsx(ET,{contentName:lo,titleName:G0,docsSlug:"alert-dialog",children:s.jsx(VT,{scope:n,cancelRef:u,children:s.jsxs(Vh,{role:"alertdialog",...o,...a,ref:c,onOpenAutoFocus:ot(a.onOpenAutoFocus,d=>{var g;d.preventDefault(),(g=u.current)==null||g.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[s.jsx(WT,{children:r}),s.jsx(zT,{contentRef:l})]})})})});Q0.displayName=lo;var G0="AlertDialogTitle",q0=i.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xr(n);return s.jsx(Bh,{...a,...r,ref:t})});q0.displayName=G0;var Y0="AlertDialogDescription",J0=i.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xr(n);return s.jsx(Wh,{...a,...r,ref:t})});J0.displayName=Y0;var UT="AlertDialogAction",K0=i.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,a=xr(n);return s.jsx(Uh,{...a,...r,ref:t})});K0.displayName=UT;var X0="AlertDialogCancel",Z0=i.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:a}=BT(X0,n),o=xr(n),l=_t(t,a);return s.jsx(Uh,{...o,...r,ref:l})});Z0.displayName=X0;var zT=({contentRef:e})=>{const t=`\`${lo}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${lo}\` by passing a \`${Y0}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${lo}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return i.useEffect(()=>{var r;document.getElementById((r=e.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},HT=W0,QT=U0,GT=z0,eN=H0,tN=Q0,sN=K0,nN=Z0,rN=q0,aN=J0;const Gi=HT,qT=QT,YT=GT,oN=i.forwardRef(({className:e,...t},n)=>s.jsx(eN,{className:it("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));oN.displayName=eN.displayName;const yo=i.forwardRef(({className:e,...t},n)=>s.jsxs(YT,{children:[s.jsx(oN,{}),s.jsx(tN,{ref:n,className:it("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));yo.displayName=tN.displayName;const wo=({className:e,...t})=>s.jsx("div",{className:it("flex flex-col space-y-2 text-center sm:text-left",e),...t});wo.displayName="AlertDialogHeader";const bo=({className:e,...t})=>s.jsx("div",{className:it("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});bo.displayName="AlertDialogFooter";const No=i.forwardRef(({className:e,...t},n)=>s.jsx(rN,{ref:n,className:it("text-lg font-semibold",e),...t}));No.displayName=rN.displayName;const jo=i.forwardRef(({className:e,...t},n)=>s.jsx(aN,{ref:n,className:it("text-sm text-muted-foreground",e),...t}));jo.displayName=aN.displayName;const So=i.forwardRef(({className:e,...t},n)=>s.jsx(sN,{ref:n,className:it(hh(),e),...t}));So.displayName=sN.displayName;const ko=i.forwardRef(({className:e,...t},n)=>s.jsx(nN,{ref:n,className:it(hh({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));ko.displayName=nN.displayName;const JT=({open:e,onOpenChange:t,currentWorkspace:n,targetWorkspace:r,onConfirm:a})=>{const o=()=>{a(),t(!1)};return s.jsx(Gi,{open:e,onOpenChange:t,children:s.jsxs(yo,{className:"fixed top-24 left-1/2 transform -translate-x-1/2 z-[70] max-h-[calc(100vh-120px)] overflow-y-auto",children:[s.jsxs(wo,{children:[s.jsx(No,{children:"Switch Workspace"}),s.jsxs(jo,{children:["Are you sure you want to switch from ",s.jsxs("strong",{children:['"',n,'"']})," to ",s.jsxs("strong",{children:['"',r,'"']}),"?",s.jsx("br",{}),s.jsx("br",{}),"This will change your current workspace context and may affect your current work."]})]}),s.jsxs(bo,{children:[s.jsx(ko,{children:"Cancel"}),s.jsx(So,{onClick:o,children:"Switch Workspace"})]})]})})},KT=L0,XT=V0,iN=i.forwardRef(({className:e,...t},n)=>s.jsx(Lh,{ref:n,className:it("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));iN.displayName=Lh.displayName;const lN=i.forwardRef(({className:e,children:t,...n},r)=>s.jsxs(XT,{children:[s.jsx(iN,{}),s.jsxs(Vh,{ref:r,className:it("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,s.jsxs(Uh,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(Es,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));lN.displayName=Vh.displayName;const cN=({className:e,...t})=>s.jsx("div",{className:it("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});cN.displayName="DialogHeader";const uN=i.forwardRef(({className:e,...t},n)=>s.jsx(Bh,{ref:n,className:it("text-lg font-semibold leading-none tracking-tight",e),...t}));uN.displayName=Bh.displayName;const dN=i.forwardRef(({className:e,...t},n)=>s.jsx(Wh,{ref:n,className:it("text-sm text-muted-foreground",e),...t}));dN.displayName=Wh.displayName;const qe=i.forwardRef(({className:e,...t},n)=>s.jsx("div",{ref:n,className:it("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));qe.displayName="Card";const vt=i.forwardRef(({className:e,...t},n)=>s.jsx("div",{ref:n,className:it("flex flex-col space-y-1.5 p-6",e),...t}));vt.displayName="CardHeader";const pt=i.forwardRef(({className:e,...t},n)=>s.jsx("h3",{ref:n,className:it("text-2xl font-semibold leading-none tracking-tight",e),...t}));pt.displayName="CardTitle";const gt=i.forwardRef(({className:e,...t},n)=>s.jsx("p",{ref:n,className:it("text-sm text-muted-foreground",e),...t}));gt.displayName="CardDescription";const Xe=i.forwardRef(({className:e,...t},n)=>s.jsx("div",{ref:n,className:it("p-6 pt-0",e),...t}));Xe.displayName="CardContent";const tf=i.forwardRef(({className:e,...t},n)=>s.jsx("div",{ref:n,className:it("flex items-center p-6 pt-0",e),...t}));tf.displayName="CardFooter";const mN=({open:e,onOpenChange:t,workspaceName:n,onContinue:r})=>{console.log("WorkspaceSuccessModal - Props:",{open:e,workspaceName:n});const a=()=>{r==null||r(),t(!1)};return s.jsx(KT,{open:e,onOpenChange:t,children:s.jsxs(lN,{className:"sm:max-w-[600px] bg-white dark:bg-vox-dark border-none shadow-2xl z-[80]",children:[s.jsxs(cN,{className:"text-center space-y-6",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto",children:s.jsx(Wm,{className:"w-16 h-16 text-green-600 dark:text-green-400 stroke-[2.5]"})}),s.jsx(uN,{className:"text-3xl font-bold text-green-600 dark:text-green-400",children:"Workspace Created Successfully! "}),s.jsx(dN,{className:"text-base text-muted-foreground",children:"Welcome to VoxBox! Your workspace has been activated successfully."})]}),s.jsx(qe,{className:"border-green-200 dark:border-green-800 bg-green-50/50 dark:bg-green-900/20 mt-4",children:s.jsx(Xe,{className:"p-6",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Wm,{className:"w-6 h-6 text-green-600 dark:text-green-400 mt-1 flex-shrink-0"}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"font-semibold text-green-700 dark:text-green-300 text-lg",children:"Workspace Activated"}),s.jsxs("p",{className:"text-sm text-green-700/80 dark:text-green-300/80",children:['Your workspace "',s.jsx("span",{className:"font-semibold",children:n}),'" is now ready. You can now start generating content right away.']})]})]})})}),s.jsxs("div",{className:"mt-6 space-y-4",children:[s.jsx("h3",{className:"font-bold text-lg text-foreground",children:"What's Next?"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-7 h-7 rounded-full bg-pink-100 dark:bg-pink-900/30 flex items-center justify-center flex-shrink-0 mt-0.5",children:s.jsx("span",{className:"text-pink-600 dark:text-pink-400 font-bold text-sm",children:"1"})}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Create your first AVA profile to understand your audience"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-7 h-7 rounded-full bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center flex-shrink-0 mt-0.5",children:s.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-bold text-sm",children:"2"})}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Set up your workspace and invite team members"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-7 h-7 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center flex-shrink-0 mt-0.5",children:s.jsx("span",{className:"text-green-600 dark:text-green-400 font-bold text-sm",children:"3"})}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Start generating content with our AI amplifiers"})]})]})]}),s.jsx("div",{className:"flex flex-col gap-3 pt-4",children:s.jsx(Ie,{onClick:a,size:"lg",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold text-base py-6",children:"Continue to Dashboard"})})]})})};var ZT=e=>{switch(e){case"success":return sR;case"info":return rR;case"warning":return nR;case"error":return aR;default:return null}},eR=Array(12).fill(0),tR=({visible:e,className:t})=>_e.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},_e.createElement("div",{className:"sonner-spinner"},eR.map((n,r)=>_e.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),sR=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),nR=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),rR=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),aR=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},_e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),oR=_e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},_e.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),_e.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),iR=()=>{let[e,t]=_e.useState(document.hidden);return _e.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},sf=1,lR=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...r}=e,a=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:sf++,o=this.toasts.find(c=>c.id===a),l=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(a)&&this.dismissedToasts.delete(a),o?this.toasts=this.toasts.map(c=>c.id===a?(this.publish({...c,...e,id:a,title:n}),{...c,...e,id:a,dismissible:l,title:n}):c):this.addToast({title:n,...r,dismissible:l,id:a}),a},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let r=e instanceof Promise?e:e(),a=n!==void 0,o,l=r.then(async u=>{if(o=["resolve",u],_e.isValidElement(u))a=!1,this.create({id:n,type:"default",message:u});else if(uR(u)&&!u.ok){a=!1;let d=typeof t.error=="function"?await t.error(`HTTP error! status: ${u.status}`):t.error,g=typeof t.description=="function"?await t.description(`HTTP error! status: ${u.status}`):t.description;this.create({id:n,type:"error",message:d,description:g})}else if(t.success!==void 0){a=!1;let d=typeof t.success=="function"?await t.success(u):t.success,g=typeof t.description=="function"?await t.description(u):t.description;this.create({id:n,type:"success",message:d,description:g})}}).catch(async u=>{if(o=["reject",u],t.error!==void 0){a=!1;let d=typeof t.error=="function"?await t.error(u):t.error,g=typeof t.description=="function"?await t.description(u):t.description;this.create({id:n,type:"error",message:d,description:g})}}).finally(()=>{var u;a&&(this.dismiss(n),n=void 0),(u=t.finally)==null||u.call(t)}),c=()=>new Promise((u,d)=>l.then(()=>o[0]==="reject"?d(o[1]):u(o[1])).catch(d));return typeof n!="string"&&typeof n!="number"?{unwrap:c}:Object.assign(n,{unwrap:c})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||sf++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Bs=new lR,cR=(e,t)=>{let n=(t==null?void 0:t.id)||sf++;return Bs.addToast({title:e,...t,id:n}),n},uR=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",dR=cR,mR=()=>Bs.toasts,fR=()=>Bs.getActiveToasts(),ai=Object.assign(dR,{success:Bs.success,info:Bs.info,warning:Bs.warning,error:Bs.error,custom:Bs.custom,message:Bs.message,promise:Bs.promise,dismiss:Bs.dismiss,loading:Bs.loading},{getHistory:mR,getToasts:fR});function hR(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}hR(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Rl(e){return e.label!==void 0}var pR=3,gR="32px",xR="16px",ox=4e3,vR=356,yR=14,wR=20,bR=200;function gn(...e){return e.filter(Boolean).join(" ")}function NR(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var jR=e=>{var t,n,r,a,o,l,c,u,d,g,m;let{invert:p,toast:f,unstyled:w,interacting:h,setHeights:v,visibleToasts:x,heights:y,index:b,toasts:N,expanded:S,removeToast:j,defaultRichColors:k,closeButton:C,style:W,cancelButtonStyle:B,actionButtonStyle:U,className:Q="",descriptionClassName:V="",duration:P,position:K,gap:G,loadingIcon:q,expandByDefault:A,classNames:E,icons:R,closeButtonAriaLabel:L="Close toast",pauseWhenPageIsHidden:I}=e,[_,$]=_e.useState(null),[F,M]=_e.useState(null),[T,ie]=_e.useState(!1),[Z,le]=_e.useState(!1),[oe,z]=_e.useState(!1),[ee,ne]=_e.useState(!1),[me,ve]=_e.useState(!1),[D,ue]=_e.useState(0),[O,H]=_e.useState(0),ae=_e.useRef(f.duration||P||ox),de=_e.useRef(null),re=_e.useRef(null),fe=b===0,Se=b+1<=x,he=f.type,se=f.dismissible!==!1,J=f.className||"",Pe=f.descriptionClassName||"",$e=_e.useMemo(()=>y.findIndex(Y=>Y.toastId===f.id)||0,[y,f.id]),Ae=_e.useMemo(()=>{var Y;return(Y=f.closeButton)!=null?Y:C},[f.closeButton,C]),Ee=_e.useMemo(()=>f.duration||P||ox,[f.duration,P]),ce=_e.useRef(0),we=_e.useRef(0),Te=_e.useRef(0),Ue=_e.useRef(null),[lt,Ze]=K.split("-"),ge=_e.useMemo(()=>y.reduce((Y,te,X)=>X>=$e?Y:Y+te.height,0),[y,$e]),pe=iR(),ke=f.invert||p,be=he==="loading";we.current=_e.useMemo(()=>$e*G+ge,[$e,ge]),_e.useEffect(()=>{ae.current=Ee},[Ee]),_e.useEffect(()=>{ie(!0)},[]),_e.useEffect(()=>{let Y=re.current;if(Y){let te=Y.getBoundingClientRect().height;return H(te),v(X=>[{toastId:f.id,height:te,position:f.position},...X]),()=>v(X=>X.filter(ye=>ye.toastId!==f.id))}},[v,f.id]),_e.useLayoutEffect(()=>{if(!T)return;let Y=re.current,te=Y.style.height;Y.style.height="auto";let X=Y.getBoundingClientRect().height;Y.style.height=te,H(X),v(ye=>ye.find(Ne=>Ne.toastId===f.id)?ye.map(Ne=>Ne.toastId===f.id?{...Ne,height:X}:Ne):[{toastId:f.id,height:X,position:f.position},...ye])},[T,f.title,f.description,v,f.id]);let je=_e.useCallback(()=>{le(!0),ue(we.current),v(Y=>Y.filter(te=>te.toastId!==f.id)),setTimeout(()=>{j(f)},bR)},[f,j,v,we]);_e.useEffect(()=>{if(f.promise&&he==="loading"||f.duration===1/0||f.type==="loading")return;let Y;return S||h||I&&pe?(()=>{if(Te.current<ce.current){let te=new Date().getTime()-ce.current;ae.current=ae.current-te}Te.current=new Date().getTime()})():ae.current!==1/0&&(ce.current=new Date().getTime(),Y=setTimeout(()=>{var te;(te=f.onAutoClose)==null||te.call(f,f),je()},ae.current)),()=>clearTimeout(Y)},[S,h,f,he,I,pe,je]),_e.useEffect(()=>{f.delete&&je()},[je,f.delete]);function Re(){var Y,te,X;return R!=null&&R.loading?_e.createElement("div",{className:gn(E==null?void 0:E.loader,(Y=f==null?void 0:f.classNames)==null?void 0:Y.loader,"sonner-loader"),"data-visible":he==="loading"},R.loading):q?_e.createElement("div",{className:gn(E==null?void 0:E.loader,(te=f==null?void 0:f.classNames)==null?void 0:te.loader,"sonner-loader"),"data-visible":he==="loading"},q):_e.createElement(tR,{className:gn(E==null?void 0:E.loader,(X=f==null?void 0:f.classNames)==null?void 0:X.loader),visible:he==="loading"})}return _e.createElement("li",{tabIndex:0,ref:re,className:gn(Q,J,E==null?void 0:E.toast,(t=f==null?void 0:f.classNames)==null?void 0:t.toast,E==null?void 0:E.default,E==null?void 0:E[he],(n=f==null?void 0:f.classNames)==null?void 0:n[he]),"data-sonner-toast":"","data-rich-colors":(r=f.richColors)!=null?r:k,"data-styled":!(f.jsx||f.unstyled||w),"data-mounted":T,"data-promise":!!f.promise,"data-swiped":me,"data-removed":Z,"data-visible":Se,"data-y-position":lt,"data-x-position":Ze,"data-index":b,"data-front":fe,"data-swiping":oe,"data-dismissible":se,"data-type":he,"data-invert":ke,"data-swipe-out":ee,"data-swipe-direction":F,"data-expanded":!!(S||A&&T),style:{"--index":b,"--toasts-before":b,"--z-index":N.length-b,"--offset":`${Z?D:we.current}px`,"--initial-height":A?"auto":`${O}px`,...W,...f.style},onDragEnd:()=>{z(!1),$(null),Ue.current=null},onPointerDown:Y=>{be||!se||(de.current=new Date,ue(we.current),Y.target.setPointerCapture(Y.pointerId),Y.target.tagName!=="BUTTON"&&(z(!0),Ue.current={x:Y.clientX,y:Y.clientY}))},onPointerUp:()=>{var Y,te,X,ye;if(ee||!se)return;Ue.current=null;let Ne=Number(((Y=re.current)==null?void 0:Y.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Ce=Number(((te=re.current)==null?void 0:te.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Ve=new Date().getTime()-((X=de.current)==null?void 0:X.getTime()),tt=_==="x"?Ne:Ce,Je=Math.abs(tt)/Ve;if(Math.abs(tt)>=wR||Je>.11){ue(we.current),(ye=f.onDismiss)==null||ye.call(f,f),M(_==="x"?Ne>0?"right":"left":Ce>0?"down":"up"),je(),ne(!0),ve(!1);return}z(!1),$(null)},onPointerMove:Y=>{var te,X,ye,Ne;if(!Ue.current||!se||((te=window.getSelection())==null?void 0:te.toString().length)>0)return;let Ce=Y.clientY-Ue.current.y,Ve=Y.clientX-Ue.current.x,tt=(X=e.swipeDirections)!=null?X:NR(K);!_&&(Math.abs(Ve)>1||Math.abs(Ce)>1)&&$(Math.abs(Ve)>Math.abs(Ce)?"x":"y");let Je={x:0,y:0};_==="y"?(tt.includes("top")||tt.includes("bottom"))&&(tt.includes("top")&&Ce<0||tt.includes("bottom")&&Ce>0)&&(Je.y=Ce):_==="x"&&(tt.includes("left")||tt.includes("right"))&&(tt.includes("left")&&Ve<0||tt.includes("right")&&Ve>0)&&(Je.x=Ve),(Math.abs(Je.x)>0||Math.abs(Je.y)>0)&&ve(!0),(ye=re.current)==null||ye.style.setProperty("--swipe-amount-x",`${Je.x}px`),(Ne=re.current)==null||Ne.style.setProperty("--swipe-amount-y",`${Je.y}px`)}},Ae&&!f.jsx?_e.createElement("button",{"aria-label":L,"data-disabled":be,"data-close-button":!0,onClick:be||!se?()=>{}:()=>{var Y;je(),(Y=f.onDismiss)==null||Y.call(f,f)},className:gn(E==null?void 0:E.closeButton,(a=f==null?void 0:f.classNames)==null?void 0:a.closeButton)},(o=R==null?void 0:R.close)!=null?o:oR):null,f.jsx||i.isValidElement(f.title)?f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title:_e.createElement(_e.Fragment,null,he||f.icon||f.promise?_e.createElement("div",{"data-icon":"",className:gn(E==null?void 0:E.icon,(l=f==null?void 0:f.classNames)==null?void 0:l.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||Re():null,f.type!=="loading"?f.icon||(R==null?void 0:R[he])||ZT(he):null):null,_e.createElement("div",{"data-content":"",className:gn(E==null?void 0:E.content,(c=f==null?void 0:f.classNames)==null?void 0:c.content)},_e.createElement("div",{"data-title":"",className:gn(E==null?void 0:E.title,(u=f==null?void 0:f.classNames)==null?void 0:u.title)},typeof f.title=="function"?f.title():f.title),f.description?_e.createElement("div",{"data-description":"",className:gn(V,Pe,E==null?void 0:E.description,(d=f==null?void 0:f.classNames)==null?void 0:d.description)},typeof f.description=="function"?f.description():f.description):null),i.isValidElement(f.cancel)?f.cancel:f.cancel&&Rl(f.cancel)?_e.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||B,onClick:Y=>{var te,X;Rl(f.cancel)&&se&&((X=(te=f.cancel).onClick)==null||X.call(te,Y),je())},className:gn(E==null?void 0:E.cancelButton,(g=f==null?void 0:f.classNames)==null?void 0:g.cancelButton)},f.cancel.label):null,i.isValidElement(f.action)?f.action:f.action&&Rl(f.action)?_e.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||U,onClick:Y=>{var te,X;Rl(f.action)&&((X=(te=f.action).onClick)==null||X.call(te,Y),!Y.defaultPrevented&&je())},className:gn(E==null?void 0:E.actionButton,(m=f==null?void 0:f.classNames)==null?void 0:m.actionButton)},f.action.label):null))};function ix(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function SR(e,t){let n={};return[e,t].forEach((r,a)=>{let o=a===1,l=o?"--mobile-offset":"--offset",c=o?xR:gR;function u(d){["top","right","bottom","left"].forEach(g=>{n[`${l}-${g}`]=typeof d=="number"?`${d}px`:d})}typeof r=="number"||typeof r=="string"?u(r):typeof r=="object"?["top","right","bottom","left"].forEach(d=>{r[d]===void 0?n[`${l}-${d}`]=c:n[`${l}-${d}`]=typeof r[d]=="number"?`${r[d]}px`:r[d]}):u(c)}),n}i.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:a=["altKey","KeyT"],expand:o,closeButton:l,className:c,offset:u,mobileOffset:d,theme:g="light",richColors:m,duration:p,style:f,visibleToasts:w=pR,toastOptions:h,dir:v=ix(),gap:x=yR,loadingIcon:y,icons:b,containerAriaLabel:N="Notifications",pauseWhenPageIsHidden:S}=e,[j,k]=_e.useState([]),C=_e.useMemo(()=>Array.from(new Set([r].concat(j.filter(I=>I.position).map(I=>I.position)))),[j,r]),[W,B]=_e.useState([]),[U,Q]=_e.useState(!1),[V,P]=_e.useState(!1),[K,G]=_e.useState(g!=="system"?g:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),q=_e.useRef(null),A=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),E=_e.useRef(null),R=_e.useRef(!1),L=_e.useCallback(I=>{k(_=>{var $;return($=_.find(F=>F.id===I.id))!=null&&$.delete||Bs.dismiss(I.id),_.filter(({id:F})=>F!==I.id)})},[]);return _e.useEffect(()=>Bs.subscribe(I=>{if(I.dismiss){k(_=>_.map($=>$.id===I.id?{...$,delete:!0}:$));return}setTimeout(()=>{iw.flushSync(()=>{k(_=>{let $=_.findIndex(F=>F.id===I.id);return $!==-1?[..._.slice(0,$),{..._[$],...I},..._.slice($+1)]:[I,..._]})})})}),[]),_e.useEffect(()=>{if(g!=="system"){G(g);return}if(g==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?G("dark"):G("light")),typeof window>"u")return;let I=window.matchMedia("(prefers-color-scheme: dark)");try{I.addEventListener("change",({matches:_})=>{G(_?"dark":"light")})}catch{I.addListener(({matches:$})=>{try{G($?"dark":"light")}catch(F){console.error(F)}})}},[g]),_e.useEffect(()=>{j.length<=1&&Q(!1)},[j]),_e.useEffect(()=>{let I=_=>{var $,F;a.every(M=>_[M]||_.code===M)&&(Q(!0),($=q.current)==null||$.focus()),_.code==="Escape"&&(document.activeElement===q.current||(F=q.current)!=null&&F.contains(document.activeElement))&&Q(!1)};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[a]),_e.useEffect(()=>{if(q.current)return()=>{E.current&&(E.current.focus({preventScroll:!0}),E.current=null,R.current=!1)}},[q.current]),_e.createElement("section",{ref:t,"aria-label":`${N} ${A}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},C.map((I,_)=>{var $;let[F,M]=I.split("-");return j.length?_e.createElement("ol",{key:I,dir:v==="auto"?ix():v,tabIndex:-1,ref:q,className:c,"data-sonner-toaster":!0,"data-theme":K,"data-y-position":F,"data-lifted":U&&j.length>1&&!o,"data-x-position":M,style:{"--front-toast-height":`${(($=W[0])==null?void 0:$.height)||0}px`,"--width":`${vR}px`,"--gap":`${x}px`,...f,...SR(u,d)},onBlur:T=>{R.current&&!T.currentTarget.contains(T.relatedTarget)&&(R.current=!1,E.current&&(E.current.focus({preventScroll:!0}),E.current=null))},onFocus:T=>{T.target instanceof HTMLElement&&T.target.dataset.dismissible==="false"||R.current||(R.current=!0,E.current=T.relatedTarget)},onMouseEnter:()=>Q(!0),onMouseMove:()=>Q(!0),onMouseLeave:()=>{V||Q(!1)},onDragEnd:()=>Q(!1),onPointerDown:T=>{T.target instanceof HTMLElement&&T.target.dataset.dismissible==="false"||P(!0)},onPointerUp:()=>P(!1)},j.filter(T=>!T.position&&_===0||T.position===I).map((T,ie)=>{var Z,le;return _e.createElement(jR,{key:T.id,icons:b,index:ie,toast:T,defaultRichColors:m,duration:(Z=h==null?void 0:h.duration)!=null?Z:p,className:h==null?void 0:h.className,descriptionClassName:h==null?void 0:h.descriptionClassName,invert:n,visibleToasts:w,closeButton:(le=h==null?void 0:h.closeButton)!=null?le:l,interacting:V,position:I,style:h==null?void 0:h.style,unstyled:h==null?void 0:h.unstyled,classNames:h==null?void 0:h.classNames,cancelButtonStyle:h==null?void 0:h.cancelButtonStyle,actionButtonStyle:h==null?void 0:h.actionButtonStyle,removeToast:L,toasts:j.filter(oe=>oe.position==T.position),heights:W.filter(oe=>oe.position==T.position),setHeights:B,expandByDefault:o,gap:x,loadingIcon:y,expanded:U,pauseWhenPageIsHidden:S,swipeDirections:e.swipeDirections})})):null}))});const kR=({onMenuClick:e})=>{const{user:t,logout:n}=fr(),{currentWorkspace:r,workspaces:a,isLoading:o,setCurrentWorkspace:l}=ls(),[c]=cu(),u=Lt(),[d,g]=i.useState(!1),[m,p]=i.useState(!1),[f]=i.useState(""),[w,h]=i.useState(null),[v,x]=i.useState(null);i.useEffect(()=>{(async()=>{if(!t){x(null);return}try{const{PaymentService:C}=await tr(async()=>{const{PaymentService:U}=await Promise.resolve().then(()=>Mu);return{PaymentService:U}},void 0),W=await C.getUserSubscription(t.id);console.log("AppNavbar - Loaded subscription:",W);const B=await C.checkUnusedSubscriptions(t.id);console.log("AppNavbar - Unused subscriptions:",B),W&&W.hasSubscription?x({...W,hasUnusedSubscription:B.hasUnusedSubscription,unusedSubscriptionCount:B.unusedSubscriptionCount}):a&&a.length>0?(console.log("AppNavbar - User has",a.length,"workspace(s) - subscription active"),x({hasSubscription:!0,workspaceId:`workspace_${t.id}`,plan:"pro",status:"active",hasUnusedSubscription:B.hasUnusedSubscription,unusedSubscriptionCount:B.unusedSubscriptionCount})):(console.log("AppNavbar - User has no subscription"),x({hasSubscription:!1,workspaceId:`workspace_${t.id}`,hasUnusedSubscription:!1,unusedSubscriptionCount:0}))}catch(C){console.error("AppNavbar - Error loading subscription:",C),a&&a.length>0?x({hasSubscription:!0,workspaceId:`workspace_${t.id}`,plan:"pro",status:"active",hasUnusedSubscription:!1,unusedSubscriptionCount:0}):x({hasSubscription:!1,workspaceId:`workspace_${t.id}`,hasUnusedSubscription:!1,unusedSubscriptionCount:0})}})()},[t,a.length]);const y=(k,C)=>{k!==(r==null?void 0:r.id)&&(h(C),g(!0))},b=()=>{if(w){const k=a.find(C=>C.name===w);k&&(l(k),g(!1),ai.success(`Switched to ${w}`))}},N=()=>{if(console.log("AppNavbar - Create workspace clicked, subscription status:",{hasSubscription:v==null?void 0:v.hasSubscription,subscription:v,workspacesCount:(a==null?void 0:a.length)||0}),!(v!=null&&v.hasSubscription)){window.location.href="/pricing";return}if(!j){a&&a.length>0&&(window.location.href="/pricing");return}u("/create-workspace")},S=c.get("payment_success")==="true"||c.get("session_id"),j=(v==null?void 0:v.hasSubscription)&&(!a||a.length===0||v.hasUnusedSubscription||S);return console.log("AppNavbar - Render subscription status:",{hasSubscription:v==null?void 0:v.hasSubscription,subscription:v,workspacesCount:(a==null?void 0:a.length)||0,workspaces:a==null?void 0:a.map(k=>({id:k.id,name:k.name}))}),s.jsxs("nav",{className:"fixed top-0 left-0 right-0 z-[60] bg-white backdrop-blur-lg border-b border-gray-200 shadow-sm",children:[s.jsxs("div",{className:"h-20 flex items-center justify-between px-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Ie,{variant:"ghost",size:"icon",className:"text-gray-700 hover:bg-gray-100 md:hidden",onClick:e,children:s.jsx($w,{className:"w-5 h-5"})}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl shadow-lg flex-shrink-0",children:s.jsx("img",{src:sl,alt:"VoxBox Logo",className:"h-full w-full object-contain rounded-xl"})}),s.jsx("div",{className:"leading-tight hidden md:block",children:s.jsx("p",{className:"text-xs font-semibold uppercase text-black",children:"Voxbox"})})]})]}),s.jsx("div",{className:"flex-1 flex justify-center",children:s.jsxs(rx,{children:[s.jsx(ax,{asChild:!0,children:s.jsxs(Ie,{variant:"ghost",className:"px-4 py-2 h-auto rounded-lg bg-gray-50 border border-gray-200 hover:bg-gray-100 z-50",children:[s.jsx(Ic,{className:"w-4 h-4 mr-2 text-gray-600"}),s.jsx("span",{className:"text-gray-900 font-semibold",children:(r==null?void 0:r.name)||"Select Workspace"}),s.jsx(Gs,{className:"w-4 h-4 ml-2 text-gray-600"})]})}),s.jsxs(Zm,{align:"center",className:"w-80 z-[70]",children:[s.jsx(ef,{children:"Switch Workspace"}),s.jsx(ri,{}),o?s.jsxs(Xn,{disabled:!0,className:"flex items-center justify-center py-3",children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary mr-2"}),"Loading workspaces..."]}):a.length===0?s.jsx(Xn,{disabled:!0,className:"flex items-center justify-center py-3 text-muted-foreground",children:"No workspaces found"}):a.map(k=>s.jsxs(Xn,{className:"flex items-center justify-between cursor-pointer py-3",onClick:()=>y(k.id,k.name),children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.jsx(Ic,{className:"w-4 h-4 text-muted-foreground"}),s.jsx("span",{className:"font-medium",children:k.name})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(gT,{status:"active"}),k.id===(r==null?void 0:r.id)&&s.jsx(ns,{className:"w-4 h-4 text-primary"})]})]},k.id)),s.jsx(ri,{}),s.jsxs(Xn,{className:"flex items-center gap-2 cursor-pointer text-primary",onClick:N,title:"Create a new workspace",children:[s.jsx(Na,{className:"w-4 h-4"}),"Create New Workspace"]})]})]})}),s.jsxs(rx,{children:[s.jsx(ax,{asChild:!0,children:s.jsx(Ie,{variant:"ghost",size:"icon",className:"text-gray-700 hover:bg-gray-100",children:s.jsx(zr,{className:"w-5 h-5"})})}),s.jsxs(Zm,{align:"end",className:"w-56 z-[70]",children:[s.jsx(ef,{children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"font-semibold",children:t==null?void 0:t.name}),s.jsx("span",{className:"text-xs text-muted-foreground",children:t==null?void 0:t.email})]})}),s.jsx(ri,{}),s.jsx(Xn,{asChild:!0,children:s.jsxs(St,{to:"/profile",className:"cursor-pointer",children:[s.jsx(zr,{className:"w-4 h-4 mr-2"}),"Profile Settings"]})}),s.jsx(Xn,{asChild:!0,children:s.jsxs(St,{to:"/workspace/settings",className:"cursor-pointer",children:[s.jsx(Hm,{className:"w-4 h-4 mr-2"}),"Workspace Settings"]})}),s.jsx(Xn,{asChild:!0,children:s.jsxs(St,{to:"/billing",className:"cursor-pointer",children:[s.jsx(Hm,{className:"w-4 h-4 mr-2"}),"Billing"]})}),s.jsx(ri,{}),s.jsxs(Xn,{className:"cursor-pointer text-destructive",onClick:async()=>{try{await n(),u("/dashboard")}catch(k){console.error("Logout error:",k),u("/dashboard")}},children:[s.jsx(Um,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})]})]}),s.jsx(JT,{open:d,onOpenChange:g,currentWorkspace:(r==null?void 0:r.name)||"",targetWorkspace:w||"",onConfirm:b}),s.jsx(mN,{open:m,onOpenChange:p,workspaceName:f,onContinue:()=>{console.log("User continued from navbar success modal"),p(!1)}},`success-modal-${f}`)]})},PR=({isOpen:e,isCollapsed:t=!1,onCollapseToggle:n})=>{const r=En(),a=i.useRef(null),[o,l]=i.useState(!1),[c,u]=i.useState(!1),d=[{icon:_P,label:"Dashboard",path:"/dashboard",disabled:!1},{icon:vh,label:"AVA Creator",path:"/tools/ava"},{icon:Ow,label:"Product Tools",path:"/tools/products"},{icon:Dw,label:"Vera Creator",path:"/tools/vera"},{icon:Rw,label:"Lead Magnet",path:"/tools/lead-magnet"},{icon:Tc,label:"Amplifiers",path:"/amplifiers"},{icon:$P,label:"My Profiles",path:"/profiles"},{icon:OP,label:"Output History",path:"/outputs"},{icon:Pn,label:"Templates",path:"/templates"},{icon:GP,label:"Team",path:"/team"},{icon:MP,label:"Billing",path:"/billing"},{icon:Hm,label:"Workspace",path:"/workspace/settings"}],g=()=>{const f=a.current;if(!f)return;const{scrollHeight:w,clientHeight:h}=f,x=w>h+5;l(x),u(x)};i.useEffect(()=>{const f=a.current;if(!f)return;g(),f.addEventListener("scroll",g);const w=new ResizeObserver(g);return w.observe(f),()=>{f.removeEventListener("scroll",g),w.disconnect()}},[t,e]);const m=()=>{const f=a.current;f&&f.scrollBy({top:-50,behavior:"smooth"})},p=()=>{const f=a.current;f&&f.scrollBy({top:50,behavior:"smooth"})};return s.jsxs(s.Fragment,{children:[e&&s.jsx("div",{className:"fixed inset-0 bg-vox-dark/80 backdrop-blur-sm z-30 md:hidden",onClick:f=>{f.stopPropagation()}}),s.jsxs("aside",{className:it("fixed left-0 top-20 h-[calc(100vh-5rem)] bg-white border-r border-gray-200 z-40 transition-all duration-300 flex flex-col",t?"w-16":"w-64",e?"translate-x-0":"-translate-x-full md:translate-x-0 md:w-0 md:overflow-hidden"),children:[n&&s.jsx(Ie,{variant:"ghost",size:"icon",onClick:f=>{f.preventDefault(),f.stopPropagation(),n()},className:it("absolute top-4 -right-3 h-7 w-7 rounded-full bg-white border border-gray-200 shadow-sm hover:bg-gray-50 transition-all duration-200 flex items-center justify-center z-50",t&&"right-[-14px]"),title:t?"Expand sidebar":"Collapse sidebar",children:t?s.jsx(Tw,{className:"w-3.5 h-3.5 text-gray-500"}):s.jsx(CP,{className:"w-3.5 h-3.5 text-gray-500"})}),s.jsxs("div",{className:"flex-1 flex flex-col relative min-h-0 overflow-hidden",children:[s.jsx("nav",{ref:a,className:it("flex-1 overflow-y-auto overflow-x-hidden space-y-2 transition-all duration-300","scrollbar-hide",t?"p-2 pr-4":"p-4"),style:{scrollbarWidth:"none",msOverflowStyle:"none",WebkitOverflowScrolling:"touch"},children:d.map(f=>{const w=f.icon,h=["/tools/products","/tools/margo","/tools/product-refiner"],x=f.path==="/tools/products"?h.some(b=>r.pathname.startsWith(b)):r.pathname===f.path||r.pathname.startsWith(f.path+"/"),y=f.disabled===!0;return s.jsxs(St,{to:f.path,className:it("flex items-center rounded-lg font-sans font-semibold transition-all group",t?"justify-center px-2 py-3":"gap-3 px-4 py-3",x?"bg-black text-white":y?"text-gray-400 cursor-not-allowed opacity-50":"text-gray-700 hover:bg-gray-100 hover:text-black"),onClick:b=>{y&&b.preventDefault()},title:t?f.label:y?"Complete payment to access Dashboard":"",children:[s.jsx(w,{className:"w-5 h-5 flex-shrink-0"}),!t&&s.jsx("span",{className:"leading-none",children:f.label})]},f.path)})}),!t&&(o||c)&&s.jsxs("div",{className:"absolute right-0 top-0 bottom-0 w-5 flex flex-col items-center justify-between py-1 pointer-events-none z-30",children:[o&&s.jsx("button",{onClick:m,className:"w-5 h-5 flex items-center justify-center bg-transparent hover:bg-gray-100 active:bg-gray-200 rounded-sm pointer-events-auto transition-colors duration-150 cursor-pointer border-0 outline-none focus:outline-none",title:"Scroll up","aria-label":"Scroll up",type:"button",children:s.jsx(Hn,{className:"w-3.5 h-3.5 text-gray-500",strokeWidth:2.5})}),c&&s.jsx("button",{onClick:p,className:"w-5 h-5 flex items-center justify-center bg-transparent hover:bg-gray-100 active:bg-gray-200 rounded-sm pointer-events-auto transition-colors duration-150 cursor-pointer border-0 outline-none focus:outline-none",title:"Scroll down","aria-label":"Scroll down",type:"button",children:s.jsx(Gs,{className:"w-3.5 h-3.5 text-gray-500",strokeWidth:2.5})})]})]})]})]})},Gt=({children:e})=>{const[t,n]=i.useState(!0),[r,a]=i.useState(()=>{const o=localStorage.getItem("sidebarCollapsed");return o?JSON.parse(o):!1});return i.useEffect(()=>{localStorage.setItem("sidebarCollapsed",JSON.stringify(r))},[r]),s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(kR,{onMenuClick:()=>n(!t)}),s.jsx("div",{className:"pt-20",children:s.jsxs("div",{className:"flex",children:[s.jsx(PR,{isOpen:t,isCollapsed:r,onCollapseToggle:()=>a(!r)}),s.jsx("main",{className:`flex-1 px-6 pb-8 pt-6 transition-all duration-300 ${t?r?"md:ml-16":"md:ml-64":"md:ml-0"}`,children:e||s.jsx(u2,{})})]})})]})},Tu=()=>{const[e,t]=i.useState(!1),{isAuthenticated:n,user:r,logout:a}=fr(),o=Lt(),l=En(),[c,u]=i.useState(!0),[d,g]=i.useState(null);i.useEffect(()=>{(async()=>{if(n&&r)try{const{PaymentService:v}=await tr(async()=>{const{PaymentService:y}=await Promise.resolve().then(()=>Mu);return{PaymentService:y}},void 0),x=await v.getUserSubscription(r.id);g((x==null?void 0:x.hasSubscription)||!1)}catch(v){console.error("Error checking subscription:",v),g(!1)}else g(null)})()},[n,r]),i.useEffect(()=>{if(n){const h=l.pathname==="/pricing";if(h&&d===!1){u(!1);return}if(h&&d===!0){u(!0);return}if(localStorage.getItem("isNewUser")==="true"){const y=new URLSearchParams(l.search).get("payment_success")==="true",b=localStorage.getItem("hasSubscription")==="true";u(b||y||!1)}else u(!0)}else u(!0)},[n,l.search,l.pathname,d]);const m=async()=>{try{await a(),o("/dashboard")}catch(h){console.error("Logout error:",h)}},p=h=>h==="/"?l.pathname==="/":l.pathname.startsWith(h),f=h=>{const v="font-sans font-semibold transition-colors",x=p(h)?"text-white border-b-2 border-white":"text-white/80 hover:text-white";return`${v} ${x}`},w=h=>{const v="font-sans font-semibold transition-colors py-2",x=p(h)?"text-white border-l-4 border-white pl-4":"text-white/80 hover:text-white";return`${v} ${x}`};return s.jsx("nav",{className:"fixed top-0 left-0 right-0 z-50 bg-vox-dark/80 backdrop-blur-lg border-b border-white/10",children:s.jsxs("div",{className:"container px-6",children:[s.jsxs("div",{className:"flex items-center justify-between h-20",children:[s.jsx("div",{className:"flex items-center gap-3",children:s.jsx("img",{src:sl,alt:"VoxBox Logo",className:"h-10"})}),s.jsxs("div",{className:"hidden md:flex items-center gap-8",children:[s.jsx(St,{to:"/",className:f("/"),children:"Home"}),s.jsx(St,{to:"/features",className:f("/features"),children:"Features"}),s.jsx(St,{to:"/pricing",className:f("/pricing"),children:"Pricing"}),s.jsx(St,{to:"/contact",className:f("/contact"),children:"Contact"})]}),s.jsx("div",{className:"flex items-center gap-4",children:n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-white/80 text-sm",children:["Welcome, ",r==null?void 0:r.name]}),c&&s.jsx(Ie,{asChild:!0,variant:"ghost",className:"font-heading font-semibold text-white hover:text-white hover:bg-white/10",children:s.jsxs(St,{to:"/dashboard",children:[s.jsx(zr,{className:"w-4 h-4 mr-2"}),"Dashboard"]})}),s.jsxs(Ie,{variant:"outline",className:"font-heading font-semibold text-black border-white hover:bg-white hover:text-vox-dark",onClick:m,children:[s.jsx(Um,{className:"w-4 h-4 mr-2 text-black"}),"Logout"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ie,{asChild:!0,variant:"ghost",className:"font-heading font-semibold text-white hover:text-white hover:bg-white/10",children:s.jsx(St,{to:"/login",children:"Sign In"})}),s.jsx(Ie,{asChild:!0,className:"bg-primary hover:bg-primary/90 font-heading font-bold",children:s.jsx(St,{to:"/register",children:"Get Started"})})]})}),s.jsx("button",{onClick:()=>t(!e),className:"sm:hidden text-white p-2",children:e?s.jsx(Es,{className:"w-6 h-6"}):s.jsx($w,{className:"w-6 h-6"})})]}),e&&s.jsx("div",{className:"sm:hidden py-6 border-t border-white/10",children:s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx(St,{to:"/",className:w("/"),onClick:()=>t(!1),children:"Home"}),s.jsx(St,{to:"/features",className:w("/features"),onClick:()=>t(!1),children:"Features"}),s.jsx(St,{to:"/pricing",className:w("/pricing"),onClick:()=>t(!1),children:"Pricing"}),s.jsx(St,{to:"/contact",className:w("/contact"),onClick:()=>t(!1),children:"Contact"}),s.jsx("div",{className:"pt-4 flex flex-col gap-3",children:n?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"text-white/80 text-sm text-center mb-2",children:["Welcome, ",r==null?void 0:r.name]}),c&&s.jsx(Ie,{asChild:!0,variant:"ghost",className:"font-heading font-semibold text-white hover:text-white hover:bg-white/10 w-full",children:s.jsxs(St,{to:"/dashboard",onClick:()=>t(!1),children:[s.jsx(zr,{className:"w-4 h-4 mr-2"}),"Dashboard"]})}),s.jsxs(Ie,{variant:"outline",className:"font-heading font-semibold text-black border-white hover:bg-white hover:text-vox-dark w-full",onClick:()=>{m(),t(!1)},children:[s.jsx(Um,{className:"w-4 h-4 mr-2 text-black"}),"Logout"]})]}):s.jsxs(s.Fragment,{children:[s.jsx(Ie,{asChild:!0,variant:"ghost",className:"font-heading font-semibold text-white hover:text-white hover:bg-white/10 w-full",children:s.jsx(St,{to:"/login",onClick:()=>t(!1),children:"Sign In"})}),s.jsx(Ie,{asChild:!0,className:"bg-primary hover:bg-primary/90 font-heading font-bold w-full",children:s.jsx(St,{to:"/register",onClick:()=>t(!1),children:"Get Started"})})]})})]})})]})})},AR="/assets/hero-bg-explosion-DY4_7o0V.jpg",CR="/assets/logo-white-7CHNZiiE.png",ER=()=>s.jsxs("section",{className:"relative min-h-screen flex items-center justify-center overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0",children:s.jsx("img",{src:AR,alt:"",className:"w-full h-full object-cover animate-[scale_20s_ease-in-out_infinite]"})}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-vox-dark/85 via-vox-dark/70 to-vox-dark/85"}),s.jsx("div",{className:"absolute inset-0 opacity-5",children:s.jsx("img",{src:CR,alt:"",className:"w-full h-full object-cover"})}),s.jsx("div",{className:"absolute top-20 left-20 w-96 h-96 bg-primary/20 rounded-full blur-3xl animate-pulse"}),s.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-vox-gold/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}})]}),s.jsx("div",{className:"container relative z-10 px-6 py-20",children:s.jsxs("div",{className:"max-w-4xl mx-auto text-center animate-fade-in",children:[s.jsx("div",{className:"mb-6",children:s.jsx("p",{className:"text-vox-gold text-lg md:text-xl font-semibold tracking-wide",children:"AI for Audience Persuasion"})}),s.jsxs("h1",{className:"font-heading font-bold text-5xl md:text-7xl lg:text-8xl mb-6 text-white drop-shadow-lg",children:["Unlock Your",s.jsx("span",{className:"block text-primary",children:"Content Power"})]}),s.jsxs("p",{className:"text-xl md:text-2xl text-white/90 mb-12 max-w-2xl mx-auto font-sans leading-relaxed",children:["Create persuasive marketing content with AI-powered profiles and amplifiers.",s.jsx("span",{className:"font-semibold",children:" Strategic. Powerful. Effective."})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[s.jsx(Ie,{asChild:!0,size:"lg",className:"bg-white hover:bg-white/90 text-vox-dark font-heading font-bold text-lg px-8 py-6 rounded-xl shadow-strong hover:scale-105 transition-transform group",children:s.jsxs(St,{to:"/register",children:["Get Started",s.jsx(xo,{className:"ml-2 group-hover:translate-x-1 transition-transform"})]})}),s.jsx(Ie,{asChild:!0,size:"lg",variant:"outline",className:"border-2 border-white text-white hover:bg-white hover:text-vox-dark font-heading font-semibold text-lg px-8 py-6 rounded-xl backdrop-blur-sm bg-white/10 hover:scale-105 transition-all",children:s.jsxs(St,{to:"/features",children:[s.jsx(Zs,{className:"mr-2"}),"Explore Features"]})})]}),s.jsxs("div",{className:"mt-16 grid grid-cols-3 gap-8 max-w-2xl mx-auto",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-heading font-bold text-5xl text-white mb-2",children:"100K+"}),s.jsx("div",{className:"text-white/80 font-sans",children:"Active Users"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-heading font-bold text-5xl text-white mb-2",children:"50M+"}),s.jsx("div",{className:"text-white/80 font-sans",children:"Creations"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-heading font-bold text-5xl text-white mb-2",children:"99.9%"}),s.jsx("div",{className:"text-white/80 font-sans",children:"Uptime"})]})]})]})}),s.jsx("div",{className:"absolute bottom-8 left-1/2 -translate-x-1/2",children:s.jsx("div",{className:"w-6 h-10 border-2 border-white/50 rounded-full flex justify-center p-1",children:s.jsx("div",{className:"w-1.5 h-3 bg-white/50 rounded-full"})})})]}),fN=()=>{const e=[{icon:PP,title:"AI-Powered Profiles",description:"Create detailed audience profiles with advanced AI analysis to understand your target market better than ever."},{icon:vh,title:"Team Collaboration",description:"Work seamlessly with your team on projects, share insights, and maintain consistent brand voice across all content."},{icon:Tc,title:"Content Amplifiers",description:"Transform your ideas into compelling marketing content with our suite of powerful content generation tools."},{icon:HP,title:"Precision Targeting",description:"Reach the right audience with laser-focused content that resonates and converts based on deep psychological insights."},{icon:AP,title:"Analytics & Insights",description:"Track performance, measure engagement, and optimize your content strategy with comprehensive analytics."},{icon:zP,title:"Enterprise Security",description:"Bank-level security with end-to-end encryption, ensuring your data and intellectual property remain protected."}];return s.jsx("section",{className:"py-20 bg-background",children:s.jsx("div",{className:"container px-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-16",children:[s.jsxs("h2",{className:"font-heading font-bold text-4xl md:text-5xl mb-6",children:["Powerful Features for",s.jsx("span",{className:"block text-primary",children:"Modern Marketers"})]}),s.jsx("p",{className:"text-xl text-muted-foreground max-w-3xl mx-auto",children:"Everything you need to create, optimize, and scale your content marketing efforts with AI-powered precision."})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:e.map((t,n)=>s.jsxs(qe,{className:"group hover:shadow-lg transition-all duration-300 hover:-translate-y-1",children:[s.jsxs(vt,{children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-black flex items-center justify-center mb-4 group-hover:scale-110 transition-transform",children:s.jsx(t.icon,{className:"w-6 h-6 text-white"})}),s.jsx(pt,{className:"text-xl font-heading font-bold",children:t.title})]}),s.jsx(Xe,{children:s.jsx(gt,{className:"text-base leading-relaxed",children:t.description})})]},n))}),s.jsx("div",{className:"text-center mt-16 bg-vox-dark/10 rounded-2xl",children:s.jsxs("div",{className:"bg-white/20 backdrop-blur-lg border border-white/30 shadow-xl rounded-2xl p-8 border border-vox-pink/20  ",children:[s.jsx("h3",{className:"font-heading font-bold text-2xl mb-4",children:"Ready to Transform Your Content Strategy?"}),s.jsx("p",{className:"text-muted-foreground mb-6 max-w-2xl mx-auto",children:"Join thousands of marketers who are already using VoxBox to create more engaging, persuasive content."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[s.jsx("a",{href:"/register",className:"inline-flex items-center justify-center px-8 py-3 bg-primary text-white font-heading font-bold rounded-lg hover:bg-primary/90 hover:scale-105 transition-all",children:"Start Free Trial"}),s.jsx("a",{href:"/features",className:"inline-flex items-center justify-center px-8 py-3 border border-vox-pink text-vox-pink font-heading font-semibold rounded-lg hover:bg-vox-pink hover:text-white transition-colors",children:"Learn More"})]})]})})]})})})},IR=()=>{const e=["Increase content engagement by 300%","Reduce content creation time by 80%","Improve conversion rates by 150%","Scale content production 10x faster"];return s.jsx("section",{className:"py-20 bg-muted/30",children:s.jsx("div",{className:"container px-6",children:s.jsx("div",{className:"max-w-7xl mx-auto",children:s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-16 items-center",children:s.jsxs("div",{children:[s.jsxs("h2",{className:"font-heading font-bold text-4xl md:text-5xl mb-6 flex items-center gap-2",children:["Why Choose",s.jsx("span",{className:"block bg-gradient-to-r from-vox-pink to-vox-blue bg-clip-text text-transparent",children:"VoxBox?"})]}),s.jsx("p",{className:"text-xl text-muted-foreground mb-8 leading-relaxed",children:"We understand that great content isn't just about wordsit's about understanding your audience, crafting the perfect message, and delivering it at the right time. VoxBox combines cutting-edge AI with deep marketing psychology to give you an unfair advantage."}),s.jsx("div",{className:"space-y-4 mb-8",children:e.map((t,n)=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wm,{className:"w-6 h-6 text-vox-green flex-shrink-0"}),s.jsx("span",{className:"font-sans text-lg",children:t})]},n))}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[s.jsxs("a",{href:"/register",className:"inline-flex items-center justify-center px-8 py-3 bg-primary text-white font-heading font-bold rounded-lg hover:bg-primary/90 transition-all",children:["Get Started Free",s.jsx(xo,{className:"ml-2 transition-transform"})]}),s.jsx("a",{href:"/contact",className:"inline-flex items-center justify-center px-8 py-4 border border-vox-pink text-vox-pink font-heading font-semibold rounded-lg hover:bg-vox-pink hover:text-white transition-colors",children:"Talk to Sales"})]})]})})})})})},TR=()=>s.jsxs("section",{className:"py-20 bg-primary relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0",children:[s.jsx("div",{className:"absolute top-20 left-20 w-96 h-96 bg-vox-pink/20 rounded-full blur-3xl animate-pulse"}),s.jsx("div",{className:"absolute bottom-20 right-20 w-96 h-96 bg-vox-pink/15 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}})]}),s.jsx("div",{className:"container px-6 relative z-10",children:s.jsxs("div",{className:"max-w-4xl mx-auto text-center",children:[s.jsxs("h2",{className:"font-heading font-bold text-4xl md:text-6xl mb-6 text-white",children:["Ready to Transform Your",s.jsx("span",{className:"block text-white",children:"Content Strategy?"})]}),s.jsx("p",{className:"text-xl md:text-2xl text-white/90 mb-12 max-w-3xl mx-auto leading-relaxed",children:"Join thousands of marketers who are already using VoxBox to create more engaging, persuasive content that converts. Start your free trial today."}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-6 justify-center items-center mb-12",children:[s.jsx(Ie,{asChild:!0,size:"lg",className:"bg-white hover:bg-white/90 text-vox-dark font-heading font-bold text-lg px-8 py-6 rounded-xl shadow-strong hover:scale-105 transition-transform group",children:s.jsxs(St,{to:"/register",children:["Start Free Trial",s.jsx(xo,{className:"ml-2 group-hover:translate-x-1 transition-transform"})]})}),s.jsx(Ie,{asChild:!0,size:"lg",variant:"outline",className:"border-2 border-white text-white hover:bg-white hover:text-vox-dark font-heading font-semibold text-lg px-8 py-6 rounded-xl backdrop-blur-sm bg-white/10 hover:scale-105 transition-all",children:s.jsxs(St,{to:"/pricing",children:[s.jsx(Zs,{className:"mr-2"}),"View Pricing"]})})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 max-w-3xl mx-auto",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-heading font-bold text-3xl text-white mb-2",children:"14-Day"}),s.jsx("div",{className:"text-white/80 font-sans",children:"Free Trial"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-heading font-bold text-3xl text-white mb-2",children:"No"}),s.jsx("div",{className:"text-white/80 font-sans",children:"Credit Card"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-heading font-bold text-3xl text-white mb-2",children:"24/7"}),s.jsx("div",{className:"text-white/80 font-sans",children:"Support"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"font-heading font-bold text-3xl text-white mb-2",children:"Cancel"}),s.jsx("div",{className:"text-white/80 font-sans",children:"Anytime"})]})]})]})})]}),Ru=()=>{const e=new Date().getFullYear();return s.jsx("footer",{className:"bg-vox-dark text-vox-neutral py-16",children:s.jsx("div",{className:"container px-6",children:s.jsxs("div",{className:"max-w-7xl mx-auto",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-12 mb-12",children:[s.jsxs("div",{className:"lg:col-span-1",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsx("img",{src:sl,alt:"VoxBox Logo",className:"h-10"}),s.jsx("span",{className:"font-heading font-bold text-2xl text-white",children:"VOXBOX"})]}),s.jsx("p",{className:"text-vox-neutral/70 font-sans mb-6",children:"Transform your creative vision with the next generation platform."}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("a",{href:"#",className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center transition-colors",children:s.jsx(QP,{className:"w-5 h-5"})}),s.jsx("a",{href:"#",className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center transition-colors",children:s.jsx(DP,{className:"w-5 h-5"})}),s.jsx("a",{href:"#",className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center transition-colors",children:s.jsx(LP,{className:"w-5 h-5"})}),s.jsx("a",{href:"#",className:"w-10 h-10 rounded-lg bg-white/5 hover:bg-white/10 flex items-center justify-center transition-colors",children:s.jsx(gh,{className:"w-5 h-5"})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-heading font-bold text-lg mb-4 text-white",children:"Product"}),s.jsxs("ul",{className:"space-y-3 font-sans",children:[s.jsx("li",{children:s.jsx(St,{to:"/features",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Features"})}),s.jsx("li",{children:s.jsx(St,{to:"/pricing",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Pricing"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Use Cases"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Changelog"})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-heading font-bold text-lg mb-4 text-white",children:"Company"}),s.jsxs("ul",{className:"space-y-3 font-sans",children:[s.jsx("li",{children:s.jsx(St,{to:"/about",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"About"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Blog"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Careers"})}),s.jsx("li",{children:s.jsx(St,{to:"/contact",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Contact"})})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-heading font-bold text-lg mb-4 text-white",children:"Resources"}),s.jsxs("ul",{className:"space-y-3 font-sans",children:[s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Documentation"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"API Reference"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Support"})}),s.jsx("li",{children:s.jsx("a",{href:"#",className:"text-vox-neutral/70 hover:text-white transition-colors",children:"Community"})})]})]})]}),s.jsx("div",{className:"pt-8 border-t border-white/10",children:s.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[s.jsxs("p",{className:"text-vox-neutral/60 text-sm font-sans",children:[" ",e," VoxBox. All rights reserved."]}),s.jsxs("div",{className:"flex gap-6 text-sm font-sans",children:[s.jsx("a",{href:"#",className:"text-vox-neutral/60 hover:text-white transition-colors",children:"Privacy Policy"}),s.jsx("a",{href:"#",className:"text-vox-neutral/60 hover:text-white transition-colors",children:"Terms of Service"}),s.jsx("a",{href:"#",className:"text-vox-neutral/60 hover:text-white transition-colors",children:"Cookie Policy"})]})]})})]})})})};class ga{static async createCheckoutSession(t){try{console.log("PaymentService: Creating checkout session"),console.log("PaymentService: Data:",t);const n=Oe.isAuthenticated();console.log("PaymentService: User authenticated:",n);let r;if(n?(console.log("PaymentService: Using authenticated request"),r=await Oe.makeAuthenticatedRequest(`${Fe}/subscriptions/checkout-session`,{method:"POST",body:JSON.stringify(t)})):(console.log("PaymentService: Using public request"),console.log("PaymentService: Request URL:",`${Fe}/subscriptions/checkout-session`),r=await fetch(`${Fe}/subscriptions/checkout-session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})),console.log("PaymentService: Response status:",r.status),console.log("PaymentService: Response ok:",r.ok),!r.ok){const l=await r.json();throw console.error("PaymentService: Error response:",l),new Error(l.message||`HTTP error! status: ${r.status}`)}const a=await r.json();console.log("PaymentService: Checkout session created, full response:",a);const o=a.data||a;if(console.log("PaymentService: Checkout session data:",o),!o.sessionId||!o.url)throw console.error("PaymentService: Invalid response structure"),new Error("Invalid response from checkout session API");return o}catch(n){throw console.error("PaymentService: Error creating checkout session:",n),n}}static async handlePaymentSuccess(t){try{const n=await fetch(`${Fe}/subscriptions/payment-success?session_id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=await n.json();return r.data||r}catch(n){throw console.error("Error handling payment success:",n),n}}static async getUserSubscription(t){try{const n=await Oe.makeAuthenticatedRequest(`${Fe}/subscriptions/user/${t}`,{method:"GET"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=await n.json();return r.data||r}catch(n){throw console.error("Error getting user subscription:",n),n}}static async getUserSubscriptionStatus(t){try{const n=await Oe.makeAuthenticatedRequest(`${Fe}/subscriptions/status/${t}`,{method:"GET"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=await n.json();return r.data||r}catch(n){throw console.error("Error getting subscription status:",n),n}}static async debugUserSubscription(t){try{const n=await Oe.makeAuthenticatedRequest(`${Fe}/subscriptions/debug/${t}`,{method:"GET"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=await n.json();return console.log("Debug subscription data:",r),r.data||r}catch(n){throw console.error("Error getting debug subscription data:",n),n}}static async checkUnusedSubscriptions(t){try{const n=await Oe.makeAuthenticatedRequest(`${Fe}/subscriptions/unused/${t}`,{method:"GET"});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const r=await n.json();return console.log("Unused subscriptions data:",r),r.data||r}catch(n){throw console.error("Error checking unused subscriptions:",n),n}}static async cancelSubscription(t,n=!1){try{const r=await Oe.makeAuthenticatedRequest(`${Fe}/subscriptions/cancel`,{method:"POST",body:JSON.stringify({workspaceId:t,immediately:n})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const a=await r.json();return a.data||a}catch(r){throw console.error("Error canceling subscription:",r),r}}}const hN=async(e,t)=>{try{console.log("redirectToCheckout: Starting checkout process");const n=window.location.origin,r=Oe.getCurrentUser();console.log("redirectToCheckout: Base URL:",n),console.log("redirectToCheckout: User:",r),console.log("redirectToCheckout: Plan:",e),console.log("redirectToCheckout: Workspace ID:",t);const a={plan:e,workspaceId:t,successUrl:`${n}/thank-you`,cancelUrl:`${n}/cancel`,customerEmail:r==null?void 0:r.email};console.log("redirectToCheckout: Checkout data:",a);const o=await ga.createCheckoutSession(a);if(console.log("redirectToCheckout: Session created:",o),!o||!o.url)throw new Error("Invalid checkout session response");console.log("redirectToCheckout: Redirecting to:",o.url),window.location.href=o.url}catch(n){throw console.error("redirectToCheckout: Error redirecting to checkout:",n),n}},pN=async e=>{if(!Oe.getCurrentUser())throw new Error("User must be authenticated");return hN(e)},Mu=Object.freeze(Object.defineProperty({__proto__:null,PaymentService:ga,redirectToAuthenticatedCheckout:pN,redirectToCheckout:hN},Symbol.toStringTag,{value:"Module"})),RR=()=>{const e=Lt(),{isAuthenticated:t,user:n,isLoading:r}=fr(),[a,o]=i.useState(!1),l=i.useRef(null);return i.useEffect(()=>{(async()=>{if(!r){if(!t||!n){l.current=null;return}if(!(a||l.current===n.id)){o(!0),l.current=n.id,console.log("Index - Checking user status for user:",n.id);try{try{const g=await Vi.getWorkspaces();if(console.log("Index - Fetched workspaces:",(g==null?void 0:g.length)||0,g),g&&g.length>0){console.log("Index - User has workspaces, redirecting to dashboard. Workspaces:",g.map(m=>m.name)),e("/dashboard",{replace:!0});return}}catch(g){console.error("Index - Error fetching workspaces:",g)}console.log("Index - No workspaces found, checking subscription status...");const u=await ga.getUserSubscription(n.id);console.log("Index - Subscription check result:",u),u&&u.hasSubscription?(console.log("Index - User has subscription but no workspace - redirecting to pricing"),e("/pricing",{replace:!0})):(console.log("Index - User has no subscription - redirecting to pricing"),e("/pricing",{replace:!0}))}catch(u){console.error("Index - Error checking user status:",u),console.log("Index - Error occurred - redirecting to pricing"),e("/pricing",{replace:!0})}finally{o(!1)}}}})()},[t,n,r,e]),r||t&&a?s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),s.jsx("p",{className:"text-white/80",children:"Loading..."})]})}):s.jsxs("div",{className:"min-h-screen",children:[s.jsx(Tu,{}),s.jsx(ER,{}),s.jsx(fN,{}),s.jsx(IR,{}),s.jsx(TR,{}),s.jsx(Ru,{})]})},MR=()=>s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Tu,{}),s.jsx(fN,{}),s.jsx(Ru,{})]}),$R={solo:"pro",growth:"pro",pro:"team",scale:"team"},DR=()=>{const[e,t]=i.useState(null),[n,r]=i.useState("solo"),{isAuthenticated:a}=fr(),o=async u=>{const d=$R[u];try{if(console.log("Pricing: Starting checkout for plan:",d),console.log("Pricing: User authenticated:",a),!a){alert("Please log in to access subscription features. You need to be authenticated to make payments.");return}t(u),console.log("Pricing: Using authenticated checkout"),await pN(d),console.log("Pricing: Checkout process completed")}catch(g){console.error("Pricing: Error starting checkout:",g);const m=(g==null?void 0:g.message)||"Failed to start checkout. Please try again.";alert(m)}finally{t(null)}},l={solo:{label:"Solo Plan",monthlyPrice:"97",annualPrice:"970",description:"Designed for individual business owners who have one main offer and one primary audience. Suitable for those at the early stage of building a structured product ecosystem.",profiles:"Up to 2 Ideal Client Profiles",products:"Up to 2 Products"},growth:{label:"Growth Plan",monthlyPrice:"117",annualPrice:"1,170",description:"Ideal for solo service providers who work with several audience types or who are developing a product suite with more than one core offer.",profiles:"Up to 4 Ideal Client Profiles",products:"Up to 4 Products"},pro:{label:"Pro Plan",monthlyPrice:"137",annualPrice:"1,370",description:"Built for established solo business owners with a growing set of offers or multiple lead magnets feeding into different programmes.",profiles:"Up to 5 Ideal Client Profiles",products:"Up to 5 Products",highlight:!0},scale:{label:"Scale Plan",monthlyPrice:"157",annualPrice:"1,570",description:"Created for mature solo businesses with an expanding or complete ecosystem. Suitable for those running multiple programmes, niches or customer journeys.",profiles:"Unlimited Ideal Client Profiles",products:"Unlimited Products"}},c=l[n];return s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Tu,{}),s.jsxs("section",{className:"relative pt-32 pb-16 overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-[#e9f4ff] via-white to-white"}),s.jsxs("div",{className:"container relative z-10 px-6",children:[s.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[s.jsx("div",{className:"inline-flex items-center px-4 py-1 mb-4 text-xs font-semibold tracking-[0.2em] uppercase rounded-full bg-black text-white",children:"Pricing"}),s.jsx("h1",{className:"font-heading font-bold text-4xl md:text-5xl lg:text-6xl mb-4",children:"Simple Transparent Pricing"}),s.jsx("p",{className:"text-base md:text-lg text-muted-foreground",children:"Choose a plan that fits your needs. Start using VoxBox immediately after payment."})]}),s.jsx("div",{className:"mt-10 flex justify-center",children:s.jsx("div",{className:"inline-flex w-full max-w-xl rounded-full bg-white p-1 shadow-md",children:["solo","growth","pro","scale"].map(u=>s.jsx("button",{type:"button",onClick:()=>r(u),className:`flex-1 px-6 py-2.5 text-sm md:text-base font-medium rounded-full transition-all ${n===u?"bg-black text-white shadow-sm":"text-slate-500 hover:text-slate-800"}`,children:l[u].label},u))})})]})]}),s.jsx("section",{className:"pb-20 pt-4",children:s.jsx("div",{className:"container px-6",children:s.jsxs("div",{className:"grid md:grid-cols-2 gap-8 max-w-5xl mx-auto",children:[s.jsxs(qe,{className:"relative rounded-[32px] border border-slate-200 shadow-md bg-white",children:[s.jsxs(vt,{className:"pb-6 space-y-4",children:[s.jsx(pt,{className:"text-3xl md:text-[32px] font-[590]",children:c.label}),s.jsx(gt,{className:"text-sm md:text-base leading-relaxed font-['SF Pro']",children:c.description}),s.jsxs("div",{className:"mt-6 flex items-baseline gap-2",children:[s.jsx("span",{className:"text-4xl md:text-5xl font-heading font-bold",children:c.monthlyPrice}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"/month"})]})]}),s.jsxs(Xe,{className:"space-y-6 pb-8",children:[s.jsxs("ul",{className:"space-y-3 text-sm",children:[s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:c.profiles})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:c.products})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:"No contracts"})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:"Cancel anytime"})]})]}),s.jsx(Ie,{onClick:()=>o(n),disabled:e===n||!a,variant:"outline",className:"w-full rounded-full h-11 text-sm font-semibold border-[1.5px] border-black text-black hover:bg-black hover:text-white",children:e===n?"Processing...":a?"Buy now":"Login Required"})]})]}),s.jsxs(qe,{className:"relative rounded-[32px] border border-slate-200 shadow-lg shadow-slate-200/70 bg-white",children:[s.jsx("div",{className:"absolute -top-4 right-6",children:s.jsx("div",{className:"inline-flex items-center rounded-full bg-white shadow px-4 py-1 text-xs font-semibold text-slate-800",children:"2 months free (Annual)"})}),s.jsxs(vt,{className:"pb-6 space-y-4",children:[s.jsx(pt,{className:"text-3xl md:text-[32px] font-[590]",children:c.label}),s.jsx(gt,{className:"text-sm md:text-base leading-relaxed font-['SF Pro']",children:c.description}),s.jsxs("div",{className:"mt-6 flex items-baseline gap-2",children:[s.jsx("span",{className:"text-4xl md:text-5xl font-heading font-bold",children:c.annualPrice}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"/Annual"})]})]}),s.jsxs(Xe,{className:"space-y-6 pb-8",children:[s.jsxs("ul",{className:"space-y-3 text-sm",children:[s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:c.profiles})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:c.products})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:"No contracts"})]}),s.jsxs("li",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-black flex items-center justify-center mt-0.5 flex-shrink-0",children:s.jsx(ns,{className:"w-3 h-3 text-white stroke-[3]"})}),s.jsx("span",{className:"font-['SF Pro']",children:"Cancel anytime"})]})]}),s.jsx(Ie,{onClick:()=>o(n),disabled:e===n||!a,className:"w-full rounded-full h-11 text-sm font-semibold bg-black hover:bg-black/90 text-white",children:e===n?"Processing...":a?"Buy now":"Login Required"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Annual price gives two months of access for free compared to paying monthly."})]})]})]})})}),s.jsx(Ru,{})]})},Ft=i.forwardRef(({className:e,type:t,...n},r)=>s.jsx("input",{type:t,className:it("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...n}));Ft.displayName="Input";var OR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],FR=OR.reduce((e,t)=>{const n=dh(`Primitive.${t}`),r=i.forwardRef((a,o)=>{const{asChild:l,...c}=a,u=l?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(u,{...c,ref:o})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),_R="Label",gN=i.forwardRef((e,t)=>s.jsx(FR.label,{...e,ref:t,onMouseDown:n=>{var a;n.target.closest("button, input, select, textarea")||((a=e.onMouseDown)==null||a.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));gN.displayName=_R;var xN=gN;const LR=mh("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),st=i.forwardRef(({className:e,...t},n)=>s.jsx(xN,{ref:n,className:it(LR(),e),...t}));st.displayName=xN.displayName;const VR=()=>s.jsxs("div",{className:"min-h-screen bg-background",children:[s.jsx(Tu,{}),s.jsx("section",{className:"pt-32 pb-20",children:s.jsx("div",{className:"container px-6",children:s.jsxs("div",{className:"max-w-3xl mx-auto text-center",children:[s.jsx("h1",{className:"font-heading font-bold text-4xl md:text-6xl mb-6",children:"Get in Touch"}),s.jsx("p",{className:"text-lg md:text-xl text-muted-foreground",children:"Have questions? We'd love to hear from you. Send us a message and we'll respond as soon as possible."})]})})}),s.jsx("section",{className:"py-20",children:s.jsx("div",{className:"container px-6",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[s.jsxs(qe,{children:[s.jsxs(vt,{children:[s.jsx(pt,{className:"text-2xl",children:"Send us a message"}),s.jsx(gt,{children:"Fill out the form below and we'll get back to you within 24 hours."})]}),s.jsxs(Xe,{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"firstName",children:"First Name"}),s.jsx(Ft,{id:"firstName",placeholder:"John"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"lastName",children:"Last Name"}),s.jsx(Ft,{id:"lastName",placeholder:"Doe"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"email",children:"Email"}),s.jsx(Ft,{id:"email",type:"email",placeholder:"john@example.com"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"subject",children:"Subject"}),s.jsx(Ft,{id:"subject",placeholder:"How can we help?"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"message",children:"Message"}),s.jsx("textarea",{id:"message",className:"flex min-h-[120px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Tell us more about your inquiry..."})]}),s.jsx(Ie,{size:"lg",className:"w-full",children:"Send Message"})]})]}),s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-heading font-bold text-2xl mb-6",children:"Contact Information"}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-vox-pink/10 flex items-center justify-center",children:s.jsx(gh,{className:"w-6 h-6 text-vox-pink"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:"Email"}),s.jsx("div",{className:"text-muted-foreground",children:"support@voxbox.ai"})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-vox-blue/10 flex items-center justify-center",children:s.jsx(WP,{className:"w-6 h-6 text-vox-blue"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:"Phone"}),s.jsx("div",{className:"text-muted-foreground",children:"+1 (555) 123-4567"})]})]}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-vox-green/10 flex items-center justify-center",children:s.jsx(VP,{className:"w-6 h-6 text-vox-green"})}),s.jsxs("div",{children:[s.jsx("div",{className:"font-semibold",children:"Address"}),s.jsxs("div",{className:"text-muted-foreground",children:["123 Innovation Street",s.jsx("br",{}),"Tech City, TC 12345"]})]})]})]})]}),s.jsxs("div",{className:"bg-muted/50 rounded-lg p-6",children:[s.jsx("h4",{className:"font-heading font-bold text-lg mb-3",children:"Response Time"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"We typically respond to all inquiries within 24 hours during business days."}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Business Hours:"}),s.jsx("span",{className:"font-semibold",children:"Mon-Fri, 9AM-6PM EST"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Weekend Support:"}),s.jsx("span",{className:"font-semibold",children:"Email Only"})]})]})]})]})]})})})}),s.jsx(Ru,{})]}),$u="/assets/login-bg-CfNlXfW6.png",ka="/assets/logo-white-7CHNZiiE.png",BR=()=>{const e=Lt(),{login:t,isLoading:n}=fr(),[r,a]=i.useState({email:"",password:""}),[o,l]=i.useState(""),[c,u]=i.useState({}),[d,g]=i.useState({email:!1,password:!1}),m=x=>{if(!x)return"Email is required";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(x))return"Please enter a valid email address"},p=x=>{if(!x)return"Password is required";if(x.length<6)return"Password must be at least 6 characters"},f=(x,y)=>{let b;switch(x){case"email":b=m(y);break;case"password":b=p(y);break}return u(N=>({...N,[x]:b})),b},w=async x=>{x.preventDefault(),l(""),g({email:!0,password:!0});const y=m(r.email),b=p(r.password);if(u({email:y,password:b}),!(y||b))try{console.log("Attempting login with:",r),await t(r),console.log("Login successful, navigating to appropriate page");const N=Oe.getCurrentUser();if(!N){console.error("User not found after login"),l("Login successful but user data not found. Please try again.");return}a({email:"",password:""}),u({}),g({email:!1,password:!1});try{const{PaymentService:S}=await tr(async()=>{const{PaymentService:k}=await Promise.resolve().then(()=>Mu);return{PaymentService:k}},void 0),j=await S.getUserSubscription(N.id);if(j&&j.hasSubscription)try{const k=await Vi.getWorkspaces();if(k&&k.length>0){console.log("User has subscription and workspace - redirecting to dashboard");const C=sessionStorage.getItem("redirectAfterLogin");C?(sessionStorage.removeItem("redirectAfterLogin"),sessionStorage.removeItem("forceDashboardRedirect"),console.log("Redirecting to saved path:",C),e(C,{replace:!0})):e("/dashboard",{replace:!0})}else console.log("User has subscription but no workspace - redirecting to pricing"),sessionStorage.removeItem("redirectAfterLogin"),sessionStorage.removeItem("forceDashboardRedirect"),e("/pricing",{replace:!0})}catch(k){console.error("Error checking workspaces:",k),sessionStorage.removeItem("redirectAfterLogin"),sessionStorage.removeItem("forceDashboardRedirect"),e("/pricing",{replace:!0})}else console.log("User has no subscription - redirecting to pricing"),sessionStorage.removeItem("redirectAfterLogin"),sessionStorage.removeItem("forceDashboardRedirect"),e("/pricing",{replace:!0})}catch(S){console.error("Error checking subscription:",S);try{const j=await Vi.getWorkspaces();if(j&&j.length>0){console.log("User has workspaces (fallback) - redirecting to dashboard");const k=sessionStorage.getItem("redirectAfterLogin");k?(sessionStorage.removeItem("redirectAfterLogin"),sessionStorage.removeItem("forceDashboardRedirect"),e(k,{replace:!0})):e("/dashboard",{replace:!0})}else console.log("User has no workspaces (fallback) - redirecting to pricing"),sessionStorage.removeItem("redirectAfterLogin"),sessionStorage.removeItem("forceDashboardRedirect"),e("/pricing",{replace:!0})}catch(j){console.error("Error checking workspaces (fallback):",j),sessionStorage.removeItem("redirectAfterLogin"),sessionStorage.removeItem("forceDashboardRedirect"),e("/pricing",{replace:!0})}}}catch(N){console.error("Login error:",N),l(N.message||"Login failed. Please try again.")}},h=x=>{const{name:y,value:b}=x.target;a(N=>({...N,[y]:b})),d[y]&&f(y,b)},v=x=>{const{name:y,value:b}=x.target;g(N=>({...N,[y]:!0})),f(y,b)};return s.jsxs("div",{className:"min-h-screen flex",children:[s.jsxs("div",{className:"hidden lg:flex lg:w-3/5 relative overflow-hidden bg-black",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${$u})`},children:s.jsx("div",{className:"absolute inset-0 bg-black/20"})}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full px-12",children:[s.jsx("div",{className:"mb-12",children:s.jsx("img",{src:ka,alt:"VoxBox Logo",className:"w-28 h-28 object-contain rounded-lg"})}),s.jsx("h1",{className:"text-white text-6xl font-bold mb-6",children:"Welcome to"}),s.jsx("p",{className:"text-white text-3xl font-semibold",children:"VOXBOX"})]})]}),s.jsx("div",{className:"w-full lg:w-2/5 bg-white flex items-center justify-center p-8",children:s.jsxs("div",{className:"w-full px-4",children:[s.jsx("div",{className:"flex justify-center mb-10",children:s.jsx("img",{src:ka,alt:"VoxBox Logo",className:"w-24 h-24 object-contain rounded-lg"})}),s.jsx("h2",{className:"text-3xl font-bold text-left mb-2",children:"Sign In"}),s.jsx("p",{className:"text-gray-600 text-left mb-8",children:"Welcome back! Get back to your account"}),s.jsxs("form",{onSubmit:w,className:"space-y-6",children:[o&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(Ft,{id:"email",name:"email",type:"email",placeholder:"Enter Email",value:r.email,onChange:h,onBlur:v,className:`h-12 rounded-lg border-gray-300 ${c.email&&d.email?"border-red-500 focus-visible:ring-red-500":""}`}),c.email&&d.email&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:c.email})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(Ft,{id:"password",name:"password",type:"password",placeholder:"Enter Password",value:r.password,onChange:h,onBlur:v,className:`h-12 rounded-lg border-gray-300 ${c.password&&d.password?"border-red-500 focus-visible:ring-red-500":""}`}),c.password&&d.password&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:c.password})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[s.jsx("input",{type:"checkbox",className:"rounded border-gray-300"}),s.jsx("span",{className:"text-gray-700",children:"Remember me"})]}),s.jsx(St,{to:"/forgot-password",className:"text-gray-700 hover:underline",children:"Forgot password?"})]}),s.jsx(Ie,{type:"submit",className:"w-full h-12 bg-black text-white hover:bg-gray-900 rounded-lg",size:"lg",disabled:n,children:n?"Signing In...":"Sign In"}),s.jsxs("div",{className:"text-center text-sm text-gray-700",children:["Don't have an Account?"," ",s.jsx(St,{to:"/register",className:"text-black hover:underline font-semibold",children:"Sign up"})]})]})]})})]})},WR=()=>{const e=Lt(),{register:t,isLoading:n}=fr(),[r,a]=i.useState(!1),[o,l]=i.useState(""),[c,u]=i.useState(!1),[d,g]=i.useState(!1),[m,p]=i.useState(!1),[f,w]=i.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),[h,v]=i.useState({}),[x,y]=i.useState({firstName:!1,lastName:!1,email:!1,password:!1,confirmPassword:!1}),b=P=>({minLength:P.length>=8,hasUppercase:/[A-Z]/.test(P),hasLowercase:/[a-z]/.test(P),hasNumber:/[0-9]/.test(P),hasSpecialChar:/[!@#$%^&*]/.test(P)}),N=P=>{if(!P)return"First name is required";if(P.trim().length<2)return"First name must be at least 2 characters"},S=P=>{if(!P)return"Last name is required";if(P.trim().length<2)return"Last name must be at least 2 characters"},j=P=>{if(!P)return"Email is required";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(P))return"Please enter a valid email address"},k=P=>{if(!P)return"Password is required";const K=b(P);if(!K.minLength||!K.hasUppercase||!K.hasLowercase||!K.hasNumber||!K.hasSpecialChar)return"Password does not meet all requirements"},C=(P,K)=>{if(!P)return"Please confirm your password";if(P!==K)return"Passwords do not match"},W=(P,K)=>{let G;switch(P){case"firstName":G=N(K);break;case"lastName":G=S(K);break;case"email":G=j(K);break;case"password":if(G=k(K),x.confirmPassword){const q=C(f.confirmPassword,K);v(A=>({...A,confirmPassword:q}))}break;case"confirmPassword":G=C(K,f.password);break}return v(q=>({...q,[P]:G})),G},B=async P=>{if(P.preventDefault(),l(""),!m){l("Please accept the Terms of Service and Privacy Policy");return}y({firstName:!0,lastName:!0,email:!0,password:!0,confirmPassword:!0});const K=N(f.firstName),G=S(f.lastName),q=j(f.email),A=k(f.password),E=C(f.confirmPassword,f.password);if(v({firstName:K,lastName:G,email:q,password:A,confirmPassword:E}),!(K||G||q||A||E))try{await t({name:`${f.firstName} ${f.lastName}`,email:f.email,password:f.password}),a(!0),localStorage.setItem("isNewUser","true"),setTimeout(()=>{e("/login")},2e3)}catch(R){l(R.message||"Registration failed. Please try again.")}},U=P=>{const{name:K,value:G}=P.target;w(q=>({...q,[K]:G})),x[K]&&W(K,G)},Q=P=>{const{name:K,value:G}=P.target;y(q=>({...q,[K]:!0})),W(K,G)},V=b(f.password);return r?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-20 h-20 rounded-full bg-green-100 flex items-center justify-center mx-auto mb-6",children:s.jsx(ns,{className:"w-10 h-10 text-green-600"})}),s.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Welcome to VoxBox! "}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Your account has been created successfully."})]})}):s.jsxs("div",{className:"min-h-screen flex",children:[s.jsxs("div",{className:"hidden lg:flex lg:w-3/5 relative overflow-hidden bg-black",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${$u})`},children:s.jsx("div",{className:"absolute inset-0 bg-black/20"})}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full px-12",children:[s.jsx("div",{className:"mb-12",children:s.jsx("img",{src:ka,alt:"VoxBox Logo",className:"w-28 h-28 object-contain rounded-lg"})}),s.jsx("h1",{className:"text-white text-6xl font-bold mb-6",children:"Welcome to"}),s.jsx("p",{className:"text-white text-3xl font-semibold",children:"VOXBOX"})]})]}),s.jsx("div",{className:"w-full lg:w-2/5 bg-white flex items-center justify-center p-8",children:s.jsxs("div",{className:"w-full px-4",children:[s.jsx("div",{className:"flex justify-center mb-10",children:s.jsx("img",{src:ka,alt:"VoxBox Logo",className:"w-24 h-24 object-contain rounded-lg"})}),s.jsx("h2",{className:"text-3xl font-bold text-left mb-2",children:"Start Creating With VoxBox"}),s.jsx("p",{className:"text-gray-600 text-left mb-8",children:"Unlock the power of persuasion marketing to connect and convert your ideal prospects"}),s.jsxs("form",{onSubmit:B,className:"space-y-5",children:[o&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("div",{className:"flex-1 space-y-1",children:[s.jsx(Ft,{id:"firstName",name:"firstName",type:"text",placeholder:"Enter First Name",value:f.firstName,onChange:U,onBlur:Q,className:`h-12 rounded-lg border-gray-300 ${h.firstName&&x.firstName?"border-red-500 focus-visible:ring-red-500":""}`}),h.firstName&&x.firstName&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:h.firstName})]}),s.jsxs("div",{className:"flex-1 space-y-1",children:[s.jsx(Ft,{id:"lastName",name:"lastName",type:"text",placeholder:"Enter Last Name",value:f.lastName,onChange:U,onBlur:Q,className:`h-12 rounded-lg border-gray-300 ${h.lastName&&x.lastName?"border-red-500 focus-visible:ring-red-500":""}`}),h.lastName&&x.lastName&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:h.lastName})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(Ft,{id:"email",name:"email",type:"email",placeholder:"Enter Email",value:f.email,onChange:U,onBlur:Q,className:`h-12 rounded-lg border-gray-300 ${h.email&&x.email?"border-red-500 focus-visible:ring-red-500":""}`}),h.email&&x.email&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:h.email})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ft,{id:"password",name:"password",type:c?"text":"password",placeholder:"Enter Password",value:f.password,onChange:U,onBlur:Q,className:`h-12 rounded-lg border-gray-300 pr-10 ${h.password&&x.password?"border-red-500 focus-visible:ring-red-500":""}`}),s.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:c?s.jsx(Ig,{className:"w-5 h-5"}):s.jsx(Tg,{className:"w-5 h-5"})})]}),h.password&&x.password&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:h.password}),f.password&&s.jsxs("div",{className:"mt-3 space-y-1.5",children:[s.jsxs("div",{className:`flex items-center gap-2 text-sm ${V.minLength?"text-green-600":"text-red-600"}`,children:[V.minLength?s.jsx(ns,{className:"w-4 h-4"}):s.jsx(Es,{className:"w-4 h-4"}),s.jsx("span",{children:"At least 8 characters"})]}),s.jsxs("div",{className:`flex items-center gap-2 text-sm ${V.hasUppercase?"text-green-600":"text-red-600"}`,children:[V.hasUppercase?s.jsx(ns,{className:"w-4 h-4"}):s.jsx(Es,{className:"w-4 h-4"}),s.jsx("span",{children:"Contains uppercase letter"})]}),s.jsxs("div",{className:`flex items-center gap-2 text-sm ${V.hasLowercase?"text-green-600":"text-red-600"}`,children:[V.hasLowercase?s.jsx(ns,{className:"w-4 h-4"}):s.jsx(Es,{className:"w-4 h-4"}),s.jsx("span",{children:"Contains lowercase letter"})]}),s.jsxs("div",{className:`flex items-center gap-2 text-sm ${V.hasNumber?"text-green-600":"text-red-600"}`,children:[V.hasNumber?s.jsx(ns,{className:"w-4 h-4"}):s.jsx(Es,{className:"w-4 h-4"}),s.jsx("span",{children:"Contains a number"})]}),s.jsxs("div",{className:`flex items-center gap-2 text-sm ${V.hasSpecialChar?"text-green-600":"text-red-600"}`,children:[V.hasSpecialChar?s.jsx(ns,{className:"w-4 h-4"}):s.jsx(Es,{className:"w-4 h-4"}),s.jsx("span",{children:"Contains special character (!@#$%^&*)"})]})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{className:"relative",children:[s.jsx(Ft,{id:"confirmPassword",name:"confirmPassword",type:d?"text":"password",placeholder:"Confirm your password",value:f.confirmPassword,onChange:U,onBlur:Q,className:`h-12 rounded-lg border-gray-300 pr-10 ${h.confirmPassword&&x.confirmPassword?"border-red-500 focus-visible:ring-red-500":""}`}),s.jsx("button",{type:"button",onClick:()=>g(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:d?s.jsx(Ig,{className:"w-5 h-5"}):s.jsx(Tg,{className:"w-5 h-5"})})]}),h.confirmPassword&&x.confirmPassword&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:h.confirmPassword})]}),s.jsxs("div",{className:"flex items-start gap-2",children:[s.jsx("input",{type:"checkbox",id:"terms",checked:m,onChange:P=>p(P.target.checked),className:"mt-1 rounded border-gray-300"}),s.jsxs("label",{htmlFor:"terms",className:"text-sm text-gray-700 cursor-pointer",children:["by signing up you accept the"," ",s.jsx(St,{to:"/terms",className:"text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",s.jsx(St,{to:"/privacy",className:"text-blue-600 hover:underline",children:"Privacy Policy"})]})]}),s.jsx(Ie,{type:"submit",className:"w-full h-12 bg-black text-white hover:bg-gray-900 rounded-lg",size:"lg",disabled:n,children:n?"Creating Account...":"Create Account"}),s.jsxs("div",{className:"text-center text-sm text-gray-700",children:["Already have an Account?"," ",s.jsx(St,{to:"/login",className:"text-black hover:underline font-semibold",children:"Sign In"})]})]})]})})]})},UR=()=>{const e=Lt(),[t,n]=i.useState(""),[r,a]=i.useState(!1),[o,l]=i.useState(""),[c,u]=i.useState(!1),[d,g]=i.useState({}),[m,p]=i.useState(!1),f=y=>{if(!y)return"Email is required";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y))return"Please enter a valid email address"},w=y=>{const b=f(y);return g({email:b}),b},h=async y=>{y.preventDefault(),l(""),p(!0);const b=f(t);if(g({email:b}),!b){a(!0);try{await Oe.forgotPassword(t),u(!0)}catch(N){console.error("Forgot password error:",N),l(N.message||"Failed to send reset email. Please try again.")}finally{a(!1)}}},v=y=>{const b=y.target.value;n(b),m&&w(b)},x=y=>{p(!0),w(y.target.value)};return c?s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center p-4",children:s.jsx(qe,{className:"w-full max-w-md",children:s.jsxs(Xe,{className:"text-center py-12",children:[s.jsx("div",{className:"w-20 h-20 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto mb-6",children:s.jsx(gh,{className:"w-10 h-10 text-green-600 dark:text-green-400"})}),s.jsx("h2",{className:"text-2xl font-bold font-heading mb-2",children:"Check Your Email"}),s.jsxs("p",{className:"text-muted-foreground mb-6",children:["We've sent a password reset link to ",s.jsx("strong",{children:t}),". Please check your inbox and follow the instructions to reset your password."]}),s.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"Didn't receive the email? Check your spam folder or try again."}),s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ie,{onClick:()=>u(!1),variant:"outline",className:"w-full",children:"Try Another Email"}),s.jsx(Ie,{onClick:()=>e("/login"),className:"w-full",children:"Back to Login"})]})]})})}):s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center p-4",children:s.jsxs(qe,{className:"w-full max-w-md",children:[s.jsxs(vt,{className:"text-center",children:[s.jsxs("div",{className:"flex justify-center items-center gap-3 mb-4",children:[s.jsx("img",{src:sl,alt:"VoxBox Logo",className:"h-12"}),s.jsx("span",{className:"font-heading font-bold text-3xl",children:"VOXBOX"})]}),s.jsx(pt,{className:"text-2xl",children:"Forgot Password?"}),s.jsx(gt,{children:"No worries! Enter your email address and we'll send you a link to reset your password."})]}),s.jsx(Xe,{children:s.jsxs("form",{onSubmit:h,className:"space-y-4",children:[o&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:o}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"email",children:"Email Address"}),s.jsx(Ft,{id:"email",name:"email",type:"email",placeholder:"john@example.com",value:t,onChange:v,onBlur:x,className:d.email&&m?"border-red-500 focus-visible:ring-red-500":""}),d.email&&m&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:d.email})]}),s.jsx(Ie,{type:"submit",className:"w-full",size:"lg",disabled:r,children:r?"Sending...":"Send Reset Link"}),s.jsx("div",{className:"text-center",children:s.jsxs(St,{to:"/login",className:"text-sm text-muted-foreground hover:text-primary inline-flex items-center gap-2",children:[s.jsx(Os,{className:"w-4 h-4"}),"Back to Login"]})})]})})]})})},zR=()=>{const e=Lt(),[t]=cu(),n=t.get("token"),[r,a]=i.useState({password:"",confirmPassword:""}),[o,l]=i.useState(!1),[c,u]=i.useState(""),[d,g]=i.useState(!1),[m,p]=i.useState({}),[f,w]=i.useState({password:!1,confirmPassword:!1});i.useEffect(()=>{n||u("Invalid or missing reset token. Please request a new password reset link.")},[n]);const h=S=>{if(!S)return"Password is required";if(S.length<8)return"Password must be at least 8 characters";if(S.length>128)return"Password must not exceed 128 characters";if(!/[a-z]/.test(S))return"Password must contain at least one lowercase letter";if(!/[A-Z]/.test(S))return"Password must contain at least one uppercase letter";if(!/[0-9]/.test(S))return"Password must contain at least one number"},v=(S,j)=>{if(!S)return"Please confirm your password";if(S!==j)return"Passwords do not match"},x=(S,j)=>{let k;switch(S){case"password":if(k=h(j),f.confirmPassword){const C=v(r.confirmPassword,j);p(W=>({...W,confirmPassword:C}))}break;case"confirmPassword":k=v(j,r.password);break}return p(C=>({...C,[S]:k})),k},y=async S=>{if(S.preventDefault(),u(""),!n){u("Invalid or missing reset token. Please request a new password reset link.");return}w({password:!0,confirmPassword:!0});const j=h(r.password),k=v(r.confirmPassword,r.password);if(p({password:j,confirmPassword:k}),!(j||k)){l(!0);try{await Oe.resetPassword(n,r.password),g(!0),setTimeout(()=>{e("/login")},3e3)}catch(C){console.error("Reset password error:",C),u(C.message||"Failed to reset password. The link may have expired. Please try again.")}finally{l(!1)}}},b=S=>{const{name:j,value:k}=S.target;a(C=>({...C,[j]:k})),f[j]&&x(j,k)},N=S=>{const{name:j,value:k}=S.target;w(C=>({...C,[j]:!0})),x(j,k)};return d?s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center p-4",children:s.jsx(qe,{className:"w-full max-w-md",children:s.jsxs(Xe,{className:"text-center py-12",children:[s.jsx("div",{className:"w-20 h-20 rounded-full bg-green-100 dark:bg-green-900/30 flex items-center justify-center mx-auto mb-6",children:s.jsx(ns,{className:"w-10 h-10 text-green-600 dark:text-green-400"})}),s.jsx("h2",{className:"text-2xl font-bold font-heading mb-2",children:"Password Reset Successful!"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Your password has been reset successfully. You can now log in with your new password."}),s.jsx(Ie,{onClick:()=>e("/login"),className:"w-full",size:"lg",children:"Go to Login"})]})})}):s.jsx("div",{className:"min-h-screen bg-gradient-hero flex items-center justify-center p-4",children:s.jsxs(qe,{className:"w-full max-w-md",children:[s.jsxs(vt,{className:"text-center",children:[s.jsxs("div",{className:"flex justify-center items-center gap-3 mb-4",children:[s.jsx("img",{src:sl,alt:"VoxBox Logo",className:"h-12"}),s.jsx("span",{className:"font-heading font-bold text-3xl",children:"VOXBOX"})]}),s.jsx(pt,{className:"text-2xl",children:"Reset Your Password"}),s.jsx(gt,{children:"Enter your new password below. Make sure it's strong and secure."})]}),s.jsx(Xe,{children:s.jsxs("form",{onSubmit:y,className:"space-y-4",children:[c&&s.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm flex items-start gap-2",children:[s.jsx(ph,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),s.jsx("span",{children:c})]}),!n&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-lg text-sm",children:"The reset link appears to be invalid. Please request a new password reset."}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"password",children:"New Password"}),s.jsx(Ft,{id:"password",name:"password",type:"password",placeholder:"",value:r.password,onChange:b,onBlur:N,disabled:!n,className:m.password&&f.password?"border-red-500 focus-visible:ring-red-500":""}),m.password&&f.password&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:m.password}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Must be 8+ characters with uppercase, lowercase, and number"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"confirmPassword",children:"Confirm New Password"}),s.jsx(Ft,{id:"confirmPassword",name:"confirmPassword",type:"password",placeholder:"",value:r.confirmPassword,onChange:b,onBlur:N,disabled:!n,className:m.confirmPassword&&f.confirmPassword?"border-red-500 focus-visible:ring-red-500":""}),m.confirmPassword&&f.confirmPassword&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:m.confirmPassword})]}),s.jsx(Ie,{type:"submit",className:"w-full",size:"lg",disabled:o||!n,children:o?"Resetting Password...":"Reset Password"})]})})]})})};function lx(e,[t,n]){return Math.min(n,Math.max(t,e))}function HR(e){const t=QR(e),n=i.forwardRef((r,a)=>{const{children:o,...l}=r,c=i.Children.toArray(o),u=c.find(qR);if(u){const d=u.props.children,g=c.map(m=>m===u?i.Children.count(d)>1?i.Children.only(null):i.isValidElement(d)?d.props.children:null:m);return s.jsx(t,{...l,ref:a,children:i.isValidElement(d)?i.cloneElement(d,void 0,g):null})}return s.jsx(t,{...l,ref:a,children:o})});return n.displayName=`${e}.Slot`,n}function QR(e){const t=i.forwardRef((n,r)=>{const{children:a,...o}=n;if(i.isValidElement(a)){const l=JR(a),c=YR(o,a.props);return a.type!==i.Fragment&&(c.ref=r?hr(r,l):l),i.cloneElement(a,c)}return i.Children.count(a)>1?i.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var GR=Symbol("radix.slottable");function qR(e){return i.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===GR}function YR(e,t){const n={...t};for(const r in t){const a=e[r],o=t[r];/^on[A-Z]/.test(r)?a&&o?n[r]=(...c)=>{const u=o(...c);return a(...c),u}:a&&(n[r]=a):r==="style"?n[r]={...a,...o}:r==="className"&&(n[r]=[a,o].filter(Boolean).join(" "))}return{...e,...n}}function JR(e){var r,a;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(a=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:a.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function KR(e){const t=i.useRef({value:e,previous:e});return i.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var vN=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),XR="VisuallyHidden",ZR=i.forwardRef((e,t)=>s.jsx(kt.span,{...e,ref:t,style:{...vN,...e.style}}));ZR.displayName=XR;var eM=[" ","Enter","ArrowUp","ArrowDown"],tM=[" ","Enter"],Pa="Select",[Du,Ou,sM]=pu(Pa),[Do]=Qn(Pa,[sM,ju]),Fu=ju(),[nM,Zr]=Do(Pa),[rM,aM]=Do(Pa),yN=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:a,onOpenChange:o,value:l,defaultValue:c,onValueChange:u,dir:d,name:g,autoComplete:m,disabled:p,required:f,form:w}=e,h=Fu(t),[v,x]=i.useState(null),[y,b]=i.useState(null),[N,S]=i.useState(!1),j=gu(d),[k,C]=Hr({prop:r,defaultProp:a??!1,onChange:o,caller:Pa}),[W,B]=Hr({prop:l,defaultProp:c,onChange:u,caller:Pa}),U=i.useRef(null),Q=v?w||!!v.closest("form"):!0,[V,P]=i.useState(new Set),K=Array.from(V).map(G=>G.props.value).join(";");return s.jsx(ub,{...h,children:s.jsxs(nM,{required:f,scope:t,trigger:v,onTriggerChange:x,valueNode:y,onValueNodeChange:b,valueNodeHasChildren:N,onValueNodeHasChildrenChange:S,contentId:Sn(),value:W,onValueChange:B,open:k,onOpenChange:C,dir:j,triggerPointerDownPosRef:U,disabled:p,children:[s.jsx(Du.Provider,{scope:t,children:s.jsx(rM,{scope:e.__scopeSelect,onNativeOptionAdd:i.useCallback(G=>{P(q=>new Set(q).add(G))},[]),onNativeOptionRemove:i.useCallback(G=>{P(q=>{const A=new Set(q);return A.delete(G),A})},[]),children:n})}),Q?s.jsxs(UN,{"aria-hidden":!0,required:f,tabIndex:-1,name:g,autoComplete:m,value:W,onChange:G=>B(G.target.value),disabled:p,form:w,children:[W===void 0?s.jsx("option",{value:""}):null,Array.from(V)]},K):null]})})};yN.displayName=Pa;var wN="SelectTrigger",bN=i.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...a}=e,o=Fu(n),l=Zr(wN,n),c=l.disabled||r,u=_t(t,l.onTriggerChange),d=Ou(n),g=i.useRef("touch"),[m,p,f]=HN(h=>{const v=d().filter(b=>!b.disabled),x=v.find(b=>b.value===l.value),y=QN(v,h,x);y!==void 0&&l.onValueChange(y.value)}),w=h=>{c||(l.onOpenChange(!0),f()),h&&(l.triggerPointerDownPosRef.current={x:Math.round(h.pageX),y:Math.round(h.pageY)})};return s.jsx(db,{asChild:!0,...o,children:s.jsx(kt.button,{type:"button",role:"combobox","aria-controls":l.contentId,"aria-expanded":l.open,"aria-required":l.required,"aria-autocomplete":"none",dir:l.dir,"data-state":l.open?"open":"closed",disabled:c,"data-disabled":c?"":void 0,"data-placeholder":zN(l.value)?"":void 0,...a,ref:u,onClick:ot(a.onClick,h=>{h.currentTarget.focus(),g.current!=="mouse"&&w(h)}),onPointerDown:ot(a.onPointerDown,h=>{g.current=h.pointerType;const v=h.target;v.hasPointerCapture(h.pointerId)&&v.releasePointerCapture(h.pointerId),h.button===0&&h.ctrlKey===!1&&h.pointerType==="mouse"&&(w(h),h.preventDefault())}),onKeyDown:ot(a.onKeyDown,h=>{const v=m.current!=="";!(h.ctrlKey||h.altKey||h.metaKey)&&h.key.length===1&&p(h.key),!(v&&h.key===" ")&&eM.includes(h.key)&&(w(),h.preventDefault())})})})});bN.displayName=wN;var NN="SelectValue",jN=i.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,children:o,placeholder:l="",...c}=e,u=Zr(NN,n),{onValueNodeHasChildrenChange:d}=u,g=o!==void 0,m=_t(t,u.onValueNodeChange);return ks(()=>{d(g)},[d,g]),s.jsx(kt.span,{...c,ref:m,style:{pointerEvents:"none"},children:zN(u.value)?s.jsx(s.Fragment,{children:l}):o})});jN.displayName=NN;var oM="SelectIcon",SN=i.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...a}=e;return s.jsx(kt.span,{"aria-hidden":!0,...a,ref:t,children:r||""})});SN.displayName=oM;var iM="SelectPortal",kN=e=>s.jsx(Su,{asChild:!0,...e});kN.displayName=iM;var Aa="SelectContent",PN=i.forwardRef((e,t)=>{const n=Zr(Aa,e.__scopeSelect),[r,a]=i.useState();if(ks(()=>{a(new DocumentFragment)},[]),!n.open){const o=r;return o?Eo.createPortal(s.jsx(AN,{scope:e.__scopeSelect,children:s.jsx(Du.Slot,{scope:e.__scopeSelect,children:s.jsx("div",{children:e.children})})}),o):null}return s.jsx(CN,{...e,ref:t})});PN.displayName=Aa;var vn=10,[AN,ea]=Do(Aa),lM="SelectContentImpl",cM=HR("SelectContent.RemoveScroll"),CN=i.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:a,onEscapeKeyDown:o,onPointerDownOutside:l,side:c,sideOffset:u,align:d,alignOffset:g,arrowPadding:m,collisionBoundary:p,collisionPadding:f,sticky:w,hideWhenDetached:h,avoidCollisions:v,...x}=e,y=Zr(Aa,n),[b,N]=i.useState(null),[S,j]=i.useState(null),k=_t(t,T=>N(T)),[C,W]=i.useState(null),[B,U]=i.useState(null),Q=Ou(n),[V,P]=i.useState(!1),K=i.useRef(!1);i.useEffect(()=>{if(b)return Ch(b)},[b]),yh();const G=i.useCallback(T=>{const[ie,...Z]=Q().map(z=>z.ref.current),[le]=Z.slice(-1),oe=document.activeElement;for(const z of T)if(z===oe||(z==null||z.scrollIntoView({block:"nearest"}),z===ie&&S&&(S.scrollTop=0),z===le&&S&&(S.scrollTop=S.scrollHeight),z==null||z.focus(),document.activeElement!==oe))return},[Q,S]),q=i.useCallback(()=>G([C,b]),[G,C,b]);i.useEffect(()=>{V&&q()},[V,q]);const{onOpenChange:A,triggerPointerDownPosRef:E}=y;i.useEffect(()=>{if(b){let T={x:0,y:0};const ie=le=>{var oe,z;T={x:Math.abs(Math.round(le.pageX)-(((oe=E.current)==null?void 0:oe.x)??0)),y:Math.abs(Math.round(le.pageY)-(((z=E.current)==null?void 0:z.y)??0))}},Z=le=>{T.x<=10&&T.y<=10?le.preventDefault():b.contains(le.target)||A(!1),document.removeEventListener("pointermove",ie),E.current=null};return E.current!==null&&(document.addEventListener("pointermove",ie),document.addEventListener("pointerup",Z,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ie),document.removeEventListener("pointerup",Z,{capture:!0})}}},[b,A,E]),i.useEffect(()=>{const T=()=>A(!1);return window.addEventListener("blur",T),window.addEventListener("resize",T),()=>{window.removeEventListener("blur",T),window.removeEventListener("resize",T)}},[A]);const[R,L]=HN(T=>{const ie=Q().filter(oe=>!oe.disabled),Z=ie.find(oe=>oe.ref.current===document.activeElement),le=QN(ie,T,Z);le&&setTimeout(()=>le.ref.current.focus())}),I=i.useCallback((T,ie,Z)=>{const le=!K.current&&!Z;(y.value!==void 0&&y.value===ie||le)&&(W(T),le&&(K.current=!0))},[y.value]),_=i.useCallback(()=>b==null?void 0:b.focus(),[b]),$=i.useCallback((T,ie,Z)=>{const le=!K.current&&!Z;(y.value!==void 0&&y.value===ie||le)&&U(T)},[y.value]),F=r==="popper"?nf:EN,M=F===nf?{side:c,sideOffset:u,align:d,alignOffset:g,arrowPadding:m,collisionBoundary:p,collisionPadding:f,sticky:w,hideWhenDetached:h,avoidCollisions:v}:{};return s.jsx(AN,{scope:n,content:b,viewport:S,onViewportChange:j,itemRefCallback:I,selectedItem:C,onItemLeave:_,itemTextRefCallback:$,focusSelectedItem:q,selectedItemText:B,position:r,isPositioned:V,searchRef:R,children:s.jsx(Pu,{as:cM,allowPinchZoom:!0,children:s.jsx(vu,{asChild:!0,trapped:y.open,onMountAutoFocus:T=>{T.preventDefault()},onUnmountAutoFocus:ot(a,T=>{var ie;(ie=y.trigger)==null||ie.focus({preventScroll:!0}),T.preventDefault()}),children:s.jsx(xu,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:T=>T.preventDefault(),onDismiss:()=>y.onOpenChange(!1),children:s.jsx(F,{role:"listbox",id:y.contentId,"data-state":y.open?"open":"closed",dir:y.dir,onContextMenu:T=>T.preventDefault(),...x,...M,onPlaced:()=>P(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:ot(x.onKeyDown,T=>{const ie=T.ctrlKey||T.altKey||T.metaKey;if(T.key==="Tab"&&T.preventDefault(),!ie&&T.key.length===1&&L(T.key),["ArrowUp","ArrowDown","Home","End"].includes(T.key)){let le=Q().filter(oe=>!oe.disabled).map(oe=>oe.ref.current);if(["ArrowUp","End"].includes(T.key)&&(le=le.slice().reverse()),["ArrowUp","ArrowDown"].includes(T.key)){const oe=T.target,z=le.indexOf(oe);le=le.slice(z+1)}setTimeout(()=>G(le)),T.preventDefault()}})})})})})})});CN.displayName=lM;var uM="SelectItemAlignedPosition",EN=i.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...a}=e,o=Zr(Aa,n),l=ea(Aa,n),[c,u]=i.useState(null),[d,g]=i.useState(null),m=_t(t,k=>g(k)),p=Ou(n),f=i.useRef(!1),w=i.useRef(!0),{viewport:h,selectedItem:v,selectedItemText:x,focusSelectedItem:y}=l,b=i.useCallback(()=>{if(o.trigger&&o.valueNode&&c&&d&&h&&v&&x){const k=o.trigger.getBoundingClientRect(),C=d.getBoundingClientRect(),W=o.valueNode.getBoundingClientRect(),B=x.getBoundingClientRect();if(o.dir!=="rtl"){const oe=B.left-C.left,z=W.left-oe,ee=k.left-z,ne=k.width+ee,me=Math.max(ne,C.width),ve=window.innerWidth-vn,D=lx(z,[vn,Math.max(vn,ve-me)]);c.style.minWidth=ne+"px",c.style.left=D+"px"}else{const oe=C.right-B.right,z=window.innerWidth-W.right-oe,ee=window.innerWidth-k.right-z,ne=k.width+ee,me=Math.max(ne,C.width),ve=window.innerWidth-vn,D=lx(z,[vn,Math.max(vn,ve-me)]);c.style.minWidth=ne+"px",c.style.right=D+"px"}const U=p(),Q=window.innerHeight-vn*2,V=h.scrollHeight,P=window.getComputedStyle(d),K=parseInt(P.borderTopWidth,10),G=parseInt(P.paddingTop,10),q=parseInt(P.borderBottomWidth,10),A=parseInt(P.paddingBottom,10),E=K+G+V+A+q,R=Math.min(v.offsetHeight*5,E),L=window.getComputedStyle(h),I=parseInt(L.paddingTop,10),_=parseInt(L.paddingBottom,10),$=k.top+k.height/2-vn,F=Q-$,M=v.offsetHeight/2,T=v.offsetTop+M,ie=K+G+T,Z=E-ie;if(ie<=$){const oe=U.length>0&&v===U[U.length-1].ref.current;c.style.bottom="0px";const z=d.clientHeight-h.offsetTop-h.offsetHeight,ee=Math.max(F,M+(oe?_:0)+z+q),ne=ie+ee;c.style.height=ne+"px"}else{const oe=U.length>0&&v===U[0].ref.current;c.style.top="0px";const ee=Math.max($,K+h.offsetTop+(oe?I:0)+M)+Z;c.style.height=ee+"px",h.scrollTop=ie-$+h.offsetTop}c.style.margin=`${vn}px 0`,c.style.minHeight=R+"px",c.style.maxHeight=Q+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[p,o.trigger,o.valueNode,c,d,h,v,x,o.dir,r]);ks(()=>b(),[b]);const[N,S]=i.useState();ks(()=>{d&&S(window.getComputedStyle(d).zIndex)},[d]);const j=i.useCallback(k=>{k&&w.current===!0&&(b(),y==null||y(),w.current=!1)},[b,y]);return s.jsx(mM,{scope:n,contentWrapper:c,shouldExpandOnScrollRef:f,onScrollButtonChange:j,children:s.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:N},children:s.jsx(kt.div,{...a,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...a.style}})})})});EN.displayName=uM;var dM="SelectPopperPosition",nf=i.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:a=vn,...o}=e,l=Fu(n);return s.jsx(mb,{...l,...o,ref:t,align:r,collisionPadding:a,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});nf.displayName=dM;var[mM,zh]=Do(Aa,{}),rf="SelectViewport",IN=i.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...a}=e,o=ea(rf,n),l=zh(rf,n),c=_t(t,o.onViewportChange),u=i.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),s.jsx(Du.Slot,{scope:n,children:s.jsx(kt.div,{"data-radix-select-viewport":"",role:"presentation",...a,ref:c,style:{position:"relative",flex:1,overflow:"hidden auto",...a.style},onScroll:ot(a.onScroll,d=>{const g=d.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:p}=l;if(p!=null&&p.current&&m){const f=Math.abs(u.current-g.scrollTop);if(f>0){const w=window.innerHeight-vn*2,h=parseFloat(m.style.minHeight),v=parseFloat(m.style.height),x=Math.max(h,v);if(x<w){const y=x+f,b=Math.min(w,y),N=y-b;m.style.height=b+"px",m.style.bottom==="0px"&&(g.scrollTop=N>0?N:0,m.style.justifyContent="flex-end")}}}u.current=g.scrollTop})})})]})});IN.displayName=rf;var TN="SelectGroup",[fM,hM]=Do(TN),pM=i.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Sn();return s.jsx(fM,{scope:n,id:a,children:s.jsx(kt.div,{role:"group","aria-labelledby":a,...r,ref:t})})});pM.displayName=TN;var RN="SelectLabel",MN=i.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=hM(RN,n);return s.jsx(kt.div,{id:a.id,...r,ref:t})});MN.displayName=RN;var Lc="SelectItem",[gM,$N]=Do(Lc),DN=i.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:a=!1,textValue:o,...l}=e,c=Zr(Lc,n),u=ea(Lc,n),d=c.value===r,[g,m]=i.useState(o??""),[p,f]=i.useState(!1),w=_t(t,y=>{var b;return(b=u.itemRefCallback)==null?void 0:b.call(u,y,r,a)}),h=Sn(),v=i.useRef("touch"),x=()=>{a||(c.onValueChange(r),c.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(gM,{scope:n,value:r,disabled:a,textId:h,isSelected:d,onItemTextChange:i.useCallback(y=>{m(b=>b||((y==null?void 0:y.textContent)??"").trim())},[]),children:s.jsx(Du.ItemSlot,{scope:n,value:r,disabled:a,textValue:g,children:s.jsx(kt.div,{role:"option","aria-labelledby":h,"data-highlighted":p?"":void 0,"aria-selected":d&&p,"data-state":d?"checked":"unchecked","aria-disabled":a||void 0,"data-disabled":a?"":void 0,tabIndex:a?void 0:-1,...l,ref:w,onFocus:ot(l.onFocus,()=>f(!0)),onBlur:ot(l.onBlur,()=>f(!1)),onClick:ot(l.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:ot(l.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:ot(l.onPointerDown,y=>{v.current=y.pointerType}),onPointerMove:ot(l.onPointerMove,y=>{var b;v.current=y.pointerType,a?(b=u.onItemLeave)==null||b.call(u):v.current==="mouse"&&y.currentTarget.focus({preventScroll:!0})}),onPointerLeave:ot(l.onPointerLeave,y=>{var b;y.currentTarget===document.activeElement&&((b=u.onItemLeave)==null||b.call(u))}),onKeyDown:ot(l.onKeyDown,y=>{var N;((N=u.searchRef)==null?void 0:N.current)!==""&&y.key===" "||(tM.includes(y.key)&&x(),y.key===" "&&y.preventDefault())})})})})});DN.displayName=Lc;var oi="SelectItemText",ON=i.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:a,...o}=e,l=Zr(oi,n),c=ea(oi,n),u=$N(oi,n),d=aM(oi,n),[g,m]=i.useState(null),p=_t(t,x=>m(x),u.onItemTextChange,x=>{var y;return(y=c.itemTextRefCallback)==null?void 0:y.call(c,x,u.value,u.disabled)}),f=g==null?void 0:g.textContent,w=i.useMemo(()=>s.jsx("option",{value:u.value,disabled:u.disabled,children:f},u.value),[u.disabled,u.value,f]),{onNativeOptionAdd:h,onNativeOptionRemove:v}=d;return ks(()=>(h(w),()=>v(w)),[h,v,w]),s.jsxs(s.Fragment,{children:[s.jsx(kt.span,{id:u.textId,...o,ref:p}),u.isSelected&&l.valueNode&&!l.valueNodeHasChildren?Eo.createPortal(o.children,l.valueNode):null]})});ON.displayName=oi;var FN="SelectItemIndicator",_N=i.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return $N(FN,n).isSelected?s.jsx(kt.span,{"aria-hidden":!0,...r,ref:t}):null});_N.displayName=FN;var af="SelectScrollUpButton",LN=i.forwardRef((e,t)=>{const n=ea(af,e.__scopeSelect),r=zh(af,e.__scopeSelect),[a,o]=i.useState(!1),l=_t(t,r.onScrollButtonChange);return ks(()=>{if(n.viewport&&n.isPositioned){let c=function(){const d=u.scrollTop>0;o(d)};const u=n.viewport;return c(),u.addEventListener("scroll",c),()=>u.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?s.jsx(BN,{...e,ref:l,onAutoScroll:()=>{const{viewport:c,selectedItem:u}=n;c&&u&&(c.scrollTop=c.scrollTop-u.offsetHeight)}}):null});LN.displayName=af;var of="SelectScrollDownButton",VN=i.forwardRef((e,t)=>{const n=ea(of,e.__scopeSelect),r=zh(of,e.__scopeSelect),[a,o]=i.useState(!1),l=_t(t,r.onScrollButtonChange);return ks(()=>{if(n.viewport&&n.isPositioned){let c=function(){const d=u.scrollHeight-u.clientHeight,g=Math.ceil(u.scrollTop)<d;o(g)};const u=n.viewport;return c(),u.addEventListener("scroll",c),()=>u.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),a?s.jsx(BN,{...e,ref:l,onAutoScroll:()=>{const{viewport:c,selectedItem:u}=n;c&&u&&(c.scrollTop=c.scrollTop+u.offsetHeight)}}):null});VN.displayName=of;var BN=i.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...a}=e,o=ea("SelectScrollButton",n),l=i.useRef(null),c=Ou(n),u=i.useCallback(()=>{l.current!==null&&(window.clearInterval(l.current),l.current=null)},[]);return i.useEffect(()=>()=>u(),[u]),ks(()=>{var g;const d=c().find(m=>m.ref.current===document.activeElement);(g=d==null?void 0:d.ref.current)==null||g.scrollIntoView({block:"nearest"})},[c]),s.jsx(kt.div,{"aria-hidden":!0,...a,ref:t,style:{flexShrink:0,...a.style},onPointerDown:ot(a.onPointerDown,()=>{l.current===null&&(l.current=window.setInterval(r,50))}),onPointerMove:ot(a.onPointerMove,()=>{var d;(d=o.onItemLeave)==null||d.call(o),l.current===null&&(l.current=window.setInterval(r,50))}),onPointerLeave:ot(a.onPointerLeave,()=>{u()})})}),xM="SelectSeparator",WN=i.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return s.jsx(kt.div,{"aria-hidden":!0,...r,ref:t})});WN.displayName=xM;var lf="SelectArrow",vM=i.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,a=Fu(n),o=Zr(lf,n),l=ea(lf,n);return o.open&&l.position==="popper"?s.jsx(fb,{...a,...r,ref:t}):null});vM.displayName=lf;var yM="SelectBubbleInput",UN=i.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const a=i.useRef(null),o=_t(r,a),l=KR(t);return i.useEffect(()=>{const c=a.current;if(!c)return;const u=window.HTMLSelectElement.prototype,g=Object.getOwnPropertyDescriptor(u,"value").set;if(l!==t&&g){const m=new Event("change",{bubbles:!0});g.call(c,t),c.dispatchEvent(m)}},[l,t]),s.jsx(kt.select,{...n,style:{...vN,...n.style},ref:o,defaultValue:t})});UN.displayName=yM;function zN(e){return e===""||e===void 0}function HN(e){const t=Un(e),n=i.useRef(""),r=i.useRef(0),a=i.useCallback(l=>{const c=n.current+l;t(c),function u(d){n.current=d,window.clearTimeout(r.current),d!==""&&(r.current=window.setTimeout(()=>u(""),1e3))}(c)},[t]),o=i.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return i.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,a,o]}function QN(e,t,n){const a=t.length>1&&Array.from(t).every(d=>d===t[0])?t[0]:t,o=n?e.indexOf(n):-1;let l=wM(e,Math.max(o,0));a.length===1&&(l=l.filter(d=>d!==n));const u=l.find(d=>d.textValue.toLowerCase().startsWith(a.toLowerCase()));return u!==n?u:void 0}function wM(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var bM=yN,GN=bN,NM=jN,jM=SN,SM=kN,qN=PN,kM=IN,YN=MN,JN=DN,PM=ON,AM=_N,KN=LN,XN=VN,ZN=WN;const $t=bM,Dt=NM,Et=i.forwardRef(({className:e,children:t,...n},r)=>s.jsxs(GN,{ref:r,className:it("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,s.jsx(jM,{asChild:!0,children:s.jsx(Gs,{className:"h-4 w-4 opacity-50"})})]}));Et.displayName=GN.displayName;const ej=i.forwardRef(({className:e,...t},n)=>s.jsx(KN,{ref:n,className:it("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(Hn,{className:"h-4 w-4"})}));ej.displayName=KN.displayName;const tj=i.forwardRef(({className:e,...t},n)=>s.jsx(XN,{ref:n,className:it("flex cursor-default items-center justify-center py-1",e),...t,children:s.jsx(Gs,{className:"h-4 w-4"})}));tj.displayName=XN.displayName;const It=i.forwardRef(({className:e,children:t,position:n="popper",...r},a)=>s.jsx(SM,{children:s.jsxs(qN,{ref:a,className:it("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[s.jsx(ej,{}),s.jsx(kM,{className:it("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),s.jsx(tj,{})]})}));It.displayName=qN.displayName;const CM=i.forwardRef(({className:e,...t},n)=>s.jsx(YN,{ref:n,className:it("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));CM.displayName=YN.displayName;const Tt=i.forwardRef(({className:e,children:t,...n},r)=>s.jsxs(JN,{ref:r,className:it("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(AM,{children:s.jsx(ns,{className:"h-4 w-4"})})}),s.jsx(PM,{children:t})]}));Tt.displayName=JN.displayName;const EM=i.forwardRef(({className:e,...t},n)=>s.jsx(ZN,{ref:n,className:it("-mx-1 my-1 h-px bg-muted",e),...t}));EM.displayName=ZN.displayName;const IM="/assets/worksspacecomplete-CNg1LndS.png",cx=e=>{const t=/(?:vimeo\.com|player\.vimeo\.com\/video)\/(\d+)(?:\/([a-f0-9]+))?/i,n=e.match(t);return n?{videoId:n[1],hash:n[2]||void 0}:null},ux=(e,t)=>{const n=`https://player.vimeo.com/video/${e}`,r=new URLSearchParams({title:"0",byline:"0",portrait:"0",autoplay:"0"});return t&&r.set("h",t),`${n}?${r.toString()}`},TM=["United States","United Kingdom","Canada","Australia","Germany","France","Spain","Italy","Netherlands","Other"],dx="https://vimeo.com/1088047119/e13812494c",RM=()=>{const e=Lt(),{addWorkspace:t,setCurrentWorkspace:n}=ls(),[r,a]=i.useState(!1),[o,l]=i.useState(!1),[c,u]=i.useState(""),[d,g]=i.useState({name:"",country:""}),[m,p]=i.useState({}),[f,w]=i.useState({name:!1,country:!1}),h=N=>{if(!N||N.trim().length===0)return"Workspace name is required";if(N.trim().length<3)return"Workspace name must be at least 3 characters";if(N.trim().length>50)return"Workspace name must not exceed 50 characters";if(!/^[a-zA-Z0-9\s\-_]+$/.test(N.trim()))return"Workspace name can only contain letters, numbers, spaces, hyphens, and underscores"},v=(N,S)=>{let j;switch(N){case"name":j=h(S);break}return p(k=>({...k,[N]:j})),j},x=async N=>{N.preventDefault(),a(!0),w({name:!0,country:!0});const S=h(d.name);if(p({name:S,country:void 0}),S){a(!1);return}try{const j={name:d.name.trim(),country:d.country||void 0},k=await Vi.createWorkspace(j);console.log("CreateWorkspace - Workspace created successfully:",k),ai.success("Workspace created!",{description:`"${d.name}" has been created successfully.`}),t(k),n(k),u(k.name||d.name.trim()),l(!0)}catch(j){console.error("Error creating workspace:",j);const k=j instanceof Error?j.message:"An unexpected error occurred.";k.includes("already created a workspace with this payment")?ai.error("Payment Required for Additional Workspace",{description:"You have already created a workspace with this payment. To create another workspace, please make a new payment.",action:{label:"Make Payment",onClick:()=>e("/pricing")}}):k.includes("No active subscription found")?ai.error("Subscription Required",{description:"You need an active subscription to create workspaces. Please upgrade your plan first.",action:{label:"Upgrade Plan",onClick:()=>e("/pricing")}}):ai.error("Failed to create workspace",{description:k})}finally{a(!1)}},y=(N,S)=>{g(j=>({...j,[N]:S})),f[N]&&v(N,S)},b=(N,S)=>{w(j=>({...j,[N]:!0})),v(N,S)};return s.jsxs("div",{className:"min-h-screen flex",children:[s.jsxs("div",{className:"hidden lg:flex lg:w-3/5 relative overflow-hidden bg-black",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${$u})`},children:s.jsx("div",{className:"absolute inset-0 bg-black/20"})}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full px-12",children:[s.jsx("div",{className:"mb-12",children:s.jsx("img",{src:ka,alt:"VoxBox Logo",className:"w-28 h-28 object-contain rounded-lg"})}),s.jsx("h1",{className:"text-white text-6xl font-bold",children:"VOXBOX"})]})]}),s.jsx("div",{className:"w-full lg:w-2/5 bg-white flex items-center justify-center py-8 px-4 lg:px-6",children:s.jsx("div",{className:"w-full",children:o?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-full -mx-8 -mt-8 mb-6 overflow-hidden",children:s.jsx("img",{src:IM,alt:"Workspace created celebration",className:"w-full h-auto object-cover"})}),s.jsx("div",{className:"flex items-center gap-4 mb-6",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-emerald-600",children:"Workspace created"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"text-emerald-600 font-semibold",children:"Congratulations"}),c?`, ${c}`:"","! Your workspace has been created."]})]})}),s.jsx("p",{className:"text-gray-700 text-sm mb-6 leading-relaxed",children:"Please watch this short tour of VoxBox so you can see where everything is and understand how to get started. This will help you have a much smoother experience from the beginning."}),s.jsx("div",{className:"mb-6 rounded-lg border border-gray-200 bg-gray-50 overflow-hidden",children:(()=>{const N=cx(dx);if(N){const S=ux(N.videoId,N.hash);return s.jsx("div",{className:"relative",style:{paddingBottom:"56.25%"},children:s.jsx("iframe",{src:S,className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"Workspace tour video"})})}return null})()}),s.jsx(Ie,{type:"button",onClick:()=>{e("/dashboard",{replace:!0})},className:"w-full h-12 bg-black text-white hover:bg-gray-900 rounded-lg",children:"I've already watched the video"})]}):s.jsxs(s.Fragment,{children:[s.jsx("h2",{className:"text-3xl font-bold text-center mb-6",children:"Create new workspace"}),s.jsx("div",{className:"mb-6",children:(()=>{const N=cx(dx);if(N){const S=ux(N.videoId,N.hash);return s.jsx("div",{className:"w-full rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:s.jsx("div",{className:"relative",style:{paddingBottom:"56.25%"},children:s.jsx("iframe",{src:S,className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"Workspace creation video"})})})}return null})()}),s.jsx("p",{className:"text-gray-700 text-center mb-8 leading-relaxed",children:"A workspace is the place where all of your Ideal Client Profiles, Product Briefs and the outputs you generate inside VoxBox are stored. It acts as your business folder so everything stays organised in one place."}),s.jsxs("form",{onSubmit:x,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs(st,{htmlFor:"workspace-name",className:"text-gray-700",children:["Business Name ",s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx(Ft,{id:"workspace-name",placeholder:"Your Business Name",value:d.name,onChange:N=>y("name",N.target.value),onBlur:N=>b("name",N.target.value),className:`h-12 rounded-lg border-gray-300 ${m.name&&f.name?"border-red-500 focus-visible:ring-red-500":""}`}),m.name&&f.name&&s.jsx("p",{className:"text-sm text-red-600 font-medium",children:m.name})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(st,{htmlFor:"country",className:"text-gray-700",children:"Country"}),s.jsxs($t,{value:d.country,onValueChange:N=>y("country",N),children:[s.jsx(Et,{id:"country",className:"h-12 rounded-lg border-gray-300",children:s.jsx(Dt,{placeholder:"Select Country"})}),s.jsx(It,{children:TM.map(N=>s.jsx(Tt,{value:N.toLowerCase(),children:N},N))})]})]}),s.jsx(Ie,{type:"submit",disabled:!d.name||r,className:"w-full h-12 bg-black text-white hover:bg-gray-900 rounded-lg",children:r?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Create Workspace"})]})]})})})]})},mx=({value:e,max:t,label:n})=>{const u=2*Math.PI*102,g=Math.min(e/(t??(e||1)),1),m=u-g*u;return s.jsxs("div",{className:"flex flex-col items-center justify-center w-full",children:[s.jsxs("svg",{viewBox:"0 0 260 260",className:"w-full max-w-[260px] mb-4",children:[s.jsx("circle",{stroke:"#E5E7EB",fill:"transparent",strokeWidth:16,r:102,cx:130,cy:130}),s.jsx("circle",{stroke:"#111827",fill:"transparent",strokeWidth:16,strokeLinecap:"round",strokeDasharray:u,strokeDashoffset:m,r:102,cx:130,cy:130,transform:"rotate(-90 130 130)"}),s.jsx("text",{x:"50%",y:"50%",dominantBaseline:"middle",textAnchor:"middle",className:"fill-black text-2xl font-semibold",children:t?`${e}/${t}`:e})]}),s.jsx("span",{className:"text-sm font-medium text-black mt-1",children:n})]})},MM=()=>{const{user:e}=fr(),{workspaces:t,isLoading:n}=ls(),r=Lt(),[a,o]=cu(),[l,c]=i.useState(null),[u,d]=i.useState(!0),[g,m]=i.useState(!1),[p]=i.useState(""),[f,w]=i.useState(!1);return i.useEffect(()=>{if(n)return;const h=localStorage.getItem("isNewUser"),v=a.get("payment_success");if(t&&t.length>0){h==="true"&&localStorage.removeItem("isNewUser");return}if(h==="true"&&!v&&!(l!=null&&l.hasSubscription)&&!u){console.log("New user without subscription - redirecting to pricing"),r("/pricing",{replace:!0});return}h==="true"&&(l!=null&&l.hasSubscription||v)&&localStorage.removeItem("isNewUser")},[l,u,a,r,t,n]),i.useEffect(()=>{console.log("Success Modal State Changed:",{showSuccessModal:g,createdWorkspaceName:p,hasCompletedPayment:f})},[g,p,f]),i.useEffect(()=>{const h=a.get("createWorkspace"),v=a.get("payment_success");h==="true"&&(v==="true"||l!=null&&l.hasSubscription?(console.log("Navigating to workspace creation page - payment success or subscription active"),v==="true"&&w(!0),r("/create-workspace",{replace:!0})):u||(o({}),console.log("User does not have active subscription - workspace creation blocked")))},[a,o,l,u]),i.useEffect(()=>{t&&t.length>0&&(l!=null&&l.hasSubscription)&&console.log("User already has workspaces - they need to pay again for more")},[t,l]),i.useEffect(()=>{const h=a.get("payment_success"),v=a.get("session_id");(h==="true"||v)&&(console.log("Payment success detected - setting hasCompletedPayment to true"),w(!0),localStorage.setItem("hasCompletedPayment","true"))},[a]),i.useEffect(()=>{localStorage.getItem("hasCompletedPayment")==="true"&&(console.log("Found stored payment completion - setting hasCompletedPayment to true"),w(!0))},[]),i.useEffect(()=>{(async()=>{if(!(!e||u))try{console.log(" Checking for unused subscriptions...");const v=await ga.checkUnusedSubscriptions(e.id);console.log(" Unused subscription check result:",v),v.hasUnusedSubscription&&v.unusedSubscriptionCount>0?(console.log(" Found unused subscription(s) - enabling workspace creation"),w(!0),localStorage.setItem("hasCompletedPayment","true"),t&&t.length>0&&console.log(" User can create additional workspace")):v.unusedSubscriptionCount===0&&t&&t.length>0&&(console.log(" All subscriptions are in use - payment required for more workspaces"),w(!1),localStorage.removeItem("hasCompletedPayment"))}catch(v){console.error("Error checking unused subscriptions:",v)}})()},[e,u,t==null?void 0:t.length]),i.useEffect(()=>{(async()=>{var v,x;if(e)try{const y=a.get("payment_success"),b=a.get("session_id");if(y==="true"||b)console.log("Payment success detected - setting subscription to active"),c({hasSubscription:!0,workspaceId:`workspace_${e.id}`,plan:"pro",status:"active"});else try{const N=await ga.debugUserSubscription(e.id);console.log("Debug subscription data:",N);const S=await ga.getUserSubscription(e.id);console.log("Loaded subscription data:",S),S&&S.hasSubscription?c(S):N&&N.hasActiveSubscription?c({hasSubscription:!0,workspaceId:`workspace_${e.id}`,plan:((v=N.status)==null?void 0:v.plan)||"pro",status:((x=N.status)==null?void 0:x.status)||"active"}):t&&t.length>0?(console.log("User has workspaces - assuming subscription active"),c({hasSubscription:!0,workspaceId:`workspace_${e.id}`,plan:"pro",status:"active"})):c({hasSubscription:!1,workspaceId:"",plan:"free",status:"inactive"})}catch(N){console.error("Error loading user subscription:",N),t&&t.length>0?(console.log("Error loading subscription but user has workspaces - assuming subscription active"),c({hasSubscription:!0,workspaceId:`workspace_${e.id}`,plan:"pro",status:"active"})):c({hasSubscription:!1,workspaceId:"",plan:"free",status:"inactive"})}}catch(y){console.error("Error loading subscription:",y),t&&t.length>0?(console.log("Error loading subscription but user has workspaces - assuming subscription active"),c({hasSubscription:!0,workspaceId:`workspace_${e.id}`,plan:"pro",status:"active"})):c({hasSubscription:!1,workspaceId:`workspace_${e.id}`})}finally{d(!1)}})()},[e,a,o,t]),console.log("Dashboard - Subscription Status:",{subscriptionLoading:u,subscription:l,hasSubscription:l==null?void 0:l.hasSubscription,hasCompletedPayment:f,shouldShowCard:!u&&!(l!=null&&l.hasSubscription)&&!f,searchParams:Object.fromEntries(a.entries()),workspacesCount:(t==null?void 0:t.length)||0}),s.jsxs("div",{className:"space-y-8 max-w-7xl mx-auto",children:[!u&&s.jsxs(s.Fragment,{children:[!(l!=null&&l.hasSubscription)&&!f&&s.jsx("div",{children:s.jsxs(qe,{className:"border-2 border-red-200 bg-red-50",children:[s.jsx(vt,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-black",children:s.jsx(Ic,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx(pt,{className:"text-lg",children:"Subscription Required"}),s.jsx(gt,{children:"You need an active subscription to create workspaces"})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:"text-sm font-semibold text-red-600",children:"No Subscription"})})]})}),s.jsx(Xe,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Upgrade to a paid plan to unlock workspace creation and all premium features."}),s.jsx(Ie,{className:"w-full",onClick:()=>r("/pricing"),children:"Upgrade Plan"})]})})]})}),l!=null&&l.hasSubscription&&(!t||t.length===0)||f||l!=null&&l.hasUnusedSubscription?f?null:s.jsx("div",{children:s.jsxs(qe,{className:"border-2 border-green-200 bg-green-50",children:[s.jsx(vt,{children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center bg-black",children:s.jsx(Ic,{className:"w-5 h-5 text-white"})}),s.jsxs("div",{children:[s.jsx(pt,{className:"text-lg",children:"Ready to Create Workspace"}),s.jsx(gt,{children:f||l!=null&&l.hasUnusedSubscription?`You can now create ${(l==null?void 0:l.unusedSubscriptionCount)>1?"another":"a new"} workspace`:"You can now create your first workspace"})]})]})})}),s.jsx(Xe,{children:s.jsxs(Ie,{className:"w-full",onClick:()=>r("/create-workspace"),children:[s.jsx(Na,{className:"w-4 h-4 mr-2"}),f||l!=null&&l.hasUnusedSubscription?"Create Additional Workspace":"Create Your First Workspace"]})})]})}):null]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"font-heading font-bold text-3xl md:text-4xl mb-2",children:"Welcome back!"}),s.jsx("p",{className:"text-lg",style:{color:"rgba(101, 107, 101, 1)",fontFamily:'"SF Pro", -apple-system, system-ui, BlinkMacSystemFont, "Segoe UI", sans-serif',fontWeight:500,lineHeight:"100%",letterSpacing:"-0.02em"},children:"Ready to create some persuasive content?"})]}),s.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[s.jsxs(qe,{className:"border border-[#f1f1f1] shadow-none rounded-3xl",children:[s.jsxs(vt,{children:[s.jsxs(pt,{className:"flex items-center gap-2",children:[s.jsx(_w,{className:"w-5 h-5"}),"Usage This Month"]}),s.jsx(gt,{className:"text-black",children:"Track your content creation activity"})]}),s.jsx(Xe,{children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-16",children:[s.jsx(mx,{value:47,max:200,label:"AI Output"}),s.jsx(mx,{value:12,max:20,label:"Profiles Created"})]})})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-2 gap-4",children:[{label:"Total Profiles",value:"12"},{label:"Outputs Created",value:"47"},{label:"Amplified Users",value:"12"},{label:"Team Members",value:"1"}].map((h,v)=>s.jsx(qe,{className:"border border-[#f1f1f1] shadow-none rounded-3xl h-full",children:s.jsxs(vt,{className:"h-full flex flex-col justify-between py-6",children:[s.jsx(pt,{className:"text-base font-semibold text-neutral-800",children:h.label}),s.jsx(gt,{className:"text-lg text-neutral-800",children:h.value}),s.jsx("p",{className:"text-xs text-neutral-400",children:"Sample data"})]})},v))})]})]}),s.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"grid sm:grid-cols-2 lg:grid-cols-2 gap-4",children:[{icon:vh,title:"Create AVA Profile",description:"Define your ideal client",path:"/tools/ava"},{icon:Ow,title:"Refine Product",description:"Use product tools",path:"/tools/products"},{icon:Dw,title:"Build Voice Profile",description:"Create with Vera",path:"/tools/vera"},{icon:Rw,title:"Design Lead Magnet",description:"Attract your audience",path:"/tools/lead-magnet"}].map((h,v)=>{const x=h.icon;return s.jsx(qe,{className:"transition-all duration-300 hover:-translate-y-1 cursor-pointer h-full border border-[#f1f1f1] shadow-none rounded-3xl",onClick:()=>r(h.path),children:s.jsxs(vt,{children:[s.jsx("div",{className:"w-12 h-12 rounded-lg bg-black flex items-center justify-center mb-3",children:s.jsx(x,{className:"w-6 h-6 text-white"})}),s.jsx(pt,{className:"text-lg",children:h.title}),s.jsx(gt,{children:h.description})]})},v)})})}),s.jsxs(qe,{className:"border border-[#f1f1f1] shadow-none rounded-3xl",children:[s.jsx(vt,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs(pt,{className:"flex items-center gap-2",children:[s.jsx(TP,{className:"w-5 h-5"}),"Recent Outputs"]}),s.jsx(gt,{children:"Your latest creations"})]}),s.jsx(Ie,{variant:"ghost",size:"sm",children:"View All"})]})}),s.jsx(Xe,{children:s.jsx("div",{className:"space-y-4",children:[{title:"Email Campaign - Product Launch",amplifier:"Email Sequence",date:"2 hours ago"},{title:"Social Post - Value Proposition",amplifier:"Social Media",date:"5 hours ago"},{title:"Landing Page Copy",amplifier:"Sales Page",date:"1 day ago"}].map((h,v)=>s.jsxs("div",{className:"flex items-start justify-between p-3 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-sm",children:h.title}),s.jsx("p",{className:"text-xs text-muted-foreground",children:h.amplifier})]}),s.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:h.date})]},v))})})]})]}),s.jsxs(qe,{className:"bg-gradient-to-br from-[#0b0b0c] via-[#141416] to-[#000000] text-white overflow-hidden border border-[#f1f1f1] shadow-none rounded-3xl",children:[s.jsxs(vt,{children:[s.jsxs(pt,{className:"flex items-center gap-2",children:[s.jsx(Tc,{className:"w-5 h-5"}),"Amplifiers"]}),s.jsx(gt,{className:"text-white/80",children:"Transform your profiles into content"})]}),s.jsxs(Xe,{children:[s.jsx("p",{className:"mb-4 text-white/90",children:"10 powerful tools to generate emails, social posts, sales pages, and more from your strategic profiles."}),s.jsxs(Ie,{variant:"secondary",className:"w-full bg-white text-black hover:bg-white/90",onClick:()=>r("/tools/ava"),children:[s.jsx(Tc,{className:"w-4 h-4 mr-2"}),"Explore Amplifiers"]})]})]}),s.jsx(mN,{open:g,onOpenChange:m,workspaceName:p,onContinue:()=>{}},`success-modal-${p}`)]})},$M="/assets/payment-successfull-DDteQFFc.png",DM=()=>{const[e]=cu(),t=e.get("session_id"),[n,r]=i.useState("");return i.useEffect(()=>{(async()=>{if(t)try{console.log("ThankYou: Processing payment success for session:",t),await ga.handlePaymentSuccess(t),console.log("ThankYou: Payment success processed successfully")}catch(l){console.error("ThankYou: Error processing payment success:",l)}})();const o=Oe.getCurrentUser();o!=null&&o.name&&r(o.name)},[t]),i.useEffect(()=>{const o=Date.now()+3e3,l=["#ec4899","#3b82f6","#10b981","#f59e0b"],c=(d,g)=>Math.random()*(g-d)+d,u=setInterval(()=>{if(o-Date.now()<=0){clearInterval(u);return}const g=3;for(let m=0;m<g;m++){const p=document.createElement("div");p.className="confetti",p.style.left=Math.random()*100+"%",p.style.backgroundColor=l[Math.floor(Math.random()*l.length)],p.style.animationDuration=c(2,4)+"s",p.style.animationDelay=c(0,.5)+"s",document.body.appendChild(p),setTimeout(()=>{p.remove()},4e3)}},100);return()=>clearInterval(u)},[]),s.jsxs(s.Fragment,{children:[s.jsx("style",{children:`
        @keyframes confetti-fall {
          0% {
            transform: translateY(-100vh) rotate(0deg);
            opacity: 1;
          }
          100% {
            transform: translateY(100vh) rotate(720deg);
            opacity: 0;
          }
        }

        .confetti {
          position: fixed;
          width: 10px;
          height: 20px;
          top: -10px;
          z-index: 9999;
          animation: confetti-fall linear forwards;
          pointer-events: none;
        }
      `}),s.jsxs("div",{className:"min-h-screen flex",children:[s.jsxs("div",{className:"hidden lg:flex lg:w-3/5 relative overflow-hidden bg-black",children:[s.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat",style:{backgroundImage:`url(${$u})`},children:s.jsx("div",{className:"absolute inset-0 bg-black/20"})}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center w-full px-12",children:[s.jsx("div",{className:"mb-8",children:s.jsx("img",{src:ka,alt:"VoxBox Logo",className:"w-32 h-32 object-contain rounded-lg"})}),s.jsx("h1",{className:"text-white text-6xl font-bold",children:"VOXBOX"})]})]}),s.jsxs("div",{className:"w-full lg:w-2/5 bg-white flex flex-col p-8",children:[s.jsxs("div",{className:"relative -mx-8 -mt-8 mb-8 p-8 overflow-hidden text-center",style:{backgroundImage:`url(${$M})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[s.jsx("div",{className:"absolute inset-0 bg-black/20"}),s.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center",children:[s.jsx("h2",{className:"text-white text-3xl lg:text-4xl font-bold mb-3",children:"Welcome to VoxBox!"}),s.jsx("p",{className:"text-white text-base lg:text-lg font-normal leading-relaxed max-w-2xl",children:"Your subscription is activated and you're all set to transform your product positioning"})]})]}),s.jsxs("div",{className:"w-full px-4 flex-1 flex flex-col justify-center",children:[s.jsx("div",{className:"flex justify-center mb-10 lg:hidden",children:s.jsx("img",{src:ka,alt:"VoxBox Logo",className:"w-24 h-24 object-contain rounded-lg"})}),s.jsxs("div",{className:"bg-gray-50 border-l-4 border-black rounded-lg p-6 mb-8",children:[s.jsxs("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:["Hey ",n||"there",", great to have you here!"]}),s.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:"I'm excited to help you use our powerful AI abilities + insights for your products. Let me guide you through a quick onboarding to get you started on the right foot."})]}),s.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Let's Get You Started"}),s.jsxs("div",{className:"space-y-4 mb-8",children:[s.jsxs("div",{className:"flex items-start gap-4 p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-black text-white flex items-center justify-center flex-shrink-0 font-bold",children:"1"}),s.jsx("span",{className:"text-gray-700 pt-1",children:"Create your first AVA profile to understand your audience"})]}),s.jsxs("div",{className:"flex items-start gap-4 p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-black text-white flex items-center justify-center flex-shrink-0 font-bold",children:"2"}),s.jsx("span",{className:"text-gray-700 pt-1",children:"Set up your workspace and invite team members"})]}),s.jsxs("div",{className:"flex items-start gap-4 p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-colors",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-black text-white flex items-center justify-center flex-shrink-0 font-bold",children:"3"}),s.jsx("span",{className:"text-gray-700 pt-1",children:"Start generating content with our AI amplifiers"})]})]}),s.jsx(Ie,{asChild:!0,className:"w-full h-12 bg-black text-white hover:bg-gray-900 rounded-lg mb-8",size:"lg",children:s.jsx(St,{to:"/dashboard?createWorkspace=true&payment_success=true",children:"Get Started"})}),s.jsxs("div",{className:"text-center pt-6 border-t border-gray-200",children:[s.jsx("p",{className:"text-gray-600 text-sm mb-3",children:"Need help? Contact support"}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center text-sm",children:[s.jsx("a",{href:"mailto:support@voxbox.ai",className:"text-gray-900 hover:underline font-semibold",children:"support@voxbox.ai"}),s.jsx("span",{className:"hidden sm:block text-gray-400",children:""}),s.jsx("a",{href:"/contact",className:"text-gray-900 hover:underline font-semibold",children:"Contact Support"})]})]})]})]})]})]})},OM=()=>s.jsx("div",{className:"min-h-screen bg-white flex items-center justify-center p-4",children:s.jsxs("div",{className:"w-full max-w-2xl space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"w-24 h-24 rounded-full bg-red-500 flex items-center justify-center mx-auto mb-6",children:s.jsx(Es,{className:"w-12 h-12 text-white stroke-[3]"})}),s.jsx("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Payment Cancelled"}),s.jsx("p",{className:"text-base text-gray-600",children:"Your payment was not completed. No charges have been made to your account."})]}),s.jsxs("div",{className:"bg-red-50 border-l-4 border-red-600 rounded-lg p-6",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"w-5 h-5 rounded-full bg-red-600 flex items-center justify-center flex-shrink-0",children:s.jsx(Es,{className:"w-3 h-3 text-white stroke-[2.5]"})}),s.jsx("h3",{className:"font-bold text-lg text-red-800",children:"Payment Not Processed"})]}),s.jsx("p",{className:"text-sm text-red-700",children:"Your subscription was not activated. You can try again or contact our support team if you're experiencing any issues."})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"font-bold text-xl text-black",children:"Common Reasons for Cancellation:"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-black mt-2 flex-shrink-0"}),s.jsx("span",{className:"text-black",children:"Payment method was declined or expired"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-black mt-2 flex-shrink-0"}),s.jsx("span",{className:"text-black",children:"Insufficient funds in your account"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-black mt-2 flex-shrink-0"}),s.jsx("span",{className:"text-black",children:"Payment was cancelled by your bank"})]}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-black mt-2 flex-shrink-0"}),s.jsx("span",{className:"text-black",children:"Technical issues during payment processing"})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx(Ie,{asChild:!0,size:"lg",className:"w-full bg-black hover:bg-black/90 text-white font-semibold px-8 py-6 rounded-lg",children:s.jsx(St,{to:"/pricing",children:"Try Again"})}),s.jsx(Ie,{asChild:!0,size:"lg",variant:"outline",className:"w-full border border-black text-black hover:bg-gray-50 font-semibold px-8 py-6 rounded-lg",children:s.jsx(St,{to:"/",children:"Back to Home"})})]})]})}),sa=()=>s.jsx("div",{className:"min-h-[calc(100vh-80px)] flex items-center justify-center px-4 py-10",children:s.jsx("div",{className:"w-full max-w-3xl",children:s.jsxs(qe,{className:"shadow-lg",children:[s.jsxs(vt,{className:"space-y-2 text-center",children:[s.jsx(pt,{className:"text-2xl font-semibold",children:"Coming Soon"}),s.jsx(gt,{children:"Content for this section will appear here."})]}),s.jsx(Xe,{className:"text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"This page is intentionally left empty for now."})})]})})}),wt="/assets/ava-avatar-8aGzYwHy.png",sj=({stage:e,progress:t,userName:n,onReset:r,offsetClassName:a="top-0",className:o})=>{const l=()=>{switch(e){case"welcome":case"name-collection":return"Let's get started";case"phase1-intro":case"phase1":return`Question ${t.currentQuestionIndex+1} of ${t.totalQuestions}`;case"transition":return"Phase 1 Complete";case"phase2":return`Generating Profile  ${t.currentQuestionIndex} of ${t.totalQuestions} completed`;case"complete":return"Profile Complete";default:return"AVA"}},c=()=>{if(e==="transition"||e==="complete")return 100;if(e==="phase1"||e==="phase2"){if(!t.totalQuestions||t.totalQuestions===0)return 0;if(t.currentQuestionIndex>=t.totalQuestions)return 100;const d=t.currentQuestionIndex/t.totalQuestions*100;return Math.min(100,Math.max(0,isNaN(d)?0:d))}return 0},u=it("bg-background border-b border-border/40",a,o);return s.jsx("div",{className:u,children:s.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 py-2",children:[s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx("img",{src:wt,alt:"AVA Avatar",className:"w-10 h-10 rounded-xl flex-shrink-0 object-cover shadow-lg"}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h1",{className:"font-heading font-bold text-lg bg-gradient-to-r from-vox-pink to-vox-orange bg-clip-text text-transparent",children:"AVA"}),s.jsx("p",{className:"text-xs text-muted-foreground font-medium truncate",children:l()})]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[n&&s.jsxs("div",{className:"hidden sm:flex items-center gap-2 px-3 py-1.5 bg-muted rounded-full",children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-green-500"}),s.jsx("span",{className:"text-xs font-medium",children:n})]}),!(typeof r=="function")||!(e==="phase1"||e==="phase2"||e==="transition"||e==="complete")?null:s.jsxs(Gi,{children:[s.jsx(qT,{asChild:!0,children:s.jsx(Ie,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",title:"Start New Session","aria-label":"Start New Session",children:s.jsx(fu,{className:"w-4 h-4"})})}),s.jsxs(yo,{className:"bg-background",children:[s.jsxs(wo,{children:[s.jsx(No,{children:"Start New Session?"}),s.jsx(jo,{children:"This will clear all progress and start fresh. Your current session will be saved in browser history."})]}),s.jsxs(bo,{children:[s.jsx(ko,{children:"Cancel"}),s.jsx(So,{onClick:()=>{typeof r=="function"&&r()},className:"bg-destructive hover:bg-destructive/90",children:"Start New Session"})]})]})]})]})]}),(e==="phase1"||e==="phase2"||e==="transition"||e==="complete")&&s.jsxs("div",{className:"mt-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Progress"}),s.jsxs("span",{className:"text-xs font-bold bg-gradient-to-r from-vox-pink to-vox-orange bg-clip-text text-transparent",children:[Math.round(c()),"%"]})]}),s.jsx("div",{className:"w-full bg-muted rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-vox-pink via-vox-purple to-vox-orange transition-all duration-500 ease-out",style:{width:`${c()}%`}})})]})]})})},Va=()=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("div",{className:"flex gap-1.5",children:[s.jsx("div",{className:"w-2 h-2 bg-vox-pink rounded-full animate-bounce",style:{animationDelay:"0ms"}}),s.jsx("div",{className:"w-2 h-2 bg-vox-orange rounded-full animate-bounce",style:{animationDelay:"150ms"}}),s.jsx("div",{className:"w-2 h-2 bg-vox-purple rounded-full animate-bounce",style:{animationDelay:"300ms"}})]}),s.jsx("span",{className:"text-xs text-muted-foreground font-medium",children:"AVA is typing..."})]}),fs=i.forwardRef(({className:e,...t},n)=>s.jsx("textarea",{className:it("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));fs.displayName="Textarea";const FM=1,_M=1e6;let Ad=0;function LM(){return Ad=(Ad+1)%Number.MAX_SAFE_INTEGER,Ad.toString()}const Cd=new Map,fx=e=>{if(Cd.has(e))return;const t=setTimeout(()=>{Cd.delete(e),gi({type:"REMOVE_TOAST",toastId:e})},_M);Cd.set(e,t)},VM=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,FM)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?fx(n):e.toasts.forEach(r=>{fx(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Zl=[];let ec={toasts:[]};function gi(e){ec=VM(ec,e),Zl.forEach(t=>{t(ec)})}function BM({...e}){const t=LM(),n=a=>gi({type:"UPDATE_TOAST",toast:{...a,id:t}}),r=()=>gi({type:"DISMISS_TOAST",toastId:t});return gi({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:a=>{a||r()}}}),{id:t,dismiss:r,update:n}}function yt(){const[e,t]=i.useState(ec);return i.useEffect(()=>(Zl.push(t),()=>{const n=Zl.indexOf(t);n>-1&&Zl.splice(n,1)}),[e]),{...e,toast:BM,dismiss:n=>gi({type:"DISMISS_TOAST",toastId:n})}}const Vc=async(e,t)=>{var o,l,c,u;if(console.log(" AVA API Debug:"),console.log("- Workspace ID:",e),console.log("- API URL:",`${Fe}/ava-sessions`),!e)throw new Error("No workspace selected");const n=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions`,{method:"POST",body:JSON.stringify({workspaceId:e,sessionName:t||"AVA Ideal Client Profile"})});if(!n.ok){const d=await n.json().catch(()=>({message:"Failed to create session"}));throw console.error(" AVA API Error:",d),new Error(d.message||"Failed to create AVA session")}const r=await n.json();console.log(" AVA Session Created, full response:",r),console.log(" Response data.message type:",typeof((o=r.data)==null?void 0:o.message),Array.isArray((l=r.data)==null?void 0:l.message)?"array":typeof((c=r.data)==null?void 0:c.message));const a=r.data||r;return a.sessionId&&!a.id&&(a.id=a.sessionId),((u=r.data)==null?void 0:u.message)!==void 0?(a.message=r.data.message,console.log(" Extracted message from result.data.message:",Array.isArray(a.message)?`array of ${a.message.length} items`:"string")):r.message!==void 0&&(a.message=r.message,console.log(" Extracted message from result.message:",Array.isArray(a.message)?`array of ${a.message.length} items`:"string")),console.log(" Mapped session data:",a),console.log(" Final sessionData.message:",a.message),a},nj=async(e,t)=>{console.log(" updateSessionName API call:",{url:`${Fe}/ava-sessions/${e}/name`,method:"POST",body:{name:t}});const n=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/name`,{method:"POST",body:JSON.stringify({name:t})});if(console.log(" updateSessionName response status:",n.status,n.ok),!n.ok){const o=await n.text();console.error(" updateSessionName API error response:",o);let l;try{l=JSON.parse(o)}catch{l={message:o||"Failed to update name"}}throw new Error(l.message||l.error||"Failed to update session name")}const r=await n.json();console.log(" updateSessionName API success, full response:",r);const a=r.data||r;return console.log(" updateSessionName extracted data:",a),a},rj=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/start-phase1`,{method:"POST"});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to start phase 1"}));throw new Error(r.message||"Failed to start Phase 1")}const n=await t.json();return n.data||n},aj=async(e,t)=>{const n=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/answer`,{method:"POST",body:JSON.stringify({answer:t})});if(!n.ok){const o=await n.json().catch(()=>({message:"Failed to submit answer"}));throw new Error(o.message||"Failed to submit answer")}const r=await n.json();return r.data||r},fa=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}`,{method:"GET"});if(!t.ok){const a=await t.json().catch(()=>({message:"Failed to get session"}));throw new Error(a.message||"Failed to get session details")}const n=await t.json(),r=(n==null?void 0:n.data)||n;return r.sessionId&&!r.id&&(r.id=r.sessionId),r},WM=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/phase1-answers`,{method:"GET"});if(!t.ok){const a=await t.json().catch(()=>({message:"Failed to get Phase 1 answers"}));throw new Error(a.message||"Failed to retrieve Phase 1 answers")}const n=await t.json(),r=(n==null?void 0:n.data)||n;return Array.isArray(r)?r.map(a=>({questionId:a.questionId||a.question_id||a.id,sectionId:a.sectionId||a.section_id,sectionTitle:a.sectionTitle||a.section_title||void 0,questionText:a.questionText||a.question_text,answer:a.answer||a.userAnswer||a.user_answer||""})):(console.warn(" Unexpected getPhase1Answers response shape:",r),[])},oj=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/start-phase2`,{method:"POST"});if(!t.ok){const n=await t.json().catch(()=>({message:"Failed to start phase 2"}));throw new Error(n.message||"Failed to start Phase 2")}return t.json()},qi=async(e,t,n=0)=>{try{const a=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/generate-section/${t}`,{method:"POST"});if(!a.ok){let l;try{l=await a.json()}catch{l={message:`Server returned ${a.status} ${a.statusText}`}}if(a.status===429&&n<3){const u=a.headers.get("retry-after"),d=u?Number(u)*1e3:l!=null&&l.retryDelay?parseInt(String(l.retryDelay))*1e3:3e4;return console.log(` Quota hit (429). Retrying section ${t} in ${Math.round(d/1e3)}s... (attempt ${n+1}/3)`),await new Promise(g=>setTimeout(g,d)),qi(e,t,n+1)}if(a.status===500&&n<3)return console.log(` Section ${t} generation failed (500), retrying... (attempt ${n+1}/3)`),await new Promise(u=>setTimeout(u,1e3*(n+1))),qi(e,t,n+1);const c=l.message||l.error||`Failed to generate section ${t}`;throw console.error(` Generate Section Error (${a.status}):`,{sessionId:e,sectionNumber:t,error:c,fullError:l}),new Error(c)}const o=await a.json();return console.log(` Section ${t} generated successfully:`,o),o}catch(a){throw console.error(" Generate Section Exception:",{sessionId:e,sectionNumber:t,error:a.message,stack:a.stack}),a instanceof Error?a:new Error(a.message||"Failed to generate section")}},cf=async(e,t)=>{const n=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/section/${t}/status`,{method:"GET"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to get section status"}));throw new Error(r.message||"Failed to get section status")}return n.json()},ij=async(e,t,n,r)=>{const a=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/section/${t}/response/${n}`,{method:"PATCH",body:JSON.stringify({editedAnswer:r})});if(!a.ok){const o=await a.json().catch(()=>({message:"Failed to update response"}));throw new Error(o.message||"Failed to update section response")}return a.json()},lj=async(e,t,n)=>{try{const r=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/confirm-phase2-question/${n}`,{method:"POST"});if(r.status===404)throw console.error(" Response not found:",n),new Error("Response not found. Please try refreshing the page.");if(!r.ok){const o=await r.json().catch(()=>({message:"Failed to confirm response"}));throw console.error(" Confirm endpoint returned error:",o),new Error(o.message||"Failed to confirm response")}const a=await r.json();return console.log(" Question confirmed:",a),(a==null?void 0:a.data)||a||{}}catch(r){throw console.error(" Error confirming question:",r),r}},cj=async(e,t)=>{const n=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/confirm-section/${t}`,{method:"POST"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to confirm section"}));throw new Error(r.message||"Failed to confirm section")}return n.json()},Hh=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/export/pdf`,{method:"GET"});if(!t.ok){const n=await t.json().catch(()=>({message:"Failed to export PDF"}));throw new Error(n.message||"Failed to export profile as PDF")}return t.blob()},uj=async(e,t)=>{const n=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/regenerate-phase2-question/${t}`,{method:"POST"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to regenerate question"}));throw new Error(r.message||"Failed to regenerate question")}return n.json()},_u=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/cancel`,{method:"POST"});if(!t.ok){const n=await t.json().catch(()=>({message:"Failed to cancel session"}));throw new Error(n.message||"Failed to cancel session")}return t.json()},uf=async(e,t,n)=>{const r=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/phase2-progress`,{method:"POST",body:JSON.stringify({sectionNumber:t,questionIndex:n})});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to save Phase 2 progress"}));throw new Error(a.message||"Failed to save Phase 2 progress")}return r.json()},df=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/phase2-progress`,{method:"GET"});if(!t.ok){if(t.status===400||t.status===404)return null;const r=await t.json().catch(()=>({message:"Failed to get Phase 2 progress"}));throw new Error(r.message||"Failed to get Phase 2 progress")}const n=await t.json();return(n==null?void 0:n.data)||n},Tn=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/workspace/${e}`,{method:"GET"});if(!t.ok){const r=await t.json().catch(()=>({message:"Failed to get workspace sessions"}));throw new Error(r.message||"Failed to get workspace sessions")}const n=await t.json();return(n==null?void 0:n.data)||n},ca=async(e,t)=>{const n=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/conversation-history`,{method:"POST",body:JSON.stringify({messages:t})});if(!n.ok){const a=await n.json().catch(()=>({message:"Failed to save conversation history"}));throw new Error(a.message||"Failed to save conversation history")}const r=await n.json();return(r==null?void 0:r.data)||r},xi=async e=>{const t=await Oe.makeAuthenticatedRequest(`${Fe}/ava-sessions/${e}/conversation-history`,{method:"GET"});if(!t.ok){if(t.status===404)return{messages:[]};const r=await t.json().catch(()=>({message:"Failed to get conversation history"}));throw new Error(r.message||"Failed to get conversation history")}const n=await t.json();return(n==null?void 0:n.data)||n},Qo=Object.freeze(Object.defineProperty({__proto__:null,cancelAvaSession:_u,confirmSection:cj,confirmSectionResponse:lj,createAvaSession:Vc,exportProfilePDF:Hh,generateSection:qi,getConversationHistory:xi,getPhase1Answers:WM,getPhase2Progress:df,getSectionStatus:cf,getSessionDetails:fa,listWorkspaceSessions:Tn,regeneratePhase2Question:uj,saveConversationHistory:ca,savePhase2Progress:uf,startPhase1:rj,startPhase2:oj,submitAnswer:aj,updateSectionResponse:ij,updateSessionName:nj},Symbol.toStringTag,{value:"Module"})),dj=(e,t)=>{var a;if(typeof window>"u")return 0;let n=0;const r=[];try{for(let o=0;o<localStorage.length;o++){const l=localStorage.key(o);if(l&&!(l==="accessToken"||l==="refreshToken"||l==="user"||l==="workspace-storage")){if(l.startsWith("ava-session-state")){if(t&&l.includes(t))continue;r.push(l);continue}if(l==="ava-name-response-store"){try{const c=localStorage.getItem(l);if(c){const u=JSON.parse(c),d=(a=u==null?void 0:u.state)==null?void 0:a.sessionId;d&&d!==e&&r.push(l)}}catch{r.push(l)}continue}if(l.startsWith("activate-now-messages-")){if(e&&l.includes(e))continue;r.push(l);continue}if(l.startsWith("ava-phase2-state-")){if(t&&l.includes(t))continue;r.push(l);continue}if(l.startsWith("margo-state-")){if(t&&l.includes(t))continue;r.push(l);continue}if(l.startsWith("margo-step")){r.push(l);continue}}}r.forEach(o=>{try{localStorage.removeItem(o),n++}catch(l){console.warn(`Failed to remove localStorage key: ${o}`,l)}}),console.log(` Cleaned up ${n} localStorage items`)}catch(o){console.error("Error during localStorage cleanup:",o)}return n},UM=(e,t)=>{var n;if(typeof window>"u")return!1;try{dj(e,t);try{const r="ava-name-response-store",a=localStorage.getItem(r);if(a){const o=JSON.parse(a),l=(n=o==null?void 0:o.state)==null?void 0:n.sessionId;if(!e||l!==e)return localStorage.removeItem(r),console.log(" Emergency cleanup: Removed old name response store"),!0}}catch(r){console.warn("Error during emergency cleanup:",r)}return!0}catch(r){return console.error("Emergency cleanup failed:",r),!1}},hx={sessionId:null,userName:null,messages:[],renderedCount:0,videoUrl:void 0,videoShown:!1,status:"idle"},zM=()=>({getItem:e=>{try{const t=localStorage.getItem(e);return t?JSON.parse(t):null}catch(t){return console.error(`Failed to get item ${e}:`,t),null}},setItem:(e,t)=>{var n,r,a,o;try{const l=JSON.stringify(t),c=t.state;try{localStorage.setItem(e,l)}catch(u){if(u.name==="QuotaExceededError"||(n=u.message)!=null&&n.includes("quota")){console.warn(` Quota exceeded when setting ${e}, attempting cleanup...`);let d,g;try{d=(c==null?void 0:c.sessionId)||void 0;try{const m=localStorage.getItem("workspace-storage");if(m){const p=JSON.parse(m);g=(a=(r=p==null?void 0:p.state)==null?void 0:r.currentWorkspace)==null?void 0:a.id}}catch{}}catch{}dj(d,g);try{localStorage.setItem(e,l),console.log(` Successfully set ${e} after cleanup`);return}catch(m){if(m.name==="QuotaExceededError"||(o=m.message)!=null&&o.includes("quota")){console.warn(" Still quota exceeded, attempting emergency cleanup..."),UM(d,g);try{localStorage.setItem(e,l),console.log(` Successfully set ${e} after emergency cleanup`);return}catch(p){if(e==="ava-name-response-store"&&(c!=null&&c.messages)&&Array.isArray(c.messages))try{const w={state:{...c,messages:c.messages.slice(0,5)},version:t.version},h=JSON.stringify(w);try{localStorage.setItem(e,h),console.warn(" Stored truncated messages due to quota limit");return}catch{console.error(" Failed to store even truncated version, continuing without persistence");try{localStorage.removeItem(e)}catch{}return}}catch{try{localStorage.removeItem(e)}catch{}return}console.error(` Failed to set ${e} even after cleanup, continuing without persistence:`,p);return}}}}console.error(`Failed to set ${e}:`,u)}}catch(l){console.error(`Failed to serialize value for ${e}:`,l)}},removeItem:e=>{try{localStorage.removeItem(e)}catch(t){console.error(`Failed to remove item ${e}:`,t)}}}),xn=uu()(du(e=>({...hx,setPayload:({sessionId:t,userName:n,messages:r,videoUrl:a,renderedCount:o=0,videoShown:l=!1})=>e({sessionId:t,userName:n,messages:r,renderedCount:o,videoUrl:a,videoShown:l,status:r.length>0?"rendering":"idle"}),incrementRendered:()=>e(t=>({renderedCount:Math.min(t.renderedCount+1,t.messages.length)})),setRenderedCount:t=>e(n=>({renderedCount:Math.max(0,Math.min(t,n.messages.length||t))})),markVideoShown:()=>e({videoShown:!0}),markComplete:()=>e({status:"complete"}),reset:()=>e({...hx})}),{name:"ava-name-response-store",version:1,storage:zM(),partialize:e=>({sessionId:e.sessionId,userName:e.userName,messages:e.messages,renderedCount:e.renderedCount,videoUrl:e.videoUrl,videoShown:e.videoShown,status:e.status})})),ia="https://vimeo.com/1088047119/e13812494c",HM=e=>[`<p><strong>Great to meet you, ${e}!</strong> This isn't just profiling. This is persuasion psychology at its highest level. You're about to enter a powerful process designed to uncover the real reasons your ideal clients say yes, hesitate, or walk away. We're not just identifying traitswe're <strong>decoding buying behavior</strong> using deep psychological insight. And I'm uniquely equipped to guide you through it. I'm AVAthe <strong>Audience Values Accelerator</strong>built through years of expert programming by my creator, who has spent over a decade mastering buyer psychology, persuasive marketing, and high-conversion messaging. Every insight I generate is powered by those frameworks, refined into a precision system you now get to use.</p><h3>Here's how it works:</h3><ol><li><strong>1. First</strong>, you'll answer a set of targeted questions to give me context on your ideal buyer.</li><li><strong>2. Then</strong>, I'll assume their perspectivecompleting a high-level psychological assessment that reveals their subconscious motivators, emotional triggers, fears, resistance points, and buying logic.</li><li><strong>3. Finally</strong>, I'll guide you step-by-step through building their Ideal Persuasion Profile. You'll review, refine, and approve each sectioncrafting a high-conversion behavioral blueprint you can apply to all your messaging, offers, and campaigns.</li></ol><h3>Why this approach is so effective:</h3><p><strong>Most strategies focus on <em>who</em> your audience is. This reveals <em>how</em> and <em>why</em> they buy.</strong> By understanding the emotional patterns, belief systems, and decision-making behaviors of your ideal buyer, you'll create content that lands with immediate relevance. When you plug these insights into VOXBOX's Amplifiers, you'll generate offers, positioning, and sales assets that speak directly to what moves your audienceand what holds them back.</p>`],QM="<p><strong>Ready to dive deep?</strong> Let's start by gathering foundational insights about your ideal client. Please thoughtfully answer each of the following predefined questions. Your responses will directly shape the psychological depth of your final ideal client profile.</p>",GM=e=>[...HM(e),QM],qM=({sessionId:e,onPhase1Complete:t,onStartOver:n,onError:r,hideHeader:a=!1,hideStartPhase2Button:o=!1,onProgressChange:l,onUserNameChange:c})=>{const u=Lt(),{toast:d}=yt(),{currentWorkspace:g}=ls(),m=i.useRef(null),p=i.useRef(null),f=i.useRef(!1),w=i.useRef(g==null?void 0:g.id),h=i.useRef(e),[v,x]=i.useState([]),[y,b]=i.useState("awaiting-name"),[N,S]=i.useState(""),[j,k]=i.useState(""),[C,W]=i.useState(()=>{if(typeof window<"u"&&e){const xe=sessionStorage.getItem("activate-now-in-progress"),De=sessionStorage.getItem("activate-now-session-id");if(xe==="true"&&De===e)return!0}return!1}),[B,U]=i.useState(!1),[Q,V]=i.useState(null),[P,K]=i.useState({current:0,total:27,percentage:0}),[G,q]=i.useState(ia),[A,E]=i.useState(!1);i.useEffect(()=>{if(l){const xe=(P==null?void 0:P.total)||27;let De=Math.max(0,((P==null?void 0:P.current)||0)-1);(y==="complete"||((P==null?void 0:P.current)||0)>=xe)&&(De=xe),l({currentQuestionIndex:De,totalQuestions:xe})}},[P,y,l]),i.useEffect(()=>{c&&N&&c(N)},[N,c]);const[R,L]=i.useState(!0),[I,_]=i.useState(null),[$,F]=i.useState(""),[M,T]=i.useState(!1),[ie,Z]=i.useState(null),le=i.useRef(null),oe=i.useRef(0),z=i.useRef(null),ee=i.useRef(null),ne=i.useRef(!1),me=i.useRef(null),ve=i.useRef(!1),D=i.useRef(!1),ue=i.useRef(),O="phase1-awaiting-question",H=xn(xe=>xe.reset),ae=(xe={})=>{if(typeof window>"u")return;const De=window.sessionStorage;De.removeItem("name-submission-in-progress"),De.removeItem("name-submission-messages-total"),De.removeItem("name-submission-messages-displayed"),De.removeItem("name-submission-messages"),De.removeItem("name-submission-retrigger"),De.removeItem("name-submission-video-url"),xe.preserveName||De.removeItem("name-submission-stored-name"),xe.preserveSession||De.removeItem("name-submission-session-id"),xe.preserveStore||xn.getState().reset()},de=()=>{if(!(g!=null&&g.id)||!e)return null;const xe=`activate-now-messages-${g.id}-${e}`;try{const De=localStorage.getItem(xe);if(De){const Me=JSON.parse(De);if(Me.messages&&Array.isArray(Me.messages)&&Me.messages.length>0){const He=Me.messages.join(""),ze=`activate-msg-restored-${e}`;let Le=!1;if(x(We=>{var at;if(We.some(ht=>{var Mt,Vt;return((Mt=ht.id)==null?void 0:Mt.includes("activate-msg"))||ht.role==="ava"&&((Vt=ht.content)==null?void 0:Vt.includes(He.substring(0,50)))}))return console.log(" Activate Now message already exists in messages, skipping restore"),We;Le=!0;let At=new Date;if(Me.timestamp)At=new Date(Me.timestamp);else if(We.length>0&&((at=We[0])!=null&&at.timestamp)){const ht=typeof We[0].timestamp=="string"?new Date(We[0].timestamp):We[0].timestamp;At=new Date(ht.getTime()-6e4)}else At=new Date(Date.now()-6e4);const Xt={id:ze,role:"ava",content:He,timestamp:At};return console.log(" Restoring Activate Now message from localStorage immediately - prepending to top"),[Xt,...We]}),Le)return{id:ze,role:"ava",content:He,timestamp:new Date}}}}catch(De){console.warn("Failed to restore Activate Now messages:",De)}return null},re=async()=>{const xe=sessionStorage.getItem("name-submission-in-progress"),De=xn.getState();if((xe==="true"||De.status==="rendering"&&De.sessionId===e)&&(console.log(" Resuming Submit Name API - restoring Activate Now messages immediately"),de()),De.status==="rendering"&&De.sessionId===e&&De.userName){console.log(" Resuming name submission via Zustand store, re-calling API"),Je(De.userName),b("processing-name"),U(!0);try{return await rt(De.userName,{renderedCount:De.renderedCount,videoShown:De.videoShown}),!0}catch(We){console.error(" Failed to resume via store:",We),H(),ae()}finally{U(!1)}}const He=sessionStorage.getItem("name-submission-in-progress"),ze=sessionStorage.getItem("name-submission-stored-name"),Le=sessionStorage.getItem("name-submission-session-id");if(He==="true"&&ze&&(!Le||Le===e)){console.log(" Resuming name submission via sessionStorage (API re-call)"),Je(ze),b("processing-name"),U(!0);try{return await rt(ze),!0}catch(We){console.error(" Failed to resume via sessionStorage:",We),ae()}finally{U(!1)}}return!1},fe=xe=>{typeof window>"u"||(D.current=!1,window.sessionStorage.setItem(O,JSON.stringify({...xe,timestamp:Date.now()})))},Se=()=>{if(typeof window>"u")return null;const xe=window.sessionStorage.getItem(O);if(!xe)return null;try{return JSON.parse(xe)}catch{return window.sessionStorage.removeItem(O),null}},he=()=>{typeof window>"u"||(window.sessionStorage.removeItem(O),D.current=!1)},se=xe=>xe?`ava-phase1-chat-${xe}-${e}`:null,J=async()=>{if(!(g!=null&&g.id))return;const xe=se(g.id);if(!xe)return;const De={messages:v,stage:y,userName:N,progress:P,videoUrl:G,currentQuestion:Q,lastUpdated:new Date().toISOString()};if(localStorage.setItem(xe,JSON.stringify(De)),e&&v.length>0)try{await ca(e,v),console.log(" Saved conversation history to backend")}catch(Me){console.warn(" Failed to save conversation to backend:",Me)}},Pe=async()=>{var ze;if(!(g!=null&&g.id)||!e)return console.log(" Cannot load persisted state: missing workspace or sessionId"),null;console.log(` Loading persisted state for session: ${e}`);let xe=null,De=0;const Me=3;for(;De<Me&&!xe;){try{console.log(` Attempting to load conversation history from backend (attempt ${De+1}/${Me})...`);const Le=await xi(e);if(Le&&Le.messages&&Le.messages.length>0){xe=Le,console.log(` Successfully loaded ${Le.messages.length} messages from backend`);break}else console.log(` Backend returned empty messages array (attempt ${De+1})`),De<Me-1&&await new Promise(We=>setTimeout(We,1e3*(De+1)))}catch(Le){console.warn(` Failed to load from backend (attempt ${De+1}/${Me}):`,Le),De<Me-1&&await new Promise(We=>setTimeout(We,1e3*(De+1)))}De++}if(xe&&xe.messages&&xe.messages.length>0){console.log(" Restoring Phase 1 chat from backend:",xe.messages.length,"messages");let Le="",We="",xt="intro",At=null,Xt={current:0,total:27,percentage:0};const at=xe.messages.findIndex(ft=>{var Vs;return ft.role==="ava"&&((Vs=ft.content)==null?void 0:Vs.includes("What's your name"))});if(at>=0&&at+1<xe.messages.length){const ft=xe.messages[at+1];(ft==null?void 0:ft.role)==="user"&&(Le=ft.content||"")}for(const ft of xe.messages)ft.videoUrl&&ft.videoUrl.trim()&&(We=ft.videoUrl);const ht=[...xe.messages].reverse().find(ft=>ft.isQuestion&&ft.role==="ava");if(ht){At={id:ht.questionId||"",sectionId:ht.sectionId||"",sectionTitle:ht.sectionTitle||"",text:ht.content||"",videoUrl:We||void 0},ht.questionNumber&&(Xt={current:ht.questionNumber,total:ht.totalQuestions||27,percentage:Math.round(ht.questionNumber/(ht.totalQuestions||27)*100)});const ft=xe.messages.findIndex(ta=>ta.id===ht.id),Vs=ft>=0&&ft+1<xe.messages.length&&((ze=xe.messages[ft+1])==null?void 0:ze.role)==="user";xt="questions"}else We?xt="showing-intro":Le&&(xt="awaiting-name");xe.messages.some(ft=>{var Vs,ta;return ft.role==="ava"&&(((Vs=ft.content)==null?void 0:Vs.includes("completed all 27 questions"))||((ta=ft.content)==null?void 0:ta.includes("Phase 1 is now complete")))})&&(xt="complete");const Vt=new Map;return xe.messages.forEach(ft=>{var ta;const Vs=ft.id||`${ft.role}-${(ta=ft.content)==null?void 0:ta.substring(0,50)}`;Vt.has(Vs)||Vt.set(Vs,{...ft,timestamp:ft.timestamp?typeof ft.timestamp=="string"?new Date(ft.timestamp):ft.timestamp:new Date})}),{messages:Array.from(Vt.values()),stage:xt,userName:Le,progress:Xt,videoUrl:We,currentQuestion:At}}console.log(" Backend has no conversation history, trying localStorage fallback...");const He=se(g.id);if(!He)return null;try{const Le=localStorage.getItem(He);if(Le){const We=JSON.parse(Le);if(console.log(" Restoring Phase 1 chat state from localStorage:",We),We.messages&&We.messages.length>0&&e){console.log(" Syncing localStorage messages to backend...");try{await ca(e,We.messages),console.log(" Successfully synced conversation history to backend")}catch(xt){console.warn(" Failed to sync conversation history to backend:",xt)}}return We}}catch(Le){console.error("Failed to load persisted state:",Le)}return null},$e=i.useRef(!0),Ae=i.useRef(!1),Ee=i.useRef(0),ce=i.useRef(!1),we=i.useRef(!1),Te=i.useRef(!1),Ue=i.useRef(0),lt=i.useRef(0),Ze=i.useRef(null);i.useEffect(()=>{(y==="questions"||y==="complete"||y==="showing-intro")&&(we.current=!0)},[y]),i.useEffect(()=>{if(y!=="questions")return;const xe=v.filter(He=>He.isQuestion&&He.questionNumber);if(xe.length===0)return;const Me=xe[xe.length-1].questionNumber;Me&&Me!==z.current&&(z.current=Me,E(!0))},[v,y]),i.useEffect(()=>{if(v.length===0){Ee.current=0,Ue.current=0;return}const xe=v.length,De=xe>Ee.current,Me=v[v.length-1],He=(Me==null?void 0:Me.content)||"";if(Te.current&&!ce.current){ce.current=!0,Ee.current=xe,Ue.current=He.length,setTimeout(()=>{var Le;const ze=be.current||y;ze!=="processing-name"&&ze!=="showing-intro"&&((Le=m.current)==null||Le.scrollIntoView({behavior:"smooth"}))},300);return}if($e.current&&!Ae.current){Ae.current=!0,Ee.current=xe,Ue.current=He.length,setTimeout(()=>{const ze=be.current||y;ze!=="processing-name"&&ze!=="showing-intro"&&window.scrollTo({top:0,behavior:"smooth"})},100);return}if(y==="complete"){Ee.current=xe,Ue.current=He.length;return}Ae.current&&De&&je()||(Ee.current=xe,Ue.current=He.length)},[v,y]);const ge=i.useRef(!1),pe=i.useRef(null),ke=i.useRef(v),be=i.useRef(y),je=()=>{const xe=be.current||y;return xe==="processing-name"||xe==="showing-intro"};i.useEffect(()=>{ke.current=v,be.current=y},[v,y]),i.useEffect(()=>{var Me,He;if(pe.current&&(clearInterval(pe.current),pe.current=null),v.length===0||$e.current&&!Ae.current)return;if(y==="complete"||o){ge.current=!1;return}if(je()){pe.current&&(clearInterval(pe.current),pe.current=null),ge.current=!1;const ze=ke.current[ke.current.length-1],Le=((Me=ze==null?void 0:ze.content)==null?void 0:Me.length)||0;lt.current=Le;return}const xe=ke.current[ke.current.length-1],De=((He=xe==null?void 0:xe.content)==null?void 0:He.length)||0;return lt.current=De,ge.current=!1,()=>{pe.current&&(clearInterval(pe.current),pe.current=null),ge.current=!1}},[v,y]),i.useEffect(()=>{let xe=!1;const De=()=>{xe||(window.requestAnimationFrame(()=>{const He=le.current,ze=(He==null?void 0:He.scrollTop)||0,Le=oe.current;if(ze<50){L(!0),oe.current=ze,xe=!1;return}ze>Le&&ze>100?L(!1):ze<Le&&L(!0),oe.current=ze,xe=!1}),xe=!0)},Me=le.current;return Me&&(oe.current=Me.scrollTop||0,De(),Me.addEventListener("scroll",De,{passive:!0})),()=>{Me&&Me.removeEventListener("scroll",De)}},[]);const Re=i.useRef(0),Y=i.useRef(null),te=async()=>{if(!(!e||v.length===0)){Y.current&&(clearTimeout(Y.current),Y.current=null);try{await ca(e,v),Re.current=Date.now(),console.log(" Conversation history saved immediately")}catch(xe){console.error(" Failed to save immediately:",xe)}}};i.useEffect(()=>{if(f.current&&v.length>0&&(J(),e))return Y.current&&clearTimeout(Y.current),Y.current=setTimeout(async()=>{try{await ca(e,v),Re.current=Date.now(),console.log(" Conversation history auto-saved to backend")}catch(xe){console.warn(" Failed to auto-save conversation to backend:",xe)}},250),()=>{Y.current&&clearTimeout(Y.current)}},[v,y,N,P,G,Q,e]),i.useEffect(()=>{if(!e||v.length===0)return;const xe=()=>{if(Date.now()-Re.current>1e3){console.log(" Saving conversation before page unload...");const ze=localStorage.getItem("accessToken"),Le=new XMLHttpRequest;Le.open("POST",`${Fe}/ava-sessions/${e}/conversation-history`,!1),Le.setRequestHeader("Content-Type","application/json"),ze&&Le.setRequestHeader("Authorization",`Bearer ${ze}`);try{Le.send(JSON.stringify({messages:v}))}catch(We){console.error("Failed to save before unload:",We)}}},De=()=>{document.hidden&&te()},Me=()=>{te()};return window.addEventListener("beforeunload",xe),window.addEventListener("pagehide",Me),document.addEventListener("visibilitychange",De),()=>{window.removeEventListener("beforeunload",xe),window.removeEventListener("pagehide",Me),document.removeEventListener("visibilitychange",De)}},[e,v]),i.useEffect(()=>{if(!(g!=null&&g.id)||!e)return;const xe=w.current&&w.current!==g.id,De=h.current&&h.current!==e;(xe||De)&&f.current&&(console.log(" Phase 1: Workspace/session changed, resetting state"),x([]),b("intro"),S(""),K({current:0,total:27,percentage:0}),q(ia),V(null),H(),f.current=!1),w.current=g.id,h.current=e},[g==null?void 0:g.id,e]),i.useEffect(()=>{if(f.current||!(g!=null&&g.id)||!e)return;(async()=>{var He,ze;if(await re()){f.current=!0;return}const Me=await Pe();if(Me&&Me.messages&&Me.messages.length>0){console.log(" Restoring Phase 1 chat with",Me.messages.length,"messages"),console.log(" Restored stage:",Me.stage),console.log(" Restored userName:",Me.userName),console.log(" Restored progress:",Me.progress),console.log(" Restored videoUrl:",Me.videoUrl);let Le=null,We=null;if(g!=null&&g.id&&e){const at=`activate-now-messages-${g.id}-${e}`;try{const ht=localStorage.getItem(at);if(ht){const Mt=JSON.parse(ht);Mt.messages&&Array.isArray(Mt.messages)&&Mt.messages.length>0&&(Le=Mt.messages,We=Mt.timestamp||null,console.log(" Found Activate Now messages in localStorage:",Mt.messages.length,"messages - will prepend to restored messages"))}}catch(ht){console.warn("Failed to parse localStorage activate messages:",ht)}}const xt=new Map;if(Le&&Le.length>0){const at=Le.join(""),ht=`activate-msg-restored-${e}`;if(Me.messages.some(Vt=>{var Ls,ft;return((Ls=Vt.id)==null?void 0:Ls.includes("activate-msg"))||Vt.role==="ava"&&((ft=Vt.content)==null?void 0:ft.includes(at.substring(0,50)))}))console.log(" Activate Now message already exists in restored messages, skipping prepend");else{let Vt=new Date;if(We)Vt=new Date(We);else{const ft=Me.messages[0];if(ft!=null&&ft.timestamp){const Vs=typeof ft.timestamp=="string"?new Date(ft.timestamp):ft.timestamp;Vt=new Date(Vs.getTime()-6e4)}}const Ls={id:ht,role:"ava",content:at,timestamp:Vt};xt.set(ht,Ls),console.log(" Prepending Activate Now message to restored messages")}}Me.messages.forEach(at=>{var Mt;const ht=at.id||`${at.role}-${(Mt=at.content)==null?void 0:Mt.substring(0,50)}-${at.videoUrl||""}`;xt.has(ht)||xt.set(ht,{...at,timestamp:at.timestamp?typeof at.timestamp=="string"?new Date(at.timestamp):at.timestamp:new Date,model:at.model||"claude-sonnet-4-20250514"})});const At=Array.from(xt.values());if(x(At),b(Me.stage||"intro"),S(Me.userName||""),K(Me.progress||{current:0,total:27,percentage:0}),q(Me.videoUrl||ia),V(Me.currentQuestion||null),W(!1),Me.stage==="questions"&&At.length>0&&At[At.length-1].role==="user"){const Mt=At.map((ft,Vs)=>ft.isQuestion&&ft.role==="ava"?Vs:-1).filter(ft=>ft>=0).pop(),Vt=At.length-1;Mt!==void 0&&Mt>Vt||(console.log(" Detected user answer without next question after restoration - loading next question..."),e&&Me.progress&&fe({sessionId:e,questionNumber:Me.progress.current||0,timestamp:Date.now()}),setTimeout(()=>{var ft;(ft=ue.current)==null||ft.call(ue)},500))}$e.current=!1,Te.current=!0,ce.current=!1,Ee.current=At.length;const Xt=At[At.length-1];Ue.current=((He=Xt==null?void 0:Xt.content)==null?void 0:He.length)||0,lt.current=((ze=Xt==null?void 0:Xt.content)==null?void 0:ze.length)||0,(Me.stage==="questions"||Me.stage==="complete"||Me.stage==="showing-intro")&&(we.current=!0),console.log(" Phase 1 chat fully restored -",At.length,"unique messages (deduplicated from",Me.messages.length,")")}else{console.log(" Starting fresh Phase 1 chat - no persisted state found"),$e.current=!0,Ae.current=!1,ce.current=!1,Ee.current=0,we.current=!1,Te.current=!1,Ue.current=0,lt.current=0;const Le=xn.getState();if(Le.status==="rendering"&&Le.sessionId===e&&Le.messages.length>0){console.log(" Resuming name submission rendering via Zustand store");const ht=Le.userName||"";ht&&(S(ht),x(Mt=>Mt.some(Ls=>Ls.role==="user"&&Ls.content===ht)?Mt:[...Mt,{id:`msg-${Date.now()}`,role:"user",content:ht,timestamp:new Date,isName:!0}])),b("processing-name"),U(!0);try{await ut(Le.messages,Le.videoUrl)}finally{U(!1)}f.current=!0;return}let We=null,xt=null;if(g!=null&&g.id&&e){const ht=`activate-now-messages-${g.id}-${e}`;try{const Mt=localStorage.getItem(ht);if(Mt){const Vt=JSON.parse(Mt);Vt.messages&&Array.isArray(Vt.messages)&&Vt.messages.length>0&&(We=Vt.messages,console.log(" Found Activate Now messages in localStorage for session:",Vt.messages.length,"messages"))}}catch(Mt){console.warn("Failed to parse localStorage activate messages:",Mt)}}if(!We){xt=sessionStorage.getItem("activate-now-messages");const ht=sessionStorage.getItem("activate-now-in-progress"),Mt=sessionStorage.getItem("activate-now-session-id");if(ht==="true"&&Mt!==e&&(console.log(" Page was refreshed - session ID mismatch, clearing sessionStorage state"),sessionStorage.removeItem("activate-now-in-progress"),sessionStorage.removeItem("activate-now-messages"),sessionStorage.removeItem("activate-now-messages-total"),sessionStorage.removeItem("activate-now-messages-displayed"),sessionStorage.removeItem("activate-now-session-id")),xt&&Mt===e)try{const Vt=JSON.parse(xt);Array.isArray(Vt)&&Vt.length>0&&(We=Vt,console.log(" Found Activate Now messages in sessionStorage for session:",We.length,"messages"))}catch(Vt){console.warn("Failed to parse sessionStorage activate messages:",Vt)}}if(We&&We.length>0){const ht=sessionStorage.getItem("activate-now-in-progress"),Mt=sessionStorage.getItem("activate-now-session-id"),Ls=!(ht==="true"&&Mt===e);console.log(" Rendering Activate Now messages:",We.length,"messages"),console.log(`   - activate-now-in-progress: ${ht}`),console.log(`   - activate-now-session-id: ${Mt}`),console.log(`   - current sessionId: ${e}`),console.log(`   - Mode: ${Ls?"REFRESH (restore immediately)":"FRESH CLICK (show typing)"}`),Ls||W(!0),Ne(We,Ls),Ls&&W(!1);return}const At=`ava-session-state-${g.id}`,Xt=localStorage.getItem(At);let at=null;if(Xt)try{at=JSON.parse(Xt).initialMessage,at&&console.log(" Found initial message from session creation")}catch(ht){console.warn("Failed to parse saved session:",ht)}Ce(at)}f.current=!0})()},[g==null?void 0:g.id,e]),i.useEffect(()=>{v.length>0&&!B&&y!=="processing-name"&&C&&(console.log(" Safety check: Clearing typing indicator - messages exist and not processing"),W(!1))},[v.length,B,y,C]),i.useEffect(()=>()=>{if(e&&v.length>0){console.log(" Component unmounting - saving conversation...");const xe=localStorage.getItem("accessToken"),De=new XMLHttpRequest;De.open("POST",`${Fe}/ava-sessions/${e}/conversation-history`,!1),De.setRequestHeader("Content-Type","application/json"),xe&&De.setRequestHeader("Authorization",`Bearer ${xe}`);try{De.send(JSON.stringify({messages:v})),console.log(" Saved on unmount")}catch(Me){console.error("Failed to save on unmount:",Me)}}},[e,v]);const X=async(xe,De=1e3)=>{W(!0),await new Promise(Me=>setTimeout(Me,De)),W(!1),x(Me=>{var ze;return Me.some(Le=>Le.id===xe.id||!xe.allowDuplicateContent&&Le.role===xe.role&&Le.content===xe.content&&(!Le.videoUrl||Le.videoUrl===xe.videoUrl))?(console.log(" Duplicate message detected, skipping:",(ze=xe.content)==null?void 0:ze.substring(0,50)),Me):[...Me,xe]})},ye=xe=>{x(De=>De.some(He=>He.id===xe.id||!xe.allowDuplicateContent&&He.role===xe.role&&He.content===xe.content&&(!He.videoUrl&&!xe.videoUrl||He.videoUrl===xe.videoUrl))?De:[...De,xe])},Ne=async(xe,De=!1)=>{console.log(" Rendering Activate Now messages as single chunk:",xe.length,"messages",De?"(refresh restore)":"(initial click)");const Me=xe.join("");if(console.log(" Combined",xe.length,"messages into single chunk"),De)console.log(" Restoring Activate Now messages immediately (refresh scenario)"),x(He=>{const ze=He.filter(xt=>{var At;return!((At=xt.id)!=null&&At.startsWith("activate-msg-"))}),Le=`activate-msg-restored-${e}-${Date.now()}`;return ze.some(xt=>xt.role==="ava"&&xt.content===Me)?(console.log(" Activate Now message already exists, skipping restore"),ze):[{id:Le,role:"ava",content:Me,timestamp:new Date},...ze]});else{console.log(" Fresh click: Showing typing indicator FIRST, then rendering Activate Now messages"),x(ze=>ze.filter(Le=>{var We;return!((We=Le.id)!=null&&We.startsWith("activate-msg-"))})),W(!0),await new Promise(ze=>setTimeout(ze,1500)),console.log(" Rendering combined message chunk after typing animation"),W(!1);const He=`activate-msg-${Date.now()}`;ye({id:He,role:"ava",content:Me,timestamp:new Date})}sessionStorage.setItem("activate-now-in-progress","false"),sessionStorage.removeItem("activate-now-messages-total"),sessionStorage.removeItem("activate-now-messages-displayed"),console.log(" Activate Now messages rendered as single chunk")},Ce=async xe=>{xe?(console.log(" Using initial message from API:",xe.substring(0,100)),await X({id:`msg-intro-${Date.now()}`,role:"ava",content:xe,timestamp:new Date},1500)):(await X({id:`msg-${Date.now()}`,role:"ava",content:"Hi! I'm A.V.A. (Audience Values Accelerator), an elite-level AI specifically engineered to help online coaches, course creators, and consultants achieve unprecedented clarity about their ideal clients.",timestamp:new Date},1500),await X({id:`msg-${Date.now()}`,role:"ava",content:"I go far beyond typical audience profiling, delivering deep psychological and psychographic analysis. My insights uncover hidden motivations, subconscious desires, emotional barriers, and decision-making triggers, empowering you to resonate powerfully with your ideal clients.",timestamp:new Date},1e3),await X({id:`msg-${Date.now()}`,role:"ava",content:"What's your name?",timestamp:new Date},800)),W(!1),b("awaiting-name")},Ve=y==="showing-intro",tt=async()=>{const xe=j.trim();!xe||B||(y==="awaiting-name"||y==="intro"?await bt(xe):y==="questions"&&await Kt(xe))},Je=(xe,De=!1)=>{x(Me=>Me.some(ze=>ze.role==="user"&&ze.content===xe)&&!De?Me:[...Me,{id:`msg-${Date.now()}`,role:"user",content:xe,timestamp:new Date,isName:!0}])},rt=async(xe,De)=>{var ze;if(!e)throw new Error("Session ID is missing. Please refresh the page and try again.");console.log(" Calling updateSessionName API for session:",e,"with name:",xe),console.log(" API URL:",`${Fe}/ava-sessions/${e}/name`);const Me=await nj(e,xe);if(console.log(" Name submission API response received:",Me),!Me)throw new Error("No response received from API");S(xe),c&&c(xe),q(Me.videoUrl||ia);const He=Array.isArray(Me.message)?Me.message:typeof Me.message=="string"?[Me.message]:null;if(He&&He.length>0){try{xn.getState().setPayload({sessionId:e,userName:xe,messages:He,videoUrl:Me.videoUrl,renderedCount:(De==null?void 0:De.renderedCount)??0,videoShown:(De==null?void 0:De.videoShown)??!1})}catch(Le){console.warn(" Failed to persist name response to storage:",Le),(ze=Le.message)!=null&&ze.includes("quota")&&console.warn(" Storage quota exceeded, continuing without persistence")}await ut(He,Me.videoUrl)}else console.log(" Unexpected message format, using fallback"),H(),await dt(xe,Me.videoUrl)},bt=async xe=>{console.log(" Name submission started - clearing any previous state to start fresh from index 0");const De=sessionStorage.getItem("name-submission-retrigger")==="true";ae({preserveName:De,preserveSession:De,preserveStore:!0}),De&&sessionStorage.removeItem("name-submission-retrigger"),sessionStorage.setItem("name-submission-in-progress","true"),sessionStorage.setItem("name-submission-stored-name",xe),e&&sessionStorage.setItem("name-submission-session-id",e),x(Me=>Me.filter(He=>{var ze;return!((ze=He.id)!=null&&ze.startsWith("name-submit-msg-"))})),Je(xe,!0),k(""),U(!0),b("processing-name");try{await rt(xe)}catch(Me){console.error(" Failed to submit name:",Me),console.error(" Error details:",{message:Me.message,stack:Me.stack,sessionId:e,name:xe}),ae(),H(),d({title:"Error",description:Me.message||"Failed to submit name. Please check console for details.",variant:"destructive"}),r==null||r(Me.message),b("awaiting-name")}finally{U(!1)}};i.useEffect(()=>{me.current=bt}),i.useEffect(()=>{if(!e||!ee.current||ne.current)return;const xe=sessionStorage.getItem("name-submission-session-id");if(xe&&xe!==e){console.log(" Stored name submission session mismatch. Clearing state."),ee.current=null,ae();return}const De=ee.current;De&&(console.log(" Retriggering name submission API with stored name:",De),ne.current=!0,ee.current=null,setTimeout(()=>{var Me;(Me=me.current)==null||Me.call(me,De)},300))},[e]);const ut=async(xe,De)=>{console.log(" Rendering name submission API response messages:",xe.length,"messages"),de();const Me=(De==null?void 0:De.trim())||ia,He=xn.getState();(He.status==="idle"||He.sessionId!==e)&&He.setPayload({sessionId:e,userName:N||He.userName||"",messages:xe,videoUrl:Me});const ze=xe.length,Le=He.renderedCount,We=Le>=ze&&ze>0,xt=We?ze:Le,At=xt>0;if(At){console.log(` Rehydrating ${xt} intro messages from store`);for(let at=0;at<xt;at++)ye({id:`name-submit-cached-${at}`,role:"ava",content:xe[at],timestamp:new Date,model:"claude-sonnet-4-20250514"});sessionStorage.setItem("name-submission-messages-displayed",String(xt))}else sessionStorage.setItem("name-submission-messages-displayed","0");if(!We){await new Promise(at=>setTimeout(at,At?500:1e3));for(let at=xt;at<ze;at++){const ht=xe[at];await X({id:`name-submit-msg-${at}-${Date.now()}`,role:"ava",content:ht,timestamp:new Date,model:"claude-sonnet-4-20250514"},at===xt?500:800),sessionStorage.setItem("name-submission-messages-displayed",String(at+1)),xn.getState().incrementRendered(),console.log(` Rendered name submission message ${at+1}/${ze}`),at<ze-1&&await new Promise(Mt=>setTimeout(Mt,500))}}const Xt=xn.getState().videoShown;Me&&!Xt&&(await X({id:`msg-${Date.now()}`,role:"ava",content:"Before we proceed, please watch this video to understand the process:",timestamp:new Date,videoUrl:Me},1e3),xn.getState().markVideoShown()),xn.getState().markComplete(),ae(),console.log(" Name submission messages rendered completely"),b("showing-intro")},dt=async(xe,De)=>{H();const Me=GM(xe);for(let ze=0;ze<Me.length;ze++)await X({id:`msg-${Date.now()}-${ze}`,role:"ava",content:Me[ze],timestamp:new Date},ze===0?800:1e3);const He=(De==null?void 0:De.trim())||ia;await X({id:`msg-${Date.now()}`,role:"ava",content:"Before we proceed, please watch this video to understand the process:",timestamp:new Date,videoUrl:He},1e3),b("showing-intro"),ae()},Qt=xe=>{const De=`<strong>Section ${xe.sectionId}: ${xe.sectionTitle}</strong>`,Me=`<strong>${xe.id}. ${xe.text}</strong>`;return`${De}<br><br>${Me}`},hn=async()=>{U(!0),W(!0);try{const xe=await rj(e);V(xe.question),K(xe.progress),b("questions");const De=xe.progress.current||1,Me=Qt(xe.question);await X({id:`msg-${Date.now()}`,role:"ava",content:Me,timestamp:new Date,isQuestion:!0,questionNumber:De,totalQuestions:xe.progress.total,examples:xe.examples||[],sectionTitle:xe.question.sectionTitle,videoUrl:xe.question.videoUrl,model:"claude-sonnet-4-20250514"},1e3)}catch(xe){console.error("Failed to start Phase 1:",xe),W(!1),d({title:"Error",description:xe.message||"Failed to start Phase 1",variant:"destructive"}),r==null||r(xe.message),b("intro")}finally{U(!1)}},Ke=xe=>xe.replace(/<[^>]*>/g,"").replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/\s+/g," ").trim().toLowerCase(),Ct=(xe,De)=>{if(!De)return!1;const Me=Ke(xe),He=Ke(De.text);if(Me===He)return!0;const ze=Ke(`${De.id}. ${De.text}`);if(Me===ze)return!0;const Le=Qt(De),We=Ke(Le);return Me===We},Kt=async xe=>{if(Ct(xe,Q)){Z("Please provide your own answer. You cannot submit the question text as your answer."),d({title:"Invalid Answer",description:"Please provide your own answer. You cannot submit the question text as your answer.",variant:"destructive"});return}const De=v.filter(Me=>Me.isQuestion&&Me.role==="ava").pop();if(De){const Me=Ke(xe),He=Ke(De.content);if(Me===He){Z("Please provide your own answer. You cannot submit the question text as your answer."),d({title:"Invalid Answer",description:"Please provide your own answer. You cannot submit the question text as your answer.",variant:"destructive"});return}}Z(null),x(Me=>[...Me,{id:`msg-${Date.now()}`,role:"user",content:xe,timestamp:new Date}]),k(""),Z(null),U(!0),W(!0),e&&fe({sessionId:e,questionNumber:P.current||0,timestamp:Date.now()});try{const Me=await aj(e,xe);console.log(" Answer submitted, response:",Me),Me.isPhaseComplete||Me.phase2AutoStarted||Me.nextAction==="start_phase2"?(await X({id:`msg-${Date.now()}`,role:"ava",content:`Amazing work, ${N}!  You've completed all 27 questions. All answers are saved to the database.`,timestamp:new Date},1e3),Me.videoUrl&&await X({id:`msg-${Date.now()}`,role:"ava",content:"Phase 1 is now complete. Watch this video to learn about Phase 2:",timestamp:new Date,videoUrl:Me.videoUrl},1200),console.log(" Phase 1 complete - conversation history preserved for Phase 2"),b("complete"),he(),requestAnimationFrame(()=>{requestAnimationFrame(()=>{if(Ze.current)Ze.current.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),console.log(" Scrolled to Start Phase 2 button");else{const He=()=>{const Le=Array.from(document.querySelectorAll("button")).find(We=>{var xt;return(xt=We.textContent)==null?void 0:xt.trim().includes("Start Phase 2")});return Le?(Le.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),console.log(" Scrolled to Start Phase 2 button (found by text)"),!0):!1};He()||setTimeout(()=>{He()||setTimeout(He,300)},100)}})})):(Me.motivationalMessage?(W(!0),await new Promise(He=>setTimeout(He,800)),x(He=>{const ze={id:`msg-motivational-${Date.now()}`,role:"ava",content:Me.motivationalMessage,timestamp:new Date,allowDuplicateContent:!0,model:"claude-sonnet-4-20250514"};return He.some(We=>We.id===ze.id||!ze.allowDuplicateContent&&We.role===ze.role&&We.content===ze.content)?(console.log(" Duplicate motivational message detected, skipping"),He):[...He,ze]})):W(!1),await Rt())}catch(Me){console.error("Failed to submit answer:",Me),he(),W(!1),d({title:"Error",description:Me.message||"Failed to submit answer",variant:"destructive"}),r==null||r(Me.message)}finally{U(!1)}},Rt=async()=>{var xe,De;W(!0);try{const Me=localStorage.getItem("accessToken"),He=await fetch(`${Fe}/ava-sessions/${e}/current-question`,{method:"GET",headers:{"Content-Type":"application/json",...Me&&{Authorization:`Bearer ${Me}`}}});if(!He.ok)throw new Error("Failed to fetch next question");const ze=await He.json(),Le=ze.data||ze;if(console.log(" Next question fetched:",Le),Le.question){V(Le.question),K(Le.progress||P);const We=Qt(Le.question);await X({id:`msg-${Date.now()}`,role:"ava",content:We,timestamp:new Date,isQuestion:!0,questionNumber:((xe=Le.progress)==null?void 0:xe.current)||1,totalQuestions:((De=Le.progress)==null?void 0:De.total)||27,examples:Le.examples||[],sectionTitle:Le.question.sectionTitle,videoUrl:Le.question.videoUrl,model:"claude-sonnet-4-20250514"},1e3),he()}}catch(Me){console.error("Failed to fetch next question:",Me),W(!1),d({title:"Error",description:"Failed to load next question",variant:"destructive"})}};ue.current=Rt,i.useEffect(()=>{var He,ze;if(!e||y!=="questions"||ve.current||D.current)return;if(v.length>0){const Le=v[v.length-1],We=(Le==null?void 0:Le.role)==="user",xt=v.map((at,ht)=>at.isQuestion&&at.role==="ava"?ht:-1).filter(at=>at>=0).pop(),At=We?v.length-1:-1,Xt=xt!==void 0&&xt>At;if(We&&!Xt){console.log(" Detected user answer without next question - loading next question..."),ve.current=!0,D.current=!0,P.current>0&&fe({sessionId:e,questionNumber:P.current,timestamp:Date.now()}),(He=ue.current)==null||He.call(ue).finally(()=>{ve.current=!1});return}}const xe=Se();if(!xe||xe.sessionId!==e)return;const De=(xe.questionNumber||0)+1;if(v.some(Le=>Le.isQuestion&&Le.questionNumber===De)){he();return}console.log(" Detected pending question after refresh. Resuming fetch..."),ve.current=!0,D.current=!0,(ze=ue.current)==null||ze.call(ue).finally(()=>{ve.current=!1})},[e,y,v,P]);const Yt=xe=>{xe.key==="Enter"&&!xe.shiftKey&&(xe.preventDefault(),tt())},Bt=xe=>{xe.style.height="auto";const De=Math.min(xe.scrollHeight,200);xe.style.height=`${De}px`},Ts=xe=>{var De;k(xe),setTimeout(()=>{p.current&&Bt(p.current)},0),(De=p.current)==null||De.focus()};i.useEffect(()=>{p.current&&Bt(p.current)},[j]);const us=(xe,De)=>{_(xe),F(De)},Mn=async xe=>{if(!$.trim()){d({title:"Error",description:"Answer cannot be empty",variant:"destructive"});return}T(!0);try{let De=[];x(Me=>(De=Me.map(He=>He.id===xe?{...He,content:$.trim()}:He),De)),e&&De.length>0&&await ca(e,De),_(null),F(""),d({title:"Saved",description:"Your answer has been updated successfully"})}catch(De){console.error("Failed to save edit:",De),d({title:"Save Failed",description:(De==null?void 0:De.message)||"Failed to save your edit",variant:"destructive"})}finally{T(!1)}},_s=()=>{_(null),F("")},ll=(xe,De)=>{if(xe.role!=="user"||y!=="questions"&&y!=="complete")return!1;const Me=v.slice(0,De),He=Me.some(We=>We.isQuestion&&We.role==="ava"),ze=!Me.some(We=>We.role==="user"),Le=xe.isName===!0||!He&&ze;return He&&!Le},Wu=n||(async()=>{if(e)try{await _u(e),console.log(" Session cancelled via API")}catch(xe){console.error(" Failed to cancel session:",xe)}if(g!=null&&g.id){localStorage.removeItem(`ava-session-state-${g.id}`);const xe=se(g.id);xe&&localStorage.removeItem(xe),Object.keys(localStorage).forEach(De=>{(De.startsWith(`ava-phase1-state-${g.id}-`)||De.startsWith(`ava-phase2-${g.id}-`))&&localStorage.removeItem(De)})}localStorage.removeItem("ava-session-state"),localStorage.removeItem("ava-chat-session"),u("/tools/ava",{replace:!0,state:{scrollToBottom:!0,resetTimestamp:Date.now()}}),setTimeout(()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})},500)});return s.jsxs("div",{className:`flex flex-col ${a?"":"min-h-screen"} bg-background pb-4 relative`,children:[s.jsxs("div",{ref:le,className:`${a?"":"flex-1 overflow-y-auto"} px-4 sm:px-6 py-8`,style:{paddingBottom:"100px"},children:[!a&&s.jsx("div",{className:`sticky top-0 z-50 bg-background/95 backdrop-blur-sm transition-transform duration-300 ${R?"translate-y-0":"-translate-y-full"}`,style:{backfaceVisibility:"hidden",willChange:"transform"},children:s.jsx(sj,{stage:y==="complete"?"complete":"phase1",userName:N||"User",progress:{currentQuestionIndex:Math.max(0,((P==null?void 0:P.current)||0)-1),totalQuestions:(P==null?void 0:P.total)||27},offsetClassName:"",onReset:Wu})}),s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[v.filter((xe,De,Me)=>{const He=Me.findIndex(ze=>ze.id===xe.id);return He!==De&&He>=0?!1:xe.id?!0:Me.findIndex(Le=>Le.role===xe.role&&Le.content===xe.content&&(!Le.videoUrl||Le.videoUrl===xe.videoUrl))===De}).map((xe,De)=>{var Me,He,ze,Le;return s.jsx("div",{"data-question-id":xe.isQuestion?xe.id:void 0,children:xe.role==="ava"?s.jsx("div",{className:"flex gap-3 items-start",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsxs("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:[(()=>{const We=typeof xe.content=="string"&&/<[^>]+>/.test(xe.content);return s.jsx("div",{className:`text-[15px] leading-relaxed text-gray-900 ${We?"":"whitespace-pre-wrap"}`,children:We?s.jsx("div",{className:"ava-message-content",dangerouslySetInnerHTML:{__html:xe.content}}):xe.content})})(),xe.videoUrl&&s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"relative w-full bg-black rounded-lg overflow-hidden",style:{paddingTop:"56.25%"},children:s.jsx("iframe",{src:(()=>{const We=xe.videoUrl.match(/vimeo\.com\/(\d+)(?:\/([a-zA-Z0-9]+))?/);if(!We)return"";const xt=We[1],At=We[2];let Xt=`https://player.vimeo.com/video/${xt}`;const at=new URLSearchParams({title:"0",byline:"0",portrait:"0",autoplay:"0"});return At&&at.set("h",At),Xt+="?"+at.toString(),Xt})(),className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"AVA Video"})}),y==="showing-intro"&&((Me=xe.content)==null?void 0:Me.includes("Before we proceed, please watch this video"))&&s.jsx("div",{className:"flex justify-center mt-6 animate-fade-in",children:s.jsx(Ie,{onClick:async We=>{We.stopPropagation(),We.preventDefault(),await hn()},size:"lg",disabled:B,className:"w-full h-14 text-lg bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink text-white shadow-2xl hover:shadow-3xl hover:brightness-110 transform hover:-translate-y-0.5 transition duration-300 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:B?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Loading..."]}):"Ready to move on?"})}),y==="complete"&&!o&&((He=xe.content)==null?void 0:He.includes("Phase 1 is now complete"))&&s.jsx("div",{className:"flex justify-center mt-6 animate-fade-in",children:s.jsx(Ie,{ref:Ze,onClick:We=>{We.stopPropagation(),We.preventDefault();const xt={scrollY:window.scrollY,scrollX:window.scrollX,timestamp:Date.now()};sessionStorage.setItem("ava-phase2-transition-scroll",JSON.stringify(xt)),sessionStorage.setItem("ava-phase2-hide-phase1-messages","true"),requestAnimationFrame(()=>{window.scrollTo({top:xt.scrollY,left:xt.scrollX})}),t(N||"User")},size:"lg",className:"bg-gradient-to-r from-vox-pink to-vox-orange text-white hover:shadow-xl hover:scale-105 transition-all duration-200 px-8 py-6 text-lg font-semibold",children:"Start Phase 2"})})]}),xe.examples&&xe.examples.length>0&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[s.jsxs("button",{onClick:()=>{var At;const We=xe.id;((At=v.filter(Xt=>Xt.isQuestion).pop())==null?void 0:At.id)===We&&E(!A)},className:"text-xs font-medium text-vox-pink hover:text-vox-orange flex items-center gap-1 mb-2",children:[s.jsx(Gs,{className:`w-3 h-3 transition-transform ${A&&((ze=v.filter(We=>We.isQuestion).pop())==null?void 0:ze.id)===xe.id?"rotate-180":""}`}),"Show examples"]}),A&&((Le=v.filter(We=>We.isQuestion).pop())==null?void 0:Le.id)===xe.id&&s.jsx("div",{className:"space-y-2",children:xe.examples.map((We,xt)=>s.jsx("button",{onClick:()=>Ts(We),className:"block w-full text-left px-3 py-2 text-sm bg-muted hover:bg-muted/80 rounded-lg text-foreground transition-colors",children:We},xt))})]})]})})}):s.jsx("div",{className:"flex gap-3 items-start justify-end",children:s.jsx("div",{className:"flex-1 max-w-[85%] flex flex-col items-end gap-2",children:(()=>{const We=v.slice(0,De),xt=We.some(at=>at.isQuestion&&at.role==="ava"),At=!We.some(at=>at.role==="user"),Xt=xe.isName===!0||!xt&&At;return s.jsx(s.Fragment,{children:I===xe.id?s.jsxs("div",{className:"flex flex-col gap-3 w-full",children:[s.jsx(fs,{value:$,onChange:at=>F(at.target.value),className:"min-h-[100px] text-[15px] leading-relaxed w-full bg-white border border-pink-200 focus:border-pink-300 focus:ring-0 focus:outline-none rounded-lg px-4 py-3 transition-all duration-200 resize-none placeholder:text-gray-400",placeholder:"Edit your answer here...",autoFocus:!0}),ll(xe,De)&&s.jsxs("div",{className:"flex gap-2.5 items-center justify-end",children:[s.jsxs(Ie,{variant:"outline",size:"sm",onClick:_s,className:"group border-2 bg-white hover:bg-gray-50 border-gray-200 hover:border-gray-300 text-gray-600 hover:text-gray-700 text-xs font-medium h-9 px-4 transition-all duration-200 shadow-sm hover:shadow-md hover:scale-[1.02] active:scale-[0.98]",children:[s.jsx(Es,{className:"w-3.5 h-3.5 mr-1.5"}),s.jsx("span",{className:"relative z-10",children:"Cancel"})]}),s.jsxs(Ie,{size:"sm",onClick:()=>Mn(xe.id),disabled:M||!$.trim(),className:"group relative bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink text-white text-xs font-medium h-9 px-5 shadow-md hover:shadow-lg transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-60 disabled:cursor-not-allowed disabled:hover:scale-100 hover:from-vox-pink/90 hover:via-vox-orange/90 hover:to-vox-pink/90",children:[M?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-3.5 h-3.5 mr-1.5 animate-spin"}),s.jsx("span",{children:"Saving..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(ns,{className:"w-3.5 h-3.5 mr-1.5 transition-transform group-hover:scale-110"}),s.jsx("span",{className:"relative z-10",children:"Save Changes"})]}),s.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 opacity-0 group-hover:opacity-100 rounded-md transition-opacity duration-300"})]})]})]}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`bg-gradient-to-br from-vox-pink/10 to-vox-orange/10 rounded-2xl rounded-tr-sm px-4 py-3 ${Xt?"w-fit max-w-full":"w-full"}`,children:(()=>{const at=typeof xe.content=="string"&&/<[^>]+>/.test(xe.content);return s.jsx("p",{className:`text-[15px] leading-relaxed text-gray-800 ${at?"":"whitespace-pre-wrap"}`,children:at?s.jsx("span",{dangerouslySetInnerHTML:{__html:xe.content}}):xe.content})})()}),ll(xe,De)&&s.jsx("div",{className:"flex gap-2 items-center w-full justify-end",children:s.jsxs(Ie,{variant:"ghost",size:"sm",onClick:()=>us(xe.id,xe.content),className:"group relative border-2 bg-white hover:bg-gradient-to-r hover:from-vox-purple/5 hover:to-indigo-50 border-vox-purple/30 hover:border-vox-purple/60 text-gray-700 hover:text-vox-purple text-xs font-medium h-9 px-4 transition-all duration-300 shadow-sm hover:shadow-md hover:scale-[1.02] active:scale-[0.98] overflow-hidden",children:[s.jsx(Fw,{className:"w-3.5 h-3.5 mr-1.5 transition-all duration-300 group-hover:rotate-12 group-hover:scale-110"}),s.jsx("span",{className:"relative z-10",children:"Edit"}),s.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-vox-purple/0 via-vox-purple/10 to-indigo/0 opacity-0 group-hover:opacity-100 rounded-md transition-opacity duration-300"})]})})]})})})()})})},`${xe.id}-${De}`)}),C&&s.jsx("div",{className:"flex gap-3 items-start animate-fade-in",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsx("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:s.jsx(Va,{})})})}),s.jsx("div",{ref:m})]})]}),s.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-background z-20 px-4 sm:px-6 pb-4 pt-2",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsx("div",{className:"flex gap-3 items-end",children:s.jsxs("div",{className:"flex-1 max-w-[85%] flex flex-col gap-2 ml-[140px]",children:[s.jsxs("div",{className:`flex gap-3 items-end bg-background rounded-xl border p-3 shadow-lg transition-colors ${ie?"border-red-500 border-2":"border-input"}`,children:[s.jsx(fs,{ref:p,value:j,onChange:xe=>{k(xe.target.value),ie&&Z(null),Bt(xe.target)},onKeyDown:Yt,placeholder:y==="awaiting-name"?"Enter your name...":y==="questions"?"Type your answer...":y==="showing-intro"?"Review AVA's intro and click Ready to Move On...":y==="complete"?"Phase 1 complete. Click 'Start Phase 2' to continue...":"",disabled:B||C||y==="processing-name"||y==="complete"||Ve,autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",spellCheck:"false","data-form-type":"other",className:`flex-1 bg-transparent border-none text-foreground placeholder-muted-foreground resize-none focus:ring-0 focus:outline-none min-h-[24px] max-h-[200px] ${ie?"text-red-600":""} ${Ve?"cursor-not-allowed opacity-70":""}`,title:Ve?"Finish AVA's intro above and click Ready to Move On first.":void 0,rows:1,style:{minHeight:"24px",maxHeight:"200px"}}),s.jsx(Ie,{onClick:tt,disabled:!j.trim()||B||C||y==="processing-name"||y==="complete"||Ve,className:`bg-gradient-to-r from-vox-pink to-vox-orange text-white hover:shadow-lg disabled:opacity-50 p-2 h-10 w-10 flex items-center justify-center rounded-lg ${Ve?"cursor-not-allowed":""}`,children:s.jsx(hu,{className:"w-4 h-4"})})]}),ie&&s.jsx("div",{className:"flex items-start gap-2 px-1 animate-fade-in",children:s.jsx("div",{className:"flex-1 bg-red-50 border-2 border-red-300 rounded-lg px-3 py-2.5 shadow-sm",children:s.jsxs("p",{className:"text-sm font-medium text-red-700 flex items-center gap-2",children:[s.jsx(ph,{className:"w-4 h-4 text-red-600 flex-shrink-0"}),s.jsx("span",{children:ie})]})})})]})}),s.jsx("p",{className:"text-xs text-center text-muted-foreground mt-2",children:"Press Enter to send, Shift+Enter for new line"})]})})]})},YM=({userName:e,phase1Answers:t,backendSessionId:n,onComplete:r,onStartOver:a,onProgressChange:o,onExportPDF:l,onPhase2CompleteChange:c,showPhase1History:u=!0})=>{const d=Lt(),{toast:g}=yt(),{currentWorkspace:m}=ls(),p=i.useRef(null),f=i.useRef(null),w=i.useRef(null),h=i.useRef(!1),v=i.useRef(new Map),x=i.useRef(null),y=i.useRef(!1),b=i.useRef(null),N=i.useRef(null),S=i.useRef(null),j=i.useRef(!1),k=i.useRef(null),C=ge=>ge?`ava-phase2-${ge}-${n||"unknown"}`:(console.warn(" Cannot create persistence key without workspace ID"),null),W=ge=>{if(!ge)return null;try{const pe=C(ge);if(!pe)return null;const ke=localStorage.getItem(pe);if(ke){const be=JSON.parse(ke);return console.log(` Restoring Phase 2 state (raw) for workspace ${ge}:`,be),be!=null&&be.sections&&Array.isArray(be.sections)?be.sections=be.sections.map(je=>(console.log(` Sanitizing section ${je.sectionNumber} - resetting approval states and clearing stuck generating states`),{...je,questions:je.questions.map(Re=>({...Re,isApproved:!1,status:Re.status==="generating"?"ready":Re.status}))})):console.log(" Detected minimal state format - will restore position only, backend will provide content"),console.log(" Restoring Phase 2 state (sanitized):",be),be}}catch(pe){console.error("Failed to load persisted Phase 2 state:",pe)}return null},[B,U]=i.useState([]),[Q,V]=i.useState(null),[P,K]=i.useState(0),[G,q]=i.useState([]),[A,E]=i.useState(!1),[R,L]=i.useState(null),[I,_]=i.useState(""),[$,F]=i.useState(!1),[M,T]=i.useState(!1),[ie,Z]=i.useState(null),[le,oe]=i.useState(null),[z,ee]=i.useState(!1),[ne,me]=i.useState([]),ve={A:"Basic Information",B:"Demographics & Background",C:"Professional & Financial Status",D:"Core Problem & Pain Points",E:"Goals & Desired Outcomes",F:"Values & Emotional Drivers",G:"Buying Behavior & Objections",H:"Communication & Content Preferences",I:"Competitor & Market Awareness",J:"Final Reflection & Additional Insights"},[D,ue]=i.useState([]),[O,H]=i.useState(!1),[ae,de]=i.useState(!1),[re,fe]=i.useState(()=>typeof window>"u"?!0:sessionStorage.getItem("ava-phase2-hide-phase1-messages")!=="true"),Se=i.useRef(!1),he=i.useRef(!1);i.useEffect(()=>{if(!(typeof window>"u"))try{const ge=sessionStorage.getItem("ava-phase2-transition-scroll");if(ge){const pe=JSON.parse(ge),ke=typeof pe.scrollY=="number"?pe.scrollY:window.scrollY,be=typeof pe.scrollX=="number"?pe.scrollX:window.scrollX;window.scrollTo({top:ke,left:be,behavior:"auto"}),console.log(" Restored scroll position for Phase 2 transition:",{targetScrollY:ke,targetScrollX:be}),sessionStorage.removeItem("ava-phase2-transition-scroll")}}catch(ge){console.warn(" Failed to restore Phase 2 scroll position:",ge)}},[]),i.useEffect(()=>{if(!(m!=null&&m.id)||!n||Se.current)return;Se.current=!0,(async()=>{try{console.log(" Attempting to restore Phase 2 state from backend...");const ke=await df(n);if(ke&&ke.sections&&ke.sections.length>0){console.log(" Restoring Phase 2 state from backend:",ke);const be=ke.sections.map(Re=>({...Re,questions:Re.questions.map(Y=>({...Y,isApproved:Y.isApproved||!1,status:Y.status==="generating"?"ready":Y.status}))}));U(be),V(ke.currentSection||null);const je=ke.currentQuestionIndex!==void 0?ke.currentQuestionIndex:0;K(je),k.current=je,q(ke.sectionsList||[]),T(!0),console.log(" Phase 2 state restored from backend",{section:ke.currentSection,questionIndex:je});return}}catch(ke){console.warn(" Failed to restore from backend, falling back to localStorage:",ke)}const pe=W(m.id);if(pe){if(pe.sections&&Array.isArray(pe.sections)&&pe.sections.length>0){console.log(" Initial load - restoring Phase 2 state from localStorage (old format) for workspace:",m.id);const ke=pe.sections.map(je=>({...je,questions:je.questions.map(Re=>({...Re,isApproved:!1,status:Re.status==="generating"?"ready":Re.status}))}));U(ke),V(pe.currentSection||null);const be=pe.currentQuestionIndex!==void 0?pe.currentQuestionIndex:0;K(be),k.current=be,q(pe.sectionsList||[]),T(pe.isStarted||!1),console.log(" Phase 2 state restored from localStorage (old format)",{section:pe.currentSection,questionIndex:be})}else if(pe.currentSection!==void 0){console.log(" Initial load - restoring Phase 2 position from localStorage (minimal format) for workspace:",m.id),V(pe.currentSection||null);const ke=pe.currentQuestionIndex!==void 0?pe.currentQuestionIndex:0;K(ke),k.current=ke,T(pe.isStarted||!1),console.log(" Phase 2 position restored from localStorage (minimal format)",{section:pe.currentSection,questionIndex:ke})}ne.length===0&&n&&(async()=>{try{const{getPhase1Answers:ke}=await tr(async()=>{const{getPhase1Answers:Re}=await Promise.resolve().then(()=>Qo);return{getPhase1Answers:Re}},void 0),be=await ke(n);console.log(` Restored ${be.length} Phase 1 answers from backend`);const je=[...be].sort((Re,Y)=>{const te=Ne=>{const Ce=Ne.match(/(\d+)/);return Ce?parseInt(Ce[1],10):0},X=te(Re.questionId||""),ye=te(Y.questionId||"");return X-ye});me(je.length>0?je:be)}catch(ke){console.warn(" Failed to load Phase 1 history during localStorage restore:",ke)}})(),!he.current&&(m!=null&&m.id)&&n&&(he.current=!0,(async()=>{try{const ke=await xi(n);if(ke.messages&&ke.messages.length>0){const be=new Map;ke.messages.forEach(Re=>{var te;const Y=Re.id||`${Re.role}-${(te=Re.content)==null?void 0:te.substring(0,50)}-${Re.videoUrl||""}`;be.has(Y)||be.set(Y,{...Re,timestamp:Re.timestamp?typeof Re.timestamp=="string"?new Date(Re.timestamp):Re.timestamp:new Date})});const je=Array.from(be.values());ue(je),console.log(` Loaded ${je.length} unique Phase 1 messages from backend (deduplicated from ${ke.messages.length})`)}else{const be=`ava-phase1-chat-${m.id}-${n}`,je=localStorage.getItem(be);if(je){const Re=JSON.parse(je);if(Re.messages&&Array.isArray(Re.messages)){const Y=new Map;Re.messages.forEach(X=>{var Ne;const ye=X.id||`${X.role}-${(Ne=X.content)==null?void 0:Ne.substring(0,50)}-${X.videoUrl||""}`;Y.has(ye)||Y.set(ye,{...X,timestamp:X.timestamp?typeof X.timestamp=="string"?new Date(X.timestamp):X.timestamp:new Date})});const te=Array.from(Y.values());ue(te),console.log(` Loaded ${te.length} unique Phase 1 messages from localStorage (deduplicated from ${Re.messages.length})`)}}else console.log(" No Phase 1 messages found in backend or localStorage")}}catch(ke){console.warn(" Failed to load Phase 1 messages:",ke),he.current=!1}})())}else console.log(" Initial load - no saved Phase 2 state for workspace:",m.id)})()},[m==null?void 0:m.id,n]),i.useEffect(()=>{if(!(m!=null&&m.id)||!n||he.current)return;he.current=!0,(async()=>{try{console.log(" Loading Phase 1 messages for Phase 2 display...");const pe=await xi(n);if(pe.messages&&pe.messages.length>0){const ke=new Map;pe.messages.forEach(je=>{var Y;const Re=je.id||`${je.role}-${(Y=je.content)==null?void 0:Y.substring(0,50)}-${je.videoUrl||""}`;ke.has(Re)||ke.set(Re,{...je,timestamp:je.timestamp?typeof je.timestamp=="string"?new Date(je.timestamp):je.timestamp:new Date})});const be=Array.from(ke.values());ue(be),console.log(` Loaded ${be.length} unique Phase 1 messages from backend (deduplicated from ${pe.messages.length})`)}else{const ke=`ava-phase1-chat-${m.id}-${n}`,be=localStorage.getItem(ke);if(be){const je=JSON.parse(be);if(je.messages&&Array.isArray(je.messages)){const Re=new Map;je.messages.forEach(te=>{var ye;const X=te.id||`${te.role}-${(ye=te.content)==null?void 0:ye.substring(0,50)}-${te.videoUrl||""}`;Re.has(X)||Re.set(X,{...te,timestamp:te.timestamp?typeof te.timestamp=="string"?new Date(te.timestamp):te.timestamp:new Date})});const Y=Array.from(Re.values());ue(Y),console.log(` Loaded ${Y.length} unique Phase 1 messages from localStorage (deduplicated from ${je.messages.length})`)}}else console.log(" No Phase 1 messages found in backend or localStorage")}}catch(pe){console.warn(" Failed to load Phase 1 messages:",pe),he.current=!1}})()},[m==null?void 0:m.id,n]);const se=i.useRef(m==null?void 0:m.id),J=i.useRef(n);i.useEffect(()=>{if(!(m!=null&&m.id)||!n||!Se.current)return;const ge=se.current!==(m==null?void 0:m.id),pe=J.current!==n;if(ge||pe){const ke=se.current;se.current=m==null?void 0:m.id,J.current=n,console.log(" Workspace/session changed, validating and reloading Phase 2 state"),ge&&(console.log(` Workspace changed from ${ke} to ${m.id}, resetting Phase 2 state`),U([]),V(null),K(0),q([]),T(!1),E(!1),me([]),ue([]),Se.current=!1,y.current=!1,he.current=!1,j.current=!1,k.current=null),pe&&(console.log(" Session changed, reloading Phase 1 messages"),ue([]),he.current=!1,j.current=!1),(async()=>{try{const{getSessionDetails:je}=await tr(async()=>{const{getSessionDetails:te}=await Promise.resolve().then(()=>Qo);return{getSessionDetails:te}},void 0),Re=await je(n);if(Re.workspaceId!==m.id){console.log(` Session ${n} belongs to workspace ${Re.workspaceId}, but current workspace is ${m.id}. Not loading Phase 2 state.`);return}const Y=W(m.id);if(Y)if(Y.sections&&Array.isArray(Y.sections)&&Y.sections.length>0){console.log(" Workspace/session changed - reloading Phase 2 state (old format):",Y);const te=Y.sections.map(X=>({...X,questions:X.questions.map(ye=>({...ye,isApproved:!1,status:ye.status==="generating"?"ready":ye.status}))}));U(te),V(Y.currentSection||null),K(Y.currentQuestionIndex||0),q(Y.sectionsList||[]),T(Y.isStarted||!1)}else Y.currentSection!==void 0&&(console.log(" Workspace/session changed - reloading Phase 2 position (minimal format):",Y),V(Y.currentSection||null),K(Y.currentQuestionIndex||0),T(Y.isStarted||!1));else console.log(" Workspace/session changed - no saved Phase 2 state, ensuring reset"),U([]),V(null),K(0),q([]),T(!1)}catch(je){console.error(" Failed to validate session workspace in Phase 2:",je),U([]),V(null),K(0),q([]),T(!1)}})()}},[m==null?void 0:m.id,n]);const Pe=21,$e=B.filter(ge=>ge.isComplete).length;i.useEffect(()=>{M||(j.current=!1)},[M]),i.useEffect(()=>{if(Q&&b.current){const ge=b.current.querySelector(`[data-section-number="${Q}"]`);ge&&ge.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[Q]),i.useEffect(()=>{if(j.current||!M||!Q||B.length===0)return;const ge=B.find(ye=>ye.sectionNumber===Q);if(!ge||ge.questions.length===0)return;const pe=k.current!==null||y.current;if(!pe){console.log(" Fresh session detected - skipping scroll restoration, will scroll naturally"),j.current=!0;return}const ke=k.current!==null?k.current:P;let be=Math.min(Math.max(ke,0),ge.questions.length-1);if(k.current!==null)be=Math.min(Math.max(k.current,0),ge.questions.length-1);else if(be===0&&ge.questions.length>1&&y.current){const ye=ge.questions.findIndex(Ne=>!Ne.isApproved);ye>=0&&(be=ye,P!==ye&&(K(ye),k.current=ye,console.log(` Updated currentQuestionIndex from ${P} to ${ye} (first unapproved question)`)))}if(be<0)return;P!==be&&(K(be),console.log(` Adjusting question index from ${P} to ${be} for scroll restoration`));let je=!1;const Re=[],Y=`section-${ge.sectionNumber}-question-${be}`;console.log(` Attempting to restore scroll to question ${be+1} in section ${Q}`,{anchorId:Y,currentQuestionIndex:P,normalizedIndex:be,restoredIndex:k.current,hasAnyRestoredState:pe,totalQuestions:ge.questions.length});const te=(ye=0)=>{if(je)return;const Ne=`[data-phase2-question-anchor="${Y}"]`,Ce=document.querySelector(Ne);if(Ce){requestAnimationFrame(()=>{je||(Ce.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}),setTimeout(()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"}),j.current=!0,console.log(" Restored scroll to Phase 2 question and scrolled to end",{anchorId:Y,attempt:ye,section:Q,questionIndex:be+1})},300))});return}if(ye<20){const Ve=ye<5?300:500,tt=window.setTimeout(()=>te(ye+1),Ve*(ye+1));Re.push(tt)}else console.warn(" Failed to restore scroll after 20 attempts - question element not found",{anchorId:Y}),window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"}),j.current=!0},X=setTimeout(()=>{const ye=window.requestAnimationFrame(()=>{requestAnimationFrame(()=>te())});return()=>{je=!0,window.cancelAnimationFrame(ye)}},500);return()=>{je=!0,clearTimeout(X),Re.forEach(clearTimeout)}},[B,Q,P,M]);const Ae=()=>{if(!Q)return{currentQuestionIndex:0,totalQuestions:0};const ge=B.find(be=>be.sectionNumber===Q);if(!ge||!ge.questions||ge.questions.length===0)return{currentQuestionIndex:0,totalQuestions:0};const pe=ge.questions.length;return{currentQuestionIndex:ge.questions.filter(be=>be.isApproved).length,totalQuestions:pe}};i.useEffect(()=>{if(o){const ge=Ae();o(ge)}},[Q,B,o]),i.useEffect(()=>{c&&c($e===Pe)},[$e,Pe,c]),i.useEffect(()=>{if(!(m!=null&&m.id)||!n||Q===null||!h.current)return;const ge=setTimeout(async()=>{try{await uf(n,Q,P),console.log(` Phase 2 progress saved to backend: Section ${Q}, Question Index ${P}`)}catch(pe){console.error("Failed to save Phase 2 progress to backend:",pe)}},500);return()=>clearTimeout(ge)},[Q,P,n,m==null?void 0:m.id]),i.useEffect(()=>{var ke;if(!(m!=null&&m.id))return;const ge=C(m.id);if(!ge){console.warn(" Cannot persist state without workspace ID");return}const pe={currentSection:Q,currentQuestionIndex:P,isStarted:M,lastUpdated:new Date().toISOString(),sectionMetadata:B.map(be=>({sectionNumber:be.sectionNumber,isComplete:be.isComplete,questionCount:be.questions.length}))};try{const be=JSON.stringify(pe),je=new Blob([be]).size/(1024*1024);if(je>4){console.warn(` Phase 2 state is too large (${je.toFixed(2)}MB), saving minimal state only`);const Re={currentSection:Q,currentQuestionIndex:P,isStarted:M,lastUpdated:new Date().toISOString()};localStorage.setItem(ge,JSON.stringify(Re))}else localStorage.setItem(ge,be);console.log(` Phase 2 state saved to localStorage for workspace ${m.id}:`,{currentSection:Q,currentQuestionIndex:P,sectionsCount:B.length,completedCount:$e,isStarted:M,sizeMB:je.toFixed(2)})}catch(be){if(be.name==="QuotaExceededError"||(ke=be.message)!=null&&ke.includes("quota")){console.warn(" localStorage quota exceeded, attempting to clear old Phase 2 data and save minimal state");try{const je=[];for(let Y=0;Y<localStorage.length;Y++){const te=localStorage.key(Y);te&&te.startsWith(`ava-phase2-${m.id}-`)&&te!==ge&&je.push(te)}je.forEach(Y=>localStorage.removeItem(Y)),console.log(` Cleared ${je.length} old Phase 2 localStorage entries`);const Re={currentSection:Q,currentQuestionIndex:P,isStarted:M,lastUpdated:new Date().toISOString()};localStorage.setItem(ge,JSON.stringify(Re)),console.log(" Saved minimal Phase 2 state after clearing old data")}catch(je){console.error(" Failed to save Phase 2 state even after clearing old data:",je)}}else console.error(" Failed to save Phase 2 state to localStorage:",be)}if(n&&D.length>0){const be=setTimeout(async()=>{try{await ca(n,D),console.log(" Phase 1 conversation history saved to backend")}catch(je){console.warn(" Failed to save conversation to backend:",je)}},2e3);return()=>clearTimeout(be)}},[B,Q,P,G,M,m==null?void 0:m.id,n,D]),i.useEffect(()=>{if(typeof window>"u")return;sessionStorage.getItem("ava-phase2-hide-phase1-messages")==="true"||fe(!0)},[]),i.useEffect(()=>{if(console.log("   PHASE 2 COMPONENT MOUNTED   "),!(m!=null&&m.id)||!n)return;sessionStorage.getItem("phase2-chunks-displaying")==="true"&&(console.log(" Page was refreshed while chunks were displaying - re-triggering API from start"),sessionStorage.removeItem("phase2-chunks-displaying"),sessionStorage.removeItem("phase2-chunks-count"),sessionStorage.removeItem("phase2-chunks-displayed"),h.current=!1,T(!1),ue(X=>X.filter(ye=>{var Ne;return!((Ne=ye.id)!=null&&Ne.startsWith("phase2-intro-"))})),sessionStorage.setItem("phase2-force-reinit","true")),console.log("Initialization check:",{backendSessionId:n,hasInitialized:h.current,userName:e,phase1AnswersCount:(t==null?void 0:t.length)||0,workspaceId:m.id}),console.log("Full props received:",{backendSessionId:n,userName:e,phase1Answers:t});const pe=sessionStorage.getItem("phase2-force-reinit")==="true";if(h.current&&!pe){console.log(" Phase 2: Already initialized, skipping");return}pe&&(console.log(" Force reinit detected - will re-initialize Phase 2"),h.current=!1);const ke=async()=>{try{console.log(" Checking backend for existing Phase 2 progress...");const X=await df(n);if(X&&X.sections&&X.sections.length>0){console.log(" Found existing Phase 2 progress in backend:",X),console.log(`   Current Section: ${X.currentSection}, Question Index: ${X.currentQuestionIndex}`),h.current=!0,x.current=n||null,y.current=!0;const ye=X.sections.map(Je=>({...Je,questions:Je.questions.map(rt=>({...rt,isApproved:rt.isApproved||!1,status:rt.status==="generating"?"ready":rt.status}))}));U(ye);const Ne=X.currentSection||null,Ce=X.currentQuestionIndex!==void 0?X.currentQuestionIndex:0;V(Ne),K(Ce),k.current=Ce,q(X.sectionsList||[]),T(!0),E(!1),ee(!1),console.log(` Restored Phase 2 state: Section ${Ne}, Question Index ${Ce}`),ne.length===0&&n&&(async()=>{try{const{getPhase1Answers:Je}=await tr(async()=>{const{getPhase1Answers:ut}=await Promise.resolve().then(()=>Qo);return{getPhase1Answers:ut}},void 0),rt=await Je(n);console.log(` Restored ${rt.length} Phase 1 answers from backend`);const bt=[...rt].sort((ut,dt)=>{const Qt=Ct=>{const Kt=Ct.match(/(\d+)/);return Kt?parseInt(Kt[1],10):0},hn=Qt(ut.questionId||""),Ke=Qt(dt.questionId||"");return hn-Ke});me(bt.length>0?bt:rt)}catch(Je){console.warn(" Failed to load Phase 1 history during restore:",Je)}})();const Ve=X.currentSection,tt=X.currentQuestionIndex||0;return Ve&&n&&(console.log(` Refreshing section ${Ve} status from backend...`),cf(n,Ve).then(Je=>{console.log(" Section status refreshed:",Je);const rt=(Je==null?void 0:Je.data)||Je;U(bt=>bt.map(ut=>{if(ut.sectionNumber===Ve){const dt=((rt==null?void 0:rt.questions)||[]).map(Ke=>({id:Ke.id,questionId:Ke.questionId,questionText:Ke.questionText,aiGeneratedAnswer:Ke.aiGeneratedAnswer,userEditedAnswer:Ke.userEditedAnswer,status:Ke.status||(Ke.aiGeneratedAnswer?"ready":"generating"),isApproved:Ke.isApproved||!1})),Qt=dt.findIndex(Ke=>!Ke.isApproved),hn=Qt>=0?Qt:Math.min(tt,dt.length-1);return hn!==tt&&hn>=0&&(console.log(` Adjusting question index from ${tt} to ${hn} after section refresh`),K(hn)),{...ut,questions:dt}}return ut}))}).catch(Je=>{console.error(" Failed to refresh section status:",Je)})),console.log(" Phase 2 restored from backend - skipping Section 1 generation"),!0}else return console.log(" No existing Phase 2 progress in backend, will check localStorage or generate Section 1"),!1}catch(X){return console.warn(" Failed to check backend progress:",X),!1}};let be=!1,je=n;const Re=t||[],Y=async()=>{var ye,Ne;if(console.log(" initPhase2 async function called!"),B.length>0&&Q!==null){console.log(" Sections already loaded from restore - skipping Section 1 generation",{sectionsCount:B.length,currentSection:Q,currentQuestionIndex:P,restoredIndex:k.current}),h.current=!0,x.current=n||null,k.current!==null&&P!==k.current&&(console.log(` Restoring question index to ${k.current} during init check`),K(k.current));return}if(await ke()){console.log(" Phase 2 already has progress - restoration complete, skipping Section 1 generation");return}if(console.log(" No backend progress found - starting fresh Phase 2 initialization..."),console.group(" Phase 2: Recovering/Getting Backend Session ID"),je)console.log(" Using backendSessionId from props:",je);else{const Ce=localStorage.getItem("ava-chat-session");if(Ce)try{const Ve=JSON.parse(Ce);Ve.backendSessionId&&(je=Ve.backendSessionId,console.log(" Found backendSessionId in localStorage:",je))}catch(Ve){console.warn(" Could not parse saved session:",Ve)}if(!je){console.log(" No backend session found, creating new one...");try{let Ve=m==null?void 0:m.id;const tt=localStorage.getItem("currentWorkspace");if(Ve||(Ve=tt?(ye=JSON.parse(tt))==null?void 0:ye.id:null),console.log(" Workspace lookup:",{fromContext:m==null?void 0:m.id,fromLocalStorage:tt?(Ne=JSON.parse(tt))==null?void 0:Ne.id:null,finalWorkspaceId:Ve}),Ve){console.log(" Creating new backend session with workspace:",Ve);const Je=await Vc(Ve,`AVA Profile - ${e} (Phase 2 Recovery)`),rt=Je.id||Je.sessionId;if(rt)je=rt,console.log(" Created new backend session:",je);else throw new Error("No session ID returned from new session creation");if(Ce)try{const bt=JSON.parse(Ce);bt.backendSessionId=je,localStorage.setItem("ava-chat-session",JSON.stringify(bt)),console.log(" Updated localStorage with new backendSessionId")}catch(bt){console.error(" Failed to update localStorage:",bt)}}else throw new Error("No workspace ID found. Please ensure you have a workspace selected.")}catch(Ve){console.error(" Failed to create backend session:",Ve),Z(`Failed to create backend session: ${Ve.message}. Please restart from Phase 1.`),console.groupEnd();return}}}if(console.log(" Final backendSessionId to use:",je),console.groupEnd(),!je){console.error(" CRITICAL: Still no backendSessionId after all recovery attempts!"),Z("Backend session ID is missing. Please restart from Phase 1.");return}h.current=!0,x.current=je,console.group(" Phase 2: Initialization Started"),console.log(" Session ID:",je);try{console.log(" Step 0: Validating Phase 1 data...",{localAnswersCount:Re.length,expectedCount:27}),console.log(" Fetching Phase 1 history for display...");try{const{getPhase1Answers:Ke}=await tr(async()=>{const{getPhase1Answers:Rt}=await Promise.resolve().then(()=>Qo);return{getPhase1Answers:Rt}},void 0),Ct=await Ke(je);console.log(` Retrieved ${Ct.length} Phase 1 answers from backend`);const Kt=[...Ct].sort((Rt,Yt)=>{const Bt=Mn=>{const _s=Mn.match(/(\d+)/);return _s?parseInt(_s[1],10):0},Ts=Bt(Rt.questionId||""),us=Bt(Yt.questionId||"");return Ts-us});if(me(Kt.length>0?Kt:Ct),!he.current&&(m!=null&&m.id)&&D.length===0&&je){he.current=!0;try{const Rt=await xi(je);if(Rt.messages&&Rt.messages.length>0){const Yt=Rt.messages.filter((Bt,Ts,us)=>{const Mn=us.findIndex(_s=>_s.id===Bt.id||_s.content===Bt.content&&_s.role===Bt.role);return Ts===Mn});ue(Yt),console.log(` Loaded ${Yt.length} unique Phase 1 messages from backend during initialization (deduplicated from ${Rt.messages.length})`)}else{const Yt=`ava-phase1-chat-${m.id}-${je}`,Bt=localStorage.getItem(Yt);if(Bt){const Ts=JSON.parse(Bt);if(Ts.messages&&Array.isArray(Ts.messages)){const us=Ts.messages.filter((Mn,_s,ll)=>{const Wu=ll.findIndex(xe=>xe.id===Mn.id||xe.content===Mn.content&&xe.role===Mn.role);return _s===Wu});ue(us),console.log(` Loaded ${us.length} unique Phase 1 messages from localStorage during initialization (deduplicated from ${Ts.messages.length})`)}}}}catch(Rt){console.warn(" Failed to load Phase 1 messages during initialization:",Rt),he.current=!1}}if(Ct.length<27){const Yt=`Incomplete Phase 1 data: ${Ct.length}/27 answers found in database. Please complete Phase 1 first.`;console.error("",Yt),Z(Yt),console.groupEnd();return}}catch(Ke){if(console.error(" Failed to fetch Phase 1 answers from backend:",Ke),Re.length>=27){console.log(" Using local Phase 1 answers as fallback");const Ct=Re.map((Kt,Rt)=>({questionId:Kt.questionId||`q-${Rt}`,sectionId:"",questionText:`Question ${Rt+1}`,answer:Kt.answer||""}));me(Ct)}else{const Kt=`Could not retrieve Phase 1 answers from database. ${Re.length}/27 answers available locally. ${Ke.message}`;Z(Kt),console.groupEnd();return}}console.log(" Step 1: Checking session status before starting Phase 2...");let Ce=null;try{Ce=await fa(je),console.log(" Session details retrieved:",{currentPhase:Ce==null?void 0:Ce.currentPhase,sessionId:je})}catch(Ke){console.warn(" Could not get session details:",Ke==null?void 0:Ke.message)}const Ve=(Ce==null?void 0:Ce.currentPhase)==="completed"||(Ce==null?void 0:Ce.currentPhase)==="complete";if(Ve)if(console.log(` Session is already ${Ce==null?void 0:Ce.currentPhase} - skipping startPhase2 call`),console.log(" Session is completed - attempting to restore all sections..."),await ke()){console.log(" Successfully restored completed Phase 2 from backend"),h.current=!0,x.current=je;return}else console.warn(" Could not restore completed Phase 2 from backend - sections may be lost");const tt=(Ce==null?void 0:Ce.currentPhase)==="phase2";let Je=null;if(!Ve&&!tt?(sessionStorage.getItem("phase2-force-reinit")==="true"&&(console.log(" Force re-initialization detected - calling startPhase2 API again"),sessionStorage.removeItem("phase2-force-reinit")),console.log(" Step 1: POST /ava-sessions/:id/start-phase2"),Je=await oj(je),console.log(" Step 1: SUCCESS",Je)):tt&&console.log(" Session is already in Phase 2 - skipping startPhase2 call, proceeding with section generation"),Je)try{const Ke=(Je==null?void 0:Je.data)||Je;if(Array.isArray(Ke==null?void 0:Ke.sections)&&q(Ke.sections.map(Ct=>({sectionNumber:Ct.sectionNumber,title:Ct.title,intro:Ct.intro,isApproved:!!Ct.isApproved}))),Ke!=null&&Ke.message){const Ct=Ke.message;if(Array.isArray(Ct)){sessionStorage.setItem("phase2-chunks-displaying","true"),sessionStorage.setItem("phase2-chunks-count",String(Ct.length)),sessionStorage.setItem("phase2-chunks-displayed","0"),await new Promise(Kt=>setTimeout(Kt,2e3+Math.random()*1e3));for(let Kt=0;Kt<Ct.length;Kt++){const Rt=Ct[Kt],Yt={id:`phase2-intro-${Kt}-${Date.now()}`,role:"ava",content:Rt,timestamp:new Date};ue(Bt=>Bt.some(us=>us.id===Yt.id||us.content===Rt&&us.role==="ava")?Bt:(sessionStorage.setItem("phase2-chunks-displayed",String(Kt+1)),[...Bt,Yt])),Kt<Ct.length-1&&await new Promise(Bt=>setTimeout(Bt,500))}sessionStorage.setItem("phase2-chunks-displaying","false"),sessionStorage.removeItem("phase2-chunks-count"),sessionStorage.removeItem("phase2-chunks-displayed"),console.log(` Added ${Ct.length} intro messages from startPhase2 response (displayed progressively)`)}else if(typeof Ct=="string"){const Kt={id:`phase2-intro-${Date.now()}`,role:"ava",content:Ct,timestamp:new Date};ue(Rt=>Rt.some(Bt=>Bt.content===Ct&&Bt.role==="ava")?Rt:(console.log(" Added intro message from startPhase2 response"),[...Rt,Kt]))}}}catch{console.warn(" Failed to parse sections list from start-phase2")}if(be){console.log(" Initialization cancelled");return}T(!0),Z(null),console.log(" Step 1.5: Verifying session state and backend data...");try{const Ke=await fa(je);console.log(" Session details:",{id:Ke.id||Ke.sessionId,currentPhase:Ke.currentPhase,userName:e});const Ct=sessionStorage.getItem("phase2-force-reinit")==="true";if(Ke!=null&&Ke.message&&!Ct){const Rt=Ke.message;if(Array.isArray(Rt)){sessionStorage.setItem("phase2-chunks-displaying","true"),sessionStorage.setItem("phase2-chunks-count",String(Rt.length)),sessionStorage.setItem("phase2-chunks-displayed","0"),await new Promise(Yt=>setTimeout(Yt,2e3+Math.random()*1e3));for(let Yt=0;Yt<Rt.length;Yt++){const Bt=Rt[Yt],Ts={id:`phase2-intro-${Yt}-${Date.now()}`,role:"ava",content:Bt,timestamp:new Date};ue(us=>us.some(_s=>_s.id===Ts.id||_s.content===Bt&&_s.role==="ava")?us:(sessionStorage.setItem("phase2-chunks-displayed",String(Yt+1)),[...us,Ts])),Yt<Rt.length-1&&await new Promise(us=>setTimeout(us,500))}sessionStorage.setItem("phase2-chunks-displaying","false"),sessionStorage.removeItem("phase2-chunks-count"),sessionStorage.removeItem("phase2-chunks-displayed"),console.log(` Added ${Rt.length} intro messages from getSessionDetails response (displayed progressively)`)}else if(typeof Rt=="string"){const Yt={id:`phase2-intro-${Date.now()}`,role:"ava",content:Rt,timestamp:new Date};ue(Bt=>Bt.some(us=>us.content===Rt&&us.role==="ava")?Bt:(console.log(" Added intro message from getSessionDetails response"),[...Bt,Yt]))}}if(!["phase2","phase_2","Phase2","PHASE2","transition"].includes(Ke.currentPhase))if(console.warn(" Session not in phase2 state:",Ke.currentPhase),Ke.currentPhase&&Ke.currentPhase.toLowerCase().includes("phase"))console.log(" Phase appears valid, proceeding despite format mismatch");else{Z(`Session is not ready for Phase 2. Current phase: ${Ke.currentPhase}. The backend may need to transition the session. Try clicking "Retry Phase 2".`),console.groupEnd();return}console.log(" Session verified, proceeding with generation")}catch(Ke){console.warn(" Could not verify session state, proceeding anyway:",Ke)}console.log(" Step 2: POST /ava-sessions/:id/generate-section/1"),E(!0),V(1);const rt=k.current!==null?k.current:P;k.current!==null?(K(k.current),console.log(` Preserving restored question index ${k.current} for Section 1`)):B.length===0||Q!==1?(K(0),console.log(" Starting fresh - setting question index to 0 for Section 1")):(K(rt),console.log(` Preserving existing question index ${rt} for Section 1`));let bt;try{bt=await qi(je,1),console.log(" Step 2: Section 1 response",bt)}catch(Ke){console.error(" Step 2: Section 1 generation failed:",Ke);const Ct=Re.length;console.error(" Error details:",{message:Ke.message,sessionId:je,phase1AnswersCount:Ct}),Ct===0?Z(`No Phase 1 answers found! Please complete Phase 1 first. Found ${Ct} answers.`):Ct<27?Z(`Incomplete Phase 1 data (${Ct}/27 answers). Backend may not have all answers saved. Please restart from Phase 1.`):Z(`Section generation failed: ${Ke.message}. This is likely a backend issue. Check: 1) AI service (Gemini) is configured, 2) Phase 1 answers are saved in database (should have 27), 3) Backend logs for details. The error suggests the backend cannot generate AI responses - check your AI API key and service configuration.`),console.log(" Proceeding with fallback - showing Phase 2 UI without initial section"),U([{sectionNumber:1,sectionTitle:"Section 1",sectionIntro:' Generation failed. Click "Regenerate Section" below or check backend logs.',questions:[],isComplete:!1}]),E(!1),T(!0),console.groupEnd();return}if(be){console.log(" Generation cancelled"),console.groupEnd();return}console.log(" RAW sectionResponse:",JSON.stringify(bt,null,2));const ut=(bt==null?void 0:bt.data)??bt;console.log(" EXTRACTED sectionPayload:",JSON.stringify(ut,null,2));const dt=((ut==null?void 0:ut.questions)||[]).map(Ke=>({id:Ke.id,questionId:Ke.questionId,questionText:Ke.questionText,aiGeneratedAnswer:Ke.aiGeneratedAnswer,userEditedAnswer:Ke.userEditedAnswer,status:Ke.status||(Ke.aiGeneratedAnswer?"ready":"generating"),isApproved:Ke.isApproved||!1}));console.log(" Parsed questions:",dt),console.log(" Questions count:",dt.length);const Qt={sectionNumber:(ut==null?void 0:ut.sectionNumber)||1,sectionTitle:(ut==null?void 0:ut.sectionTitle)||"Section 1",sectionIntro:(ut==null?void 0:ut.sectionIntro)||"",questions:dt,isComplete:!1};console.log(" NEW SECTION TO ADD:",JSON.stringify(Qt,null,2)),U([Qt]),console.log(" Step 2: Section 1 added to state via setSections"),console.log(" setSections([newSection]) called - React should re-render now"),sessionStorage.getItem("ava-phase2-hide-phase1-messages")==="true"&&(sessionStorage.removeItem("ava-phase2-hide-phase1-messages"),setTimeout(()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{fe(!0),console.log(" Showing Phase 1 messages now that Phase 2 section is ready - user can scroll up to see them")})})},200)),ut!=null&&ut.allReady?(console.log(" Step 3: All questions ready, no polling needed"),E(!1)):(console.log(" Step 3: Starting status polling (GET /ava-sessions/:id/section/1/status)"),ce(je,1)),console.groupEnd(),console.log(" Phase 2: Initialization complete!")}catch(Ce){if(be){console.groupEnd();return}console.groupEnd(),console.group(" Phase 2: Initialization Failed"),console.error("Error:",Ce),console.error("Error message:",Ce==null?void 0:Ce.message),console.error("Error response:",Ce==null?void 0:Ce.response),console.error("Error stack:",Ce==null?void 0:Ce.stack),console.groupEnd(),E(!1),Z((Ce==null?void 0:Ce.message)||"Failed to start Phase 2"),g({title:"Phase 2 Start Failed",description:(Ce==null?void 0:Ce.message)||"Check console for details",variant:"destructive"})}};console.log(" Scheduling initPhase2 to run in 1000ms to allow restore to complete...");const te=setTimeout(()=>{console.log(" Timeout fired, calling initPhase2..."),Y()},1e3);return()=>{console.log(" Phase 2 initialization cleanup"),be=!0,clearTimeout(te)}},[n,e,t,m==null?void 0:m.id]),i.useEffect(()=>()=>{w.current&&clearInterval(w.current)},[]);const Ee=async ge=>{var X;const pe=x.current||n;if(!pe)return console.error(" Cannot generate section: No backend session ID"),g({title:"Error",description:"Backend session ID is missing. Please refresh the page.",variant:"destructive"}),Promise.reject(new Error("No backend session ID"));const ke=B.find(ye=>ye.sectionNumber===ge),be=!!ke,je=Q,Re=be&&ge===je;let Y=0;if(be&&ke.questions.length>0)if(Re&&P>=0)Y=P;else{const ye=ke.questions.findIndex(Ne=>!Ne.isApproved);ye>=0?Y=ye:Y=ke.questions.length-1}console.group(` Generating Section ${ge}`),console.log(` POST /ava-sessions/${pe}/generate-section/${ge}`),console.log(` isGenerating=true, isTransitioningSection=${z}, isExistingSection=${be}, preservedIndex=${Y}`),E(!0),V(ge);const te=be?Y:0;K(te);try{await uf(pe,ge,te),console.log(` Progress saved when navigating to Section ${ge}`)}catch(ye){console.warn("Failed to save progress when navigating:",ye)}try{const ye=await qi(pe,ge);console.log(` Section ${ge} response:`,ye),V(ge);const Ne=(ye==null?void 0:ye.data)??ye,Ce=((Ne==null?void 0:Ne.questions)||[]).map(Je=>({id:Je.id,questionId:Je.questionId,questionText:Je.questionText,aiGeneratedAnswer:Je.aiGeneratedAnswer,userEditedAnswer:Je.userEditedAnswer,status:Je.status||(Je.aiGeneratedAnswer?"ready":"generating"),isApproved:Je.isApproved||!1})),Ve={sectionNumber:(Ne==null?void 0:Ne.sectionNumber)||ge,sectionTitle:(Ne==null?void 0:Ne.sectionTitle)||`Section ${ge}`,sectionIntro:(Ne==null?void 0:Ne.sectionIntro)||"",questions:Ce,isComplete:!1},tt=Ce.some(Je=>Je.status==="ready"||Je.aiGeneratedAnswer);return U(Je=>{const rt=Je.find(ut=>ut.sectionNumber===ge);let bt;if(rt&&rt.isComplete?(console.log(` Section ${ge} already completed, preserving approval state for review`),bt={...Ve,isComplete:!0,questions:Ve.questions.map(ut=>{const dt=rt.questions.find(Qt=>Qt.id&&Qt.id===ut.id||Qt.questionId===ut.questionId);return{...ut,isApproved:(dt==null?void 0:dt.isApproved)||!1,userEditedAnswer:(dt==null?void 0:dt.userEditedAnswer)||ut.userEditedAnswer}})}):rt?(console.log(` Section ${ge} exists but not complete, merging with existing data`),bt={...Ve,questions:Ve.questions.map(ut=>{const dt=rt.questions.find(Qt=>Qt.id&&Qt.id===ut.id||Qt.questionId===ut.questionId);return{...ut,isApproved:(dt==null?void 0:dt.isApproved)||!1,userEditedAnswer:(dt==null?void 0:dt.userEditedAnswer)||ut.userEditedAnswer}})}):(console.log(` Adding new section ${ge}`),bt=Ve),be&&bt.questions.length>0&&ge!==je){const ut=bt.questions.findIndex(dt=>!dt.isApproved);ut>=0?(K(ut),console.log(` Navigating to section ${ge} from ${je}, showing first unapproved question at index ${ut}`)):(K(bt.questions.length-1),console.log(` All questions approved in section ${ge}, showing all (index ${bt.questions.length-1})`))}else be&&ge===je&&console.log(` Staying on section ${ge}, preserving currentQuestionIndex ${Y}`);return rt&&rt.isComplete?Je.map(ut=>ut.sectionNumber===ge?bt:ut):rt?Je.map(ut=>ut.sectionNumber===ge?bt:ut):[...Je,bt].sort((ut,dt)=>ut.sectionNumber-dt.sectionNumber)}),tt&&(console.log(` Section ${ge} has ready questions, clearing transition state if needed`),ee(Je=>Je&&(console.log(` Clearing transition state for Section ${ge}`),!1))),Ne!=null&&Ne.allReady?(console.log(` All questions ready for Section ${ge}`),E(!1),ee(Je=>Je&&(console.log(" All questions ready, clearing transition state"),!1))):(console.log(` Starting polling for Section ${ge}...`),ce(pe,ge)),console.groupEnd(),Promise.resolve()}catch(ye){return console.groupEnd(),console.group(` Section ${ge} Generation Failed`),console.error("Error:",ye),console.error("Details:",{message:ye==null?void 0:ye.message,response:ye==null?void 0:ye.response,status:(X=ye==null?void 0:ye.response)==null?void 0:X.status}),console.groupEnd(),E(!1),g({title:`Section ${ge} Failed`,description:(ye==null?void 0:ye.message)||"Check console for details",variant:"destructive"}),Promise.reject(ye)}},ce=(ge,pe)=>{w.current&&(clearInterval(w.current),w.current=null);const ke=v.current.get(pe)||0;v.current.set(pe,ke+1),console.log(` Polling Section ${pe} status (attempt ${ke+1})...`),w.current=setInterval(async()=>{var je,Re;const be=ge||x.current||n;if(!be){console.error(" Polling stopped: No backend session ID"),w.current&&(clearInterval(w.current),w.current=null);return}try{console.log(` GET /ava-sessions/${be}/section/${pe}/status`);const Y=await cf(be,pe),te=(Y==null?void 0:Y.data)??Y;console.log(` Section ${pe} status:`,te);const X=((te==null?void 0:te.questions)||[]).map(ye=>({id:ye.id,questionId:ye.questionId,questionText:ye.questionText,aiGeneratedAnswer:ye.aiGeneratedAnswer,userEditedAnswer:ye.userEditedAnswer,status:ye.status||(ye.aiGeneratedAnswer?"ready":"generating"),isApproved:ye.isApproved||!1}));if(U(ye=>{const Ne=ye.find(dt=>dt.sectionNumber===pe);if(!Ne)return ye;if(Ne.questions.every(dt=>dt.isApproved)&&Ne.questions.length>0)return console.log(` Section ${pe} already complete - stopping polling`),w.current&&(clearInterval(w.current),w.current=null),ye;const Ve=X.map(dt=>{const Qt=Ne.questions.find(Ke=>Ke.id&&Ke.id===dt.id||Ke.questionId===dt.questionId),hn=Qt!=null&&Qt.isApproved?!0:dt.isApproved||!1;return{...dt,isApproved:hn,userEditedAnswer:(Qt==null?void 0:Qt.userEditedAnswer)||dt.userEditedAnswer}}),tt=Ve.some(dt=>dt.status==="ready"||dt.aiGeneratedAnswer),Je=Ne.questions.some(dt=>dt.status==="ready"||dt.aiGeneratedAnswer);tt&&!Je&&pe===Q&&(console.log(` First ready question detected for Section ${pe}, clearing transition state`),ee(!1));const rt=Ne.questions.length,bt=Ve.length,ut=bt>rt;return console.log(` Polling update for Section ${pe}:`,{previousCount:rt,newCount:bt,hasNewQuestions:ut,currentQuestionIndex:P,currentSectionNumber:Q,allReady:te==null?void 0:te.allReady,hasReadyQuestion:tt,previousHasReadyQuestion:Je,questionStatuses:Ve.map(dt=>({id:dt.questionId,status:dt.status,isApproved:dt.isApproved}))}),ye.map(dt=>dt.sectionNumber===pe?{...dt,questions:Ve}:dt)}),te!=null&&te.allReady){const ye=((je=te==null?void 0:te.questions)==null?void 0:je.length)||0;console.log(` Section ${pe}: All ${ye} questions ready!`),console.log(" Complete question list:",(Re=te==null?void 0:te.questions)==null?void 0:Re.map((Ne,Ce)=>({index:Ce,questionId:Ne.questionId,hasAnswer:!!(Ne.aiGeneratedAnswer||Ne.userEditedAnswer),status:Ne.status}))),E(!1),pe===Q&&ee(!1),w.current&&(clearInterval(w.current),w.current=null)}}catch(Y){console.error(` Failed to poll Section ${pe} status:`,Y),console.error("Poll error details:",{message:Y==null?void 0:Y.message,response:Y==null?void 0:Y.response})}},2e3)},we=async(ge,pe)=>{const ke=x.current||n;if(!ke||!ge.id)return;console.log(` Confirming question ${ge.questionId} (responseId=${ge.id}) in section ${pe.sectionNumber}`),k.current=null,y.current=!1;const be=pe.questions.findIndex(Ne=>Ne.id===ge.id),je=be===pe.questions.length-1;console.log(" Question position:",{currentIndex:be,totalQuestions:pe.questions.length,isLastQuestion:je,questionId:ge.questionId});let Re=null;try{console.log(" API Call 1: Confirming individual question via confirm-phase2-question..."),Re=await lj(ke,pe.sectionNumber,ge.id),console.log(" Question confirmed successfully:",Re)}catch(Ne){console.error(" Failed to confirm question:",Ne==null?void 0:Ne.message),E(!1),ee(!1),g({title:"Error",description:(Ne==null?void 0:Ne.message)||"Failed to confirm question. Please try again.",variant:"destructive"});return}if(je)try{console.log(" API Call 2: This is the LAST question - confirming entire section");const Ne=await cj(ke,pe.sectionNumber);console.log(" Section confirmed successfully:",Ne),Ne&&(Re={...Re,...Ne,sectionConfirmed:!0})}catch(Ne){console.warn(" Failed to confirm section (non-critical):",Ne==null?void 0:Ne.message)}const Y=ge.id,te=ge.questionId,X=pe.sectionNumber;console.log(" Before confirm - question state:",{id:Y,questionId:te,isApproved:ge.isApproved});const ye=je&&pe.questions.filter(Ne=>Ne.id!==Y).every(Ne=>Ne.isApproved);console.log(" Pre-confirmation check:",{isLastQuestion:je,totalQuestions:pe.questions.length,alreadyApprovedCount:pe.questions.filter(Ne=>Ne.isApproved).length,willCompleteSection:ye}),U(Ne=>{const Ce=Ne.find(rt=>rt.sectionNumber===X);if(!Ce)return Ne;const Ve={...Ce,questions:Ce.questions.map(rt=>rt.id===Y||rt.questionId===te?(console.log(" Marking question as approved:",{id:rt.id,questionId:rt.questionId,wasApproved:rt.isApproved}),{...rt,isApproved:!0}):(rt.isApproved&&console.log(" Preserving approved state for question:",rt.questionId),rt))},tt=Ve.questions.findIndex(rt=>rt.id===Y||rt.questionId===te);console.log(" Question index check:",{currentQIndex:tt,totalQuestions:Ve.questions.length,confirmedQuestionId:Y,allQuestionIds:Ve.questions.map(rt=>({id:rt.id,questionId:rt.questionId,status:rt.status,isApproved:rt.isApproved})),isGenerating:A,hasGeneratingQuestions:Ve.questions.some(rt=>rt.status==="generating")});const Je=Ne.map(rt=>rt.sectionNumber===X?Ve:rt);return tt<Ve.questions.length-1?(console.log(` Moving to next question (index ${tt+1} of ${Ve.questions.length} loaded questions)`),K(tt+1),Je):(console.log(" At last loaded question in section"),Je)}),ye&&(console.log(` Section ${X} will be complete after this confirmation`),setTimeout(()=>{console.log(` Triggering section transition from ${X} to next section`),ee(!0),q(Ce=>Ce.map(Ve=>Ve.sectionNumber===X?{...Ve,isApproved:!0}:Ve)),U(Ce=>Ce.map(Ve=>Ve.sectionNumber===X?{...Ve,isComplete:!0}:Ve)),K(0);const Ne=(Re==null?void 0:Re.nextSection)||X+1;Ne<=21?(console.log(` Starting generation of Section ${Ne}`),Ee(Ne).catch(Ce=>{console.error(` Failed to generate Section ${Ne}:`,Ce),ee(!1)})):(console.log(" All 21 sections complete!"),ee(!1),U(Ce=>(r(Ce),Ce)))},100)),Re!=null&&Re.sectionCompleted&&console.log(` Section ${pe.sectionNumber} questions all approved (from API).`)},Te=async(ge,pe)=>{var be;const ke=x.current||n;if(!(!ke||!ge.id)){console.log(`
 ========== REGENERATING QUESTION ==========`),console.log(`Question ID: ${ge.questionId}`),console.log(`Response ID: ${ge.id}`),console.log(`Section: ${pe.sectionNumber}`),console.log(`Question Text: ${ge.questionText}`),console.log(`===========================================
`),oe(ge.id||null);try{const je=await uj(ke,ge.id);console.log(" Question regeneration API response:",je);const Re=((be=je==null?void 0:je.data)==null?void 0:be.aiGeneratedAnswer)||(je==null?void 0:je.aiGeneratedAnswer);if(console.log(" New regenerated answer:",Re?`${Re.substring(0,100)}...`:"NONE"),Re)console.log(" Updating question with new answer for question ID:",ge.id),console.log(" Regenerated answer length:",Re.length),U(Y=>{var Ne;const te=Y.map(Ce=>{if(Ce.sectionNumber===pe.sectionNumber){const Ve=Ce.questions.map(tt=>{if(tt.id===ge.id){const{userEditedAnswer:Je,...rt}=tt,bt={...rt,aiGeneratedAnswer:Re,isApproved:!1,status:"ready"};return console.log(" Updated question object:",{id:bt.id,questionId:bt.questionId,hasAiAnswer:!!bt.aiGeneratedAnswer,status:bt.status}),bt}return tt});return{...Ce,questions:Ve}}return Ce}),X=te.find(Ce=>Ce.sectionNumber===pe.sectionNumber),ye=X==null?void 0:X.questions.find(Ce=>Ce.id===ge.id);return console.log(" State after update - Question has answer:",!!(ye!=null&&ye.aiGeneratedAnswer)),console.log(" State after update - Answer preview:",(Ne=ye==null?void 0:ye.aiGeneratedAnswer)==null?void 0:Ne.substring(0,100)),te}),g({title:"Question Regenerated",description:"AI has generated a new answer for this question"});else throw new Error("No regenerated answer received from API")}catch(je){console.error(" Failed to regenerate question:",je),g({title:"Regeneration Failed",description:(je==null?void 0:je.message)||"Could not regenerate this answer",variant:"destructive"})}finally{oe(null)}}},Ue=(ge,pe)=>{L(ge),_(pe)},lt=async(ge,pe,ke)=>{const be=x.current||n;if(!be||!R||!pe){console.error(" Cannot save edit: Missing required data",{currentSessionId:be,editingQuestionId:R,responseId:pe}),g({title:"Error",description:"Backend session ID is missing. Please refresh the page.",variant:"destructive"});return}console.log(` Saving edit for Section ${ge}, Question ${ke}`),F(!0);try{await ij(be,ge,pe,I),console.log(" Edit saved successfully"),U(je=>je.map(Re=>Re.sectionNumber===ge?{...Re,questions:Re.questions.map(Y=>Y.questionId===ke?{...Y,userEditedAnswer:I}:Y)}:Re)),L(null),_(""),g({title:"Saved",description:"Your edit has been saved successfully"})}catch(je){console.error(" Failed to save edit:",je),g({title:"Save Failed",description:(je==null?void 0:je.message)||"Check console for details",variant:"destructive"})}finally{F(!1)}},Ze=()=>{L(null),_("")};return console.log(" Phase 2 component rendering with state:",{sectionsCount:B.length,currentSection:Q,isGenerating:A,isStarted:M,initError:ie,editingQuestionId:R}),s.jsxs(s.Fragment,{children:[s.jsx("div",{ref:f,className:"px-4 sm:px-6 pb-32 pt-2",style:{scrollBehavior:"smooth"},children:s.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",style:{minHeight:"100%"},children:[u&&D.length>0&&re&&sessionStorage.getItem("ava-phase2-hide-phase1-messages")!=="true"&&s.jsx("div",{className:"space-y-4 mb-6 pt-6",children:D.filter((ge,pe,ke)=>{const be=ke.findIndex(je=>je.id===ge.id||je.content===ge.content&&je.role===ge.role);return pe===be}).map((ge,pe)=>s.jsx("div",{children:ge.role==="ava"?s.jsx("div",{className:"flex gap-3 items-start",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsxs("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",style:pe===0?{marginTop:"58px"}:void 0,children:[s.jsx("div",{className:`text-[15px] leading-relaxed text-gray-900 ${(()=>{const ke=/<[^>]+>/;return typeof ge.content=="string"&&ke.test(ge.content)?"":"whitespace-pre-wrap"})()}`,children:(()=>{const ke=/<[^>]+>/;return typeof ge.content=="string"&&ke.test(ge.content)?s.jsx("div",{className:"ava-message-content",dangerouslySetInnerHTML:{__html:ge.content}}):ge.content})()}),ge.videoUrl&&s.jsx("div",{className:"mt-4",children:s.jsx("div",{className:"relative w-full bg-black rounded-lg overflow-hidden",style:{paddingTop:"56.25%"},children:s.jsx("iframe",{src:(()=>{const ke=ge.videoUrl.match(/vimeo\.com\/(\d+)(?:\/([a-zA-Z0-9]+))?/);if(!ke)return"";const be=ke[1],je=ke[2];let Re=`https://player.vimeo.com/video/${be}`;const Y=new URLSearchParams({title:"0",byline:"0",portrait:"0",autoplay:"0"});return je&&Y.set("h",je),Re+="?"+Y.toString(),Re})(),className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"AVA Video"})})}),ge.examples&&ge.examples.length>0&&!M&&s.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[s.jsx("div",{className:"text-xs font-medium text-vox-pink mb-2",children:"Examples:"}),s.jsx("div",{className:"space-y-2",children:ge.examples.map((ke,be)=>s.jsx("div",{className:"text-sm text-gray-600 bg-muted/50 px-3 py-2 rounded-lg",children:ke},be))})]})]})})}):s.jsx("div",{className:"flex gap-3 items-start justify-end",children:s.jsx("div",{className:"flex-1 max-w-[85%] flex justify-end",children:s.jsx("div",{className:"bg-gradient-to-br from-vox-pink/10 to-vox-orange/10 rounded-2xl rounded-tr-sm px-4 py-3",children:s.jsx("p",{className:"text-[15px] leading-relaxed whitespace-pre-wrap text-gray-800",children:ge.content})})})})},`${ge.id}-${pe}`))}),u&&ne.length>0&&D.length===0&&sessionStorage.getItem("ava-phase2-hide-phase1-messages")!=="true"&&s.jsx("div",{className:"space-y-6 mb-8",children:ne.map((ge,pe)=>{const ke=ge.sectionTitle||(ge.sectionId?ve[ge.sectionId]:null);return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex gap-3 items-start",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsxs("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:[ke&&s.jsx("div",{className:"mb-2",children:s.jsx("div",{className:"text-xs font-medium text-vox-pink",children:ke})}),s.jsx("p",{className:"text-[15px] leading-relaxed text-gray-900 whitespace-pre-wrap",children:ge.questionText})]})})}),s.jsx("div",{className:"flex gap-3 items-start justify-end",children:s.jsx("div",{className:"flex-1 max-w-[85%] flex justify-end",children:s.jsx("div",{className:"bg-gradient-to-br from-vox-pink/10 to-vox-orange/10 rounded-2xl rounded-tr-sm px-4 py-3",children:s.jsx("p",{className:"text-[15px] leading-relaxed whitespace-pre-wrap text-gray-800",children:ge.answer})})})})]},ge.questionId||pe)})}),s.jsx("div",{ref:N,className:`flex justify-center pt-4 mb-6 ${(D.length>0||ne.length>0)&&!M?"":"pt-6"}`,children:s.jsx("div",{className:"px-6 py-3 bg-gradient-to-r from-vox-pink/10 via-vox-purple/10 to-vox-orange/10 border border-vox-pink/20 rounded-xl shadow-sm",children:s.jsx("p",{className:"text-sm font-semibold text-vox-pink",children:"Phase 2: Profile Generation"})})}),!M&&!ie&&s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsx("div",{className:"px-6 py-3 bg-gradient-to-r from-vox-pink/10 via-vox-purple/10 to-vox-orange/10 border border-vox-pink/20 rounded-xl shadow-sm",children:s.jsx("p",{className:"text-sm text-center font-medium",children:"Initializing Phase 2..."})}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[s.jsx(Qe,{className:"w-4 h-4 animate-spin"}),s.jsx("span",{children:"Starting backend session..."})]})]}),ie&&!M&&s.jsxs("div",{className:"flex flex-col items-center gap-4",children:[s.jsxs("div",{className:"px-6 py-3 bg-destructive/10 border border-destructive/20 rounded-xl shadow-sm max-w-2xl",children:[s.jsx("p",{className:"text-sm text-center font-medium text-destructive",children:"Failed to initialize Phase 2"}),s.jsx("p",{className:"text-xs text-center text-muted-foreground mt-2",children:ie}),s.jsx("p",{className:"text-xs text-center text-muted-foreground mt-2",children:"Check browser console for detailed error logs. The backend may be experiencing issues, but you can try generating sections manually."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ie,{variant:"outline",size:"sm",onClick:()=>{h.current=!1,Z(null),T(!1),window.location.reload()},className:"text-xs",children:"Retry Phase 2"}),s.jsx(Ie,{variant:"default",size:"sm",onClick:async()=>{console.log(" Attempting to generate Section 1 manually..."),Z(null),T(!0),E(!0);try{await Ee(1),console.log(" Section 1 generated manually")}catch(ge){console.error(" Manual generation also failed:",ge),Z(`Section generation still failing: ${ge.message}. Please check backend logs.`),E(!1)}},className:"text-xs bg-gradient-to-r from-vox-pink to-vox-orange",disabled:A,children:A?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Generating..."]}):"Start Section 1 Manually"})]})]}),(B.length>0&&console.log(` RENDERING ${B.length} SECTIONS IN UI`,B),null),z&&Q&&!B.find(ge=>ge.sectionNumber===Q)&&s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 py-12",children:[s.jsx("div",{className:"flex gap-3 items-start animate-fade-in",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsx("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:s.jsx(Va,{})})})}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[s.jsx(Qe,{className:"w-4 h-4 animate-spin"}),s.jsxs("span",{children:["Loading Section ",Q,"..."]})]})]}),B.map(ge=>{const pe=ge.sectionNumber===Q,ke=ge.sectionNumber===1;console.log(` Rendering section ${ge.sectionNumber} with ${ge.questions.length} questions`);const be=G.find(X=>X.sectionNumber===ge.sectionNumber),je=(be==null?void 0:be.title)||ge.sectionTitle,Re=(be==null?void 0:be.intro)||ge.sectionIntro,Y=k.current!==null&&pe?k.current:P,te=ge.isComplete?ge.questions:pe?ge.questions.slice(0,Y+1):ge.questions;return s.jsxs("div",{className:"space-y-4 animate-fade-in",ref:ke?S:null,children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"px-6 py-3 bg-gradient-to-r from-vox-pink/10 via-vox-purple/10 to-vox-orange/10 border border-vox-pink/20 rounded-xl shadow-sm max-w-2xl",children:s.jsxs("p",{className:"text-sm text-center font-medium",children:[s.jsxs("strong",{className:"font-semibold",children:["Section ",ge.sectionNumber,": ",je]}),Re&&s.jsx("span",{className:"block mt-2 text-xs text-muted-foreground font-normal",children:Re})]})})}),(()=>{var Ve;const X=ge.questions.length>0,ye=te.some(tt=>tt.status==="ready"||tt.aiGeneratedAnswer),Ne=Q===ge.sectionNumber,Ce=Ne&&!ye&&(z||A||!X);return Ce?console.log(` Showing loader for Section ${ge.sectionNumber}:`,{isGenerating:A,isTransitioningSection:z,questionsCount:ge.questions.length,questionsToShowCount:te.length,hasQuestions:X,hasReadyQuestions:ye}):ye&&Ne&&console.log(` Loader hidden for Section ${ge.sectionNumber}: first question appeared`,{questionsToShowCount:te.length,firstQuestionId:(Ve=te[0])==null?void 0:Ve.questionId}),Ce&&s.jsx("div",{className:"flex gap-3 items-start animate-fade-in",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsx("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:s.jsx(Va,{})})})})})(),te.map((X,ye)=>{const Ne=R===X.questionId,Ce=X.userEditedAnswer||X.aiGeneratedAnswer||"",Ve=`section-${ge.sectionNumber}-question-${ye}`;ye===0&&console.log(` First question appeared for Section ${ge.sectionNumber} - loader should hide`),console.log(` Rendering question ${ye+1}:`,{questionId:X.questionId,isApproved:X.isApproved,status:X.status,sectionNumber:ge.sectionNumber,isComplete:ge.isComplete});const tt=X;return s.jsxs("div",{className:"space-y-4","data-phase2-question-anchor":Ve,children:[s.jsx("div",{className:"flex gap-3 items-start",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsxs("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:[s.jsxs("div",{className:"text-xs text-gray-900 mb-1",style:{fontWeight:700},children:["Question ",ge.sectionNumber,".",ye+1]}),s.jsx("p",{className:"text-[15px] leading-relaxed text-gray-900 whitespace-pre-wrap",style:{fontWeight:600},children:tt.questionText.replace(/^Question \d+\s*/i,"")})]})})}),tt.status==="generating"&&s.jsx("div",{className:"flex gap-3 items-start",children:s.jsx("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:s.jsx(Va,{})})}),tt.status==="ready"&&s.jsx("div",{className:"space-y-3",children:s.jsx("div",{className:"flex gap-3 items-start justify-end",children:s.jsxs("div",{className:"flex-1 max-w-[85%] flex flex-col items-end gap-2",children:[s.jsx("div",{className:`${Ne?"px-0 py-2":"bg-gradient-to-br from-vox-pink/10 to-vox-orange/10 rounded-2xl rounded-tr-sm px-4 py-3"} w-full transition-all duration-300 ${Ne?"":"animate-ai-answer-in"}`,children:Ne?s.jsx(fs,{value:I,onChange:Je=>_(Je.target.value),className:"min-h-[120px] text-[15px] leading-relaxed w-full bg-white border border-pink-200 focus:border-pink-300 focus:ring-0 focus:outline-none rounded-lg px-4 py-3 transition-all duration-200 resize-none placeholder:text-gray-400",placeholder:"Edit your answer here...",autoFocus:!0}):s.jsx("p",{className:"text-[15px] leading-relaxed whitespace-pre-wrap text-gray-800",children:Ce})}),s.jsxs("div",{className:"flex gap-3 items-center w-full justify-between mt-3 pt-3 border-t border-gray-100",children:[s.jsxs("div",{className:"flex gap-2.5 items-center",children:[!tt.isApproved&&s.jsxs(Ie,{variant:"outline",size:"sm",onClick:()=>we(X,ge),className:`group relative appearance-none select-none
                                      border-2 border-green-200 hover:border-green-400
                                      bg-white hover:bg-green-100
                                      text-gray-700 hover:text-green-700
                                      text-xs font-medium h-9 px-4
                                      shadow-sm hover:shadow-md
                                      transition-colors duration-200 ease-linear
                                      focus:outline-none focus-visible:ring-0 active:outline-none
                                      active:bg-white active:text-gray-700`,children:[s.jsx(ns,{className:"w-3.5 h-3.5 mr-1.5 transition-transform group-hover:scale-110"}),s.jsx("span",{className:"relative z-10",children:"Confirm"})]}),tt.isApproved&&s.jsxs("span",{className:"inline-flex items-center gap-1.5 text-xs font-medium text-emerald-700 bg-gradient-to-r from-emerald-50 to-green-50 border border-emerald-200 rounded-md px-3 h-9 shadow-sm",children:[s.jsx(ns,{className:"w-3.5 h-3.5"}),"Approved"]}),Ne?s.jsxs("div",{className:"flex gap-2.5 items-center",children:[s.jsx(Ie,{variant:"outline",size:"sm",onClick:Ze,className:"group border-2 bg-white hover:bg-gray-50 border-gray-200 hover:border-gray-300 text-gray-600 hover:text-gray-700 text-xs font-medium h-9 px-4 transition-all duration-200 shadow-sm hover:shadow-md hover:scale-[1.02] active:scale-[0.98]",children:s.jsx("span",{className:"relative z-10",children:"Cancel"})}),s.jsxs(Ie,{size:"sm",onClick:()=>lt(ge.sectionNumber,X.id,X.questionId),disabled:!X.id||$,className:"group relative bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink text-white text-xs font-medium h-9 px-5 shadow-md hover:shadow-lg transition-all duration-300 hover:scale-[1.02] active:scale-[0.98] disabled:opacity-60 disabled:cursor-not-allowed disabled:hover:scale-100 hover:from-vox-pink/90 hover:via-vox-orange/90 hover:to-vox-pink/90",children:[$?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-3.5 h-3.5 mr-1.5 animate-spin"}),s.jsx("span",{children:"Saving..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(ns,{className:"w-3.5 h-3.5 mr-1.5 transition-transform group-hover:scale-110"}),s.jsx("span",{className:"relative z-10",children:"Save Changes"})]}),s.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-white/0 via-white/20 to-white/0 opacity-0 group-hover:opacity-100 rounded-md transition-opacity duration-300"})]})]}):s.jsxs(Ie,{variant:"ghost",size:"sm",onClick:()=>Ue(X.questionId,Ce),className:"group relative border-2 bg-white hover:bg-gradient-to-r hover:from-vox-purple/5 hover:to-indigo-50 border-vox-purple/30 hover:border-vox-purple/60 text-gray-700 hover:text-vox-purple text-xs font-medium h-9 px-4 transition-all duration-300 shadow-sm hover:shadow-md hover:scale-[1.02] active:scale-[0.98] overflow-hidden",children:[s.jsx(Fw,{className:"w-3.5 h-3.5 mr-1.5 transition-all duration-300 group-hover:rotate-12 group-hover:scale-110"}),s.jsx("span",{className:"relative z-10",children:"Edit Answer"})]})]}),!tt.isApproved&&s.jsxs(Ie,{variant:"outline",size:"sm",disabled:le===X.id,onClick:()=>Te(X,ge),className:"group relative border-2 bg-white hover:bg-gradient-to-r hover:from-vox-orange/5 hover:to-amber-50 border-vox-orange/30 hover:border-vox-orange/50 text-vox-orange hover:text-vox-orange/90 text-xs font-medium h-9 px-4 transition-all duration-300 shadow-sm hover:shadow-md hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 ml-auto",children:[le===X.id?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-3.5 h-3.5 mr-1.5 animate-spin"}),s.jsx("span",{children:"Regenerating..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(UP,{className:"w-3.5 h-3.5 mr-1.5 transition-transform group-hover:rotate-180 duration-500"}),s.jsx("span",{className:"relative z-10",children:"AI Regenerate"})]}),s.jsx("span",{className:"absolute inset-0 bg-gradient-to-r from-vox-orange/0 via-vox-orange/10 to-amber/0 opacity-0 group-hover:opacity-100 rounded-md transition-opacity duration-300"})]})]})]})})}),tt.status==="failed"&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10"}),s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-xl p-4",children:s.jsx("p",{className:"text-sm text-destructive",children:"Failed to generate answer. Please regenerate."})})})]})]},tt.id||tt.questionId)}),ge.isComplete&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"flex justify-center",children:s.jsx("div",{className:"px-4 py-2 bg-green-500/10 border border-green-500/20 rounded-lg",children:s.jsxs("p",{className:"text-xs text-green-600 font-medium",children:[" Section ",ge.sectionNumber," Complete"]})})}),(()=>{const X=ge.sectionNumber+1,ye=B.find(Ce=>Ce.sectionNumber===X);return Q===X&&(z||A)&&(!ye||ye.questions.length===0||!ye.questions.some(Ce=>Ce.status==="ready"||Ce.aiGeneratedAnswer))&&s.jsx("div",{className:"flex gap-3 items-start",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsx("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:s.jsx(Va,{})})})})})()]})]},ge.sectionNumber)}),A&&Q&&B.length===0&&s.jsx("div",{className:"flex gap-3 items-start animate-fade-in",children:s.jsx("div",{className:"flex-1 max-w-[85%]",children:s.jsx("div",{className:"bg-white rounded-2xl rounded-tl-sm px-4 py-3",children:s.jsx(Va,{})})})}),$e===Pe&&B.length>0&&s.jsxs("div",{className:"flex flex-col items-center justify-center gap-6 py-12 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-vox-pink via-vox-orange to-vox-pink/80 flex items-center justify-center mx-auto shadow-2xl animate-pulse-glow",children:s.jsx(Zs,{className:"w-10 h-10 text-white"})}),s.jsxs("h2",{className:"font-heading font-bold text-3xl bg-gradient-to-r from-vox-pink to-vox-orange bg-clip-text text-transparent",children:["Congratulations, ",e,"! "]}),s.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:"Your complete AVA Ideal Client Profile is ready"})]}),s.jsxs("div",{className:"bg-white border-2 border-vox-pink/20 rounded-xl shadow-xl p-8 max-w-2xl w-full space-y-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs(Ie,{onClick:async()=>{if(l)await l();else{const ge=x.current||n;if(!ge){g({title:"Error",description:"Session ID is missing. Please refresh the page.",variant:"destructive"});return}try{const{exportProfilePDF:pe}=await tr(async()=>{const{exportProfilePDF:Re}=await Promise.resolve().then(()=>Qo);return{exportProfilePDF:Re}},void 0),ke=await pe(ge),be=URL.createObjectURL(ke),je=document.createElement("a");je.href=be,je.download=`AVA-Profile-${e}-${new Date().toISOString().split("T")[0]}.pdf`,je.click(),URL.revokeObjectURL(be),g({title:"Profile Exported",description:"Your AVA profile has been downloaded as PDF"})}catch(pe){g({title:"Export Failed",description:(pe==null?void 0:pe.message)||"Failed to export PDF. Please try again.",variant:"destructive"})}}},size:"lg",className:"w-full bg-gradient-to-r from-vox-pink to-vox-orange text-white shadow-lg hover:shadow-xl",children:[s.jsx(ln,{className:"w-5 h-5 mr-2"}),"Download Profile PDF"]}),a&&s.jsxs(s.Fragment,{children:[s.jsxs(Ie,{onClick:()=>{de(!0)},variant:"outline",size:"lg",className:"w-full",children:[s.jsx(Pn,{className:"w-5 h-5 mr-2"}),"Create New Profile"]}),s.jsx(Gi,{open:ae,onOpenChange:de,children:s.jsxs(yo,{className:"bg-background",children:[s.jsxs(wo,{children:[s.jsx(No,{children:"Start New Profile?"}),s.jsx(jo,{children:"This will clear all progress and start fresh. Your current session will be saved in browser history."})]}),s.jsxs(bo,{children:[s.jsx(ko,{children:"Cancel"}),s.jsx(So,{onClick:()=>{de(!1),typeof a=="function"&&a()},className:"bg-destructive hover:bg-destructive/90",children:"Start New Profile"})]})]})})]})]}),s.jsxs("div",{className:"pt-6 border-t space-y-3",children:[s.jsx("h3",{className:"font-semibold text-sm text-muted-foreground",children:"Next Steps"}),s.jsxs("ul",{className:"space-y-2 text-sm text-left",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-vox-pink",children:""}),s.jsx("span",{children:"Use this profile to craft hyper-relevant marketing messages"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-vox-pink",children:""}),s.jsx("span",{children:"Share with your team to align on ideal client vision"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"text-vox-pink",children:""}),s.jsx("span",{children:"Apply insights to all VoxBox Amplifiers for consistent messaging"})]})]})]})]})]}),s.jsx("div",{ref:p})]})}),s.jsx(Gi,{open:O,onOpenChange:H,children:s.jsxs(yo,{children:[s.jsxs(wo,{children:[s.jsx(No,{children:"Create New Session"}),s.jsx(jo,{children:"Are you sure you want to create a new session? This will reset your current progress and start fresh."})]}),s.jsxs(bo,{children:[s.jsx(ko,{children:"Cancel"}),s.jsx(So,{onClick:async()=>{H(!1);const ge=x.current||n;if(ge)try{await _u(ge),console.log(" Session cancelled via API")}catch(pe){console.error(" Failed to cancel session:",pe)}if(m!=null&&m.id){localStorage.removeItem(`ava-session-state-${m.id}`);const pe=C(m.id);pe&&localStorage.removeItem(pe),Object.keys(localStorage).forEach(ke=>{(ke.startsWith(`ava-phase1-state-${m.id}-`)||ke.startsWith(`ava-phase2-${m.id}-`))&&localStorage.removeItem(ke)}),k.current=null,y.current=!1,j.current=!1,console.log(" Cleared all restored state references for new session")}d("/tools/ava",{replace:!0,state:{scrollToBottom:!0,resetTimestamp:Date.now()}}),setTimeout(()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})},500)},className:"bg-gradient-to-r from-vox-pink to-vox-orange text-white hover:opacity-90",children:"Create New Session"})]})]})})]})},px=({onStart:e,isLoading:t=!1})=>{const n=En(),{currentWorkspace:r}=ls(),a=xn(u=>u.videoUrl),o=ia,[l,c]=i.useState(o);return i.useEffect(()=>{var m;if(typeof window>"u")return;const u=p=>{if(!p)return null;const f=p.trim();return f.length?f:null},d=u(a);if(d){c(d);return}const g=u(sessionStorage.getItem("name-submission-video-url"));if(g){c(g);return}if(r!=null&&r.id){try{const f=localStorage.getItem("ava-name-response-store");if(f){const w=JSON.parse(f),h=u((m=w.state)==null?void 0:m.videoUrl);if(h){c(h);return}}}catch{}const p=`ava-name-response-${r.id}`;try{const f=localStorage.getItem(p);if(f){const w=JSON.parse(f),h=u(w.videoUrl);if(h){c(h);return}}}catch{}try{const f=Object.keys(localStorage);for(const w of f){if(!w.startsWith(`ava-phase1-chat-${r.id}-`))continue;const h=localStorage.getItem(w);if(!h)continue;const v=JSON.parse(h),x=u(v.videoUrl);if(x){c(x);return}}}catch{}}if(r!=null&&r.id)try{const p=Object.keys(localStorage);for(const f of p){if(!f.startsWith(`activate-now-messages-${r.id}-`))continue;const w=localStorage.getItem(f);if(!w)continue;const h=JSON.parse(w),v=u(h.videoUrl);if(v){c(v);return}}}catch{}c(o)},[r==null?void 0:r.id,a,o]),i.useEffect(()=>{var u;(u=n.state)!=null&&u.scrollToActivateButton&&setTimeout(()=>{const d=document.getElementById("activate-ava-button");d&&d.scrollIntoView({behavior:"smooth",block:"center"})},300)},[n.state]),s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-vox-pink/5 flex items-center justify-center p-6 relative",children:s.jsxs("div",{className:"max-w-6xl w-full space-y-8 animate-fade-in",children:[s.jsxs("div",{className:"text-center space-y-6",children:[s.jsxs("div",{className:"relative inline-block",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-vox-pink to-vox-orange rounded-full blur-3xl opacity-30 animate-pulse"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-vox-orange to-vox-pink rounded-full blur-2xl opacity-20 animate-pulse",style:{animationDelay:"1s"}}),s.jsxs("div",{className:"relative w-40 h-40 mx-auto",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-vox-pink via-vox-orange to-vox-pink rounded-full animate-pulse"}),s.jsx("div",{className:"absolute inset-1 bg-background rounded-full"}),s.jsx("img",{src:wt,alt:"AVA Avatar",className:"absolute inset-2 w-[calc(100%-1rem)] h-[calc(100%-1rem)] rounded-full object-cover"})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"inline-block px-4 py-1.5 rounded-full bg-gradient-to-r from-vox-pink/10 to-vox-orange/10 border border-vox-pink/20",children:s.jsx("span",{className:"text-sm font-medium bg-gradient-to-r from-vox-pink to-vox-orange bg-clip-text text-transparent",children:"AI-Powered Audience Intelligence"})}),s.jsx("h1",{className:"font-heading font-bold text-5xl md:text-7xl bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink bg-clip-text text-transparent",children:"Meet AVA"}),s.jsx("p",{className:"text-2xl md:text-3xl font-semibold text-foreground",children:"Advanced Virtual Audience Analyzer"}),s.jsxs("p",{className:"text-lg md:text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:["Create a deep psychological profile of your ideal client that goes beyond demographics. AVA helps you understand the ",s.jsx("span",{className:"text-vox-pink font-semibold",children:"subconscious motivations"}),",",s.jsx("span",{className:"text-vox-orange font-semibold",children:" emotional triggers"}),", and",s.jsx("span",{className:"text-vox-pink font-semibold",children:" decision-making patterns"})," that drive purchasing behavior."]})]})]}),s.jsx(qe,{className:"border-2 border-vox-pink/30 bg-gradient-to-br from-background via-background to-vox-pink/5",children:s.jsxs(Xe,{className:"p-8",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h3",{className:"font-heading font-bold text-2xl mb-2",children:"Get Started with AVA"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Watch this video to understand how AVA works"})]}),s.jsx("div",{className:"relative w-full bg-black rounded-lg overflow-hidden",style:{paddingTop:"56.25%"},children:l?s.jsx("iframe",{src:(()=>{if(!l)return"";let u=l.match(/vimeo\.com\/(\d+)(?:\/([a-zA-Z0-9]+))?/);if(!u){if(u=l.match(/player\.vimeo\.com\/video\/(\d+)/),u){const f=l.match(/[?&]h=([a-zA-Z0-9]+)/),w=u[1],h=f?f[1]:void 0;let v=`https://player.vimeo.com/video/${w}`;const x=new URLSearchParams({title:"0",byline:"0",portrait:"0",autoplay:"0"});return h&&x.set("h",h),v+="?"+x.toString(),v}return""}const d=u[1],g=u[2];let m=`https://player.vimeo.com/video/${d}`;const p=new URLSearchParams({title:"0",byline:"0",portrait:"0",autoplay:"0"});return g&&p.set("h",g),m+="?"+p.toString(),m})(),className:"absolute top-0 left-0 w-full h-full border-0",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"AVA Profile Video",loading:"lazy"}):s.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:s.jsxs("div",{className:"text-center px-4",children:[s.jsx("p",{className:"text-white/80 text-sm mb-2",children:"Loading video..."}),s.jsx("p",{className:"text-white/60 text-xs",children:"The video will appear here once available"})]})})})]})}),s.jsx(qe,{className:"border-2 border-vox-pink/30 shadow-2xl bg-gradient-to-br from-background via-background to-vox-pink/5",children:s.jsxs(Xe,{className:"p-10 space-y-8",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3 mb-8",children:[s.jsx(Zs,{className:"w-7 h-7 text-vox-pink"}),s.jsx("h2",{className:"font-heading font-bold text-3xl",children:"Your Journey with AVA"}),s.jsx(Zs,{className:"w-7 h-7 text-vox-orange"})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"relative space-y-4 group",children:[s.jsx("div",{className:"absolute -inset-2 bg-gradient-to-br from-vox-pink to-vox-orange opacity-0 group-hover:opacity-10 rounded-xl blur-xl transition-opacity"}),s.jsx("div",{className:"relative w-14 h-14 rounded-full bg-gradient-to-br from-vox-pink via-vox-orange to-vox-pink flex items-center justify-center text-white font-bold text-xl shadow-lg",children:"1"}),s.jsx("h3",{className:"font-bold text-xl",children:"Phase 1: Discovery"}),s.jsxs("p",{className:"text-sm text-muted-foreground leading-relaxed",children:["Engage in an intelligent conversation with AVA. Answer ",s.jsx("span",{className:"font-semibold text-foreground",children:"25-30 strategically designed questions"})," that uncover the foundational elements of your ideal client profile. AVA adapts to your responses for deeper insights."]}),s.jsx("div",{className:"text-xs text-vox-pink font-semibold",children:" 15-20 minutes"})]}),s.jsxs("div",{className:"relative space-y-4 group",children:[s.jsx("div",{className:"absolute -inset-2 bg-gradient-to-br from-vox-orange to-vox-pink opacity-0 group-hover:opacity-10 rounded-xl blur-xl transition-opacity"}),s.jsx("div",{className:"relative w-14 h-14 rounded-full bg-gradient-to-br from-vox-orange via-vox-pink to-vox-orange flex items-center justify-center text-white font-bold text-xl shadow-lg",children:"2"}),s.jsx("h3",{className:"font-bold text-xl",children:"Phase 2: Deep Analysis"}),s.jsxs("p",{className:"text-sm text-muted-foreground leading-relaxed",children:["Watch as AVA generates your ",s.jsx("span",{className:"font-semibold text-foreground",children:"complete 21-section profile"})," in real-time. Each section is crafted using advanced AI to analyze patterns, extract insights, and build a comprehensive psychological map of your audience."]}),s.jsx("div",{className:"text-xs text-vox-orange font-semibold",children:" 10-15 minutes"})]}),s.jsxs("div",{className:"relative space-y-4 group",children:[s.jsx("div",{className:"absolute -inset-2 bg-gradient-to-br from-vox-pink to-vox-orange opacity-0 group-hover:opacity-10 rounded-xl blur-xl transition-opacity"}),s.jsx("div",{className:"relative w-14 h-14 rounded-full bg-gradient-to-br from-vox-pink via-vox-orange to-vox-pink flex items-center justify-center text-white font-bold text-xl shadow-lg",children:"3"}),s.jsx("h3",{className:"font-bold text-xl",children:"Phase 3: Activation"}),s.jsxs("p",{className:"text-sm text-muted-foreground leading-relaxed",children:[s.jsx("span",{className:"font-semibold text-foreground",children:"Download your complete profile"})," as a formatted document. Immediately integrate it into VoxBox Amplifiers to generate content that resonates at a subconscious level with your ideal clients."]}),s.jsx("div",{className:"text-xs text-vox-pink font-semibold",children:" Instant download"})]})]}),s.jsxs("div",{className:"pt-8 space-y-6",children:[s.jsx(Ie,{id:"activate-ava-button",onClick:e,size:"lg",disabled:t,className:"w-full h-14 text-lg bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink text-white shadow-2xl hover:shadow-3xl hover:brightness-110 transform hover:-translate-y-0.5 transition duration-300 font-bold disabled:opacity-50 disabled:cursor-not-allowed",children:t?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Creating Session..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Zs,{className:"mr-2 w-6 h-6"}),"Activate AVA Now",s.jsx(xo,{className:"ml-2 w-6 h-6"})]})}),s.jsx("p",{className:"text-center text-xs text-muted-foreground",children:" Your data stays private   Progress auto-saves   Instant profile generation"})]})]})})]})})},JM=()=>{const{toast:e}=yt(),{currentWorkspace:t,isLoading:n}=ls(),r=En(),a=Lt(),o=i.useRef(null),l=i.useRef(!1),c=i.useRef(null),u=I=>I?`ava-session-state-${I}`:"ava-session-state",g=(()=>{var I,_;if(typeof window>"u")return{showWelcome:!0,currentStage:"welcome",sessionId:null,userName:""};try{let $=null;try{const T=localStorage.getItem("workspace-storage");if(T){const ie=JSON.parse(T),Z=(I=ie==null?void 0:ie.state)==null?void 0:I.currentWorkspace;Z!=null&&Z.id?$=Z.id:(_=ie==null?void 0:ie.currentWorkspace)!=null&&_.id&&($=ie.currentWorkspace.id)}}catch{}if($){const T=`ava-session-state-${$}`;try{const ie=localStorage.getItem(T);if(ie){const Z=JSON.parse(ie);if(Z.sessionId&&Z.currentStage&&Z.currentStage!=="welcome")return{showWelcome:!1,currentStage:Z.currentStage,sessionId:Z.sessionId,userName:Z.userName||""}}}catch{}}const M=Object.keys(localStorage).sort((T,ie)=>{const Z=T.startsWith("ava-session-state-")&&T!=="ava-session-state",le=ie.startsWith("ava-session-state-")&&ie!=="ava-session-state";return Z&&!le?-1:!Z&&le?1:0});for(const T of M)if(T.startsWith("ava-session-state"))try{const ie=localStorage.getItem(T);if(ie){const Z=JSON.parse(ie);if(Z.sessionId&&Z.currentStage&&Z.currentStage!=="welcome")return{showWelcome:!1,currentStage:Z.currentStage,sessionId:Z.sessionId,userName:Z.userName||""}}}catch{continue}}catch{}return{showWelcome:!0,currentStage:"welcome",sessionId:null,userName:""}})();c.current=g.sessionId;const[m,p]=i.useState(g.showWelcome),[f,w]=i.useState(!1),[h,v]=i.useState(g.currentStage),[x,y]=i.useState(g.sessionId),[b,N]=i.useState(g.userName),[S,j]=i.useState([]),[k,C]=i.useState({currentQuestionIndex:0,totalQuestions:27}),[W,B]=i.useState({currentQuestionIndex:0,totalQuestions:0}),[U,Q]=i.useState(!1),[V,P]=i.useState(!1);i.useEffect(()=>{var I;(I=r.state)!=null&&I.scrollToBottom&&m&&setTimeout(()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})},300)},[r.state,m]),i.useEffect(()=>{if(l.current||n)return;if(!(t!=null&&t.id)){o.current!==null&&x&&(console.log(" Workspace removed, clearing session"),p(!0),v("welcome"),y(null),N(""),o.current=null);return}const I=t.id;if(x&&c.current===x&&!o.current&&fa(x).then($=>{$.workspaceId!==I?(console.log(` Initial session ${x} belongs to workspace ${$.workspaceId}, but current workspace is ${I}. Resetting.`),y(null),N(""),v("welcome"),p(!0),j([]),o.current=null):(p(!1),o.current=I,l.current=!1)}).catch($=>{console.error("Failed to validate initial session workspace:",$),y(null),N(""),v("welcome"),p(!0),j([]),o.current=null}),o.current!==null&&o.current!==I&&(console.log(` Workspace changed from ${o.current} to ${I}, clearing old session`),y(null),N(""),v("welcome"),p(!0),j([])),o.current===I&&x){fa(x).then($=>{$.workspaceId!==I&&(console.log(` Session ${x} belongs to workspace ${$.workspaceId}, but current workspace is ${I}. Clearing session.`),y(null),N(""),v("welcome"),p(!0),j([]),o.current=null)}).catch($=>{console.error("Failed to validate session workspace:",$),y(null),N(""),v("welcome"),p(!0),j([]),o.current=null});return}l.current=!0,o.current=I,console.log(` RESTORING session for workspace: ${I}`),(async()=>{try{const $=u(I),F=localStorage.getItem($);if(F){const M=JSON.parse(F);if(M.sessionId&&M.currentStage&&M.currentStage!=="welcome"){console.log(` FOUND saved session for workspace ${I}:`,M),console.log(` Restoring: stage=${M.currentStage}, sessionId=${M.sessionId}`);try{const T=await fa(M.sessionId);if(T.workspaceId!==I){console.log(` Session ${M.sessionId} belongs to workspace ${T.workspaceId}, but current workspace is ${I}. Not restoring.`),localStorage.removeItem($),p(!0),v("welcome"),y(null),N(""),j([]);return}y(M.sessionId),N(M.userName||T.userName||""),v(M.currentStage),p(!1),console.log(` STATE RESTORED: stage=${M.currentStage}, sessionId=${M.sessionId}`)}catch(T){console.error(" Failed to validate session workspace:",T),localStorage.removeItem($),p(!0),v("welcome"),y(null),N(""),j([])}}else console.log(` Invalid saved session for workspace ${I}`)}else console.log(` No saved session for workspace ${I}`)}catch($){console.error(" Error restoring session:",$)}finally{l.current=!1}})()},[t==null?void 0:t.id,n,x]),i.useEffect(()=>{if(t!=null&&t.id&&x&&h!=="welcome"){const I=u(t.id),_={sessionId:x,userName:b,currentStage:h};localStorage.setItem(I,JSON.stringify(_)),console.log(` Session state SAVED for workspace ${t.id}:`,_)}},[x,b,h,t==null?void 0:t.id]),i.useEffect(()=>{(async()=>{if(!(h!=="phase1"||!x))try{await fa(x)}catch(_){const $=(_==null?void 0:_.message)||"";if($.toLowerCase().includes("access denied")||$.toLowerCase().includes("forbidden")){if(!(t!=null&&t.id))return;try{const M=await Vc(t.id,"AVA Ideal Client Profile"),T=M.id||M.sessionId;if(T){y(T);const ie=u(t.id),Z={sessionId:T,userName:"",currentStage:"phase1"};localStorage.setItem(ie,JSON.stringify(Z)),e({title:"New Session Created",description:"Your previous session was not accessible. A new one has been created."})}}catch(M){e({title:"Session Error",description:(M==null?void 0:M.message)||"Failed to create new session",variant:"destructive"})}}}})()},[h,x,t==null?void 0:t.id,e]);const K=I=>{if(Q(!0),e({title:"Profile Complete! ",description:"Your AVA Ideal Client Profile is ready"}),t!=null&&t.id&&x){const _=u(t.id),$={sessionId:x,userName:b,currentStage:"phase2"};localStorage.setItem(_,JSON.stringify($)),console.log(" Phase 2 Complete - keeping stage as phase2 to preserve content visibility")}},G=async()=>{if(x)try{await _u(x),console.log(" Session cancelled via API")}catch(I){console.error(" Failed to cancel session:",I)}if(y(null),N(""),j([]),v("welcome"),p(!0),t!=null&&t.id){const I=u(t.id);localStorage.removeItem(I),x&&(localStorage.removeItem(`ava-phase1-state-${t.id}-${x}`),localStorage.removeItem(`ava-phase2-${t.id}-${x}`)),Object.keys(localStorage).forEach(_=>{(_.startsWith(`ava-phase1-state-${t.id}-`)||_.startsWith(`ava-phase2-${t.id}-`)||_.startsWith(`activate-now-messages-${t.id}-`))&&localStorage.removeItem(_)})}localStorage.removeItem("ava-session-state"),localStorage.removeItem("ava-chat-session"),a("/tools/ava",{replace:!0,state:{scrollToActivateButton:!0,resetTimestamp:Date.now()}}),e({title:"New Session Started",description:"Click 'Activate AVA Now' to begin."})},q=async()=>{if(console.log(" Starting AVA Session:"),console.log("- Current Workspace:",t),console.log("- Workspace ID:",t==null?void 0:t.id),!t){e({title:"No Workspace Selected",description:"Please select a workspace before starting AVA",variant:"destructive"});return}w(!0);try{console.log(" Activate Now clicked - clearing any previous state to start fresh"),sessionStorage.removeItem("activate-now-in-progress"),sessionStorage.removeItem("activate-now-messages"),sessionStorage.removeItem("activate-now-messages-total"),sessionStorage.removeItem("activate-now-messages-displayed"),sessionStorage.removeItem("activate-now-session-id"),t!=null&&t.id&&Object.keys(localStorage).forEach(F=>{F.startsWith(`activate-now-messages-${t.id}-`)&&localStorage.removeItem(F)}),sessionStorage.setItem("activate-now-in-progress","true"),console.log(" Calling createAvaSession API...");const I=await Vc(t.id,"AVA Ideal Client Profile");console.log(" Backend session response:",I),console.log(" Backend session message type:",typeof I.message,Array.isArray(I.message)?"array":typeof I.message);const _=I.id||I.sessionId;if(!_)throw new Error("No session ID returned from backend");const $=I.message||[];if(console.log(" Response messages:",$),Array.isArray($)&&$.length>0){if(console.log(" Storing",$.length,"Activate Now messages to render as single chunk"),sessionStorage.setItem("activate-now-messages",JSON.stringify($)),sessionStorage.setItem("activate-now-session-id",_),sessionStorage.setItem("activate-now-in-progress","true"),t!=null&&t.id){const F=`activate-now-messages-${t.id}-${_}`;localStorage.setItem(F,JSON.stringify({messages:$,sessionId:_,timestamp:Date.now()})),console.log(" Activate Now messages stored in localStorage for persistence:",F)}console.log(" Activate Now messages stored in both sessionStorage and localStorage, ready for single chunk rendering")}else console.warn(" No messages array in API response. Message value:",$),console.warn(" Backend session object keys:",Object.keys(I));if(console.log(" Setting sessionId:",_),y(_),v("phase1"),p(!1),t!=null&&t.id){const F=u(t.id),M={sessionId:_,userName:"",currentStage:"phase1"};localStorage.setItem(F,JSON.stringify(M)),console.log(` New session saved: Phase 1 for workspace ${t.id}`)}e({title:"Session Created",description:"AVA is ready to help you create your ideal client profile"}),setTimeout(()=>{window.scrollTo({top:0,behavior:"smooth"})},100)}catch(I){console.error("Failed to create AVA session:",I),sessionStorage.removeItem("activate-now-in-progress"),sessionStorage.removeItem("activate-now-messages"),sessionStorage.removeItem("activate-now-messages-total"),sessionStorage.removeItem("activate-now-messages-displayed"),sessionStorage.removeItem("activate-now-session-id"),t!=null&&t.id&&Object.keys(localStorage).forEach(_=>{_.startsWith(`activate-now-messages-${t.id}-`)&&localStorage.removeItem(_)}),e({title:"Error",description:I.message||"Failed to create session. Please try again.",variant:"destructive"})}finally{w(!1)}},A=i.useMemo(()=>h==="phase2"||h==="complete"||b&&h!=="welcome",[h,b]),E=I=>{console.log(" Phase 1 Complete, transitioning to Phase 2"),console.log("User Name from Phase 1:",I);const _={scrollY:window.scrollY,scrollX:window.scrollX,timestamp:Date.now()};sessionStorage.setItem("ava-phase2-transition-scroll",JSON.stringify(_)),sessionStorage.setItem("ava-phase2-hide-phase1-messages","true"),i.startTransition(()=>{if(N(I),v("phase2"),p(!1),t!=null&&t.id&&x){const $=u(t.id),F={sessionId:x,userName:I,currentStage:"phase2"};localStorage.setItem($,JSON.stringify(F)),console.log(` Phase transition saved: Phase 1  Phase 2 for workspace ${t.id}`)}}),e({title:"Phase 1 Complete! ",description:"Moving to Phase 2: Profile Generation"})};if(m&&(!x||h==="welcome"))return s.jsx(px,{onStart:q,isLoading:f});const L=async()=>{if(!x){e({title:"Error",description:"Session ID is missing. Please refresh the page.",variant:"destructive"});return}P(!0);try{const I=await Hh(x),_=URL.createObjectURL(I),$=document.createElement("a");$.href=_,$.download=`AVA-Profile-${b||"Client"}-${new Date().toISOString().split("T")[0]}.pdf`,$.click(),URL.revokeObjectURL(_),e({title:"Profile Exported",description:"Your AVA profile has been downloaded as PDF"})}catch(I){e({title:"Export Failed",description:(I==null?void 0:I.message)||"Failed to export PDF. Please try again.",variant:"destructive"})}finally{P(!1)}};if(x){const I=U?"complete":h==="phase2"?"phase2":"phase1",_=h==="phase2"||U?W:k;return s.jsxs("div",{className:"flex flex-col min-h-[calc(100vh-80px)] overflow-hidden bg-background",children:[s.jsxs("div",{className:"sticky top-20 z-50 bg-background backdrop-blur-xl",children:[s.jsx(sj,{stage:I,progress:_,userName:b||"User",offsetClassName:"top-20",onReset:G}),h==="phase2"&&U&&s.jsx("div",{className:"bg-background/95 backdrop-blur-xl px-4 sm:px-6 py-2",children:s.jsx("div",{className:"max-w-3xl mx-auto flex items-center justify-end gap-2",children:s.jsxs(Ie,{variant:"outline",size:"sm",onClick:L,disabled:V,className:"h-7 text-xs gap-1",children:[V?s.jsx(Qe,{className:"w-3 h-3 animate-spin"}):s.jsx(ln,{className:"w-3 h-3"}),"Export PDF"]})})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto",style:{paddingTop:"6rem"},children:[(h==="phase1"||A)&&s.jsx(qM,{sessionId:x,onPhase1Complete:E,onStartOver:G,hideHeader:!0,hideStartPhase2Button:h==="phase2",onProgressChange:C,onUserNameChange:N,onError:$=>{e({title:"Error",description:$,variant:"destructive"})}},`phase1-${x}`),(h==="phase2"||h==="complete")&&s.jsx(YM,{userName:b||"User",phase1Answers:S||[],backendSessionId:x,onComplete:K,onStartOver:G,onProgressChange:B,onExportPDF:L,onPhase2CompleteChange:Q,showPhase1History:!1})]})]})}return s.jsx(px,{onStart:q,isLoading:f})},KM=()=>{const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState([]),[o,l]=i.useState(!0),[c,u]=i.useState(new Set);i.useEffect(()=>{if(!(e!=null&&e.id)){t({title:"No Workspace Selected",description:"Please select a workspace to view previous profiles",variant:"destructive"}),n("/tools/ava");return}d()},[e==null?void 0:e.id]);const d=async()=>{if(e!=null&&e.id){l(!0);try{const f=(await Tn(e.id)).completed||[];a(f)}catch(p){console.error("Failed to load completed sessions:",p),t({title:"Error",description:(p==null?void 0:p.message)||"Failed to load previous profiles",variant:"destructive"})}finally{l(!1)}}},g=async p=>{if(!c.has(p.id)){u(f=>new Set(f).add(p.id));try{const f=await Hh(p.id),w=URL.createObjectURL(f),h=document.createElement("a");h.href=w;const x=(p.completedAt?new Date(p.completedAt):new Date(p.createdAt)).toISOString().replace(/[:.]/g,"-").replace("T","-").slice(0,-5),b=`Ava-Profile-${p.userName||p.sessionName||"Client"}-${x}.pdf`;h.download=b,h.click(),URL.revokeObjectURL(w),t({title:"Profile Downloaded",description:`Downloaded ${b}`})}catch(f){console.error("Failed to download PDF:",f),t({title:"Download Failed",description:(f==null?void 0:f.message)||"Failed to download profile PDF",variant:"destructive"})}finally{u(f=>{const w=new Set(f);return w.delete(p.id),w})}}},m=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return s.jsx("div",{className:"h-[calc(100vh-80px)] overflow-hidden bg-gradient-to-br from-background via-background to-vox-pink/5 flex items-center justify-center p-6",children:s.jsxs("div",{className:"max-w-6xl w-full max-h-full flex flex-col space-y-6 overflow-hidden",children:[s.jsx("div",{className:"flex items-center justify-between flex-shrink-0",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Ie,{variant:"outline",onClick:()=>n("/tools/ava"),className:"border-vox-pink/20 bg-background hover:!bg-gradient-to-r hover:!from-vox-pink/80 hover:!to-vox-orange/80 hover:!text-white hover:!border-vox-pink/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-vox-pink/20 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:"Back to AVA"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink bg-clip-text text-transparent",children:"Previous Profiles"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"View and download your completed AVA profiles"})]})]})}),o?s.jsx(qe,{className:"border-vox-pink/20 flex-1 flex items-center justify-center",children:s.jsxs(Xe,{className:"p-12 flex items-center justify-center",children:[s.jsx(Qe,{className:"w-8 h-8 animate-spin text-vox-pink"}),s.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading profiles..."})]})}):r.length===0?s.jsx(qe,{className:"border-vox-pink/20 flex-1 flex items-center justify-center",children:s.jsxs(Xe,{className:"p-12 text-center",children:[s.jsx(Pn,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Completed Profiles"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"You haven't completed any AVA profiles yet. Start creating your first profile to see it here."}),s.jsx(Ie,{onClick:()=>{n("/tools/ava",{state:{scrollToBottom:!0}})},className:"bg-gradient-to-r from-vox-pink to-vox-orange text-white",children:"Create New Profile"})]})}):s.jsx("div",{className:"grid gap-4 overflow-y-auto flex-1 pr-2",children:r.map(p=>{const f=c.has(p.id),h=(p.completedAt?new Date(p.completedAt):new Date(p.createdAt)).toISOString().replace(/[:.]/g,"-").replace("T","-").slice(0,-5),x=`Ava-Profile-${p.userName||p.sessionName||"Client"}-${h}.pdf`;return s.jsx(qe,{className:"border-vox-pink/20 hover:border-vox-pink/40 transition-all duration-300 hover:shadow-lg",children:s.jsx(Xe,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-foreground mb-1",children:p.sessionName}),s.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:x})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[p.userName&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(zr,{className:"w-4 h-4"}),s.jsx("span",{children:p.userName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(mu,{className:"w-4 h-4"}),s.jsxs("span",{children:["Completed: ",m(p.completedAt||p.createdAt)]})]})]})]}),s.jsx(Ie,{onClick:()=>g(p),disabled:f,className:"bg-gradient-to-r from-vox-pink to-vox-orange text-white hover:shadow-lg transition-all duration-300 shrink-0",children:f?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ln,{className:"w-4 h-4 mr-2"}),"Download PDF"]})})]})})},p.id)})})]})})},XM=()=>s.jsx("div",{className:"min-h-[calc(100vh-80px)] ",children:s.jsxs("div",{className:"mx-auto flex h-full max-w-5xl flex-col gap-6 px-4 py-6 sm:px-6",children:[s.jsx("header",{className:"rounded-2xl border border-white/70 bg-white/90 px-5 py-5 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1),0_10px_15px_-3px_rgba(0,0,0,0.1),0_4px_6px_-2px_rgba(0,0,0,0.05)] backdrop-blur-md",children:s.jsxs("div",{className:"flex flex-col gap-3",children:[s.jsx("span",{className:"text-[10px] font-semibold uppercase tracking-[0.35em] text-muted-foreground/70",children:"Product Intelligence Suite"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h1",{className:"font-heading text-[26px] font-bold text-gray-900",children:"Product Tools"}),s.jsx(Zs,{className:"h-6 w-6 text-vox-pink"})]}),s.jsx("p",{className:"text-sm text-muted-foreground sm:max-w-2xl",children:"Unlock structured frameworks to evaluate, refine, and elevate your product positioning with AI-guided workflows."})]})}),s.jsx("div",{className:"flex-1 overflow-hidden rounded-2xl border border-white/70 bg-white/85 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1),0_10px_15px_-3px_rgba(0,0,0,0.1),0_4px_6px_-2px_rgba(0,0,0,0.05)] backdrop-blur",children:s.jsx("div",{className:"h-full overflow-y-auto px-4 py-6 sm:px-6 sm:py-7",children:s.jsxs("div",{className:"grid gap-6",children:[s.jsxs(qe,{className:"col-span-1 sm:col-span-2 xl:col-span-3 relative overflow-hidden border-vox-pink/20 shadow-lg shadow-vox-pink/10 transition-all hover:-translate-y-1 hover:shadow-xl",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-vox-pink/10 via-vox-orange/5 to-transparent"}),s.jsxs(vt,{className:"relative",children:[s.jsx(pt,{className:"flex items-center justify-between text-2xl sm:text-3xl",children:s.jsx("span",{children:"M.A.R.G.O."})}),s.jsx(gt,{className:"text-base sm:text-lg",children:"Multi-dimensional product assessment journey to align your offer with your ideal buyer."})]}),s.jsx(Xe,{className:"relative space-y-4 pt-0 text-sm text-muted-foreground",children:s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1.5 h-1.5 w-1.5 rounded-full bg-vox-pink"}),s.jsx("span",{children:"Structured 7-step evaluation guided by an AI strategist"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1.5 h-1.5 w-1.5 rounded-full bg-vox-orange"}),s.jsx("span",{children:"Capture blind spots across messaging, positioning, and objections"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1.5 h-1.5 w-1.5 rounded-full bg-vox-purple"}),s.jsx("span",{children:"Generate an actionable brief tailored to your offer"})]})]})}),s.jsxs(tf,{className:"relative flex flex-col gap-3 sm:flex-row",children:[s.jsx(Ie,{asChild:!0,className:"group w-full sm:w-auto bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink text-white shadow-lg hover:shadow-xl",children:s.jsxs(St,{to:"/tools/margo",children:["Launch Margo",s.jsx(xo,{className:"ml-2 h-4 w-4 transition-transform group-hover:translate-x-1"})]})}),s.jsx(Ie,{asChild:!0,variant:"outline",className:"w-full sm:w-auto border-vox-pink/30 text-vox-pink hover:bg-vox-pink/10",children:s.jsx(St,{to:"/tools/margo/previous-briefs",children:"Previous MARGO Briefs"})})]})]}),s.jsxs(qe,{className:"col-span-1 sm:col-span-2 xl:col-span-3 relative overflow-hidden border-vox-orange/20 shadow-lg shadow-vox-orange/10 transition-all hover:-translate-y-1 hover:shadow-xl",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-vox-orange/10 via-vox-pink/5 to-transparent"}),s.jsxs(vt,{className:"relative",children:[s.jsx(pt,{className:"flex items-center justify-between text-2xl sm:text-3xl",children:s.jsx("span",{children:"Product Refiner"})}),s.jsx(gt,{className:"text-base sm:text-lg",children:"Comprehensive 10-step product refinement workflow to transform your product into a market-ready offer."})]}),s.jsx(Xe,{className:"relative space-y-4 pt-0 text-sm text-muted-foreground",children:s.jsxs("ul",{className:"space-y-2",children:[s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1.5 h-1.5 w-1.5 rounded-full bg-vox-orange"}),s.jsx("span",{children:"Step-by-step product refinement process with AI guidance"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1.5 h-1.5 w-1.5 rounded-full bg-vox-pink"}),s.jsx("span",{children:"Define product promise, outcomes, features, and pricing"})]}),s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1.5 h-1.5 w-1.5 rounded-full bg-vox-purple"}),s.jsx("span",{children:"Generate comprehensive product specification documents"})]})]})}),s.jsxs(tf,{className:"relative flex flex-col gap-3 sm:flex-row",children:[s.jsx(Ie,{asChild:!0,className:"group w-full sm:w-auto bg-gradient-to-r from-vox-orange via-vox-pink to-vox-orange text-white shadow-lg hover:shadow-xl",children:s.jsxs(St,{to:"/tools/product-refiner",children:["Launch Product Refiner",s.jsx(xo,{className:"ml-2 h-4 w-4 transition-transform group-hover:translate-x-1"})]})}),s.jsx(Ie,{asChild:!0,variant:"outline",className:"w-full sm:w-auto border-vox-orange/30 text-vox-orange hover:bg-vox-orange/10",children:s.jsx(St,{to:"/tools/product-refiner/previous-sessions",children:"Previous Sessions"})})]})]})]})})})]})}),ts=({className:e,...t})=>s.jsxs("span",{className:it("margo-typing-indicator text-current/80",e),"aria-live":"polite",...t,children:[s.jsx("span",{className:"margo-typing-dot"}),s.jsx("span",{className:"margo-typing-dot"}),s.jsx("span",{className:"margo-typing-dot"})]}),ZM=(e,t)=>{const n=e.replace(/\r\n/g,`
`).trim();if(!n)return[];const r=n.split(/\n{2,}/).map(o=>o.trim()).filter(Boolean),a=o=>{if(o.length<=t)return[o];if(o.includes(`
`))return o.split(/\n+/).map(d=>d.trim()).filter(Boolean);const l=o.split(new RegExp("(?<=[.!?])\\s+(?=[A-Z0-9])")).map(d=>d.trim()).filter(Boolean);if(l.length===0)return[o];if(l.length===1||l.every(d=>d.length>=t))return l;const c=[];let u="";return l.forEach(d=>{if(!u){u=d;return}const g=`${u} ${d}`.trim();g.length<=t*1.5?u=g:(c.push(u),u=d)}),u&&c.push(u),c};return r.flatMap(o=>a(o))},Ge=({text:e,className:t,chunkClassName:n,minChunkLength:r=120,staggerMs:a=0,animation:o="fade",onComplete:l,isChunk:c=!0,...u})=>{const d=i.useMemo(()=>(e||"").replace(/\r\n/g,`
`).replace(/\\n/g,`
`).split(`
`).map(k=>k.trim()).filter(k=>k.length>0).join(`
`),[e]),g=i.useRef(!1),m=i.useRef(d),p=i.useMemo(()=>{if(!c||!d)return[];const S=ZM(d,r);return S.length===0?d?[d]:[]:S},[d,r,c]),[f,w]=i.useState(0),[h,v]=i.useState(""),x=i.useRef(l);i.useEffect(()=>{x.current=l},[l]);const y=i.useMemo(()=>{if(!c||!d||!p.length)return[];const S=[];let j=0;return p.forEach(k=>{if(!k){S.push(j);return}const C=k.trim();if(!C){S.push(j);return}const W=d.indexOf(C,j);if(W===-1){S.push(S.length>0?S[S.length-1]:d.length);return}const B=W+C.length;S.push(B),j=B}),S[S.length-1]!==d.length&&(S[S.length-1]=d.length),S},[p,d,c]);if(i.useEffect(()=>{m.current!==d&&(g.current=!1,m.current=d),!c&&l&&!g.current&&(g.current=!0,l())},[c,l,d]),i.useEffect(()=>{var k;if(!c)return;if(o==="typewriter"){if(!d){v(""),(k=x.current)==null||k.call(x);return}v(""),w(0);let C=!0;const W=d,B=y.length?y:[W.length];let U=0,Q=0;const V=6;let P=null;const K=()=>{var q;if(!C)return;if(Q+=1,v(W.slice(0,Q)),Q>=W.length){(q=x.current)==null||q.call(x);return}const G=B[U];if(G!==void 0&&Q>=G&&(U+=1,a>0)){P=window.setTimeout(K,a);return}P=window.setTimeout(K,V)};return P=window.setTimeout(K,V),()=>{C=!1,P&&window.clearTimeout(P)}}if(!p.length){w(0),v("");return}if(!a||a<=0){w(p.length);return}w(1);let S=1;const j=window.setInterval(()=>{var C;S+=1,S>=p.length?(w(p.length),window.clearInterval(j),(C=x.current)==null||C.call(x)):w(S)},a);return()=>{window.clearInterval(j)}},[o,p,d,a,c,y]),!c)return s.jsx("div",{className:it("leading-relaxed whitespace-pre-wrap",n,t),...u,children:d||e||""});const b=()=>s.jsx("div",{className:it("leading-relaxed whitespace-pre-wrap",n),children:h}),N=()=>s.jsx(s.Fragment,{children:p.map((S,j)=>j>=f?null:s.jsx("div",{className:it("leading-relaxed margo-chunk",n),children:S},`${j}-${S.slice(0,24)}`))});return s.jsx("div",{className:it("flex flex-col gap-1.5 text-left",t),...u,children:o==="typewriter"?b():N()})},Ye=(e,t,n)=>{var c;const r=typeof import.meta<"u"?(c=import.meta)==null?void 0:c.env:void 0;if((r==null?void 0:r.MODE)==="test"||(r==null?void 0:r.VITEST))return;const o=new Date().toISOString(),l=`[MARGO API][${e.toUpperCase()}][${t}]`;n&&Object.keys(n).length>0?console.log(l,{...n,timestamp:o}):console.log(l,{timestamp:o})},e4=async(e,t="My Product Evaluation")=>{const n=`${Fe}/margo-briefs`,r="createMargoBrief";Ye("request",r,{endpoint:n,workspaceId:e,sessionName:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify({workspaceId:e,sessionName:t})});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to create MARGO session"}));throw Ye("failure",r,{endpoint:n,workspaceId:e,sessionName:t,status:a.status,error:l}),new Error(l.message||"Failed to create MARGO session")}const o=await a.json();return Ye("success",r,{endpoint:n,workspaceId:e,sessionName:t,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,workspaceId:e,sessionName:t,error:(a==null?void 0:a.message)||a}),a}},t4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step1`,r="submitMargoStep1";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 1 response"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 1 response")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},s4=async e=>{const t=`${Fe}/margo-briefs/workspace/${e}/available-ava-profiles`,n="getAvailableAvaProfiles";Ye("request",n,{endpoint:t,workspaceId:e});try{const r=await Oe.makeAuthenticatedRequest(t,{method:"GET"});if(!r.ok){const o=await r.json().catch(()=>({message:"Failed to load AVA profiles"}));throw Ye("failure",n,{endpoint:t,workspaceId:e,status:r.status,error:o}),new Error(o.message||"Failed to load AVA profiles")}const a=await r.json();return Ye("success",n,{endpoint:t,workspaceId:e,status:r.status,response:a}),a}catch(r){throw Ye("failure",n,{endpoint:t,workspaceId:e,error:(r==null?void 0:r.message)||r}),r}},n4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step2`,r="submitMargoStep2";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to set AVA profile"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to set AVA profile")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},r4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/ready`,r="confirmMargoReady";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to confirm readiness"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to confirm readiness")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},a4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step3/question/${t}`,r="fetchMargoStep3Question";Ye("request",r,{endpoint:n,briefId:e,questionNumber:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"GET"});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to load Step 3 question"}));throw Ye("failure",r,{endpoint:n,briefId:e,questionNumber:t,status:a.status,error:l}),new Error(l.message||"Failed to load Step 3 question")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,questionNumber:t,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,questionNumber:t,error:(a==null?void 0:a.message)||a}),a}},o4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step3/question`,r="submitMargoStep3Answer";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 3 answer"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 3 answer")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},i4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step4/ready`,r="submitMargoStep4Ready";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to generate Step 4 assessment"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to generate Step 4 assessment")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},l4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step4/video-watched`,r="submitMargoStep4VideoWatched";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to acknowledge video completion"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to acknowledge video completion")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},c4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step5/ready`,r="submitMargoStep5Ready";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to generate Step 5 recommendations"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to generate Step 5 recommendations")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},u4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step5/video-watched`,r="submitMargoStep5VideoWatched";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to acknowledge Step 5 video"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to acknowledge Step 5 video")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},d4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step6/ready`,r="submitMargoStep6Ready";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to prepare Step 6"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to prepare Step 6")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},m4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step6/video-watched`,r="submitMargoStep6VideoWatched";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to acknowledge Step 6 video"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to acknowledge Step 6 video")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},f4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step6/bonus-request`,r="submitMargoStep6BonusRequest";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to generate Step 6 bonuses"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to generate Step 6 bonuses")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},h4=async(e,t)=>{const n=`${Fe}/margo-briefs/${e}/step7/generate`,r="submitMargoStep7Generate";Ye("request",r,{endpoint:n,briefId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to generate Step 7 section"}));throw Ye("failure",r,{endpoint:n,briefId:e,status:a.status,error:l}),new Error(l.message||"Failed to generate Step 7 section")}const o=await a.json();return Ye("success",r,{endpoint:n,briefId:e,status:a.status,response:o}),o}catch(a){throw Ye("failure",r,{endpoint:n,briefId:e,error:(a==null?void 0:a.message)||a}),a}},Qh=async e=>{const t=`${Fe}/margo-briefs/${e}/final-product-brief`,n="fetchMargoFinalProductBrief";Ye("request",n,{endpoint:t,briefId:e});try{const r=await Oe.makeAuthenticatedRequest(t,{method:"GET",headers:{Accept:"application/pdf"}});if(!r.ok){let o=null;try{o=await r.json()}catch{}throw Ye("failure",n,{endpoint:t,briefId:e,status:r.status,error:o}),new Error((o==null?void 0:o.message)||"Failed to download final product brief")}const a=await r.blob();return Ye("success",n,{endpoint:t,briefId:e,status:r.status,size:a.size,type:a.type}),a}catch(r){throw Ye("failure",n,{endpoint:t,briefId:e,error:(r==null?void 0:r.message)||r}),r}},qn=async e=>{const t=`${Fe}/margo-briefs/workspace/${e}`,n="listWorkspaceBriefs";Ye("request",n,{endpoint:t,workspaceId:e});try{const r=await Oe.makeAuthenticatedRequest(t,{method:"GET"});if(!r.ok){const o=await r.json().catch(()=>({message:"Failed to load MARGO briefs"}));throw Ye("failure",n,{endpoint:t,workspaceId:e,status:r.status,error:o}),new Error(o.message||"Failed to load MARGO briefs")}const a=await r.json();return Ye("success",n,{endpoint:t,workspaceId:e,status:r.status}),(a==null?void 0:a.data)||a}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to load MARGO briefs";throw Ye("failure",n,{endpoint:t,workspaceId:e,error:a}),new Error(a)}},p4=async e=>{var r,a;const t=`${Fe}/margo-briefs/${e}/final-product-brief`,n="fetchMargoFinalProductBriefData";Ye("request",n,{endpoint:t,briefId:e});try{const o=await Oe.makeAuthenticatedRequest(t,{method:"GET",headers:{Accept:"application/json"}});if(o.status===404)return Ye("failure",n,{endpoint:t,briefId:e,status:o.status,error:"Final product brief not ready"}),null;if(!o.ok){const c=await o.json().catch(()=>({message:"Failed to fetch final product brief"}));throw Ye("failure",n,{endpoint:t,briefId:e,status:o.status,error:c}),new Error((c==null?void 0:c.message)||"Failed to fetch final product brief")}const l=await o.json();return Ye("success",n,{endpoint:t,briefId:e,status:o.status,hasSummary:!!((r=l==null?void 0:l.data)!=null&&r.finalProductBrief),sectionsCount:Array.isArray((a=l==null?void 0:l.data)==null?void 0:a.sections)?l.data.sections.length:0}),l}catch(o){throw Ye("failure",n,{endpoint:t,briefId:e,error:(o==null?void 0:o.message)||o}),o}},tc=e=>{if(!e)return null;const t=e.split(/\n/),n=r=>{const a=[];let o=0;const l=/\*\*(.+?)\*\*/g,c=[];let u;for(;(u=l.exec(r))!==null;)c.push({start:u.index,end:u.index+u[0].length,content:u[1]});const d=new RegExp("(?<!\\*)\\*([^*]+?)\\*(?!\\*)","g"),g=[];for(;(u=d.exec(r))!==null;)c.some(v=>u.index<v.end&&u.index+u[0].length>v.start)||g.push({start:u.index,end:u.index+u[0].length,content:u[1]});const m=/"([^"]+)"/g,p=[];for(;(u=m.exec(r))!==null;)[...c,...g].some(x=>u.index<x.end&&u.index+u[0].length>x.start)||p.push({start:u.index,end:u.index+u[0].length,content:u[1]});const f=[...c.map(h=>({...h,type:"double"})),...g.map(h=>({...h,type:"single"})),...p.map(h=>({...h,type:"quoted"}))].sort((h,v)=>h.start-v.start);let w=0;for(const h of f)h.start>w&&a.push(r.slice(w,h.start)),a.push(s.jsx("strong",{className:"font-semibold text-gray-900",children:h.content},`bold-${o++}-${h.start}`)),w=h.end;return w<r.length&&a.push(r.slice(w)),a.length>0?a:[r]};return s.jsx("div",{className:"space-y-2 text-sm leading-relaxed",children:t.map((r,a)=>{if(!r.trim())return s.jsx("div",{className:"h-2"},`empty-${a}`);const l=/^\s*#{1,6}\s+(.+)/.exec(r);return l?s.jsx("div",{className:"font-bold text-base text-gray-900 mb-1",children:l[1]},`h-${a}`):s.jsx("div",{className:"whitespace-pre-wrap text-gray-700",children:n(r)},`p-${a}`)})})},vi=e=>e?e.replace(/```[\s\S]*?```/g,t=>t.replace(/```/g,"")).replace(/`([^`]*)`/g,"$1").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/~~(.*?)~~/g,"$1").replace(/^#{1,6}\s+/gm,"").replace(/^\s*>+\s?/gm,"").replace(/!\[[^\]]*\]\((.*?)\)/g,"$1").replace(/\[([^\]]+)\]\((.*?)\)/g,"$1").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/\r/g,"").replace(/\n{3,}/g,`

`).trim():"",g4=e=>{if(!e)return"";let t=e.replace(//g,"");const n=t.split(`
`),r=[];let a=!1;for(let f=0;f<n.length;f++){const w=n[f],h=w.trim();if(h.match(/https?:\/\/[^\s]+/)){a=!0;continue}if(h.match(/^Please watch this short video/i)){a=!0;continue}if(!(h===""||h.match(/^\s*$/))){if(a&&h.match(/^It explains/i)){a=!1;continue}a=!1,r.push(w)}}t=r.map(f=>{var v;const h=f.trim().match(new RegExp("^(\\p{Emoji}+)\\s*(.+)$","u"));if(h){const x=h[2].trim();return`${((v=f.match(/^\s*/))==null?void 0:v[0])||""}**${x}**`}return f}).join(`
`),t=t.replace(/https?:\/\/[^\s]+/g,""),t=t.replace(/^(\s*Step\s+\d+:[^\n]+)/gm,"**$1**"),t=t.replace(/^(\s+[^\n]+)/gm,"**$1**"),t=t.replace(/(\s+[^\n]+)/g,"**$1**"),t=t.replace(/(Where your offer already excels)/g,"**$1**"),t=t.replace(/(Where we can refine to increase traction and conversions)/g,"**$1**"),t=t.replace(new RegExp('(?<!\\*\\*)"([^"]+)"(?!\\*\\*)',"g"),'**"$1"**'),t=t.replace(/\*\*"([^"]+)"\*\*/g,"**$1**"),t=t.replace(/\*\*"([^"]+)"/g,"**$1"),t=t.replace(/"([^"]+)"\*\*/g,"$1**");const l=t.split(`
`),c=[];let u=0;for(;u<l.length;){const f=l[u],w=f.trim();if(w.endsWith(":")&&!w.match(/^[-*]\s/)&&!w.match(/^\d+\.\s/)){const h=[];let v=u+1,x=!1;for(;v<l.length&&l[v].trim()==="";)v++;for(;v<l.length;){const b=l[v].trim();if(b===""&&x){let N=v+1;for(;N<l.length&&l[N].trim()==="";)N++;if(N<l.length){const S=l[N].trim();if(S.startsWith("**")||S.match(/^[-*]\s/)||S.match(/^\d+\.\s/)||S.length>100)break}}if(b===""&&!x||b.match(/^[-*]\s/)||b.match(/^\d+\.\s/)||b.startsWith("**")||b.match(/^[]/))break;b!==""&&(h.push(b),x=!0),v++}if(x&&h.length>0){c.push(f),h.forEach(y=>{c.push(`- ${y}`)}),u=v;continue}}c.push(f),u++}t=c.join(`
`);const d=t.split(`
`),g=[];let m=!1,p=[];for(let f=0;f<d.length;f++){const w=d[f],h=w.trim();if(h.startsWith("**")&&!h.endsWith("**"))m=!0,p=[h];else if(m)if(h.endsWith("**")){h.startsWith("**"),p.push(h);const v=p[0]||"",x=p[p.length-1]||"",y=p.slice(1,-1).filter(Boolean),b=v.replace(/^\*\*+/,"").trim(),N=x.replace(/\*\*+$/,"").trim(),j=`**${[b,...y,N].filter(Boolean).join(" ")}**`;g.push(j),m=!1,p=[]}else h&&p.push(h);else g.push(w)}return m&&p.length>0&&g.push(...p),t=g.join(`
`),t=t.replace(/(\*\*[^\n]+)\n+([^\n]+)\*\*/g,"$1 $2**"),t=t.replace(/\n{3,}/g,`

`),t.trim()},x4=(e,t)=>{const n=e.replace(/\r\n/g,`
`).trim();if(!n)return[];const r=n.split(/\n{2,}/).map(o=>o.trim()).filter(Boolean),a=o=>{if(o.length<=t)return[o];if(o.includes(`
`))return o.split(/\n+/).map(d=>d.trim()).filter(Boolean);const l=o.split(new RegExp("(?<=[.!?])\\s+(?=[A-Z0-9])")).map(d=>d.trim()).filter(Boolean);if(l.length===0)return[o];if(l.length===1||l.every(d=>d.length>=t))return l;const c=[];let u="";return l.forEach(d=>{if(!u){u=d;return}const g=`${u} ${d}`.trim();g.length<=t*1.5?u=g:(c.push(u),u=d)}),u&&c.push(u),c};return r.flatMap(o=>a(o))},gs=({text:e,className:t,chunkClassName:n,minChunkLength:r=120,staggerMs:a=200,animation:o="fade",onComplete:l,isCompleted:c=!1,isChunk:u=!0,...d})=>{const g=i.useMemo(()=>(e||"").replace(/\r\n/g,`
`).replace(/\\n/g,`
`).split(`
`).map(k=>k.trim()).filter(k=>k.length>0).join(`
`),[e]),m=i.useMemo(()=>g4(g),[g]),p=i.useMemo(()=>{if(!m)return[];const S=x4(m,r);return S.length===0?m?[m]:[]:S},[m,r]),f=i.useMemo(()=>{if(!m||!p.length)return[];const S=[];let j=0;return p.forEach(k=>{if(!k){S.push(j);return}const C=k.trim();if(!C){S.push(j);return}const W=m.indexOf(C,j);if(W===-1){S.push(S.length>0?S[S.length-1]:m.length);return}const B=W+C.length;S.push(B),j=B}),S[S.length-1]!==m.length&&(S[S.length-1]=m.length),S},[p,m]),[w,h]=i.useState(0),[v,x]=i.useState(""),y=i.useRef(l);if(i.useEffect(()=>{y.current=l},[l]),i.useEffect(()=>{var k,C,W,B;if(!u)return;if(c){h(p.length),x(m||""),(k=y.current)==null||k.call(y);return}if(!m){h(0),x(""),(C=y.current)==null||C.call(y);return}if(o==="typewriter"){x(""),h(0);let U=!0;const Q=m,V=f.length?f:[Q.length];let P=0,K=0;const G=6;let q=null;const A=()=>{var R;if(!U)return;if(K+=1,x(Q.slice(0,K)),K>=Q.length){(R=y.current)==null||R.call(y);return}const E=V[P];if(E!==void 0&&K>=E&&(P+=1,a>0)){q=window.setTimeout(A,a);return}q=window.setTimeout(A,G)};return q=window.setTimeout(A,G),()=>{U=!1,q&&window.clearTimeout(q)}}if(!p.length){h(0),x(""),(W=y.current)==null||W.call(y);return}if(!a||a<=0){h(p.length),(B=y.current)==null||B.call(y);return}h(1);let S=1;const j=window.setInterval(()=>{var U;S+=1,S>=p.length?(h(p.length),window.clearInterval(j),(U=y.current)==null||U.call(y)):h(S)},a);return()=>{window.clearInterval(j)}},[p,a,c,o,m,f,u]),i.useEffect(()=>{!u&&m&&(l==null||l())},[u,m,l]),!m)return null;if(!u)return s.jsx("div",{className:it("flex flex-col gap-1.5 text-left",t),...d,children:s.jsx("div",{className:it("leading-relaxed whitespace-pre-wrap",n),children:tc(m)})});const b=()=>s.jsx("div",{className:it("leading-relaxed whitespace-pre-wrap",n),children:tc(v)}),N=()=>s.jsx(s.Fragment,{children:p.map((S,j)=>j>=w?null:s.jsx("div",{className:it("leading-relaxed margo-chunk",n),children:tc(S)},`${j}-${S.slice(0,24)}`))});return s.jsx("div",{className:it("flex flex-col gap-1.5 text-left",t),...d,children:o==="typewriter"?b():N()})},v4=({workspaceId:e,session:t,onSessionChange:n,onLoadingChange:r,onErrorChange:a,isCompleted:o=!1,onInputHandlersReady:l})=>{const{toast:c}=yt(),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState((t==null?void 0:t.userName)??""),[w,h]=i.useState("I'm ready"),[v,x]=i.useState(!1),[y,b]=i.useState(!(t!=null&&t.welcomeMessage)),N=i.useRef(!1),[S,j]=i.useState(!1),[k,C]=i.useState(!1),[W,B]=i.useState(!1),[U,Q]=i.useState(!1),[V,P]=i.useState(!1);i.useEffect(()=>{f((t==null?void 0:t.userName)??"")},[t==null?void 0:t.userName]),i.useEffect(()=>{t!=null&&t.step1Completed&&h("I'm ready")},[t==null?void 0:t.step1Completed]),i.useEffect(()=>{t!=null&&t.welcomeMessage?N.current||b(!1):(b(!0),N.current=!0)},[t==null?void 0:t.welcomeMessage]);const K=!!(t!=null&&t.userName&&((t==null?void 0:t.nextAction)==="confirm_ready"||(t==null?void 0:t.nextAction)==="select_ava_profile"||t!=null&&t.step1Completed));i.useEffect(()=>{const L=(t==null?void 0:t.nextAction)==="submit_name";if(!t||o||!L||K){j(!0),C(!0),B(!0),Q(!0),P(!0);return}j(!1),C(!1),B(!1),Q(!1),P(!1);const I=setTimeout(()=>{j(!0)},300);return()=>{clearTimeout(I)}},[t==null?void 0:t.id,t==null?void 0:t.welcomeMessage,o,t==null?void 0:t.nextAction,t==null?void 0:t.userName,t==null?void 0:t.step1Completed,K]),i.useEffect(()=>{if(U&&!k&&(t==null?void 0:t.nextAction)==="submit_name"&&!K){const L=setTimeout(()=>{C(!0)},200);return()=>clearTimeout(L)}},[U,k,t==null?void 0:t.nextAction,K]),i.useEffect(()=>{if(V&&!W&&(t==null?void 0:t.nextAction)==="submit_name"&&!K){const L=setTimeout(()=>{B(!0)},200);return()=>clearTimeout(L)}},[V,W,t==null?void 0:t.nextAction,K]),i.useEffect(()=>{t!=null&&t.welcomeMessage||(Q(!1),P(!1))},[t==null?void 0:t.id]);const G=K&&(t==null?void 0:t.nextAction)==="confirm_ready"&&!(t!=null&&t.step1Completed)&&!(t!=null&&t.step2Completed),q=(t==null?void 0:t.nextAction)==="submit_name"||K,A=G||K&&(t==null?void 0:t.nextAction)==="confirm_ready"&&!(t!=null&&t.step1Completed);i.useEffect(()=>{if(!l)return;const I=(t==null?void 0:t.nextAction)==="submit_name"&&!K&&!o&&t;l(I?{inputValue:p,onInputChange:f,onInputSubmit:E,isSubmitting:g,placeholder:"e.g., Clara"}:null)},[l,t==null?void 0:t.nextAction,t==null?void 0:t.userName,K,o,t==null?void 0:t.id,p,g]),i.useEffect(()=>{if(!e||t!=null&&t.id&&(!t.workspaceId||t.workspaceId===e))return;let L=!1;return(async()=>{d(!0),r==null||r(!0),a==null||a(null);try{const _=await e4(e,"My Product Evaluation");if(L)return;const $=_==null?void 0:_.data;if(!$)throw new Error("Missing session data in response");n({...$,workspaceId:$.workspaceId??e,step1Completed:$.step1Completed??!1,currentStep:$.currentStep&&$.currentStep>1?$.currentStep:1}),f($.userName??""),c({title:"MARGO Activated",description:"Your product evaluation journey is ready to begin."})}catch(_){if(L)return;const $=(_==null?void 0:_.message)||"Unable to start MARGO session.";a==null||a($),c({title:"Unable to start MARGO",description:$,variant:"destructive"})}finally{if(L)return;d(!1),r==null||r(!1)}})(),()=>{L=!0}},[e,t==null?void 0:t.workspaceId,t==null?void 0:t.id,n,r,a,c]);const E=async()=>{if(!(t!=null&&t.id)){c({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}if(!p.trim()){c({title:"Name required",description:"Please enter your name to continue.",variant:"destructive"});return}const L=p.trim();try{m(!0);const I=await t4(t.id,{userName:L}),_=(I==null?void 0:I.data)||null,$={...t||{},..._??{},id:t.id,workspaceId:(_==null?void 0:_.workspaceId)??t.workspaceId??e,userName:(_==null?void 0:_.userName)||L,step1Completed:!1,currentStep:1,nextAction:"confirm_ready"};n($),f(L),h("I'm ready"),c({title:"Step 1 submitted",description:"Great! MARGO is preparing the next part of your journey."})}catch(I){const _=(I==null?void 0:I.message)||"Unable to submit your answer.";_.includes("current step is 2")||_.includes("Expected step 1")?(n({...t,currentStep:2,nextAction:"select_ava_profile"}),c({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"})):c({title:"Submission failed",description:_,variant:"destructive"})}finally{m(!1)}},R=async()=>{var I,_;if(!(t!=null&&t.id)){c({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const L=w.trim();if(!L){c({title:"Confirmation required",description:"Please confirm you're ready to continue.",variant:"destructive"});return}try{x(!0),a==null||a(null);const $=await r4(t.id,{message:L}),F=($==null?void 0:$.data)||null;if(!F&&!($!=null&&$.data))throw new Error("No response data received from server");const M={...t,...F??{},id:t.id,workspaceId:t.workspaceId??e,step1Completed:!0,currentStep:F!=null&&F.currentStep&&F.currentStep>(t.currentStep??0)?F.currentStep:Math.max(t.currentStep??2,2),nextAction:(F==null?void 0:F.nextAction)||"select_ava_profile"};setTimeout(()=>{n(M)},0),c({title:"Ready to continue",description:"Perfect! Let's connect your AVA profile next."})}catch($){console.error("Ready confirmation error:",$);const F=($==null?void 0:$.message)||((_=(I=$==null?void 0:$.response)==null?void 0:I.data)==null?void 0:_.message)||"Unable to confirm readiness. Please try again.";if(F.includes("current step is 2")||F.includes("Expected step 1")){const M={...t,currentStep:2,nextAction:"select_ava_profile",step1Completed:!0};setTimeout(()=>{n(M)},0),c({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),a==null||a(null)}else a==null||a(F),c({title:"Confirmation failed",description:F,variant:"destructive"})}finally{x(!1)}};if(u&&!t)return s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900 mb-1",children:"Initializing MARGO..."}),s.jsx(Ge,{text:"Booting up your strategic workspace. One moment while I set the stage",chunkClassName:"text-sm text-gray-600",animation:"typewriter",isChunk:!0,staggerMs:300,minChunkLength:60}),s.jsx(ts,{className:"text-gray-400"})]})]})})});if(!t)return null;if(o)return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4",children:[t.welcomeMessage&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(gs,{text:t.welcomeMessage,chunkClassName:"text-sm",animation:"typewriter",isChunk:!1,staggerMs:30,minChunkLength:100,onComplete:()=>{}})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:"Hey there! I'm MARGO  let me personalize this journey. What name should I greet you by?",chunkClassName:"text-sm"})})}),t.userName&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:`You can call me ${t.userName}.`,chunkClassName:"text-sm"})})})]}),t.step1Completed&&s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:t.userName?`Amazing, ${t.userName}! When you say the word, I'll lock in your AVA profile options.`:"Amazing! When you say the word, I'll lock in your AVA profile options.",chunkClassName:"text-sm",isChunk:!1})})}),t.userName&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:"I'm ready",chunkClassName:"text-sm",isChunk:!1})})})]})]});if(q&&!o){const L=t.nextAction==="submit_name",I=K&&!L,_=I?!0:S,$=I?!0:k;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4",children:[t.welcomeMessage&&_&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${S?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(gs,{text:t.welcomeMessage,chunkClassName:"text-sm",animation:"typewriter",isChunk:!!L,staggerMs:30,minChunkLength:100,onComplete:()=>{b(!0),N.current=!0,Q(!0)}}),!y&&L&&_&&s.jsx(ts,{className:"text-gray-400"})]})}),$&&(y||I)&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${k?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(Ge,{text:"Hey there! I'm MARGO  let me personalize this journey. What name should I greet you by?",chunkClassName:"text-sm",animation:L?"typewriter":void 0,isChunk:!0,staggerMs:30,minChunkLength:80,onComplete:()=>{P(!0)}}),g&&L&&s.jsx(ts,{className:"text-gray-400"})]})}),I&&t.userName&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user transition-opacity duration-500 opacity-100",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:`You can call me ${t.userName}.`,chunkClassName:"text-sm",isChunk:!1})})})]})]}),A&&s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 opacity-100",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(Ge,{text:t.userName?`Amazing, ${t.userName}! When you say the word, I'll lock in your AVA profile options.`:"Amazing! When you say the word, I'll lock in your AVA profile options.",chunkClassName:"text-sm",animation:"typewriter",isChunk:!0,staggerMs:30,minChunkLength:100}),v&&s.jsx(ts,{className:"text-gray-400"})]})}),s.jsxs("div",{className:"space-y-3 mb-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"margo-ready-confirmation",className:"text-sm font-medium text-gray-700",children:"Click on ready button"}),s.jsx("p",{className:"text-xs text-gray-500",children:"This message is sent to MARGO to confirm you're ready for the AVA profile step."})]}),s.jsx("div",{className:"flex flex-col items-center gap-3",children:s.jsx(Ie,{type:"button",onClick:R,disabled:v,className:"margo-soft-button text-sm w-full",children:v?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending confirmation..."]}):"I'm ready"})}),s.jsx("span",{className:"text-sm text-gray-500 text-left w-full",children:"MARGO will advance once you confirm."})]})]})]})}return G&&!o&&!q?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(Ge,{text:t.userName?`Amazing, ${t.userName}! When you say the word, I'll lock in your AVA profile options.`:"Amazing! When you say the word, I'll lock in your AVA profile options.",chunkClassName:"text-sm",animation:"typewriter",isChunk:!1,staggerMs:350,minChunkLength:60}),v&&s.jsx(ts,{className:"text-gray-400"})]})}),s.jsxs("div",{className:"space-y-3 ml-12 mb-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"margo-ready-confirmation",className:"text-sm font-medium text-gray-700",children:"Type your confirmation"}),s.jsx(Ft,{id:"margo-ready-confirmation",value:w,onChange:L=>h(L.target.value),disabled:v,className:"h-10 rounded border-gray-300 bg-white transition focus:border-gray-400 focus:ring-gray-400"}),s.jsx("p",{className:"text-xs text-gray-500",children:"This message is sent to MARGO to confirm you're ready for the AVA profile step."})]}),s.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center",children:[s.jsx(Ie,{type:"button",onClick:R,disabled:v,className:"margo-soft-button",children:v?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending confirmation..."]}):"I'm ready"}),s.jsx("span",{className:"text-sm text-gray-500",children:"MARGO will advance once you confirm."})]})]})]}):t.step1Completed&&!o?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"space-y-4",children:[t.welcomeMessage&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(gs,{text:t.welcomeMessage,chunkClassName:"text-sm",animation:"typewriter",isChunk:!1,staggerMs:30,minChunkLength:100,onComplete:()=>{}})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:"Hey there! I'm MARGO  let me personalize this journey. What name should I greet you by?",chunkClassName:"text-sm",isChunk:!1})})}),t.userName&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:`You can call me ${t.userName}.`,chunkClassName:"text-sm",isChunk:!1})})})]}),s.jsxs("div",{className:"space-y-4 mt-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:t.userName?`Amazing, ${t.userName}! When you say the word, I'll lock in your AVA profile options.`:"Amazing! When you say the word, I'll lock in your AVA profile options.",chunkClassName:"text-sm",isChunk:!1})})}),t.userName&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:"I'm ready",chunkClassName:"text-sm",isChunk:!1})})})]})]}):null},y4=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1})=>{var N,S;const{toast:c}=yt(),[u,d]=i.useState([]),[g,m]=i.useState(!1),[p,f]=i.useState(null),[w,h]=i.useState(t.step2AvaProfileId??""),[v,x]=i.useState(!1);i.useEffect(()=>{h(t.step2AvaProfileId??"")},[t.step2AvaProfileId]);const y=i.useMemo(()=>!e||!t.id?!1:!!(n||r||l||t.step2AvaProfileId),[e,t.id,n,r,l,t.step2AvaProfileId]);i.useEffect(()=>{if(!y)return;let j=!1;return(async()=>{var C;m(!0),f(null);try{const W=await s4(e);if(j)return;const B=(W==null?void 0:W.data)??[];d(B),o==null||o(null);const U=t.step2AvaProfileId||((C=B[0])==null?void 0:C.id)||"";h(Q=>Q||U)}catch(W){if(j)return;const B=(W==null?void 0:W.message)||"Unable to load AVA profiles.";f(B),o==null||o(B),c({title:"Unable to load AVA profiles",description:B,variant:"destructive"})}finally{if(j)return;m(!1)}})(),()=>{j=!0}},[y,e,t.step2AvaProfileId,c]);const b=async()=>{if(!t.id){c({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}if(!w){c({title:"Select a profile",description:"Choose an AVA profile to continue.",variant:"destructive"});return}try{x(!0);const j=await n4(t.id,{avaProfileId:w}),k=(j==null?void 0:j.data)??null,C={...t,...k??{},step2AvaProfileId:(k==null?void 0:k.step2AvaProfileId)||w,step2Completed:(k==null?void 0:k.step2Completed)??!0,currentStep:k!=null&&k.currentStep&&k.currentStep>3?k.currentStep:3,nextAction:(k==null?void 0:k.nextAction)||"start_product_interview"};a(C),C.step2AvaProfileId&&h(C.step2AvaProfileId),o==null||o(null),c({title:"Profile locked in",description:"MARGO will use this AVA profile for the next steps."})}catch(j){const k=(j==null?void 0:j.message)||"Unable to set AVA profile.";if(k.includes("current step is 3")||k.includes("Expected step 2")){const C={...t,step2AvaProfileId:t.step2AvaProfileId||w,step2Completed:!0,currentStep:3,nextAction:"start_product_interview"};a(C),c({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),o==null||o(null)}else o==null||o(k),c({title:"Submission failed",description:k,variant:"destructive"})}finally{x(!1)}};return!n&&!r&&!l&&!t.step2AvaProfileId?null:r?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:t.userName?`Great, ${t.userName}! Select the AVA profile that feels like the perfect match for this evaluation.`:"Great! You're ready for the next step. Select the AVA profile that feels like the perfect match for this evaluation.",chunkClassName:"text-sm",isChunk:!1})})}),w&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:`Let's use the ${((N=u.find(j=>j.id===w))==null?void 0:N.sessionName)||"selected profile"}.`,chunkClassName:"text-sm",isChunk:!1})})}),u.length>0&&s.jsx("div",{className:"ml-12 space-y-3 mb-4",children:s.jsx("div",{className:"grid gap-3",children:u.map(j=>{const k=(t.step2AvaProfileId||w)===j.id;return s.jsxs("div",{className:`text-left rounded-lg border p-4 ${k?"border-gray-400 bg-gray-50":"border-gray-200 bg-white opacity-60"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-base font-semibold text-gray-900",children:j.sessionName||j.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Created ",new Date(j.createdAt).toLocaleDateString(),"  ",j.userName||"Unnamed"]})]}),s.jsx("div",{className:`h-4 w-4 rounded-full border ${k?"border-gray-600 bg-gray-600":"border-gray-300"}`})]}),j.currentPhase&&s.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["Status: ",j.currentPhase.replace(/_/g," ")]})]},j.id)})})})]}):s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(Ge,{text:t.userName?`Great, ${t.userName}! Select the AVA profile that feels like the perfect match for this evaluation.`:"Great! You're ready for the next step. Select the AVA profile that feels like the perfect match for this evaluation.",chunkClassName:"text-sm",isChunk:!1}),(g||v)&&s.jsx(ts,{className:"text-gray-400"})]})}),w&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:`Let's use the ${((S=u.find(j=>j.id===w))==null?void 0:S.sessionName)||"selected profile"}.`,chunkClassName:"text-sm",isChunk:!1})})}),g&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx(Ge,{text:"Scanning your workspace for the strongest AVA matches",chunkClassName:"text-sm",isChunk:!1}),s.jsx(ts,{className:"text-gray-400"})]})]})})}),!g&&p&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content bg-red-50 border-red-200",children:s.jsx("p",{className:"text-sm text-red-600",children:p})})}),!g&&!p&&u.length===0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"No AVA profiles are available for this workspace yet. Create one in AVA Creator to continue."}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Once an AVA profile is available, you can connect it here to continue."})]})}),!g&&!p&&u.length>0&&s.jsxs("div",{className:"ml-12 space-y-3 mb-4",children:[s.jsx("div",{className:"grid gap-3",children:u.map(j=>{const k=w===j.id;return s.jsxs("button",{type:"button",onClick:()=>h(j.id),className:`text-left rounded-lg border p-4 transition-all ${k?"border-gray-400 bg-gray-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-base font-semibold text-gray-900",children:j.sessionName||j.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Created ",new Date(j.createdAt).toLocaleDateString(),"  ",j.userName||"Unnamed"]})]}),s.jsx("div",{className:`h-4 w-4 rounded-full border ${k?"border-gray-600 bg-gray-600":"border-gray-300"}`})]}),j.currentPhase&&s.jsxs("p",{className:"mt-2 text-xs text-gray-500",children:["Status: ",j.currentPhase.replace(/_/g," ")]})]},j.id)})}),s.jsx("div",{className:"flex flex-col items-center gap-3 sm:flex-row sm:justify-center",children:s.jsx(Ie,{type:"button",disabled:u.length===0||!w||v,onClick:b,className:"margo-soft-button w-full",children:v?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving selection..."]}):"Confirm profile"})}),s.jsx("span",{className:"text-sm text-gray-500",children:"MARGO will reference this AVA profile for messaging, objections, and emotional insights."})]})]})};var Lu="Collapsible",[w4,mj]=Qn(Lu),[b4,Gh]=w4(Lu),fj=i.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:a,disabled:o,onOpenChange:l,...c}=e,[u,d]=Hr({prop:r,defaultProp:a??!1,onChange:l,caller:Lu});return s.jsx(b4,{scope:n,disabled:o,contentId:Sn(),open:u,onOpenToggle:i.useCallback(()=>d(g=>!g),[d]),children:s.jsx(kt.div,{"data-state":Yh(u),"data-disabled":o?"":void 0,...c,ref:t})})});fj.displayName=Lu;var hj="CollapsibleTrigger",pj=i.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,a=Gh(hj,n);return s.jsx(kt.button,{type:"button","aria-controls":a.contentId,"aria-expanded":a.open||!1,"data-state":Yh(a.open),"data-disabled":a.disabled?"":void 0,disabled:a.disabled,...r,ref:t,onClick:ot(e.onClick,a.onOpenToggle)})});pj.displayName=hj;var qh="CollapsibleContent",gj=i.forwardRef((e,t)=>{const{forceMount:n,...r}=e,a=Gh(qh,e.__scopeCollapsible);return s.jsx(gr,{present:n||a.open,children:({present:o})=>s.jsx(N4,{...r,ref:t,present:o})})});gj.displayName=qh;var N4=i.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:a,...o}=e,l=Gh(qh,n),[c,u]=i.useState(r),d=i.useRef(null),g=_t(t,d),m=i.useRef(0),p=m.current,f=i.useRef(0),w=f.current,h=l.open||c,v=i.useRef(h),x=i.useRef(void 0);return i.useEffect(()=>{const y=requestAnimationFrame(()=>v.current=!1);return()=>cancelAnimationFrame(y)},[]),ks(()=>{const y=d.current;if(y){x.current=x.current||{transitionDuration:y.style.transitionDuration,animationName:y.style.animationName},y.style.transitionDuration="0s",y.style.animationName="none";const b=y.getBoundingClientRect();m.current=b.height,f.current=b.width,v.current||(y.style.transitionDuration=x.current.transitionDuration,y.style.animationName=x.current.animationName),u(r)}},[l.open,r]),s.jsx(kt.div,{"data-state":Yh(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!h,...o,ref:g,style:{"--radix-collapsible-content-height":p?`${p}px`:void 0,"--radix-collapsible-content-width":w?`${w}px`:void 0,...e.style},children:h&&a})});function Yh(e){return e?"open":"closed"}var j4=fj,S4=pj,k4=gj,Rn="Accordion",P4=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Jh,A4,C4]=pu(Rn),[Vu]=Qn(Rn,[C4,mj]),Kh=mj(),xj=_e.forwardRef((e,t)=>{const{type:n,...r}=e,a=r,o=r;return s.jsx(Jh.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?s.jsx(R4,{...o,ref:t}):s.jsx(T4,{...a,ref:t})})});xj.displayName=Rn;var[vj,E4]=Vu(Rn),[yj,I4]=Vu(Rn,{collapsible:!1}),T4=_e.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},collapsible:o=!1,...l}=e,[c,u]=Hr({prop:n,defaultProp:r??"",onChange:a,caller:Rn});return s.jsx(vj,{scope:e.__scopeAccordion,value:_e.useMemo(()=>c?[c]:[],[c]),onItemOpen:u,onItemClose:_e.useCallback(()=>o&&u(""),[o,u]),children:s.jsx(yj,{scope:e.__scopeAccordion,collapsible:o,children:s.jsx(wj,{...l,ref:t})})})}),R4=_e.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:a=()=>{},...o}=e,[l,c]=Hr({prop:n,defaultProp:r??[],onChange:a,caller:Rn}),u=_e.useCallback(g=>c((m=[])=>[...m,g]),[c]),d=_e.useCallback(g=>c((m=[])=>m.filter(p=>p!==g)),[c]);return s.jsx(vj,{scope:e.__scopeAccordion,value:l,onItemOpen:u,onItemClose:d,children:s.jsx(yj,{scope:e.__scopeAccordion,collapsible:!0,children:s.jsx(wj,{...o,ref:t})})})}),[M4,Bu]=Vu(Rn),wj=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:a,orientation:o="vertical",...l}=e,c=_e.useRef(null),u=_t(c,t),d=A4(n),m=gu(a)==="ltr",p=ot(e.onKeyDown,f=>{var C;if(!P4.includes(f.key))return;const w=f.target,h=d().filter(W=>{var B;return!((B=W.ref.current)!=null&&B.disabled)}),v=h.findIndex(W=>W.ref.current===w),x=h.length;if(v===-1)return;f.preventDefault();let y=v;const b=0,N=x-1,S=()=>{y=v+1,y>N&&(y=b)},j=()=>{y=v-1,y<b&&(y=N)};switch(f.key){case"Home":y=b;break;case"End":y=N;break;case"ArrowRight":o==="horizontal"&&(m?S():j());break;case"ArrowDown":o==="vertical"&&S();break;case"ArrowLeft":o==="horizontal"&&(m?j():S());break;case"ArrowUp":o==="vertical"&&j();break}const k=y%x;(C=h[k].ref.current)==null||C.focus()});return s.jsx(M4,{scope:n,disabled:r,direction:a,orientation:o,children:s.jsx(Jh.Slot,{scope:n,children:s.jsx(kt.div,{...l,"data-orientation":o,ref:u,onKeyDown:r?void 0:p})})})}),Bc="AccordionItem",[$4,Xh]=Vu(Bc),bj=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...a}=e,o=Bu(Bc,n),l=E4(Bc,n),c=Kh(n),u=Sn(),d=r&&l.value.includes(r)||!1,g=o.disabled||e.disabled;return s.jsx($4,{scope:n,open:d,disabled:g,triggerId:u,children:s.jsx(j4,{"data-orientation":o.orientation,"data-state":Aj(d),...c,...a,ref:t,disabled:g,open:d,onOpenChange:m=>{m?l.onItemOpen(r):l.onItemClose(r)}})})});bj.displayName=Bc;var Nj="AccordionHeader",jj=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Bu(Rn,n),o=Xh(Nj,n);return s.jsx(kt.h3,{"data-orientation":a.orientation,"data-state":Aj(o.open),"data-disabled":o.disabled?"":void 0,...r,ref:t})});jj.displayName=Nj;var mf="AccordionTrigger",Sj=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Bu(Rn,n),o=Xh(mf,n),l=I4(mf,n),c=Kh(n);return s.jsx(Jh.ItemSlot,{scope:n,children:s.jsx(S4,{"aria-disabled":o.open&&!l.collapsible||void 0,"data-orientation":a.orientation,id:o.triggerId,...c,...r,ref:t})})});Sj.displayName=mf;var kj="AccordionContent",Pj=_e.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,a=Bu(Rn,n),o=Xh(kj,n),l=Kh(n);return s.jsx(k4,{role:"region","aria-labelledby":o.triggerId,"data-orientation":a.orientation,...l,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});Pj.displayName=kj;function Aj(e){return e?"open":"closed"}var D4=xj,O4=bj,F4=jj,Cj=Sj,Ej=Pj;const Ij=D4,Zh=i.forwardRef(({className:e,...t},n)=>s.jsx(O4,{ref:n,className:it("border-b border-border last:border-b-0",e),...t}));Zh.displayName="AccordionItem";const ep=i.forwardRef(({className:e,children:t,...n},r)=>s.jsx(F4,{className:"flex",children:s.jsxs(Cj,{ref:r,className:it("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline",e),...n,children:[t,s.jsx(Gs,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));ep.displayName=Cj.displayName;const tp=i.forwardRef(({className:e,children:t,...n},r)=>s.jsx(Ej,{ref:r,className:it("overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",e),...n,children:s.jsx("div",{className:"pt-0 pb-4",children:t})}));tp.displayName=Ej.displayName;const Fa=9,gx=e=>e?e.replace(/\r\n/g,`
`).split(`
`).map(t=>t.trim()).filter(Boolean).join(`
`):"",_4=e=>{let t=e.replace(/^\s*/,"").trim();return t=t.replace(/^(\s*)?Question\s+\d+\s+of\s+\d+\s*/i,"").trim(),t},L4=e=>e?`margo-step3-${e}`:null,V4=({session:e,isActive:t,isCompleted:n=!1,onSessionChange:r,onComplete:a,onError:o,onInputHandlersReady:l})=>{const{toast:c}=yt(),[u,d]=i.useState([]),[g,m]=i.useState(!1),[p,f]=i.useState(null),[w,h]=i.useState(1),[v,x]=i.useState(!1),[y,b]=i.useState(""),N=i.useRef(null),[S,j]=i.useState(new Set),k=i.useRef(new Set),[C,W]=i.useState(new Set),[B,U]=i.useState(new Set),Q=i.useRef(new Map),V=i.useRef(!1),P=i.useRef(t),K=i.useRef(n);i.useEffect(()=>{k.current=S},[S]),i.useEffect(()=>{P.current=t},[t]),i.useEffect(()=>{K.current=n},[n]);const G=e.id,q=i.useMemo(()=>L4(G),[G]);i.useEffect(()=>{if(!G)return;if(!t&&!n){if(q)try{localStorage.removeItem(q)}catch(le){console.warn("Failed to clear Step 3 persistence",le)}V.current=!1;return}if(V.current&&u.length>0&&n)return;let M=!1,T=null;const ie=(()=>{if(!q)return null;try{const le=localStorage.getItem(q);if(!le)return null;const oe=JSON.parse(le);return!oe||!Array.isArray(oe.questions)?null:(T=oe,new Map(oe.questions.map(z=>[z.questionNumber,z])))}catch(le){return console.warn("Failed to restore Step 3 state",le),null}})();return(async()=>{var le;m(!0),f(null),d([]),h(1);try{const oe=[];let z=null;for(let ee=1;ee<=Fa;ee+=1)try{const ne=await a4(G,ee),me=(ne==null?void 0:ne.data)??null,ve=((le=me==null?void 0:me.question)==null?void 0:le.questionText)||(me==null?void 0:me.questionText)||(me==null?void 0:me.prompt)||`Question ${ee}`,D=(me==null?void 0:me.exampleAnswer)||(me==null?void 0:me.example)||"",ue=(me==null?void 0:me.answer)||(me==null?void 0:me.userAnswer)||"",O=!!(ue&&ue.trim().length>0),H=ie==null?void 0:ie.get(ee),ae=H!=null&&H.answer&&H.answer.trim().length>0?H.answer:ue||(H==null?void 0:H.answer)||"",de=(H==null?void 0:H.hasSubmitted)!==void 0?H.hasSubmitted:O||!!(ae&&ae.trim().length>0),re=(H==null?void 0:H.feedbackMessage)??null,fe=(H==null?void 0:H.expanded)??!1;!de&&z===null&&(z=ee),console.log("data....",ne),oe.push({questionNumber:ee,prompt:ve,exampleAnswer:D,deeperExample:(me==null?void 0:me.deeperExample)||null,answer:ae,isLoading:!1,isSubmitting:!1,hasSubmitted:de,error:null,expanded:fe,feedbackMessage:re}),o==null||o(null)}catch(ne){const me=(ne==null?void 0:ne.message)||"",ve=me.includes("Expected step")||me.includes("current step");!n&&!ve&&(console.error(`Failed to load Step 3 question ${ee}`,ne),o==null||o(me||"Unable to load Step 3 question"));const D=ie==null?void 0:ie.get(ee);console.log("persisted....",D);const ue=!!(D!=null&&D.answer&&D.answer.trim().length>0),O=!!(D!=null&&D.hasSubmitted);!O&&!ue&&z===null&&(z=ee),oe.push({questionNumber:ee,prompt:(D==null?void 0:D.prompt)||`Question ${ee}`,exampleAnswer:"",deeperExample:null,answer:(D==null?void 0:D.answer)??"",isLoading:!1,isSubmitting:!1,hasSubmitted:O,error:n||ve?null:me||"Unable to load question",expanded:!!(D!=null&&D.expanded),feedbackMessage:(D==null?void 0:D.feedbackMessage)??null})}if(!M){const ee=T!=null&&T.activeQuestionNumber&&T.activeQuestionNumber>0?T.activeQuestionNumber:z??Fa;if(d(oe),h(ee),V.current=!0,!n&&oe.length>0){const ne=new Set,me=new Set,ve=new Set;oe.forEach(D=>{const ue=D.questionNumber,O=D.hasSubmitted||D.answer&&D.answer.trim().length>0;(ue===ee||D.hasSubmitted)&&(ne.add(ue),O&&(me.add(ue),D.hasSubmitted&&ve.add(ue)))}),j(ne),W(me),U(ve)}else if(n&&oe.length>0){const ne=oe.map(ve=>ve.questionNumber);j(new Set(ne)),W(new Set(ne));const me=oe.filter(ve=>ve.hasSubmitted).map(ve=>ve.questionNumber);U(new Set(me))}}}catch(oe){if(!M){const z=(oe==null?void 0:oe.message)||"Unable to load Step 3 questions.";f(z),c({title:"Unable to load Step 3 questions",description:z,variant:"destructive"})}}finally{M||m(!1)}})(),()=>{M=!0}},[G,t,n,c,q]),i.useEffect(()=>{if(q&&!(!t&&!n)&&u.length!==0)try{const M={activeQuestionNumber:w,questions:u.map(T=>({questionNumber:T.questionNumber,answer:T.answer,hasSubmitted:T.hasSubmitted,feedbackMessage:T.feedbackMessage??null,expanded:T.expanded,prompt:T.prompt}))};localStorage.setItem(q,JSON.stringify(M))}catch(M){console.warn("Failed to persist Step 3 state",M)}},[q,t,n,u,w]);const A=i.useMemo(()=>u.length===Fa&&u.every(M=>M.hasSubmitted),[u]);i.useEffect(()=>{A&&!v&&e&&a&&(x(!0),a(e))},[A,v,a,e]),i.useEffect(()=>{A||x(!1)},[A]);const E=(M,T)=>{d(ie=>ie.map(Z=>Z.questionNumber===M?T(Z):Z))};i.useEffect(()=>{if(!t||n)return;const M=u.find(T=>T.questionNumber===w);if(b(M?M.answer:""),t&&!n&&w&&S.has(w)){const T=M&&(M.hasSubmitted||M.answer&&M.answer.trim().length>0),ie=C.has(w);T&&ie&&setTimeout(()=>{const Z=Q.current.get(w);Z&&P.current&&!K.current&&Z.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)}},[w,u,t,n,S,C]),i.useEffect(()=>{t&&!n&&N.current&&N.current.focus()},[w,t,n]),i.useEffect(()=>{if(n&&u.length>0){const oe=u.map(ee=>ee.questionNumber);if(!oe.every(ee=>S.has(ee))){j(new Set(oe)),W(new Set(oe));const ee=u.filter(ne=>ne.hasSubmitted).map(ne=>ne.questionNumber);U(new Set(ee))}return}if(u.length===0)return;const M=[],T=[],ie=[],Z=k.current,le=[];if(u.forEach(oe=>{const z=oe.questionNumber,ee=z===w||oe.hasSubmitted,ne=oe.hasSubmitted||oe.answer&&oe.answer.trim().length>0;if(ee&&!Z.has(z))if(le.push(z),ne)T.push(z),oe.hasSubmitted&&ie.push(z);else{const ve=setTimeout(()=>{j(D=>D.has(z)?D:new Set([...D,z]))},z===w?0:200);M.push(ve)}}),le.length>0){const oe=le.filter(z=>{const ee=u.find(ne=>ne.questionNumber===z);return ee&&(ee.hasSubmitted||ee.answer&&ee.answer.trim().length>0)});oe.length>0&&j(z=>{const ee=new Set(z);return oe.forEach(ne=>ee.add(ne)),ee})}return T.length>0&&W(oe=>{const z=new Set(oe);return T.forEach(ee=>z.add(ee)),z}),ie.length>0&&U(oe=>{const z=new Set(oe);return ie.forEach(ee=>z.add(ee)),z}),()=>{M.forEach(oe=>clearTimeout(oe))}},[u,w,n]),i.useEffect(()=>{if(n||!t)return;const M=[];return u.forEach(T=>{const ie=T.questionNumber;if(T.hasSubmitted&&C.has(ie)&&!B.has(ie)){const Z=setTimeout(()=>{U(le=>new Set([...le,ie])),setTimeout(()=>{const le=Q.current.get(ie);le&&P.current&&!K.current&&le.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)},200);M.push(Z)}}),()=>{M.forEach(T=>clearTimeout(T))}},[u,C,B,n,t]);const R=M=>{b(M),w&&E(w,T=>({...T,answer:M}))},L=async M=>{var le;const T=w;if(n){c({title:"Step 3 completed",description:"This step is already completed. You cannot modify answers.",variant:"default"});return}if(!u.find(oe=>oe.questionNumber===T))return;const Z=y.trim();if(!Z.trim()){E(T,oe=>({...oe,error:"Please provide an answer before submitting."})),c({title:"Answer required",description:"Please add your response to continue.",variant:"destructive"});return}E(T,oe=>({...oe,isSubmitting:!0,error:null}));try{const oe=await o4(G,{questionNumber:T,answer:Z.trim()}),z=(oe==null?void 0:oe.data)??null,ee={...e,currentStep:z!=null&&z.isStepComplete?Math.max(e.currentStep??4,4):Math.max(e.currentStep??3,3),nextAction:z!=null&&z.isStepComplete?"prepare_step4":e.nextAction||"continue_product_interview"};r(ee);const ne=u.map(ve=>ve.questionNumber===T?{...ve,isSubmitting:!1,hasSubmitted:!0,error:null,feedbackMessage:(z==null?void 0:z.feedbackMessage)||ve.feedbackMessage,answer:Z.trim()}:ve);let me=null;if(z!=null&&z.nextQuestion)me=z.nextQuestion;else{const ve=(le=ne.find(D=>!D.hasSubmitted&&D.questionNumber>T))==null?void 0:le.questionNumber;ve?me=ve:T===Fa&&(me=T)}if(d(ne),S.has(T)?(W(ve=>new Set([...ve,T])),setTimeout(()=>{U(ve=>new Set([...ve,T])),setTimeout(()=>{const ve=Q.current.get(T);ve&&P.current&&!K.current&&ve.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)},300)):(j(ve=>new Set([...ve,T])),setTimeout(()=>{W(ve=>new Set([...ve,T])),setTimeout(()=>{U(ve=>new Set([...ve,T])),setTimeout(()=>{const ve=Q.current.get(T);ve&&P.current&&!K.current&&ve.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},100)},200)},100)),q)try{const ve={activeQuestionNumber:me??w,questions:ne.map(D=>({questionNumber:D.questionNumber,answer:D.answer,hasSubmitted:D.hasSubmitted,feedbackMessage:D.feedbackMessage??null,expanded:D.expanded,prompt:D.prompt}))};localStorage.setItem(q,JSON.stringify(ve))}catch(ve){console.warn("Failed to immediately persist Step 3 state",ve)}me!==null&&h(me),b(""),o==null||o(null),c({title:`Question ${T} saved`,description:(z==null?void 0:z.feedbackMessage)||"Your response has been captured."})}catch(oe){const z=(oe==null?void 0:oe.message)||"Unable to save your answer.";z.includes("current step is 4")||z.includes("Expected step 3")?(r({...e,currentStep:4,nextAction:"prepare_step4"}),c({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),E(T,ee=>({...ee,isSubmitting:!1,error:null})),o==null||o(null)):(E(T,ee=>({...ee,isSubmitting:!1,error:z})),o==null||o(z),c({title:"Submission failed",description:z,variant:"destructive"}))}},I=M=>{const T=M.match(/"([\s\S]*?)"/);if(T&&T[1])return T[1];const ie=M.replace(/^ Example Answer (for guidance):\s*/i,""),Z=ie.replace(/\s+/g," ").trim();return Z.length>0?Z:ie.trim()},_=M=>{const T=u.find(le=>le.questionNumber===M);if(!T||!T.exampleAnswer)return;const Z=I(gx(T.exampleAnswer))||T.exampleAnswer;E(M,le=>({...le,answer:Z,error:null})),M===w&&b(Z),c({title:"Example copied",description:"Feel free to personalize it before saving."})},$=u.find(M=>M.questionNumber===w),F=($==null?void 0:$.isSubmitting)??!1;return i.useEffect(()=>{l&&(t&&!n&&!g&&!p&&u.length>0?l({inputValue:y,onInputChange:R,onInputSubmit:()=>L(),isSubmitting:F,placeholder:$?`Answer question ${w} of ${Fa}...`:"Type your answer..."}):l(null))},[t,n,g,p,u.length,y,F,w,$,l]),s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(Ge,{text:"Let's capture the heart of your offer. Answer each prompt and I'll guide you with examples and deeper insights.",chunkClassName:"text-sm",isChunk:!1}),(g||u.some(M=>M.isLoading))&&s.jsx(ts,{className:"text-gray-400"})]})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:"Ready! I'll work through each question one at a time.",chunkClassName:"text-sm",isChunk:!1})})}),g&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx(Ge,{text:"Gathering your interview prompts and calibrating examples",chunkClassName:"text-sm",isChunk:!1}),s.jsx(ts,{className:"text-gray-400"})]})]})})}),!g&&p&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content bg-red-50 border-red-200",children:s.jsx("p",{className:"text-sm text-red-600",children:p})})}),!g&&!p&&s.jsx("div",{className:"space-y-6",children:u.map(M=>{const T=M.questionNumber===w,ie=M.hasSubmitted;if(n?!1:!T&&!ie)return null;const le=n||S.has(M.questionNumber),oe=M.hasSubmitted||M.answer&&M.answer.trim().length>0,z=C.has(M.questionNumber),ne=!n&&!z&&le&&!oe&&!z,me=n||M.hasSubmitted&&B.has(M.questionNumber);return s.jsxs("div",{ref:ve=>{ve?Q.current.set(M.questionNumber,ve):Q.current.delete(M.questionNumber)},className:"space-y-4 scroll-mt-32",children:[le&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${le?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",M.questionNumber," of ",Fa]}),s.jsx(Ge,{text:_4(M.prompt),chunkClassName:"text-base text-gray-900",animation:"typewriter",isChunk:!(n||z||oe),staggerMs:30,minChunkLength:100,onComplete:()=>{W(ve=>new Set([...ve,M.questionNumber])),T&&P.current&&!K.current&&setTimeout(()=>{const ve=Q.current.get(M.questionNumber);ve&&P.current&&!K.current&&ve.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},200)}}),ne&&s.jsx(ts,{className:"text-gray-400 pb-20"}),M.hasSubmitted&&(oe||C.has(M.questionNumber))&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})}),me&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--user transition-opacity duration-300 ${me?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:M.answer})})}),!n&&T&&M.exampleAnswer&&z&&s.jsx("div",{className:"ml-12 pb-20",children:s.jsx(Ij,{type:"single",collapsible:!0,children:s.jsxs(Zh,{value:`example-${M.questionNumber}`,className:"border border-gray-200 rounded-lg bg-gray-50",children:[s.jsxs(ep,{className:"flex items-center gap-2 px-4 py-3 text-sm font-medium text-gray-700 transition",children:[s.jsx(pr,{className:"h-4 w-4 flex-shrink-0 text-gray-600"}),s.jsx("span",{className:"flex-1 text-left",children:"Example Inspiration"}),M.exampleAnswer&&s.jsx("button",{type:"button",onClick:ve=>{ve.stopPropagation(),_(M.questionNumber)},className:"rounded px-2 py-1 text-xs font-medium text-gray-600 transition hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-300",children:"Use this example"})]}),s.jsx(tp,{className:"border-t border-gray-200 bg-white px-4 py-4 text-sm text-gray-700",children:s.jsx("div",{className:"flex flex-col gap-3",children:s.jsx("p",{className:"whitespace-pre-line leading-relaxed",children:gx(M.exampleAnswer)||"No example provided for this prompt."})})})]})})}),M.error&&T&&s.jsx("div",{className:"ml-12 mb-4",children:s.jsx("p",{className:"text-sm text-red-600",children:M.error})})]},M.questionNumber)})})]})};function B4(e,t=[]){let n=[];function r(o,l){const c=i.createContext(l);c.displayName=o+"Context";const u=n.length;n=[...n,l];const d=m=>{var x;const{scope:p,children:f,...w}=m,h=((x=p==null?void 0:p[e])==null?void 0:x[u])||c,v=i.useMemo(()=>w,Object.values(w));return s.jsx(h.Provider,{value:v,children:f})};d.displayName=o+"Provider";function g(m,p){var h;const f=((h=p==null?void 0:p[e])==null?void 0:h[u])||c,w=i.useContext(f);if(w)return w;if(l!==void 0)return l;throw new Error(`\`${m}\` must be used within \`${o}\``)}return[d,g]}const a=()=>{const o=n.map(l=>i.createContext(l));return function(c){const u=(c==null?void 0:c[e])||o;return i.useMemo(()=>({[`__scope${e}`]:{...c,[e]:u}}),[c,u])}};return a.scopeName=e,[r,W4(a,...t)]}function W4(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(a=>({useScope:a(),scopeName:a.scopeName}));return function(o){const l=r.reduce((c,{useScope:u,scopeName:d})=>{const m=u(o)[`__scope${d}`];return{...c,...m}},{});return i.useMemo(()=>({[`__scope${t.scopeName}`]:l}),[l])}};return n.scopeName=t.scopeName,n}var U4=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Tj=U4.reduce((e,t)=>{const n=dh(`Primitive.${t}`),r=i.forwardRef((a,o)=>{const{asChild:l,...c}=a,u=l?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(u,{...c,ref:o})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),sp="Progress",np=100,[z4]=B4(sp),[H4,Q4]=z4(sp),Rj=i.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:a,getValueLabel:o=G4,...l}=e;(a||a===0)&&!xx(a)&&console.error(q4(`${a}`,"Progress"));const c=xx(a)?a:np;r!==null&&!vx(r,c)&&console.error(Y4(`${r}`,"Progress"));const u=vx(r,c)?r:null,d=Wc(u)?o(u,c):void 0;return s.jsx(H4,{scope:n,value:u,max:c,children:s.jsx(Tj.div,{"aria-valuemax":c,"aria-valuemin":0,"aria-valuenow":Wc(u)?u:void 0,"aria-valuetext":d,role:"progressbar","data-state":Dj(u,c),"data-value":u??void 0,"data-max":c,...l,ref:t})})});Rj.displayName=sp;var Mj="ProgressIndicator",$j=i.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,a=Q4(Mj,n);return s.jsx(Tj.div,{"data-state":Dj(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...r,ref:t})});$j.displayName=Mj;function G4(e,t){return`${Math.round(e/t*100)}%`}function Dj(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Wc(e){return typeof e=="number"}function xx(e){return Wc(e)&&!isNaN(e)&&e>0}function vx(e,t){return Wc(e)&&!isNaN(e)&&e<=t&&e>=0}function q4(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${np}\`.`}function Y4(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${np} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Oj=Rj,J4=$j;const Fj=i.forwardRef(({className:e,value:t,...n},r)=>s.jsx(Oj,{ref:r,className:it("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:s.jsx(J4,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Fj.displayName=Oj.displayName;const yx=[{label:"Excellent",range:"85  100%",description:"High resonance. Your offer strongly aligns with the AVA profile across all scoring criteria.",color:"text-emerald-600"},{label:"Good",range:"70  84%",description:"Solid fit. Minor improvements could elevate the message and emotional pull.",color:"text-vox-orange"},{label:"Moderate",range:"50  69%",description:"Some alignment. Target specific weaknesses to boost product relevancy.",color:"text-amber-600"},{label:"Weak",range:"0  49%",description:"Limited resonance. Revisit positioning and core value drivers for this profile.",color:"text-red-600"}],K4=e=>{if(!e)return null;const n=/(https?:\/\/[^\s]+)/g.exec(e);return n?n[0]:null},X4=e=>{if(!e)return null;const t=/(?:vimeo\.com|player\.vimeo\.com\/video)\/(\d+)(?:\/([a-f0-9]+))?/i,n=e.match(t);return n?{videoId:n[1],hash:n[2]||void 0}:null},Z4=(e,t)=>{const n=`https://player.vimeo.com/video/${e}`;return t?`${n}?h=${t}`:n},e5=({session:e,isActive:t,isCompleted:n=!1,onSessionChange:r,onContinue:a,onError:o})=>{var de;const{toast:l}=yt(),[c,u]=i.useState(null),[d,g]=i.useState(!1),[m,p]=i.useState(!1),[f,w]=i.useState(!1),[h,v]=i.useState(null),[x,y]=i.useState(null),[b,N]=i.useState(null),[S,j]=i.useState(!1),[k,C]=i.useState("I've watched the video"),[W,B]=i.useState(null),[U,Q]=i.useState([]),[V,P]=i.useState({}),[K,G]=i.useState(!1),[q,A]=i.useState(!1),[E,R]=i.useState(!1),[L,I]=i.useState(!1),[_,$]=i.useState(!1),[F,M]=i.useState(!1),[T,ie]=i.useState(!1),[Z,le]=i.useState(!1),[oe,z]=i.useState(!1),ee=e.id,ne=i.useMemo(()=>ee?`margo-step4-${ee}`:null,[ee]);i.useEffect(()=>{if(!ne||typeof window>"u"){K||G(!0);return}if(!K)try{const re=window.localStorage.getItem(ne);if(re){const fe=JSON.parse(re);p(!!fe.hasRequested),v(fe.instructionMessage??null),y(fe.instructionAction??null),N(fe.instructionVideoUrl??null),u(fe.assessment??null),B(fe.videoAcknowledgementMessage??null),Q(Array.isArray(fe.videoScores)?fe.videoScores:[]),P(fe.videoSummary??{}),w(!!fe.videoReady),C(fe.watchMessage??"I've watched the video"),(fe.hasRequested||fe.assessment||fe.instructionMessage)&&(R(!0),I(!0),fe.instructionMessage&&($(!0),M(!0)),fe.videoAcknowledgementMessage&&(ie(!0),le(!0)),fe.assessment&&z(!0))}}catch(re){console.error("Failed to hydrate Step 4 state:",re);try{window.localStorage.removeItem(ne)}catch(fe){console.error("Failed to clear corrupted Step 4 state:",fe)}}finally{G(!0)}},[ne,K]),i.useEffect(()=>{if(n||m||c){R(!0),I(!0);return}if(!K||!t)return;const re=setTimeout(()=>{R(!0)},300);return()=>clearTimeout(re)},[K,t,n,m,c]),i.useEffect(()=>{if(n){h&&($(!0),M(!0));return}if(!h||!K)return;if(m&&h)$(!0),M(!0);else{const fe=setTimeout(()=>{$(!0)},200);return()=>clearTimeout(fe)}},[h,K,n,m]),i.useEffect(()=>{if(n){W&&(ie(!0),le(!0));return}if(!W||!K)return;if(m&&W)ie(!0),le(!0);else if(F){const fe=setTimeout(()=>{ie(!0)},300);return()=>clearTimeout(fe)}},[W,K,n,m,F]),i.useEffect(()=>{if(n){c&&z(!0);return}if(!c||!K)return;if(m&&c)z(!0);else{const fe=W?Z?300:0:300;if(fe===0&&!W){const Se=setTimeout(()=>{z(!0)},300);return()=>clearTimeout(Se)}else if(Z||!W){const Se=setTimeout(()=>{z(!0)},fe);return()=>clearTimeout(Se)}}},[c,K,n,m,W,Z]),i.useEffect(()=>{if(!ne||typeof window>"u"||!K)return;const re={hasRequested:m,instructionMessage:h,instructionAction:x,instructionVideoUrl:b,assessment:c,videoAcknowledgementMessage:W,videoScores:U,videoSummary:V,videoReady:f,watchMessage:k};try{window.localStorage.setItem(ne,JSON.stringify(re))}catch(fe){console.error("Failed to persist Step 4 state:",fe)}},[ne,K,m,h,x,b,c,W,U,V,f,k]);const me=async()=>{if(ee)try{g(!0),u(null),v(null),y(null),N(null),B(null),Q([]),P({});const re=await i4(ee,{message:"yes"}),fe=(re==null?void 0:re.data)??{},Se=(fe==null?void 0:fe.assessment)??null,he=(fe==null?void 0:fe.nextAction)??e.nextAction??"",se=(fe==null?void 0:fe.message)??(re==null?void 0:re.message)??"",J=(fe==null?void 0:fe.videoUrl)??null;r({...e,currentStep:Math.max(e.currentStep??3,4),nextAction:he||e.nextAction||"step4_ready"}),Se?(u(Se),v(null),y(null),N(Se.videoUrl??null),setTimeout(()=>{z(!0)},300),o==null||o(null)):(v(se||"Please confirm once you've watched the video to proceed."),y(he||null),N(J??K4(se)),C("I've watched the video"),setTimeout(()=>{$(!0)},300),o==null||o(null)),p(!0)}catch(re){const fe=(re==null?void 0:re.message)||"Unable to generate relevancy assessment.";fe.includes("current step is 5")||fe.includes("Expected step 4")?(r({...e,currentStep:5,nextAction:"step5_ready"}),l({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),o==null||o(null)):(l({title:"Assessment failed",description:fe,variant:"destructive"}),o==null||o(fe))}finally{g(!1)}},ve=i.useMemo(()=>(c==null?void 0:c.percentage)??0,[c==null?void 0:c.percentage]),D=i.useMemo(()=>(c==null?void 0:c.band)??"",[c==null?void 0:c.band]),ue=i.useMemo(()=>D?yx.find(re=>re.label.toLowerCase()===D.toLowerCase())??null:null,[D]),O=async()=>{if(ee)try{j(!0);const re=k.trim()||"I've watched the video",fe=await l4(ee,{message:re}),Se=(fe==null?void 0:fe.data)??{},he=(Se==null?void 0:Se.assessment)??null,se=(Se==null?void 0:Se.message)??(fe==null?void 0:fe.message)??(Se==null?void 0:Se.acknowledgement)??(fe==null?void 0:fe.acknowledgement)??null,J=Array.isArray(Se==null?void 0:Se.scores)?Se.scores:[],Pe=typeof(Se==null?void 0:Se.totalScore)=="number"?Se.totalScore:typeof(he==null?void 0:he.totalScore)=="number"?he.totalScore:void 0,$e=typeof(Se==null?void 0:Se.percentage)=="number"?Se.percentage:typeof(he==null?void 0:he.percentage)=="number"?he.percentage:Pe,Ae=(Se==null?void 0:Se.interpretation)??(he==null?void 0:he.band)??(typeof(Se==null?void 0:Se.band)=="string"?Se.band:void 0),Ee=he??(J.length?{totalScore:Pe??0,percentage:$e??0,band:Ae??"Moderate",criteriaScores:J.map((we,Te)=>({criteria:we.criteriaName??`Criteria ${we.criteriaId??Te+1}`,score:we.score,reasoning:we.reasoning})),videoUrl:(Se==null?void 0:Se.videoUrl)??null}:null);r({...e,currentStep:Math.max(e.currentStep??3,4),nextAction:(Se==null?void 0:Se.nextAction)||"prepare_step4"});const ce=Ee??c;u(ce),y(null),B(se||null),Q(J),P({totalScore:Pe??(Ee==null?void 0:Ee.totalScore)??(Ee==null?void 0:Ee.percentage)??void 0,interpretation:Ae??null}),C("I've watched the video"),se&&setTimeout(()=>{ie(!0)},200),ce&&setTimeout(()=>{z(!0)},se?500:300),l({title:"Great! Generating your score now.",description:"Here's how your product resonates with this AVA profile."}),o==null||o(null)}catch(re){const fe=(re==null?void 0:re.message)||"Unable to continue with scoring. Please try again.";fe.includes("current step is 5")||fe.includes("Expected step 4")?(r({...e,currentStep:5,nextAction:"step5_ready"}),l({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),u(null),o==null||o(null)):(l({title:"Action required",description:fe,variant:"destructive"}),o==null||o(fe))}finally{j(!1)}},H=m||c||h,ae=E&&!H&&!L;return s.jsxs("div",{className:"space-y-4",children:[!m&&E&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${E?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[H||n?s.jsx("p",{className:"text-sm",children:"Ready to see how your offer scores? I'll analyze your responses and compute the full relevancy model."}):s.jsx(Ge,{text:"Ready to see how your offer scores? I'll analyze your responses and compute the full relevancy model.",chunkClassName:"text-sm",animation:"typewriter",isChunk:!0,minChunkLength:60,staggerMs:30,onComplete:()=>{I(!0)}}),ae&&s.jsx(ts,{className:"text-gray-400"}),d&&s.jsx(ts,{className:"text-gray-400"})]})}),!m&&L&&s.jsxs("div",{className:"ml-4 ",children:[s.jsx("div",{className:"space-y-3 mb-4 flex flex-col",children:s.jsx(Ie,{type:"button",onClick:me,disabled:d,className:"margo-soft-button w-full",children:d?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Preparing assessment"]}):"Ready"})}),s.jsx("p",{className:"text-xs text-gray-500",children:"This takes a moment while I evaluate all ten scoring criteria."})]}),d&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx(Ge,{text:"Crunching every signal from your interview responses",chunkClassName:"text-sm",animation:"typewriter",isChunk:!1,minChunkLength:50,staggerMs:200}),s.jsx(ts,{className:"text-gray-400"})]})]})})}),h&&_&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${_?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(gs,{text:h,chunkClassName:"text-sm",animation:"typewriter",isChunk:!!(h&&x==="watch_video_step4"&&!c&&F),staggerMs:30,minChunkLength:100,onComplete:()=>{A(!0),M(!0)}}),!F&&!n&&s.jsx(ts,{className:"text-gray-400"})]})}),h&&b&&F&&q&&s.jsx("div",{className:"ml-4 mb-4",children:(()=>{const re=X4(b);if(re){const fe=Z4(re.videoId,re.hash);return s.jsx("div",{className:"w-[85%] rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:s.jsx("div",{className:"relative",style:{paddingBottom:"56.25%"},children:s.jsx("iframe",{src:fe,className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"Vimeo video player"})})})}return s.jsxs("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"margo-soft-button margo-soft-button--outline inline-flex items-center gap-2",children:[s.jsx(Wi,{className:"h-4 w-4"}),"Watch explainer video"]})})()}),h&&x==="watch_video_step4"&&!c&&F&&q&&s.jsx("div",{className:"ml-4 space-y-3 mb-4 flex flex-col items-center",children:s.jsx(Ie,{type:"button",onClick:O,disabled:S,className:"margo-soft-button w-full",children:S?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Notifying MARGO"]}):"Confirm I watched the video"})}),W&&T&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${T?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[n||Z?s.jsx("p",{className:"text-sm",children:W}):s.jsx(Ge,{text:W,chunkClassName:"text-sm",animation:"typewriter",isChunk:!(n||Z),minChunkLength:60,staggerMs:30,onComplete:()=>{le(!0)}}),!Z&&!n&&s.jsx(ts,{className:"text-gray-400"})]})}),U.length>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Assessment Summary"}),typeof V.totalScore=="number"&&s.jsxs("p",{className:"mt-1 text-lg font-semibold text-gray-900",children:["Total Score: ",V.totalScore]})]}),V.interpretation&&s.jsx("p",{className:"max-w-md text-sm text-gray-600 sm:text-right",children:V.interpretation})]}),s.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"grid grid-cols-12 gap-0 border-b border-gray-200 bg-gray-50 px-4 py-3 text-xs font-medium text-gray-600",children:[s.jsx("div",{className:"col-span-4",children:"Criteria"}),s.jsx("div",{className:"col-span-2 text-center",children:"Score"}),s.jsx("div",{className:"col-span-6",children:"Reasoning"})]}),s.jsx("div",{className:"divide-y divide-gray-100 text-sm text-gray-700",children:U.map(re=>s.jsxs("div",{className:"grid grid-cols-12 gap-0 px-4 py-3",children:[s.jsx("div",{className:"col-span-4 text-gray-900",children:re.criteriaName}),s.jsx("div",{className:"col-span-2 text-center text-gray-900",children:re.score}),s.jsx("div",{className:"col-span-6 leading-6",children:re.reasoning})]},re.criteriaId))})]})]})})}),(c==null?void 0:c.videoUrl)&&!f&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Wi,{className:"h-5 w-5 text-gray-600"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Playing your assessment overview"})]}),s.jsx("video",{className:"h-0 w-full",src:c.videoUrl,autoPlay:!0,muted:!0,onEnded:()=>w(!0),onCanPlay:()=>w(!0)})]})}),c&&oe&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${oe?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-end sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Total Relevance"}),s.jsxs("p",{className:"mt-1 text-3xl font-bold text-gray-900",children:[ve.toFixed(0),"%"]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Based on weighted scoring across positioning, emotional pull, message clarity, and value delivery."})]}),s.jsxs("div",{className:"flex min-w-[160px] flex-col gap-2 rounded-lg border border-gray-200 bg-gray-50 p-3 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx(_w,{className:"h-4 w-4 text-gray-600"}),"Interpretation"]}),s.jsx("div",{className:`text-base font-semibold ${(ue==null?void 0:ue.color)??"text-gray-900"}`,children:((ue==null?void 0:ue.label)??D)||"Pending"}),s.jsx("p",{className:"text-xs text-gray-600",children:(ue==null?void 0:ue.description)??"Your assessment will appear once scoring completes."})]})]}),s.jsx(Fj,{value:ve,className:"h-2 rounded-full border border-gray-200 bg-gray-100"})]})})}),s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${oe?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"grid grid-cols-12 gap-0 border-b border-gray-200 bg-gray-50 px-4 py-3 text-xs font-medium text-gray-600",children:[s.jsx("div",{className:"col-span-6",children:"Criteria"}),s.jsx("div",{className:"col-span-2 text-center",children:"Score"}),s.jsx("div",{className:"col-span-4",children:"Reasoning"})]}),s.jsx("div",{className:"divide-y divide-gray-100 text-sm text-gray-700",children:(de=c.criteriaScores)==null?void 0:de.map(re=>s.jsxs("div",{className:"grid grid-cols-12 gap-0 px-4 py-3",children:[s.jsx("div",{className:"col-span-6 text-gray-900",children:re.criteria}),s.jsx("div",{className:"col-span-2 text-center text-gray-900",children:re.score.toFixed(1)}),s.jsx("div",{className:"col-span-4 leading-6",children:re.reasoning})]},re.criteria))})]})})}),s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${oe?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Relevancy Bands"}),s.jsx("div",{className:"grid gap-3 sm:grid-cols-2",children:yx.map(re=>s.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:`text-sm font-semibold ${re.color}`,children:re.label}),s.jsx("span",{className:"text-xs font-semibold text-gray-500",children:re.range})]}),s.jsx("p",{className:"mt-2 text-xs text-gray-600",children:re.description})]},re.label))})]})})}),!n&&s.jsxs("div",{className:"ml-4",children:[s.jsx("div",{className:"space-y-3 mb-4 flex flex-col items-center",children:s.jsx(Ie,{type:"button",disabled:!c||d||n,onClick:a,className:"margo-soft-button w-full",children:"Continue to Step 5"})}),s.jsx("p",{className:"text-xs text-gray-500",children:"MARGO uses internal weighting to balance strategic positioning, emotional resonance, and offer clarity for this AVA profile."})]})]})]})},t5=e=>{if(!e)return null;const t=/(?:vimeo\.com|player\.vimeo\.com\/video)\/(\d+)(?:\/([a-f0-9]+))?/i,n=e.match(t);return n?{videoId:n[1],hash:n[2]||void 0}:null},s5=(e,t)=>{const n=`https://player.vimeo.com/video/${e}`;return t?`${n}?h=${t}`:n},Ed=e=>e?e.replace(/```[\s\S]*?```/g,t=>t.replace(/```/g,"")).replace(/`([^`]*)`/g,"$1").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/~~(.*?)~~/g,"$1").replace(/^#{1,6}\s+/gm,"").replace(/^\s*>+\s?/gm,"").replace(/!\[[^\]]*\]\((.*?)\)/g,"$1").replace(/\[([^\]]+)\]\((.*?)\)/g,"$1").replace(/\r/g,"").replace(/\n{3,}/g,`

`).trim():"",n5=e=>{if(!e)return{cleanedMessage:null,videoUrl:null};const t=/(https?:\/\/[^\s]+)/g;let n=null;return{cleanedMessage:e.split(`
`).map(a=>{if(t.test(a)){t.lastIndex=0;const o=t.exec(a);return o&&!n&&(n=o[0]),a.replace(t,"").trim()}return a}).filter((a,o,l)=>{if(!a.trim()){const c=l[o-1];return c&&c.trim()}return!0}).join(`
`).replace(/\n{3,}/g,`

`).trim()||null,videoUrl:n}},r5=({session:e,isActive:t,isCompleted:n=!1,onSessionChange:r,onContinue:a,onError:o})=>{var H;const{toast:l}=yt(),[c,u]=i.useState(!1),[d,g]=i.useState(!1),[m,p]=i.useState(!1),[f,w]=i.useState(null),[h,v]=i.useState(null),[x,y]=i.useState(!1),[b,N]=i.useState(null),[S,j]=i.useState([]),[k,C]=i.useState(null),[W,B]=i.useState(null),[U,Q]=i.useState(!1),[V,P]=i.useState(!1),[K,G]=i.useState(!1),[q,A]=i.useState(!1),[E,R]=i.useState(!1),[L,I]=i.useState(!1),[_,$]=i.useState(!1),[F,M]=i.useState(!1),[T,ie]=i.useState(!1),[Z,le]=i.useState(!1),[oe,z]=i.useState(!1),ee=e.id,ne=i.useMemo(()=>ee?`margo-step5-${ee}`:null,[ee]);i.useEffect(()=>{var ae;if(!ne||typeof window>"u"){V||P(!0);return}if(!V)try{const de=window.localStorage.getItem(ne);if(de){const re=JSON.parse(de);Q(!!re.hasRequested),w(re.instructionMessage??null),v(re.instructionVideoUrl??null),N(re.videoAcknowledgementMessage??null),j(Array.isArray(re.tableRecommendations)?re.tableRecommendations:[]),C(re.transitionMessage??null),B(re.readyResponseMessage??null),g(!!re.hasGenerated),(re.hasRequested||re.instructionMessage||(ae=re.tableRecommendations)!=null&&ae.length)&&(R(!0),I(!0),re.instructionMessage&&($(!0),M(!0)),re.videoAcknowledgementMessage&&(ie(!0),le(!0)),re.transitionMessage&&z(!0))}}catch(de){console.error("Failed to hydrate Step 5 state:",de);try{window.localStorage.removeItem(ne)}catch(re){console.error("Failed to clear corrupted Step 5 state:",re)}}finally{P(!0)}},[ne,V]),i.useEffect(()=>{if(n||U||f){R(!0),I(!0);return}if(!V||!t)return;const ae=setTimeout(()=>{R(!0)},300);return()=>clearTimeout(ae)},[V,t,n,U,f]),i.useEffect(()=>{if(n){f&&($(!0),M(!0));return}if(!f||!V)return;if(U&&f)$(!0),M(!0);else{const de=setTimeout(()=>{$(!0)},200);return()=>clearTimeout(de)}},[f,V,n,U]),i.useEffect(()=>{if(n){b&&(ie(!0),le(!0));return}if(!b||!V)return;if(U&&b)ie(!0),le(!0);else if(F){const de=setTimeout(()=>{ie(!0)},300);return()=>clearTimeout(de)}},[b,V,n,U,F]),i.useEffect(()=>{if(n){k&&z(!0);return}if(!k||!V)return;if(U&&k)z(!0);else{const de=b?Z?300:0:300;if(de===0&&!b){const re=setTimeout(()=>{z(!0)},300);return()=>clearTimeout(re)}else if(Z||!b){const re=setTimeout(()=>{z(!0)},de);return()=>clearTimeout(re)}}},[k,V,n,U,b,Z]),i.useEffect(()=>{if(!ne||typeof window>"u"||!V)return;const ae={hasRequested:U,instructionMessage:f,instructionVideoUrl:h,videoAcknowledgementMessage:b,tableRecommendations:S,transitionMessage:k,readyResponseMessage:W,hasGenerated:d};try{window.localStorage.setItem(ne,JSON.stringify(ae))}catch(de){console.error("Failed to persist Step 5 state:",de)}},[ne,V,U,f,h,b,S,k,W,d]);const me=async()=>{if(ee)try{u(!0),Q(!0);const ae=await c4(ee,{message:"yes"}),de=(ae==null?void 0:ae.data)??{},re=Array.isArray(de==null?void 0:de.recommendations)?de==null?void 0:de.recommendations:[],fe=(de==null?void 0:de.nextAction)??e.nextAction??"",Se=(de==null?void 0:de.message)??"",{cleanedMessage:he,videoUrl:se}=n5(Se);r({...e,currentStep:Math.max(e.currentStep??4,5),nextAction:fe||"step5_recommendations"}),w(he?Ed(he):null),v(se),N(null),j([]),C(null),y(!1),B(Se||null),he&&setTimeout(()=>{$(!0)},300),o==null||o(null),!re.length&&!Se&&l({title:"No adjustments needed",description:Se||"All criteria scored above the enhancement threshold."}),g(re.length>0)}catch(ae){const de=(ae==null?void 0:ae.message)||"Unable to generate improvement recommendations.";de.includes("current step is 6")||de.includes("Expected step 5")?(r({...e,currentStep:6,nextAction:"step6_ready"}),l({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),o==null||o(null)):(l({title:"Recommendation generation failed",description:de,variant:"destructive"}),o==null||o(de),Q(!1))}finally{u(!1)}},ve=async()=>{if(ee)try{y(!0);const ae=await u4(ee,{message:"I've watched the video"});if(ae!=null&&ae.data){const de=(ae==null?void 0:ae.data)??{},re=(de==null?void 0:de.message)??(ae==null?void 0:ae.message)??null,fe=(de==null?void 0:de.recommendations)??[],Se=(de==null?void 0:de.transitionMessage)??null;r({...e,currentStep:Math.max(e.currentStep??4,5),nextAction:(de==null?void 0:de.nextAction)||"view_recommendations"}),N(re?Ed(re):null),j(fe),C(Se?Ed(Se):null),g(fe.length>0),re&&setTimeout(()=>{ie(!0)},200),Se&&setTimeout(()=>{z(!0)},re?500:300),o==null||o(null)}}catch(ae){const de=(ae==null?void 0:ae.message)||"Unable to acknowledge the video at this time.";de.includes("current step is 6")||de.includes("Expected step 5")?(r({...e,currentStep:6,nextAction:"step6_ready"}),l({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),j([]),o==null||o(null)):(l({title:"Action required",description:de,variant:"destructive"}),o==null||o(de))}finally{y(!1)}},D=async()=>{if(!ee||n)return;p(!0),r({...e,currentStep:Math.max(e.currentStep??5,6),nextAction:"step6_ready"}),a==null||a(),p(!1)},ue=U||f,O=E&&!ue&&!L;return s.jsxs("div",{className:"space-y-4",children:[!U&&E&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${E?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(Ge,{text:"Want tailored recommendations for improvement? I'll surface the precise levers to tighten before you go to market.",chunkClassName:"text-sm",animation:"typewriter",isChunk:!(ue||n),minChunkLength:60,staggerMs:30,onComplete:()=>{I(!0)}}),O&&s.jsx(ts,{className:"text-gray-400"}),c&&s.jsx(ts,{className:"text-gray-400"})]})}),!U&&L&&s.jsx("div",{className:"ml-4 mb-4 flex flex-col items-center",children:s.jsx(Ie,{type:"button",onClick:me,disabled:c,className:"margo-soft-button w-full",children:c?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Scanning for opportunities"]}):"Ready"})}),c&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("span",{children:"Reviewing the scoring layers to pinpoint your sharpest optimization moves"}),s.jsx(ts,{className:"text-gray-400"})]})]})})}),f&&_&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${_?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(gs,{text:f,chunkClassName:"text-sm",animation:"typewriter",isChunk:!!(f&&!S.length),staggerMs:30,minChunkLength:100,onComplete:()=>{G(!0),M(!0)}}),!F&&!n&&s.jsx(ts,{className:"text-gray-400"})]})}),f&&h&&K&&s.jsx("div",{className:"ml-4 mb-4",children:(()=>{const ae=t5(h);if(ae){const de=s5(ae.videoId,ae.hash);return s.jsx("div",{className:"w-[85%] rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:s.jsx("div",{className:"relative",style:{paddingBottom:"56.25%"},children:s.jsx("iframe",{src:de,className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"Vimeo video player"})})})}return s.jsxs(Ie,{type:"button",onClick:()=>window.open(h,"_blank","noopener"),variant:"outline",className:"margo-soft-button margo-soft-button--outline inline-flex items-center gap-2",children:[s.jsx(Wi,{className:"h-4 w-4"}),"Watch explainer video"]})})()}),f&&!S.length&&K&&!n&&e.currentStep<6&&!((H=e.nextAction)!=null&&H.startsWith("step6"))&&s.jsxs("div",{className:"ml-4",children:[s.jsx("p",{className:"text-xs text-gray-500",children:"Confirm once you've watched the explainer so I can generate your improvement table."}),s.jsx("div",{className:"space-y-3 mb-4 mt-4 flex flex-col items-center",children:s.jsx(Ie,{type:"button",onClick:ve,disabled:x,className:"margo-soft-button w-full",children:x?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirming"]}):"I've watched the video"})})]}),b&&T&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${T?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[n||Z?s.jsx("p",{className:"text-sm",children:b}):s.jsx(Ge,{text:b,chunkClassName:"text-sm",animation:"typewriter",isChunk:!0,minChunkLength:60,staggerMs:30,onComplete:()=>{le(!0)}}),!Z&&!n&&s.jsx(ts,{className:"text-gray-400"})]})}),S.length>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Improvement Recommendations"}),s.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"grid grid-cols-12 gap-6 border-b border-gray-200 bg-gray-50 px-4 py-3 text-xs font-medium text-gray-600",children:[s.jsx("div",{className:"col-span-4",children:"Negative Factor"}),s.jsx("div",{className:"col-span-4",children:"Suggested Enhancement"}),s.jsx("div",{className:"col-span-4",children:"Key Considerations"})]}),s.jsx("div",{className:"divide-y divide-gray-100 text-sm text-gray-700",children:S.map((ae,de)=>s.jsxs("div",{className:"grid grid-cols-12 gap-6 px-4 py-3",children:[s.jsx("div",{className:"col-span-4 leading-6 text-gray-900",children:ae.negativeFactor}),s.jsx("div",{className:"col-span-4 leading-6 text-gray-900",children:ae.suggestedEnhancement}),s.jsx("div",{className:"col-span-4 leading-6",children:ae.keyConsiderations})]},`${ae.negativeFactor}-${de}`))})]})]})})}),k&&oe&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${oe?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:k,chunkClassName:"text-sm",animation:"typewriter",isChunk:!n,minChunkLength:70,staggerMs:30,onComplete:()=>{A(!0)}})})}),k&&!n&&q&&s.jsx("div",{className:"ml-4 mb-4 flex flex-col items-center",children:s.jsx(Ie,{type:"button",onClick:D,disabled:m||n,className:"margo-soft-button w-full",children:m?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Locking in Step 6"]}):"Yes, I'm ready to move on"})}),d&&S.length===0&&!c&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"All clear!"}),s.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Every scoring criteria landed above our improvement threshold. You're ready to move forward without any changes."})]})})]})},wx=e=>{if(!e)return null;const t=/(?:vimeo\.com|player\.vimeo\.com\/video)\/(\d+)(?:\/([a-f0-9]+))?/i,n=e.match(t);return n?{videoId:n[1],hash:n[2]||void 0}:null},bx=(e,t)=>{const n=`https://player.vimeo.com/video/${e}`;return t?`${n}?h=${t}`:n},Nx=e=>{if(!e)return{cleanedMessage:null,videoUrl:null};const t=/(https?:\/\/[^\s]+)/g;let n=null;return{cleanedMessage:e.split(`
`).map(a=>{if(t.test(a)){t.lastIndex=0;const o=t.exec(a);return o&&!n&&(n=o[0]),a.replace(t,"").trim()}return a}).filter((a,o,l)=>{if(!a.trim()){const c=l[o-1];return c&&c.trim()}return!0}).join(`
`).replace(/\n{3,}/g,`

`).trim()||null,videoUrl:n}},Ml=e=>e?e.replace(/```[\s\S]*?```/g,t=>t.replace(/```/g,"")).replace(/`([^`]*)`/g,"$1").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/~~(.*?)~~/g,"$1").replace(/^#{1,6}\s+/gm,"").replace(/^\s*>+\s?/gm,"").replace(/!\[[^\]]*\]\((.*?)\)/g,"$1").replace(/\[([^\]]+)\]\((.*?)\)/g,"$1").replace(/\r/g,"").replace(/\n{3,}/g,`

`).trim():"",a5=e=>[...e].sort((t,n)=>(t.rank??0)-(n.rank??0)).map((t,n)=>({rank:n+1,vehicleBelief:t.vehicleBelief,internalBelief:t.internalBelief,externalBelief:t.externalBelief,includeBonus:n<5})),o5=({session:e,isActive:t,isCompleted:n=!1,onSessionChange:r,onContinue:a,onError:o})=>{const{toast:l}=yt(),{id:c}=e,[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(null),[w,h]=i.useState(null),[v,x]=i.useState(!1),[y,b]=i.useState(null),[N,S]=i.useState([]),[j,k]=i.useState(null),[C,W]=i.useState(null),[B,U]=i.useState([]),[Q,V]=i.useState(!1),[P,K]=i.useState(!1),[G,q]=i.useState(null),[A,E]=i.useState(null),[R,L]=i.useState(!1),[I,_]=i.useState(!1),[$,F]=i.useState(!1),[M,T]=i.useState(!1),[ie,Z]=i.useState(!1),[le,oe]=i.useState(!1),[z,ee]=i.useState(!1),[ne,me]=i.useState(!1),[ve,D]=i.useState(!1),[ue,O]=i.useState(!1),[H,ae]=i.useState(!1),[de,re]=i.useState(!1),[fe,Se]=i.useState(!1),[he,se]=i.useState(!1),[J,Pe]=i.useState(!1),[$e,Ae]=i.useState(!1),[Ee,ce]=i.useState(!1),[we,Te]=i.useState(!1),Ue=N.length>0,lt=B.length>0,Ze=i.useMemo(()=>c?`margo-step6-${c}`:null,[c]);i.useEffect(()=>{var te,X,ye;if(!Ze||typeof window>"u"){M||T(!0);return}if(!M)try{const Ne=window.localStorage.getItem(Ze);if(Ne){const Ce=JSON.parse(Ne);d(!!Ce.hasInitialized),f(Ce.instructionMessage??null),h(Ce.instructionVideoUrl??null),b(Ce.videoAcknowledgementMessage??null),S(Array.isArray(Ce.falseBeliefRows)?Ce.falseBeliefRows:[]),k(Ce.formattedOutput??null),W(Ce.bonusRequestMessage??null),U(Array.isArray(Ce.bonusSuggestions)?Ce.bonusSuggestions:[]),q(Ce.step7IntroMessage??null),E(Ce.step7IntroVideoUrl??null),_(!!Ce.hasStep6Completed),F(!!Ce.hasContinuedToStep7),(Ce.hasInitialized||Ce.instructionMessage||(te=Ce.falseBeliefRows)!=null&&te.length)&&(me(!0),D(!0),Ce.instructionMessage&&(O(!0),ae(!0)),Ce.videoAcknowledgementMessage&&(re(!0),Se(!0)),(X=Ce.falseBeliefRows)!=null&&X.length&&se(!0),Ce.bonusRequestMessage&&Pe(!0),(ye=Ce.bonusSuggestions)!=null&&ye.length&&Ae(!0),Ce.step7IntroMessage&&(ce(!0),Te(!0),oe(!0)))}}catch(Ne){console.error("Failed to hydrate Step 6 state:",Ne);try{window.localStorage.removeItem(Ze)}catch(Ce){console.error("Failed to clear corrupted Step 6 state:",Ce)}}finally{T(!0)}},[Ze,M]),i.useEffect(()=>{if(!Ze||typeof window>"u"||!M)return;const te={hasInitialized:u,instructionMessage:p,instructionVideoUrl:w,videoAcknowledgementMessage:y,falseBeliefRows:N,formattedOutput:j,bonusRequestMessage:C,bonusSuggestions:B,step7IntroMessage:G,step7IntroVideoUrl:A,hasStep6Completed:I,hasContinuedToStep7:$};try{window.localStorage.setItem(Ze,JSON.stringify(te))}catch(X){console.error("Failed to persist Step 6 state:",X)}console.log("step7IntroMessage.....",G)},[Ze,M,u,p,w,y,N,j,C,B,G,A,I,$]),i.useEffect(()=>{if(n||u||p){me(!0),D(!0);return}if(!M||!t)return;const te=setTimeout(()=>{me(!0)},300);return()=>clearTimeout(te)},[M,t,n,u,p]),i.useEffect(()=>{if(n){p&&(O(!0),ae(!0));return}if(!p||!M)return;if(u&&p)O(!0),ae(!0);else{const X=setTimeout(()=>{O(!0)},200);return()=>clearTimeout(X)}},[p,M,n,u]),i.useEffect(()=>{if(n){y&&(re(!0),Se(!0));return}if(!y||!M)return;if(u&&y)re(!0),Se(!0);else if(H){const X=setTimeout(()=>{re(!0)},300);return()=>clearTimeout(X)}},[y,M,n,u,H]),i.useEffect(()=>{if(n){Ue&&se(!0);return}if(!Ue||!M)return;if(u&&Ue)se(!0);else{const X=y?fe?300:0:300;if(X===0&&!y){const ye=setTimeout(()=>{se(!0)},300);return()=>clearTimeout(ye)}else if(fe||!y){const ye=setTimeout(()=>{se(!0)},X);return()=>clearTimeout(ye)}}},[Ue,M,n,u,y,fe]),i.useEffect(()=>{if(n){C&&Pe(!0);return}if(!C||!M)return;if(u&&C)Pe(!0);else if(he||!Ue){const X=setTimeout(()=>{Pe(!0)},300);return()=>clearTimeout(X)}},[C,M,n,u,he,Ue]),i.useEffect(()=>{if(n){lt&&Ae(!0);return}if(!lt||!M)return;if(u&&lt)Ae(!0);else if(J||!C){const X=setTimeout(()=>{Ae(!0)},300);return()=>clearTimeout(X)}},[lt,M,n,u,J,C]),i.useEffect(()=>{if(n){G&&ce(!0);return}if(!G||!M)return;if(u&&G)ce(!0);else{const X=lt?$e?300:0:J?300:0;if(X===0&&!lt&&!C){const ye=setTimeout(()=>{ce(!0)},300);return()=>clearTimeout(ye)}else if($e||J&&!lt){const ye=setTimeout(()=>{ce(!0)},X||300);return()=>clearTimeout(ye)}}},[G,M,n,u,$e,J,lt,C]);const ge=async()=>{if(c)try{m(!0);const te=await d4(c,{message:"yes"}),X=(te==null?void 0:te.data)??{},ye=(X==null?void 0:X.nextAction)??e.nextAction??"",Ne=(X==null?void 0:X.message)??"",{videoUrl:Ce}=Nx(Ne),Ve=Ml(Ne);r({...e,currentStep:Math.max(e.currentStep??5,6),nextAction:ye||"step6_ready"}),f(Ve||null),h(Ce),d(!0),Ve&&setTimeout(()=>{O(!0)},300),o==null||o(null)}catch(te){const X=(te==null?void 0:te.message)||"Unable to prepare Step 6.";X.includes("current step is 7")||X.includes("Expected step 6")?(r({...e,currentStep:7,nextAction:"step7_ready"}),l({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),o==null||o(null)):(console.error("Failed to start MARGO Step 6:",te),o==null||o(X))}finally{m(!1)}},pe=async()=>{if(c)try{x(!0);const te=await m4(c,{message:"I've watched the video"}),X=(te==null?void 0:te.data)??{},ye=(X==null?void 0:X.message)??null,Ne=Array.isArray(X==null?void 0:X.falseBeliefs)?X.falseBeliefs:[];r({...e,currentStep:Math.max(e.currentStep??5,6),nextAction:(X==null?void 0:X.nextAction)||"view_false_beliefs"}),b(ye?Ml(ye):null),S(a5(Ne)),k((X==null?void 0:X.formattedOutput)??null),W(X!=null&&X.bonusRequestMessage?Ml(X.bonusRequestMessage):null),U([]),q(null),ye&&setTimeout(()=>{re(!0)},200),Ne.length>0&&setTimeout(()=>{se(!0)},ye?500:300),X!=null&&X.bonusRequestMessage&&setTimeout(()=>{Pe(!0)},Ne.length>0?500:300),o==null||o(null)}catch(te){const X=(te==null?void 0:te.message)||"Unable to acknowledge the Step 6 video.";X.includes("current step is 7")||X.includes("Expected step 6")?(r({...e,currentStep:7,nextAction:"step7_ready"}),l({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),o==null||o(null)):(console.error("Failed to acknowledge Step 6 video:",te),o==null||o(X))}finally{x(!1)}},ke=async te=>{if(c)try{te?(V(!0),K(!1)):(K(!0),V(!1));const ye=await f4(c,{message:te?"yes":"no"}),Ne=(ye==null?void 0:ye.data)??{};r({...e,currentStep:Math.max(e.currentStep??5,6),nextAction:(Ne==null?void 0:Ne.nextAction)||"view_bonuses"}),U(Array.isArray(Ne==null?void 0:Ne.bonusSuggestions)?Ne.bonusSuggestions:[]),W(null);const Ce=Ne!=null&&Ne.step7IntroMessage?Ml(Ne.step7IntroMessage):null;if(Ce){const{cleanedMessage:Ve,videoUrl:tt}=Nx(Ce);q(Ve),E(tt)}else q(null),E(null);_(!0),Array.isArray(Ne==null?void 0:Ne.bonusSuggestions)&&Ne.bonusSuggestions.length>0&&setTimeout(()=>{Ae(!0)},300),Ne!=null&&Ne.step7IntroMessage&&setTimeout(()=>{ce(!0)},Array.isArray(Ne==null?void 0:Ne.bonusSuggestions)&&Ne.bonusSuggestions.length>0?500:300),o==null||o(null)}catch(X){const ye=(X==null?void 0:X.message)||"Unable to process the bonus request.";ye.includes("current step is 7")||ye.includes("Expected step 6")?(r({...e,currentStep:7,nextAction:"step7_ready"}),l({title:"Already completed",description:"This step has already been completed. Moving forward...",variant:"default"}),_(!0),o==null||o(null)):(console.error("Failed to process Step 6 bonus request:",X),o==null||o(ye))}finally{V(!1),K(!1)}},be=async()=>{if(!(!c||n||$))try{L(!0),F(!0),r({...e,currentStep:Math.max(e.currentStep??6,6)+1,nextAction:"step7_ready"}),a==null||a()}finally{L(!1)}},je=u||p!==null||Ue,Re=u||p,Y=ne&&!Re&&!ve;return s.jsxs("div",{className:"space-y-4",children:[!je&&ne&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${ne?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(Ge,{text:`Ready to tackle belief barriers? I'll map out the psychological objections preventing Clara from saying "yes."`,chunkClassName:"text-sm",animation:"typewriter",isChunk:!(Re||n),minChunkLength:60,staggerMs:30,onComplete:()=>{D(!0)}}),Y&&s.jsx(ts,{className:"text-gray-400"}),g&&s.jsx(ts,{className:"text-gray-400"})]})}),!je&&ve&&s.jsx("div",{className:"ml-4 mb-4 flex flex-col items-center",children:s.jsx(Ie,{type:"button",onClick:ge,disabled:g,className:"margo-soft-button w-full",children:g?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Preparing false beliefs"]}):"Yes"})}),p&&ue&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${ue?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(gs,{text:p,chunkClassName:"text-sm",animation:"typewriter",isChunk:!(Ue&&he),staggerMs:30,minChunkLength:100,onComplete:()=>{Z(!0),ae(!0)}}),!H&&!n&&s.jsx(ts,{className:"text-gray-400"})]})}),p&&w&&ie&&s.jsx("div",{className:"ml-4 mb-4",children:(()=>{const te=wx(w);if(te){const X=bx(te.videoId,te.hash);return s.jsx("div",{className:"w-[85%] rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:s.jsx("div",{className:"relative",style:{paddingBottom:"56.25%"},children:s.jsx("iframe",{src:X,className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"Vimeo video player"})})})}return s.jsxs(Ie,{type:"button",onClick:()=>window.open(w,"_blank","noopener"),variant:"outline",className:"margo-soft-button margo-soft-button--outline inline-flex items-center gap-2",children:[s.jsx(Wi,{className:"h-4 w-4"}),"Watch explainer video"]})})()}),p&&w&&ie&&!Ue&&!he&&s.jsx("div",{className:"ml-4 space-y-3 mb-4 flex flex-col items-center",children:s.jsx(Ie,{type:"button",onClick:pe,disabled:v,className:"margo-soft-button w-full",children:v?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Confirming"]}):"I've watched the video"})}),y&&de&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${de?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[n||fe?s.jsx("p",{className:"text-sm",children:y}):s.jsx(Ge,{text:y,chunkClassName:"text-sm",animation:"typewriter",isChunk:!0,minChunkLength:60,staggerMs:30,onComplete:()=>{Se(!0)}}),!fe&&!n&&s.jsx(ts,{className:"text-gray-400"})]})}),Ue&&he&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${he?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"False Beliefs Table"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Drag controls give you quick refinements before we lock the brief."})]}),s.jsxs("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:[s.jsxs("div",{className:"grid grid-cols-12 gap-0 border-b border-gray-200 bg-gray-50 px-4 py-3 text-xs font-medium text-gray-600",children:[s.jsx("div",{className:"col-span-1 text-center",children:"Rank"}),s.jsx("div",{className:"col-span-4",children:"Vehicle"}),s.jsx("div",{className:"col-span-4",children:"Internal"}),s.jsx("div",{className:"col-span-3",children:"External"})]}),s.jsx("div",{className:"divide-y divide-gray-100 text-sm text-gray-700",children:N.map(te=>s.jsxs("div",{className:"grid grid-cols-12 items-start gap-0 px-4 py-3",children:[s.jsx("div",{className:"col-span-1 flex items-center justify-center text-sm font-semibold text-gray-900",children:te.rank}),s.jsx("div",{className:"col-span-4 pr-3",children:s.jsx("div",{children:te.vehicleBelief})}),s.jsx("div",{className:"col-span-4 pr-3",children:s.jsx("div",{children:te.internalBelief})}),s.jsx("div",{className:"col-span-3 pr-3",children:s.jsx("div",{children:te.externalBelief})})]},`belief-row-${te.rank}-${te.vehicleBelief}`))})]})]})})}),C&&J&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${J?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:n?s.jsx("p",{className:"text-sm",children:C}):s.jsx(gs,{text:C,chunkClassName:"text-sm",animation:"typewriter",isChunk:!0,minChunkLength:70,staggerMs:30,onComplete:()=>{ee(!0)}})})}),C&&J&&z&&s.jsx("div",{className:"ml-4 space-y-3 mb-4",children:s.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[s.jsx(Ie,{type:"button",onClick:()=>ke(!0),disabled:Q||P,className:"margo-soft-button w-full",children:Q?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Crafting bonus ideas"]}):"Yes, suggest bonuses"}),s.jsx(Ie,{type:"button",variant:"outline",onClick:()=>ke(!1),disabled:Q||P,className:"margo-soft-button margo-soft-button--outline w-full",children:P?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing"]}):"I'll skip bonuses"})]})}),lt&&$e&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${$e?"opacity-100":"opacity-0"}`,children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Bonus ideas mapped to beliefs"}),s.jsx("div",{className:"space-y-3",children:B.map((te,X)=>s.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"False belief addressed"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-gray-900",children:te.falseBelief}),s.jsx("p",{className:"mt-3 text-xs font-medium text-gray-500",children:"Bonus title"}),s.jsx("p",{className:"text-sm font-semibold text-gray-900",children:te.title}),s.jsx("p",{className:"mt-3 text-xs font-medium text-gray-500",children:"Bonus description"}),s.jsx("p",{className:"text-sm leading-6 text-gray-600",children:te.description})]},`${te.falseBelief}-${X}`))})]})})}),G&&Ee&&s.jsx("div",{className:`margo-chat-bubble margo-chat-bubble--bot transition-opacity duration-500 ${Ee?"opacity-100":"opacity-0"}`,children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx(gs,{text:G,chunkClassName:"text-sm",animation:"typewriter",isChunk:!!(G&&I&&!$),minChunkLength:70,staggerMs:30,onComplete:()=>{oe(!0),Te(!0)}}),!we&&!n&&s.jsx(ts,{className:"text-gray-400"})]})}),G&&A&&(le||n||we)&&s.jsx("div",{className:"ml-4 mb-4",children:(()=>{const te=wx(A);if(te){const X=bx(te.videoId,te.hash);return s.jsx("div",{className:"w-[85%] rounded-lg overflow-hidden border border-gray-200 bg-gray-50",children:s.jsx("div",{className:"relative",style:{paddingBottom:"56.25%"},children:s.jsx("iframe",{src:X,className:"absolute top-0 left-0 w-full h-full",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,title:"Vimeo video player"})})})}return s.jsxs(Ie,{type:"button",onClick:()=>window.open(A,"_blank","noopener"),variant:"outline",className:"margo-soft-button margo-soft-button--outline inline-flex items-center gap-2",children:[s.jsx(Wi,{className:"h-4 w-4"}),"Watch explainer video"]})})()}),G&&I&&!$&&we&&s.jsx("div",{className:"ml-4 mb-4",children:s.jsx(Ie,{type:"button",onClick:be,disabled:R||n,className:"margo-soft-button w-full",children:R?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),'"Confirming"']}):"I've watched the video"})})]})},qs=9,i5=["First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth"],l5=(e,t,n)=>{const f=Math.max(32,Math.floor(84.92307692307692)),w=Math.floor((792-36*2)/14),h="    ",v=V=>{const P=V.trim();return/^=+$/.test(P)&&P.length>48?"=".repeat(48):V},x=(V,P=f)=>{const G=v(V).trim();if(!G)return[""];const q=G.split(/\s+/),A=[];let E="";return q.forEach(R=>{const L=E?`${E} ${R}`:R;if(L.length<=P)E=L;else if(E&&A.push(E),R.length>P){let I=R;for(;I.length>P;)A.push(I.slice(0,P)),I=I.slice(P);E=I}else E=R}),E&&A.push(E),A.length>0?A:[""]},y=(V,P,K=h)=>{P.split(/\n/).forEach(G=>{if(!G.trim()){V.push("");return}const q=Math.max(20,f-K.length);x(G,q).forEach(A=>{V.push(K+A)})})},b=t?vi(t):"",N=[];N.push(e.toUpperCase()),N.push(`${h}${new Date().toLocaleString()}`),N.push(""),b&&(y(N,b),N.push("")),n.forEach((V,P)=>{const K=(V.title||`Section ${P+1}`).toUpperCase(),G=vi(V.content||"");N.push(""),N.push(`${h}SECTION ${P+1}: ${K}`),N.push(""),y(N,G,h+"  ")}),N.length===0&&N.push(e);const S=V=>V.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)"),j=[];N.forEach(V=>{const P=j[j.length-1];(!P||P.length>=w)&&j.push([]),j[j.length-1].push(V)});const k=[],C=[];j.forEach((V,P)=>{const K=3+P*2,G=K+1;C.push(`${K} 0 R`);let q=`BT
/F1 12 Tf
1 0 0 1 20 756 Tm
`;V.forEach((A,E)=>{const R=S(A);E===0?R&&(q+=`(${R}) Tj
`):(q+=`0 -14 Td
`,R&&(q+=`(${R}) Tj
`))}),q+="ET",k.push(`${K} 0 obj
<< /Type /Page /Parent 2 0 R /MediaBox [0 0 612 792] /Contents ${G} 0 R /Resources << /Font << /F1 5 0 R >> >> /CropBox [20 0 572 792] >>
endobj`),k.push(`${G} 0 obj
<< /Length ${q.length} >>
stream
${q}
endstream
endobj`)});const W=3+j.length*2;k.unshift(`2 0 obj
<< /Type /Pages /Kids [${C.join(" ")}] /Count ${j.length} >>
endobj`),k.unshift(`1 0 obj
<< /Type /Catalog /Pages 2 0 R >>
endobj`),k.push(`${W} 0 obj
<< /Type /Font /Subtype /Type1 /BaseFont /Helvetica >>
endobj`);let B=`%PDF-1.4
`;const U=[`0000000000 65535 f 
`];k.forEach(V=>{const P=B.length;U.push(String(P).padStart(10,"0")+` 00000 n 
`),B+=V+`
`});const Q=B.length;return B+=`xref
0 ${k.length+1}
`,U.forEach(V=>{B+=V}),B+=`trailer
<< /Size ${k.length+1} /Root 1 0 R >>
startxref
${Q}
%%EOF`,new Blob([B],{type:"application/pdf"})},c5=({session:e,isActive:t,isCompleted:n=!1,onSessionChange:r,onComplete:a,state:o,onStateChange:l,onStartNew:c})=>{const[u,d]=i.useState(!1),[g,m]=i.useState(null),[p,f]=i.useState(!1),{toast:w}=yt(),{sections:h,generateAttempts:v,statusMessage:x,completionMessage:y,statusHistory:b,finalBriefText:N,finalSections:S,statusHistoryContent:j}=o;i.useEffect(()=>{t||(m(null),d(!1))},[t]),console.log("statusHistoryContent....",j);const k=async()=>{if(!(!(e!=null&&e.id)||u||v>=qs))try{d(!0),m(null);const V=await h4(e.id,{message:"generate"}),P=(V==null?void 0:V.data)??{},K=(P==null?void 0:P.section)??null,G=P==null?void 0:P.progress,q=P==null?void 0:P.message,A=P==null?void 0:P.content,E=(P==null?void 0:P.finalProductBrief)??(P==null?void 0:P.finalBrief)??null,R=Array.isArray(P==null?void 0:P.sections)?P==null?void 0:P.sections:null,L=!!(P!=null&&P.isComplete),I=(G==null?void 0:G.completed)!==void 0&&(G==null?void 0:G.total)!==void 0&&G.completed>=G.total,_=v+1,$=K?[...h,K]:h,F=(P==null?void 0:P.nextAction)||"step7_generating",M=(G==null?void 0:G.total)??qs,T=(G==null?void 0:G.completed)??$.length,ie=T>0&&T<M?`Section ${T}/${M} generated successfully! Continue to generate the next section.`:null,Z=q||ie,le=T>=M||$.length>=qs?`All ${M} sections have been generated. Your product brief is complete!`:null,oe=$.length>=qs,z=L&&oe||I&&oe||F==="step7_complete"&&oe||oe&&T>=M,ee=z?q||le||`MARGO brief profile completed. (${(G==null?void 0:G.completed)??M}/${M})`:void 0;l(ne=>{const me=Z?[...ne.statusHistory,Z].slice(-qs):ne.statusHistory,ve=A?[...ne.statusHistoryContent||[],A].slice(-qs):ne.statusHistoryContent||[];return{...ne,sections:$,generateAttempts:_,statusMessage:z?null:Z??ne.statusMessage,statusHistory:me,statusHistoryContent:ve,completionMessage:ee??ne.completionMessage,finalBriefText:E??ne.finalBriefText,finalSections:R??ne.finalSections}}),r({...e,currentStep:Math.max(e.currentStep??6,7),nextAction:F}),z&&C(R??$,ee??void 0)}catch(V){const P=(V==null?void 0:V.message)||"Unable to generate the next section. Please try again.";P.includes("current step is")&&P.includes("Expected step 7")?(r({...e,currentStep:7,nextAction:"step7_complete"}),w({title:"Already completed",description:"This step has already been completed.",variant:"default"}),m(null)):m(P)}finally{d(!1)}},C=(V,P)=>{const K=V??h;r({...e,currentStep:Math.max(e.currentStep??6,7),nextAction:"step7_complete"}),P&&l(G=>({...G,completionMessage:P})),a==null||a(K)},W=async()=>{if(!p){if(!(e!=null&&e.id)){w({title:"Download unavailable",description:"No MARGO session found.",variant:"destructive"});return}try{f(!0);try{const V=await Qh(e.id),P=window.URL.createObjectURL(V),K=document.createElement("a");K.href=P,K.download="Margo - Product Brief.pdf",document.body.appendChild(K),K.click(),document.body.removeChild(K),window.URL.revokeObjectURL(P),w({title:"Download started",description:"Your Product Positioning Brief PDF is downloading."});return}catch(V){console.warn("Backend PDF generation failed, falling back to client-side generation:",V);let P=N??null,K=S.length>0?S:h;try{const E=await p4(e.id);E!=null&&E.data&&(E.data.finalProductBrief&&(P=E.data.finalProductBrief),Array.isArray(E.data.sections)&&E.data.sections.length>0&&(K=E.data.sections))}catch(E){console.warn("Unable to fetch final product brief data; falling back to local state",E)}if(!P&&K.length===0){w({title:"Download unavailable",description:"Generate the brief first to download the PDF.",variant:"destructive"});return}const G=l5("Margo - Product Brief",P,K),q=window.URL.createObjectURL(G),A=document.createElement("a");A.href=q,A.download="Margo - Product Brief.pdf",document.body.appendChild(A),A.click(),document.body.removeChild(A),window.URL.revokeObjectURL(q),w({title:"Download started",description:"Your Product Positioning Brief PDF is downloading (client-side generation)."})}}catch(V){console.error("MARGO final brief download failed",V),w({title:"Download failed",description:(V==null?void 0:V.message)||"Unable to download the Product Positioning Brief.",variant:"destructive"})}finally{f(!1)}}},B=h.length,U=v<qs&&B<qs,Q=B===0?"Generate Product Positioning Brief":"Generate Product Positioning Brief again";return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:B===0?"Ready for the final synthesis? I'll craft each section of your Product Positioning Brief one at a time.":"Keep the momentum goingeach click stitches another section into your Product Positioning Brief.",chunkClassName:"text-sm",animation:"typewriter",isChunk:!1,minChunkLength:70,staggerMs:300})})}),x&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:x,chunkClassName:"text-sm",animation:"typewriter",isChunk:!1,minChunkLength:20,staggerMs:200},x)})}),(j&&j.length>0||b.length>0)&&s.jsx("div",{className:"space-y-2",children:Array.from({length:Math.max(b.length,(j==null?void 0:j.length)||0)}).map((V,P)=>{const K=b[P]||null,G=j&&j[P]?j[P]:null;return s.jsxs("div",{className:"space-y-2",children:[K&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("span",{className:"whitespace-pre-wrap leading-relaxed",children:K})})}),G&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:tc(G)})})]},`chat-row-${P}`)})}),U&&s.jsx("div",{className:"ml-4 mb-4",children:s.jsx(Ie,{type:"button",onClick:k,disabled:u,className:"margo-soft-button w-full",children:u?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating"]}):Q})}),B>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-xs font-medium text-gray-500",children:["Generated Sections (",B," / ",qs,")"]}),s.jsx("div",{className:"space-y-3",children:h.map((V,P)=>s.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:`Section ${P+1}`}),s.jsx("p",{className:"text-sm font-semibold text-gray-900 mt-1",children:`${i5[P]??`Brief ${P+1}`} Product Positioning Brief generated`}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Progress ",P+1,"/",qs]}),s.jsx("h3",{className:"text-base font-semibold text-gray-900 mt-2",children:V.title||`Section ${P+1}`}),s.jsx(fs,{value:vi(V.content),onChange:K=>l(G=>{const q=G.sections.map((A,E)=>E===P?{...A,content:K.target.value}:A);return{...G,sections:q}}),className:"mt-3 min-h-[120px] rounded border-gray-300 bg-white text-sm"})]},V.id||`section-${P}`))})]})})}),(j.length===qs||y)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Zs,{className:"h-4 w-4 text-gray-600 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Journey Complete"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mt-1",children:"Product Positioning Brief ready"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:y||`All ${qs} sections have been generated. Your product brief is complete!`})]})]}),N&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Executive Summary"}),s.jsx("div",{className:"rounded-lg border border-gray-200 bg-gray-50 p-4 text-sm leading-relaxed text-gray-700 whitespace-pre-wrap",children:vi(N)})]}),(S.length>0||B>=qs&&h.length>0)&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Brief Sections"}),s.jsx("div",{className:"grid gap-3",children:(S.length>0?S:h).map((V,P)=>s.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white p-4",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500",children:V.title||`Section ${P+1}`}),s.jsx("pre",{className:"mt-2 whitespace-pre-wrap text-sm leading-relaxed text-gray-700",children:vi(V.content)})]},V.id||`final-section-${P}`))})]}),s.jsxs("div",{className:"flex flex-col gap-3 pt-4 border-t border-gray-200 sm:flex-row sm:items-center sm:justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Archived in this workspace and ready to share with Amplifier collaborators."}),s.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[s.jsx(Ie,{type:"button",onClick:W,disabled:p,variant:"outline",className:"margo-soft-button margo-soft-button--outline",children:p?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Preparing PDF"]}):"Download PDF"}),c&&s.jsx(Ie,{type:"button",onClick:c,className:"margo-soft-button",children:"Start a new MARGO"})]})]})]})})}),g&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content bg-red-50 border-red-200",children:s.jsx("p",{className:"text-sm text-red-600",children:g})})})]})},u5=({open:e,onOpenChange:t,workspaceName:n,onConfirm:r})=>{const a=()=>{r(),t(!1)};return s.jsx(Gi,{open:e,onOpenChange:t,children:s.jsxs(yo,{className:"fixed top-24 left-1/2 transform -translate-x-1/2 z-[70] max-h-[calc(100vh-120px)] overflow-y-auto",children:[s.jsxs(wo,{children:[s.jsx(No,{children:"Reset MARGO Progress"}),s.jsxs(jo,{children:["Are you sure you want to reset your MARGO progress in ",s.jsxs("strong",{children:['"',n,'"']}),"?",s.jsx("br",{}),s.jsx("br",{}),"This will clear all your current progress and start over from Step 1. This action cannot be undone."]})]}),s.jsxs(bo,{children:[s.jsx(ko,{children:"Cancel"}),s.jsx(So,{onClick:a,children:"Reset Progress"})]})]})})},d5=e=>e?e.replace(/```[\s\S]*?```/g,t=>t.replace(/```/g,"")).replace(/`([^`]*)`/g,"$1").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/_(.*?)_/g,"$1").replace(/~~(.*?)~~/g,"$1").replace(/^#{1,6}\s+/gm,"").replace(/^\s*>+\s?/gm,"").replace(/!\[[^\]]*\]\((.*?)\)/g,"$1").replace(/\[([^\]]+)\]\((.*?)\)/g,"$1").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/\r/g,"").replace(/\n{3,}/g,`

`).trim():"",m5="margo-state",f5=["margo-step3-","margo-step4-","margo-step5-","margo-step6-"],Id=e=>`${m5}-${e}`,na=()=>({sections:[],generateAttempts:0,statusMessage:null,completionMessage:null,finalBriefText:null,finalSections:[],statusHistory:[],statusHistoryContent:[]}),h5=()=>{var H,ae,de,re,fe,Se,he;const{currentWorkspace:e,isLoading:t}=ls(),{toast:n}=yt(),[r,a]=i.useState(null),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState([]),[m,p]=i.useState(!1),[f,w]=i.useState(!0),[h,v]=i.useState(na()),[x,y]=i.useState(null),[b,N]=i.useState(null),[S,j]=i.useState(!1),k=i.useRef(null),C=i.useRef(null),W=i.useRef(null),B=i.useRef(null),U=(e==null?void 0:e.id)??null;i.useEffect(()=>{if(t)return;if(typeof window>"u"){w(!1);return}if(!U){l(!0),a(null),g([]),v(na()),u(null),W.current=null,w(!1);return}if(l(!1),u(null),W.current===U){w(!1);return}w(!0);const se=Id(U);try{const J=localStorage.getItem(se);if(J){const Pe=JSON.parse(J);a((Pe==null?void 0:Pe.session)??null),g(Array.isArray(Pe==null?void 0:Pe.finalBriefSections)?Pe.finalBriefSections:[]),v(Pe!=null&&Pe.step7State?{...na(),...Pe.step7State}:na())}else a(null),g([]),v(na())}catch(J){console.error("Failed to restore MARGO state from storage:",J),a(null),g([]),v(na())}finally{W.current=U,w(!1)}},[U,t]),i.useEffect(()=>{if(f||!U||typeof window>"u")return;const se=Id(U);if(!r){try{localStorage.removeItem(se)}catch(Pe){console.error("Failed to clear persisted MARGO state:",Pe)}return}const J={session:r,finalBriefSections:d,step7State:h,lastUpdated:new Date().toISOString()};try{localStorage.setItem(se,JSON.stringify(J))}catch(Pe){console.error("Failed to persist MARGO state:",Pe)}},[r,d,h,U,f]);const Q=i.useCallback(se=>{if(!(typeof window>"u"))try{const J=[];for(let Pe=0;Pe<window.localStorage.length;Pe+=1){const $e=window.localStorage.key(Pe);if(!(!$e||!f5.some(Ee=>$e.startsWith(Ee))))if(se){const Ee=`-${se}`;$e.endsWith(Ee)&&J.push($e)}else J.push($e)}J.forEach(Pe=>{window.localStorage.removeItem(Pe)})}catch(J){console.error("Failed to clear persisted step state:",J)}},[]),V=i.useCallback(()=>{if(!(!U||typeof window>"u"))try{localStorage.removeItem(Id(U))}catch(se){console.error("Failed to clear persisted MARGO state:",se)}},[U]),P=i.useCallback(()=>{const se=r==null?void 0:r.id;V(),Q(se),g([]),v(na()),a(null),u(null)},[V,Q,r==null?void 0:r.id]),K=(r==null?void 0:r.step1Completed)??!1,G=(r==null?void 0:r.step2Completed)??!1,q=i.useMemo(()=>r?!!(r.currentStep&&r.currentStep>3||r.nextAction&&r.nextAction.startsWith("step4")):!1,[r]),A=i.useMemo(()=>r?!!(r.currentStep&&r.currentStep>4||r.nextAction&&r.nextAction.startsWith("step5")):!1,[r]),E=i.useMemo(()=>r?!!(r.currentStep&&r.currentStep>5||r.nextAction&&r.nextAction.startsWith("step6")):!1,[r]),R=i.useMemo(()=>r?!!(r.currentStep&&r.currentStep>6||r.nextAction&&r.nextAction.startsWith("step7")):!1,[r]),L=i.useMemo(()=>r?!!(r.nextAction==="step7_complete"||r.currentStep&&r.currentStep>7):!1,[r]),I=i.useMemo(()=>!r||G?!1:!!(r.nextAction==="select_ava_profile"||r.currentStep>=2||r.step2AvaProfileId),[r,G]),_=i.useMemo(()=>!r||q?!1:r.currentStep>=3||r.nextAction==="start_product_interview",[r,q]),$=i.useMemo(()=>!r||A?!1:r.nextAction==="step4_ready"||r.nextAction==="prepare_step4"||r.nextAction==="watch_video_step4"||r.currentStep===4,[r,A]),F=i.useMemo(()=>{var se;return!r||E?!1:!!(r.nextAction&&r.nextAction.startsWith("step5")||r.currentStep&&r.currentStep>=5&&!((se=r.nextAction)!=null&&se.startsWith("step6")))},[r,E]),M=i.useMemo(()=>{var se;return!r||R?!1:!!(r.nextAction&&r.nextAction.startsWith("step6")||r.currentStep&&r.currentStep>=6&&!((se=r.nextAction)!=null&&se.startsWith("step7")))},[r,R]),T=i.useMemo(()=>!r||L?!1:!!(r.nextAction&&r.nextAction.startsWith("step7")&&r.nextAction!=="step7_complete"||r.currentStep&&r.currentStep>=7&&r.nextAction!=="step7_complete"),[r,L]),ie=7,Z=ie,le=9,oe=i.useMemo(()=>{if(T||L)return 7;if(M)return 6;if(F)return 5;if($)return 4;if(_)return 3;if(I)return 2;let se=1;r!=null&&r.step1Completed&&(se=Math.max(se,2)),G&&(se=Math.max(se,3)),q&&(se=Math.max(se,4)),A&&(se=Math.max(se,5)),E&&(se=Math.max(se,6)),R&&(se=Math.max(se,7)),L&&(se=Math.max(se,7));const J=Math.min((r==null?void 0:r.currentStep)??1,ie);return Math.max(se,J)},[I,_,$,F,M,G,q,A,E,R,r==null?void 0:r.step1Completed,r==null?void 0:r.currentStep,T,L]),z=i.useMemo(()=>Math.min(Math.max(oe,1),Z),[oe,Z]),ee=(e==null?void 0:e.name)??"Select a workspace",ne=i.useMemo(()=>d.length>=le||h.sections.length>=le||h.finalSections.length>=le,[d.length,h.sections.length,h.finalSections.length]),me=i.useMemo(()=>!!(L&&ne||h.statusHistoryContent.length>=le||h.completionMessage),[L,ne,h.statusHistoryContent.length,h.completionMessage]),ve=i.useMemo(()=>{if(!r)return 0;let se=0;K&&se++,G&&se++,q&&se++,A&&se++,E&&se++,R&&se++,me&&se++;const J=se/Z*100;return Math.min(100,Math.max(0,J))},[r,K,G,q,A,E,R,me,Z]);i.useEffect(()=>{if(x&&r){const se=r.nextAction==="submit_name"&&!r.userName,J=!!(r.userName&&(r.nextAction==="confirm_ready"||r.nextAction==="select_ava_profile"||r.step1Completed));(!se||J||K)&&y(null)}},[r==null?void 0:r.nextAction,r==null?void 0:r.userName,r==null?void 0:r.step1Completed,K,x]),i.useEffect(()=>{C.current&&C.current.scrollIntoView({behavior:"smooth",block:"end"})},[t,o,r==null?void 0:r.id,r==null?void 0:r.currentStep,r==null?void 0:r.nextAction,d.length]),i.useEffect(()=>{if(!k.current)return;const se=new ResizeObserver(()=>{var J;(J=C.current)==null||J.scrollIntoView({behavior:"smooth",block:"end"})});return se.observe(k.current),()=>se.disconnect()},[]),i.useEffect(()=>{const se=B.current;if(!se)return;const J=()=>{se.style.height="auto";const Ee=Math.min(Math.max(se.scrollHeight,56),200);se.style.height=`${Ee}px`};J();const Pe=()=>J();return se.addEventListener("input",Pe),()=>{se.removeEventListener("input",Pe)}},[(H=x||b)==null?void 0:H.inputValue,x,b]);const D=async()=>{var se;if(!(r!=null&&r.id)){n({title:"Download unavailable",description:"No MARGO session found.",variant:"destructive"});return}try{p(!0);const J=await Qh(r.id),Pe=window.URL.createObjectURL(J),$e=document.createElement("a"),Ae=((se=r.sessionName)==null?void 0:se.trim().replace(/[^\w\d-_]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""))||"margo-brief";$e.href=Pe,$e.download=`${Ae}.pdf`,document.body.appendChild($e),$e.click(),document.body.removeChild($e),window.URL.revokeObjectURL(Pe),n({title:"Download started",description:"Your Product Positioning Brief PDF is downloading."})}catch(J){n({title:"Download failed",description:(J==null?void 0:J.message)||"Unable to download the Product Positioning Brief.",variant:"destructive"})}finally{p(!1)}},ue=i.useCallback(()=>{f||j(!0)},[f]),O=i.useCallback(()=>{N(null),P(),j(!1)},[P]);return s.jsxs("div",{className:"min-h-[calc(100vh-80px)] bg-white",children:[s.jsxs("div",{className:"mx-auto flex h-full w-full flex-col",children:[s.jsxs("header",{className:"sticky top-0 z-10 border-b border-gray-200 bg-white px-4 py-3 mx-16",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full overflow-hidden bg-gray-100",children:s.jsx("img",{src:wt,alt:"MARGO Avatar",className:"h-full w-full object-cover"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"MARGO"}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Step ",z," / ",Z]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:ee}),s.jsxs(Ie,{type:"button",variant:"ghost",size:"icon",onClick:ue,disabled:t||o||f,title:"Reset MARGO progress",className:"h-8 w-8 text-gray-500 hover:text-gray-700",children:[s.jsx(fu,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Reset MARGO progress"})]})]})]}),r&&s.jsxs("div",{className:"mt-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Progress"}),s.jsxs("span",{className:"text-xs font-bold bg-gradient-to-r from-vox-pink to-vox-orange bg-clip-text text-transparent",children:[Math.round(ve),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-vox-pink via-vox-purple to-vox-orange transition-all duration-500 ease-out",style:{width:`${ve}%`}})})]})]}),s.jsx("main",{className:"flex flex-1 flex-col overflow-hidden bg-white mx-16",style:{"--ava-avatar-url":`url(${wt})`},children:s.jsx("div",{ref:k,className:"flex-1 overflow-y-auto px-4 ",children:s.jsxs("div",{className:"mx-auto flex w-full flex-col",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:"I'll guide you through each phase. Ready to craft a standout evaluation experience?"})}),t&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Loading workspace"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Preparing your MARGO environment."})]})]})})}),!t&&o&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Select a workspace to continue"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"MARGO works inside a specific workspace. Choose one from the workspace switcher to activate this journey."})]})}),!t&&c&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content bg-red-50 border-red-200",children:[s.jsx("p",{className:"font-medium text-red-700",children:"We ran into an issue"}),s.jsx("p",{className:"text-sm text-red-600 mt-1",children:c}),s.jsx(Ie,{onClick:()=>window.location.reload(),className:"mt-3 margo-soft-button margo-soft-button--sm",children:"Try again"})]})}),!t&&!o&&s.jsxs(s.Fragment,{children:[f&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Restoring your progress"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fetching your saved MARGO session for this workspace."})]})]})})}),!f&&s.jsxs(s.Fragment,{children:[U&&s.jsx("div",{className:"mb-4 pb-20",children:s.jsx(v4,{workspaceId:U,session:r,onSessionChange:a,onErrorChange:u,isCompleted:K,onInputHandlersReady:y},`margo-step1-${U}`)}),U&&r&&K&&s.jsx("div",{className:"mb-5",children:s.jsx(y4,{workspaceId:U,session:r,isActive:I,isCompleted:G,isUnlocked:K,onSessionChange:se=>a(J=>({...J??se,...se}))},`margo-step2-${r.id}`)}),r&&G&&s.jsx("div",{className:"mb-5",children:s.jsx(V4,{session:r,isActive:_,isCompleted:q,onSessionChange:se=>a(J=>({...J??se,...se})),onComplete:se=>a(J=>({...J??se,...se,currentStep:Math.max(se.currentStep??4,4),nextAction:se.nextAction||"prepare_step4"})),onInputHandlersReady:N},`margo-step3-${r.id}`)}),r&&q&&s.jsx("div",{className:"mb-5",children:s.jsx(e5,{session:r,isActive:$,isCompleted:A,onSessionChange:se=>a(J=>({...J??se,...se})),onContinue:()=>a(se=>se&&{...se,currentStep:Math.max(se.currentStep??4,4)+1,nextAction:"step5_ready"})},`margo-step4-${r.id}`)}),r&&A&&s.jsx("div",{className:"mb-5",children:s.jsx(r5,{session:r,isActive:F,isCompleted:E,onSessionChange:se=>a(J=>({...J??se,...se})),onContinue:()=>a(se=>se&&{...se,currentStep:Math.max(se.currentStep??0,6),nextAction:"step6_ready"})},`margo-step5-${r.id}`)}),r&&E&&s.jsx("div",{className:"mb-5",children:s.jsx(o5,{session:r,isActive:M,onSessionChange:se=>a(J=>({...J??se,...se})),onContinue:()=>a(se=>se&&{...se,currentStep:Math.max(se.currentStep??6,6)+1,nextAction:"step7_ready"})},`margo-step6-${r.id}`)}),r&&R&&s.jsx(c5,{session:r,isActive:T||!ne,isCompleted:L,state:h,onStateChange:se=>v(J=>se(J)),onSessionChange:se=>a(J=>({...J??se,...se})),onStartNew:ue,onComplete:se=>{g(se),a(J=>J&&{...J,currentStep:Math.max(J.currentStep??7,7),nextAction:"step7_complete"})}},`margo-step7-${r.id}`),L&&ne&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Zs,{className:"h-4 w-4 text-gray-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Congratulations! Your Product Positioning Brief is ready."})]}),s.jsx("p",{className:"text-sm text-gray-600",children:"Share it with the team, export it, or start a brand new MARGO journey whenever you're ready."}),d.length>0&&s.jsx("div",{className:"space-y-3 mt-4",children:d.map((se,J)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[s.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:`Section ${J+1}`}),s.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:se.title||`Section ${J+1}`}),s.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-700 font-normal",children:d5(se.content)||"Draft content saved."})]},se.id||`final-${J}`))}),s.jsxs("div",{className:"flex flex-col gap-3 pt-4 border-t border-gray-200 sm:flex-row sm:items-center sm:justify-between",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"Every section is stored in your workspace and ready for Amplifier collaboration."}),s.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center",children:[s.jsx(Ie,{type:"button",onClick:D,disabled:m,variant:"outline",className:"margo-soft-button margo-soft-button--outline",children:m?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin"}),"Preparing PDF"]}):"Download PDF"}),s.jsx(Ie,{type:"button",onClick:ue,className:"margo-soft-button",children:"Start a new MARGO"})]})]})]})})})]})]}),s.jsx("div",{ref:C,className:"h-4"})]})})}),(x||b)&&s.jsx("div",{className:"fixed bottom-0 right-0 z-50 w-[82%] bg-white px-16",children:s.jsx("div",{className:"px-4 py-4",children:s.jsxs("div",{className:"mx-auto flex flex-col",children:[s.jsxs("div",{className:"flex gap-3 items-end",children:[s.jsx("div",{className:"flex-1 relative w-[40%] bg-red-50 rounded-xl",children:s.jsx(fs,{ref:B,value:((ae=x||b)==null?void 0:ae.inputValue)||"",onChange:se=>{const J=x||b;J==null||J.onInputChange(se.target.value)},onKeyDown:se=>{if(se.key==="Enter"&&!se.shiftKey){se.preventDefault();const J=x||b;J!=null&&J.inputValue.trim()&&!J.isSubmitting&&J.onInputSubmit()}},placeholder:((de=x||b)==null?void 0:de.placeholder)||"",disabled:((re=x||b)==null?void 0:re.isSubmitting)||!1,className:"min-h-[56px] max-h-[200px] resize-none bg-white border-2 border-gray-300 focus:border-gray-400 focus:ring-gray-400 rounded-xl text-sm px-4 shadow-sm transition-all disabled:bg-gray-50 disabled:opacity-50",rows:1,style:{paddingTop:"18px",paddingBottom:"18px",lineHeight:"1.25"}})}),s.jsx(Ie,{onClick:()=>{const se=x||b;se==null||se.onInputSubmit()},disabled:!((fe=x||b)!=null&&fe.inputValue.trim())||((Se=x||b)==null?void 0:Se.isSubmitting)||!1,size:"icon",className:"h-14 w-14 bg-gray-900 hover:bg-gray-800 text-white shrink-0 rounded-xl shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:(he=x||b)!=null&&he.isSubmitting?s.jsx(Qe,{className:"w-5 h-5 animate-spin"}):s.jsx(hu,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-2 text-center",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px] border border-gray-300",children:"Enter"})," to send  ",s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px] border border-gray-300",children:"Shift+Enter"})," new line"]})]})})})]}),s.jsx(u5,{open:S,onOpenChange:j,workspaceName:ee,onConfirm:O})]})},p5=()=>{const e=Lt(),{currentWorkspace:t}=ls(),{toast:n}=yt(),[r,a]=i.useState(!0),[o,l]=i.useState([]),[c,u]=i.useState(new Set);i.useEffect(()=>{if(!(t!=null&&t.id)){n({title:"No Workspace Selected",description:"Please select a workspace to view previous MARGO briefs",variant:"destructive"}),e("/tools/products");return}d()},[t==null?void 0:t.id]);const d=async()=>{if(t!=null&&t.id){a(!0);try{const f=(await qn(t.id)||[]).filter(w=>w.status==="completed"||!!w.step7Completed||!!w.completedAt);l(f)}catch(p){console.error("Failed to load MARGO briefs:",p),n({title:"Error",description:(p==null?void 0:p.message)||"Failed to load previous MARGO briefs",variant:"destructive"})}finally{a(!1)}}},g=async p=>{if(!c.has(p.id)){u(f=>new Set(f).add(p.id));try{const f=await Qh(p.id),w=URL.createObjectURL(f),h=document.createElement("a");h.href=w;const x=(p.completedAt?new Date(p.completedAt):new Date(p.updatedAt||p.createdAt)).toISOString().replace(/[:.]/g,"-").replace("T","-").slice(0,-5),b=`Margo-Product-Brief-${p.userName||p.sessionName||"Client"}-${x}.pdf`;h.download=b,h.click(),URL.revokeObjectURL(w),n({title:"Brief Downloaded",description:`Downloaded ${b}`})}catch(f){console.error("Failed to download MARGO brief:",f),n({title:"Download Failed",description:(f==null?void 0:f.message)||"Failed to download product brief PDF",variant:"destructive"})}finally{u(f=>{const w=new Set(f);return w.delete(p.id),w})}}},m=p=>new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return s.jsx("div",{className:"h-[calc(100vh-80px)] overflow-hidden bg-gradient-to-br from-background via-background to-vox-pink/5 flex items-center justify-center p-6",children:s.jsxs("div",{className:"max-w-6xl w-full max-h-full flex flex-col space-y-6 overflow-hidden",children:[s.jsx("div",{className:"flex items-center justify-between flex-shrink-0",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>e("/tools/products"),className:"border-vox-pink/20 bg-background hover:!bg-gradient-to-r hover:!from-vox-pink/80 hover:!to-vox-orange/80 hover:!text-white hover:!border-vox-pink/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-vox-pink/20 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back to MARGO"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-vox-pink via-vox-orange to-vox-pink bg-clip-text text-transparent",children:"Previous MARGO Briefs"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"View and download completed product briefs"})]})]})}),r?s.jsx(qe,{className:"border-vox-pink/20 flex-1 flex items-center justify-center",children:s.jsxs(Xe,{className:"p-12 flex items-center justify-center",children:[s.jsx(Qe,{className:"w-8 h-8 animate-spin text-vox-pink"}),s.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading briefs..."})]})}):o.length===0?s.jsx(qe,{className:"border-vox-pink/20 flex-1 flex items-center justify-center",children:s.jsxs(Xe,{className:"p-12 text-center",children:[s.jsx(Pn,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Completed Briefs"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"You haven't completed any MARGO briefs yet. Start a MARGO session to see it here."}),s.jsx(Ie,{onClick:()=>{e("/tools/margo",{state:{scrollToBottom:!0}})},className:"bg-gradient-to-r from-vox-pink to-vox-orange text-white",children:"Create New Brief"})]})}):s.jsx("div",{className:"grid gap-4 overflow-y-auto flex-1 pr-2",children:o.map(p=>{const f=c.has(p.id),h=(p.completedAt?new Date(p.completedAt):new Date(p.createdAt)).toISOString().replace(/[:.]/g,"-").replace("T","-").slice(0,-5),x=`Margo-Product-Brief-${p.userName||p.sessionName||"Client"}-${h}.pdf`;return s.jsx(qe,{className:"border-vox-pink/20 hover:border-vox-pink/40 transition-all duration-300 hover:shadow-lg",children:s.jsx(Xe,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-foreground mb-1",children:p.sessionName}),s.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:x})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[p.userName&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(zr,{className:"w-4 h-4"}),s.jsx("span",{children:p.userName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(mu,{className:"w-4 h-4"}),s.jsxs("span",{children:["Completed: ",m(p.completedAt||p.updatedAt||p.createdAt)]})]})]})]}),s.jsx(Ie,{onClick:()=>g(p),disabled:f,className:"bg-gradient-to-r from-vox-pink to-vox-orange text-white hover:shadow-lg transition-all duration-300 shrink-0",children:f?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ln,{className:"w-4 h-4 mr-2"}),"Download PDF"]})})]})})},p.id)})})]})})},g5=e=>`product-refiner-store-${e}`,x5=e=>{const t=g5(e);return uu()(du(n=>({session:null,uiState:{},formData:{step2:null,step4:null,step5:null,step6:null,step7:null,step8:null,step9:null},setSession:r=>{n({session:r}),r&&n(a=>({formData:{step2:r.step2Product||r.step2TargetAudience||r.step2Problem||r.step2Features||r.step2Delivery||r.step2Pricing?{product:r.step2Product||"",targetAudience:r.step2TargetAudience||"",problem:r.step2Problem||"",features:r.step2Features||"",delivery:r.step2Delivery||"",pricing:r.step2Pricing||""}:a.formData.step2,step4:r.step4CorePromise||r.step4FinalPromise?{corePromise:r.step4CorePromise||"",finalPromise:r.step4FinalPromise||""}:a.formData.step4,step5:r.step5Outcomes&&Array.isArray(r.step5Outcomes)&&r.step5Outcomes.length>0?r.step5Outcomes:a.formData.step5,step6:r.step6FeatureBenefitTable&&Array.isArray(r.step6FeatureBenefitTable)&&r.step6FeatureBenefitTable.length>0?r.step6FeatureBenefitTable:a.formData.step6,step7:r.step7ValueStack?r.step7ValueStack:a.formData.step7,step8:r.step8ProofElements?{proofElements:r.step8ProofElements.proofElements||null,notes:r.step8ProofElements.notes||""}:a.formData.step8,step9:r.step9Pricing?r.step9Pricing:a.formData.step9}}))},setUiState:r=>n({uiState:r}),setStep2FormData:r=>n(a=>({formData:{...a.formData,step2:r}})),setStep4FormData:r=>n(a=>({formData:{...a.formData,step4:r}})),setStep5FormData:r=>n(a=>({formData:{...a.formData,step5:r}})),setStep6FormData:r=>n(a=>({formData:{...a.formData,step6:r}})),setStep7FormData:r=>n(a=>({formData:{...a.formData,step7:r}})),setStep8FormData:r=>n(a=>({formData:{...a.formData,step8:r}})),setStep9FormData:r=>n(a=>({formData:{...a.formData,step9:r}})),clearState:()=>n({session:null,uiState:{},formData:{step2:null,step4:null,step5:null,step6:null,step7:null,step8:null,step9:null}})}),{name:t,storage:yw(()=>localStorage),partialize:n=>({session:n.session,formData:n.formData})}))},yi=new Map,v5=e=>{const t=yi.get(e);t&&t.getState().clearState(),yi.delete(e)},Ra=e=>e?(yi.has(e)||yi.set(e,x5(e)),yi.get(e)):null,y5=async e=>{const t=`${Fe}/product-refiner/workspace/${e}`;try{const n=await Oe.makeAuthenticatedRequest(t,{method:"GET"});if(!n.ok){const a=await n.json().catch(()=>({message:"Failed to load Product Refiner sessions"}));throw new Error(a.message||"Failed to load Product Refiner sessions")}const r=await n.json();return(r==null?void 0:r.data)||r||[]}catch(n){const r=n instanceof Error?n.message:typeof n=="string"?n:"Failed to load Product Refiner sessions";throw new Error(r)}},w5=async(e,t)=>{const n=`${Fe}/product-refiner`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify({workspaceId:e,sessionName:t||"My Product Refinement"})});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to create Product Refiner session"}));throw new Error(a.message||"Failed to create Product Refiner session")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to create Product Refiner session";throw new Error(a)}},b5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step1`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 1"}));throw new Error(a.message||"Failed to submit Step 1")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 1";throw new Error(a)}},N5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/ready`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to confirm readiness"}));throw new Error(a.message||"Failed to confirm readiness")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to confirm readiness";throw new Error(a)}},j5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step2`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 2"}));throw new Error(a.message||"Failed to submit Step 2")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 2";throw new Error(a)}},S5=async e=>{const t=`${Fe}/product-refiner/${e}/step3/assess`;try{const n=await Oe.makeAuthenticatedRequest(t,{method:"POST"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to generate assessment"}));throw new Error(r.message||"Failed to generate assessment")}return await n.json()}catch(n){const r=n instanceof Error?n.message:typeof n=="string"?n:"Failed to generate assessment";throw new Error(r)}},k5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step4`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 4"}));throw new Error(a.message||"Failed to submit Step 4")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 4";throw new Error(a)}},P5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step5`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 5"}));throw new Error(a.message||"Failed to submit Step 5")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 5";throw new Error(a)}},A5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step6`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 6"}));throw new Error(a.message||"Failed to submit Step 6")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 6";throw new Error(a)}},C5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step7`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 7"}));throw new Error(a.message||"Failed to submit Step 7")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 7";throw new Error(a)}},E5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step8`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 8"}));throw new Error(a.message||"Failed to submit Step 8")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 8";throw new Error(a)}},I5=async(e,t)=>{const n=`${Fe}/product-refiner/${e}/step9`;try{const r=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!r.ok){const a=await r.json().catch(()=>({message:"Failed to submit Step 9"}));throw new Error(a.message||"Failed to submit Step 9")}return await r.json()}catch(r){const a=r instanceof Error?r.message:typeof r=="string"?r:"Failed to submit Step 9";throw new Error(a)}},T5=async e=>{const t=`${Fe}/product-refiner/${e}/step10`;try{const n=await Oe.makeAuthenticatedRequest(t,{method:"POST"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to generate final specification"}));throw new Error(r.message||"Failed to generate final specification")}return await n.json()}catch(n){const r=n instanceof Error?n.message:typeof n=="string"?n:"Failed to generate final specification";throw new Error(r)}},R5=async e=>{const t=`${Fe}/product-refiner/${e}`;try{const n=await Oe.makeAuthenticatedRequest(t,{method:"DELETE"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to delete session"}));throw new Error(r.message||"Failed to delete session")}}catch(n){const r=n instanceof Error?n.message:typeof n=="string"?n:"Failed to delete session";throw new Error(r)}},_j=async e=>{const t=`${Fe}/product-refiner/${e}/export/pdf`;try{const n=await Oe.makeAuthenticatedRequest(t,{method:"GET"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to export PDF"}));throw new Error(r.message||"Failed to export PDF")}return await n.blob()}catch(n){const r=n instanceof Error?n.message:typeof n=="string"?n:"Failed to export PDF";throw new Error(r)}},M5=async e=>{const t=`${Fe}/product-refiner/${e}/export/docx`;try{const n=await Oe.makeAuthenticatedRequest(t,{method:"GET"});if(!n.ok){const r=await n.json().catch(()=>({message:"Failed to export DOCX"}));throw new Error(r.message||"Failed to export DOCX")}return await n.blob()}catch(n){const r=n instanceof Error?n.message:typeof n=="string"?n:"Failed to export DOCX";throw new Error(r)}},$5=({workspaceId:e,session:t,onSessionChange:n,onLoadingChange:r,onErrorChange:a,isCompleted:o=!1,onInputHandlersReady:l})=>{const{toast:c}=yt(),[u,d]=i.useState(!1),g=3,[m,p]=i.useState(!1),[f,w]=i.useState((t==null?void 0:t.userName)??""),[h,v]=i.useState("I'm ready"),[x,y]=i.useState(!1),[b,N]=i.useState(null),S=i.useRef(!1),j=i.useRef(t),[k,C]=i.useState(null),[W,B]=i.useState(!1),[U,Q]=i.useState(!1),[V,P]=i.useState(!1),[K,G]=i.useState(!1);i.useEffect(()=>{w((t==null?void 0:t.userName)??""),j.current=t},[t]),i.useEffect(()=>{t!=null&&t.step1Completed&&v("I'm ready")},[t==null?void 0:t.step1Completed]),i.useEffect(()=>{t!=null&&t.welcomeMessage||(S.current=!0)},[t==null?void 0:t.welcomeMessage]);const q=!!(t!=null&&t.userName&&((t==null?void 0:t.nextAction)==="wait_for_ready"||(t==null?void 0:t.nextAction)==="confirm_ready"||t!=null&&t.step1Completed));i.useEffect(()=>{const I=(t==null?void 0:t.nextAction)==="submit_name";if(!t||o||!I||q){B(!0),Q(!0),P(!0),G(!0);return}B(!1),Q(!1),P(!1),G(!1);const _=setTimeout(()=>{B(!0)},300),$=setTimeout(()=>{Q(!0),P(!0),G(!0)},1800);return()=>{clearTimeout(_),clearTimeout($)}},[t,o,q]),i.useEffect(()=>{if(!e||t)return;let I=!1;return(async()=>{d(!0),r==null||r(!0),a==null||a(null);try{console.log("[ProductRefinerStep1] Creating session for workspace:",e);const $=await w5(e);if(console.log("[ProductRefinerStep1] Session creation response:",$),I)return;const F=($==null?void 0:$.data)||$;if(!F||!F.id)throw console.error("[ProductRefinerStep1] Invalid session response - missing ID:",{response:$,sessionData:F}),new Error("Failed to create session - invalid response");const M={id:F.id,workspaceId:F.workspaceId,userId:F.userId,sessionName:F.sessionName,userName:F.userName,currentStep:F.currentStep,status:F.status,version:F.version,step1Completed:!1,step2Completed:!1,step2Product:null,step2TargetAudience:null,step2Problem:null,step2Features:null,step2Delivery:null,step2Pricing:null,step3Completed:!1,step3Assessment:null,step4Completed:!1,step4CorePromise:null,step4FinalPromise:null,step5Completed:!1,step5Outcomes:null,step6Completed:!1,step6FeatureBenefitTable:null,step7Completed:!1,step7ValueStack:null,step8Completed:!1,step8ProofElements:null,step9Completed:!1,step9Pricing:null,step10Completed:!1,step10FinalSpecification:null,completedAt:null,createdAt:F.createdAt||new Date().toISOString(),updatedAt:F.updatedAt||new Date().toISOString(),welcomeMessage:F.welcomeMessage,question:F.question,nextAction:F.nextAction};console.log("[ProductRefinerStep1] Created new session:",M),j.current=M,n(M),setTimeout(()=>{d(!1),r==null||r(!1)},0)}catch($){if(I)return;const F=($==null?void 0:$.message)||"Failed to initialize Product Refiner session";a==null||a(F),c({title:"Initialization failed",description:F,variant:"destructive"}),d(!1),r==null||r(!1)}})(),()=>{I=!0}},[e,t,n,r,a,c]);const A=i.useCallback(async()=>{var $;const I=j.current||t;if(console.log("[ProductRefinerStep1] handleSubmitName called!",{hasSession:!!t,hasRefSession:!!j.current,sessionId:t==null?void 0:t.id,refSessionId:($=j.current)==null?void 0:$.id,currentSessionId:I==null?void 0:I.id,userName:f.trim(),userNameLength:f.trim().length}),!(I!=null&&I.id)){console.error("[ProductRefinerStep1] No session ID!",{session:t,refSession:j.current,currentSession:I}),c({title:"Session missing",description:"Please wait for the session to initialize, then try again.",variant:"destructive"});return}const _=f.trim();if(!_){console.warn("[ProductRefinerStep1] No user name provided!"),C("Name is required"),c({title:"Name required",description:"Please enter your name to continue.",variant:"destructive"});return}if(_.length<g){const F=`Name must be at least ${g} characters`;C(F),c({title:"Name too short",description:F,variant:"destructive"});return}C(null),console.log("[ProductRefinerStep1] Submitting name:",_,"for session:",I.id),p(!0),a==null||a(null);try{console.log("[ProductRefinerStep1] Calling submitStep1Name API...");const F=await b5(I.id,{userName:_});console.log("[ProductRefinerStep1] API response:",F),F.message&&(console.log("[ProductRefinerStep1] Setting role explanation message"),N(F.message));const M={...I,userName:_,nextAction:F.nextAction||"wait_for_ready"};console.log("[ProductRefinerStep1] Updating session:",M),n(M)}catch(F){console.error("[ProductRefinerStep1] Error submitting name:",F);const M=(F==null?void 0:F.message)||"Failed to submit name";a==null||a(M),c({title:"Submission failed",description:M,variant:"destructive"})}finally{p(!1)}},[t,f,c,a,n]),E=async()=>{if(!(t!=null&&t.id)){c({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}y(!0),a==null||a(null);try{const I=h.trim()||"I'm ready";await N5(t.id,{message:I});const _={...t,step1Completed:!0,currentStep:2};n(_)}catch(I){const _=(I==null?void 0:I.message)||"Failed to confirm ready";a==null||a(_),c({title:"Confirmation failed",description:_,variant:"destructive"})}finally{y(!1)}};if(i.useEffect(()=>{if(!l)return;if(u){console.log("[ProductRefinerStep1] Still initializing - clearing handlers"),l(null);return}const I=(t==null?void 0:t.nextAction)==="submit_name",_=I&&!q&&!o&&t&&t.id;if(console.log("[ProductRefinerStep1] Setting up input handlers:",{isNameInputPhase:I,hasSubmittedName:q,isCompleted:o,hasSession:!!t,hasSessionId:!!(t!=null&&t.id),sessionId:t==null?void 0:t.id,nextAction:t==null?void 0:t.nextAction,isInitializing:u,shouldProvideHandlers:_}),_){console.log("[ProductRefinerStep1] Registering input handlers with handleSubmitName");const $=()=>{const ie=j.current;console.log("[ProductRefinerStep1] Wrapped submit function called!",{refSessionId:ie==null?void 0:ie.id,propSessionId:t==null?void 0:t.id,currentUserName:f}),ie!=null&&ie.id?A():(console.error("[ProductRefinerStep1] Cannot submit - no session ID in ref",{refSession:ie,propSession:t}),c({title:"Session not ready",description:"Please wait for the session to initialize, then try again.",variant:"destructive"}))},F=ie=>{w(ie),k&&ie.trim().length>=g&&C(null)},M=f.trim(),T=M.length>0&&M.length<g;l({inputValue:f,onInputChange:F,onInputSubmit:$,isSubmitting:m,placeholder:"Enter your name",validationError:k,validationHint:T?`Required  minimum ${g} characters`:null})}else console.log("[ProductRefinerStep1] Clearing input handlers - not in name input phase"),l(null)},[l,t==null?void 0:t.nextAction,t==null?void 0:t.userName,q,o,t==null?void 0:t.id,f,m,u]),u)return s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Initializing Product Refiner"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Setting up your refinement session."})]})]})})});if(!t)return null;const R=t.userName&&!t.step1Completed,L=t.userName&&!t.step1Completed;return s.jsxs(s.Fragment,{children:[t.welcomeMessage&&W&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:V?s.jsx(gs,{text:t.welcomeMessage}):s.jsx(Ge,{text:t.welcomeMessage,onComplete:()=>P(!0),staggerMs:50})})}),!t.userName&&U&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:K?s.jsx("p",{children:t.question||" What's your name?"}):s.jsx(Ge,{text:t.question||" What's your name?",onComplete:()=>G(!0),staggerMs:30})})}),t.userName&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:t.userName})})}),R&&b&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:o?s.jsx("p",{children:b}):s.jsx(Ge,{text:b,staggerMs:30})})}),L&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user w-full",style:{maxWidth:"100%"},children:s.jsx("div",{className:"margo-message-content",style:{padding:0},children:s.jsx(Ie,{onClick:E,disabled:x,className:"margo-soft-button w-full text-lg font-semibold justify-center",style:{height:"auto"},children:x?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin mr-2"}),"Processing..."]}):h})})}),t.step1Completed&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 1 completed - Welcome and Role Introduction"})})})]})},D5=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1,examples:c,onInputHandlersReady:u,persistedState:d,onPersistedStateChange:g})=>{const m={product:5,targetAudience:10,problem:15,features:10,delivery:8,pricing:5},{toast:p}=yt(),f=Ra(e),w=!!(t.step2Product||t.step2TargetAudience||t.step2Problem||t.step2Features||t.step2Delivery||t.step2Pricing),h=(w||d)&&(f!=null&&f.getState().formData.step2)?f.getState().formData.step2:null,[v,x]=i.useState(!1),[y,b]=i.useState((d==null?void 0:d.currentInputValue)||""),[N,S]=i.useState((d==null?void 0:d.currentQuestionKey)||null),[j,k]=i.useState(d!=null&&d.answeredQuestions?new Set(d.answeredQuestions):new Set),[C,W]=i.useState(null),B=i.useRef(t),U=i.useRef(null),Q=i.useRef(!1),[V,P]=i.useState(()=>w?{product:t.step2Product||"",targetAudience:t.step2TargetAudience||"",problem:t.step2Problem||"",features:t.step2Features||"",delivery:t.step2Delivery||"",pricing:t.step2Pricing||""}:d&&h?h:{product:"",targetAudience:"",problem:"",features:"",delivery:"",pricing:""}),[K,G]=i.useState({});i.useEffect(()=>{B.current=t},[t]);const q=i.useMemo(()=>{var z,ee,ne,me,ve,D;return[{key:"product",label:"What is your product?",example:((z=c==null?void 0:c.product)==null?void 0:z.example)||"Example: A comprehensive online course teaching small business owners how to build and scale their email marketing strategy, including templates, automation workflows, and growth tactics."},{key:"targetAudience",label:"Who is the product for?",example:((ee=c==null?void 0:c.targetAudience)==null?void 0:ee.example)||"Example: Small business owners and entrepreneurs who are new to email marketing and want to build a sustainable customer acquisition system without hiring expensive agencies."},{key:"problem",label:"What specific problem does the product solve?",example:((ne=c==null?void 0:c.problem)==null?void 0:ne.example)||"Example: Small business owners struggle to build effective email marketing campaigns because they lack the knowledge, templates, and strategic framework needed to create campaigns that actually convert."},{key:"features",label:"What does the product include (features or components)?",example:((me=c==null?void 0:c.features)==null?void 0:me.example)||"Example: 12 video modules, 50+ email templates, automation workflow blueprints, case studies, a private community, monthly Q&A sessions, and lifetime access to updates."},{key:"delivery",label:"How is the product delivered?",example:((ve=c==null?void 0:c.delivery)==null?void 0:ve.example)||"Example: Delivered through an online learning platform with video content, downloadable resources, and a private community. Access is immediate upon purchase, with new content added monthly."},{key:"pricing",label:"What is the current pricing structure?",example:((D=c==null?void 0:c.pricing)==null?void 0:D.example)||"Example: One-time payment of $497, or three monthly payments of $199. Includes all modules, templates, and lifetime access to the community and updates."}]},[c]),A=q.length;i.useEffect(()=>{if(!w&&!d){Object.values(V).some(ee=>ee&&ee.trim())&&(P({product:"",targetAudience:"",problem:"",features:"",delivery:"",pricing:""}),k(new Set),S(null),b(""));return}if(d&&!w&&h){const z=Object.values(h).some(ne=>ne&&ne.trim()),ee=Object.values(V).some(ne=>ne&&ne.trim());if(z&&!ee){P(h);const ne=new Set;q.forEach(me=>{const ve=h[me.key];ve&&ve.trim()&&ne.add(me.key)}),k(ne)}}},[d,w,V,h,q]);const E=i.useCallback(z=>{const ee=z||V;for(const ne of q){const me=ee[ne.key];if(!me||!me.trim())return ne}return null},[V,q]),R=i.useRef(null),L=i.useRef(g);i.useEffect(()=>{L.current=g},[g]),i.useEffect(()=>{const z=L.current;if(!z)return;if(r||!n){const D=R.current;D&&(D.isCompleted!==r||D.isActive!==n)&&(R.current=null,z(null));return}const ee=Array.from(j).sort(),ne={currentQuestionKey:N,currentInputValue:y,answeredQuestions:ee},me=R.current;(!me||me.currentQuestionKey!==ne.currentQuestionKey||me.currentInputValue!==ne.currentInputValue||me.answeredQuestions.length!==ne.answeredQuestions.length||me.answeredQuestions.some((D,ue)=>D!==ne.answeredQuestions[ue])||me.isCompleted!==r||me.isActive!==n)&&(R.current={currentQuestionKey:ne.currentQuestionKey,currentInputValue:ne.currentInputValue,answeredQuestions:[...ne.answeredQuestions],isCompleted:r,isActive:n},z(ne))},[N,y,j,r,n]);const I=i.useRef(""),_=i.useRef("");i.useEffect(()=>{if(!w&&!d){JSON.stringify(Array.from(j).sort())!=="[]"&&(k(new Set),_.current="[]"),Q.current=!0,I.current="";return}const z=JSON.stringify(V);if(I.current===z)return;I.current=z;const ee=new Set;q.forEach(ve=>{const D=V[ve.key];D&&D.trim()&&ee.add(ve.key)});const ne=Array.from(ee).sort(),me=JSON.stringify(ne);_.current!==me&&(_.current=me,k(ee)),Q.current=!0},[V,q,w,d]),i.useEffect(()=>{if(n&&!r){if(!d){const ee=q[0];ee&&ee.key!==N&&(S(ee.key),b(""));return}if(d.currentQuestionKey){const ee=V[d.currentQuestionKey];if(!ee||!ee.trim())return}const z=E();z&&z.key!==N&&q.findIndex(ne=>ne.key===z.key)>=0&&(S(z.key),b(V[z.key]||""))}},[n,r,E,q,V,d,N]),i.useEffect(()=>{N&&G(z=>z[N]?z:{...z,[N]:!0})},[N]);const $=(z,ee)=>{const ne=ee.replace(/^Example:\s*/i,"").trim();S(z),b(ne),requestAnimationFrame(()=>{var me;(me=document.getElementById("product-refiner-unified-input"))==null||me.scrollIntoView({behavior:"smooth",block:"center"})})};i.useEffect(()=>{if(!N){U.current=null;return}if(!n)return;const z=U.current;z&&z.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},[N,n]);const F=i.useRef(""),M=i.useRef("");i.useEffect(()=>{const z=JSON.stringify({step2Product:t.step2Product,step2TargetAudience:t.step2TargetAudience,step2Problem:t.step2Problem,step2Features:t.step2Features,step2Delivery:t.step2Delivery,step2Pricing:t.step2Pricing});if(F.current===z)return;F.current=z;const ee={product:t.step2Product||"",targetAudience:t.step2TargetAudience||"",problem:t.step2Problem||"",features:t.step2Features||"",delivery:t.step2Delivery||"",pricing:t.step2Pricing||""},ne=w?ee:h&&d?h:ee,me=JSON.stringify(ne);M.current!==me&&(M.current=me,P(ne),f&&w&&f.getState().setStep2FormData(ne))},[t.step2Product,t.step2TargetAudience,t.step2Problem,t.step2Features,t.step2Delivery,t.step2Pricing,w,h,d,f]);const T=i.useCallback(async(z,ee)=>{var ve;if(v)return;if(!((ve=B.current)!=null&&ve.id)){p({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const ne=ee.trim(),me=m[z]??3;if(!ne){const D=q.find(ue=>ue.key===z);W(`${(D==null?void 0:D.label)||"This field"} is required`),p({title:"Answer required",description:"Please provide an answer before submitting.",variant:"destructive"});return}if(ne.length<me){const D=q.find(H=>H.key===z),O=`${(D==null?void 0:D.label)||"This field"} must be at least ${me} characters`;W(O),p({title:"Answer too short",description:O,variant:"destructive"});return}W(null),x(!0),o==null||o(null);try{const D={...V,[z]:ee.trim()};if(P(D),f&&f.getState().setStep2FormData(D),D.product.trim()&&D.targetAudience.trim()&&D.problem.trim()&&D.features.trim()&&D.delivery.trim()&&D.pricing.trim()){await j5(B.current.id,D);const O={...B.current,step2Completed:!0,step2Product:D.product,step2TargetAudience:D.targetAudience,step2Problem:D.problem,step2Features:D.features,step2Delivery:D.delivery,step2Pricing:D.pricing,currentStep:3};a(O),S(null),b("")}else{const O=E(D);O&&q.findIndex(ae=>ae.key===O.key)>=0?(S(O.key),b(""),k(ae=>new Set([...ae,z]))):(S(null),b(""))}}catch(D){const ue=(D==null?void 0:D.message)||"Failed to submit answer";o==null||o(ue),p({title:"Submission failed",description:ue,variant:"destructive"})}finally{x(!1)}},[V,E,o,a,q,p,v]),ie=i.useRef(u),Z=i.useRef(""),le=i.useRef(!1),oe=i.useRef(T);return i.useEffect(()=>{ie.current=u,oe.current=T},[u,T]),i.useEffect(()=>{if(!ie.current)return;const z=n&&!r&&N!==null,ee=JSON.stringify({shouldProvideHandlers:z,isActive:n,isCompleted:r,currentQuestionKey:N,currentInputValue:y,isSubmitting:v,validationError:C});if(Z.current===ee)return;const ne=le.current;if(Z.current=ee,z){const me=q.find(de=>de.key===N),ve=()=>{if(N&&y.trim())oe.current(N,y);else if(N){const de=m[N]??3,re=(me==null?void 0:me.label)||"This field",fe=y.trim();fe?fe.length<de&&W(`${re} must be at least ${de} characters`):W(`${re} is required`)}},D=de=>{b(de),C&&de.trim().length>=(m[N??""]??3)&&W(null)},ue=N?m[N]??10:10,O=(me==null?void 0:me.label)||"Answer",H=y.trim(),ae=H.length>0&&H.length<ue;ie.current({inputValue:y,onInputChange:D,onInputSubmit:ve,isSubmitting:v,placeholder:me?`Answer question ${(q.findIndex(de=>de.key===N)||0)+1} of ${A}...`:"Enter your answer",currentQuestionKey:N,currentQuestionLabel:(me==null?void 0:me.label)||null,validationError:C,validationHint:ae?`${O}  minimum ${ue} characters`:null}),le.current=!0}else ne&&ie.current(null),le.current=!1},[n,r,N,y,v,q,C]),!l&&!n&&!r?null:s.jsxs(s.Fragment,{children:[(n||r)&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:r?s.jsx("p",{children:"Great! Now let's collect information about your product. We'll ask you a series of questions, and I'll provide examples for each one to guide you."}):s.jsx(Ge,{text:"Great! Now let's collect information about your product. We'll ask you a series of questions, and I'll provide examples for each one to guide you.",staggerMs:30})})}),q.map((z,ee)=>{const ne=h==null?void 0:h[z.key],me=V[z.key],ve=z.key==="product"?t.step2Product:z.key==="targetAudience"?t.step2TargetAudience:z.key==="problem"?t.step2Problem:z.key==="features"?t.step2Features:z.key==="delivery"?t.step2Delivery:z.key==="pricing"?t.step2Pricing:null,D=ne||me||ve||"",O=!!(D&&D.trim())||j.has(z.key),H=z.key===N;if(!(r||O||H))return null;const de=D||"",re=ee+1;return s.jsxs("div",{className:"space-y-1",ref:H&&!r?fe=>{U.current=fe}:void 0,children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",re," of ",A]}),r?s.jsx("p",{className:"text-base text-gray-900",children:z.label}):s.jsx(Ge,{text:z.label,chunkClassName:"text-base text-gray-900",staggerMs:30}),O&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-1 transition-opacity duration-300 opacity-100",children:" Saved"})]})})}),H&&!r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content p-0",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Example Inspiration"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{type:"button",onClick:()=>$(z.key,z.example||""),className:"text-sm font-semibold text-vox-pink hover:text-vox-pink/80 transition-colors",children:"Use this example"}),s.jsx("button",{type:"button",onClick:fe=>{fe.preventDefault(),G(Se=>({...Se,[z.key]:!Se[z.key]}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":K[z.key]?"Hide example":"Show example",children:K[z.key]?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]})]}),K[z.key]&&z.example&&s.jsxs("div",{className:"px-4 py-4 space-y-3",children:[s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:z.example}),s.jsx("div",{className:"text-xs text-gray-500",children:"Feel free to personalize this example before submitting."})]})]})})}),O&&de&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:de})})})]},z.key)}),!r&&s.jsx("div",{className:"h-4","aria-hidden":!0})]}),r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 2 completed - Product intake information saved"})})})]})},O5=({session:e,isActive:t,isCompleted:n,onSessionChange:r,onError:a,isUnlocked:o=!1,persistedState:l,onPersistedStateChange:c})=>{const{toast:u}=yt(),d=["Step 3: Early Product Assessment","","Purpose","Give you clarity about the current state of your product before refinement.","","Process Flow","- I'll explain what this assessment is and why it matters.","- I'll evaluate your initial intake to surface strengths, weaknesses, gaps, unclear areas, and improvement opportunities.","- I'll present a written summary of the assessment for you.","- Youll confirm you understand before we continue to the next step."].join(`
`),[g,m]=i.useState(()=>!!(l!=null&&l.hasGenerated&&!e.step3Completed&&!e.step3Assessment)),[p,f]=i.useState(()=>!!(l!=null&&l.hasGenerated||e.step3Completed||e.step3Assessment)),w=i.useRef(null),h=()=>e.id&&e.step2Completed?`${e.id}-${e.step2Completed}`:null,v=i.useMemo(()=>{if(!e.step3Assessment)return null;if(typeof e.step3Assessment=="object")return e.step3Assessment;if(typeof e.step3Assessment=="string")try{return JSON.parse(e.step3Assessment)}catch(y){return console.error("Failed to parse step3Assessment:",y),null}return null},[e.step3Assessment]);i.useEffect(()=>{c&&c({hasGenerated:p})},[p,c]),i.useEffect(()=>{const y=h();w.current===y&&!e.step3Completed&&!e.step3Assessment||(t&&!n&&p&&!e.step3Completed&&!e.step3Assessment&&!g||t&&!n&&!p&&e.step2Completed)&&x()},[t,n,p,e.step2Completed,e.step3Completed,e.step3Assessment,e.id,g]);const x=async()=>{const y=h(),b=p&&!e.step3Completed&&!e.step3Assessment;if(!(!e.id||p&&!b||g)&&!(w.current===y&&!e.step3Completed&&!e.step3Assessment)){w.current=y||null,m(!0),p||f(!0),a==null||a(null);try{const N=await S5(e.id),S={...e,step3Assessment:N.assessment,step3Completed:!0,currentStep:4};r(S),w.current=null}catch(N){const S=(N==null?void 0:N.message)||"Failed to generate assessment";a==null||a(S),u({title:"Assessment failed",description:S,variant:"destructive"})}finally{m(!1)}}};return!o&&!t&&!n?null:s.jsxs(s.Fragment,{children:[t&&!n&&!g&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:d,staggerMs:30})})}),g&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Analyzing your product..."}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Identifying strengths, weaknesses, gaps, and improvement opportunities."})]})]})})}),n&&v&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-5",children:[s.jsx("h3",{className:"font-semibold text-lg text-gray-900 mb-4",children:"Early Product Assessment"}),v.summary&&s.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-lg",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"Summary"}),s.jsx("p",{className:"text-sm text-blue-800 whitespace-pre-wrap leading-relaxed",children:v.summary})]}),v.strengths&&Array.isArray(v.strengths)&&v.strengths.length>0&&s.jsxs("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 rounded-r-lg",children:[s.jsx("h4",{className:"font-medium text-green-900 mb-3",children:"Strengths"}),s.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-green-800",children:v.strengths.map((y,b)=>s.jsx("li",{className:"leading-relaxed",children:y},b))})]}),v.weaknesses&&Array.isArray(v.weaknesses)&&v.weaknesses.length>0&&s.jsxs("div",{className:"bg-orange-50 border-l-4 border-orange-400 p-4 rounded-r-lg",children:[s.jsx("h4",{className:"font-medium text-orange-900 mb-3",children:"Weaknesses"}),s.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-orange-800",children:v.weaknesses.map((y,b)=>s.jsx("li",{className:"leading-relaxed",children:y},b))})]}),v.gaps&&Array.isArray(v.gaps)&&v.gaps.length>0&&s.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-lg",children:[s.jsx("h4",{className:"font-medium text-yellow-900 mb-3",children:"Gaps"}),s.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-yellow-800",children:v.gaps.map((y,b)=>s.jsx("li",{className:"leading-relaxed",children:y},b))})]}),v.unclearAreas&&Array.isArray(v.unclearAreas)&&v.unclearAreas.length>0&&s.jsxs("div",{className:"bg-purple-50 border-l-4 border-purple-400 p-4 rounded-r-lg",children:[s.jsx("h4",{className:"font-medium text-purple-900 mb-3",children:"Unclear Areas"}),s.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-purple-800",children:v.unclearAreas.map((y,b)=>s.jsx("li",{className:"leading-relaxed",children:y},b))})]}),v.improvementOpportunities&&Array.isArray(v.improvementOpportunities)&&v.improvementOpportunities.length>0&&s.jsxs("div",{className:"bg-indigo-50 border-l-4 border-indigo-400 p-4 rounded-r-lg",children:[s.jsx("h4",{className:"font-medium text-indigo-900 mb-3",children:"Improvement Opportunities"}),s.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm text-indigo-800",children:v.improvementOpportunities.map((y,b)=>s.jsx("li",{className:"leading-relaxed",children:y},b))})]})]})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 3 completed - Early Product Assessment"})})})]})]})},F5=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1,example:c,onInputHandlersReady:u,persistedState:d,onPersistedStateChange:g})=>{const{toast:p}=yt(),f=Ra(e),w=!!(t.step4CorePromise||t.step4FinalPromise),v=(w||!!d)&&(f==null?void 0:f.getState().formData.step4)?(f==null?void 0:f.getState().formData.step4)??null:null,[x,y]=i.useState(!1),[b,N]=i.useState(()=>t.step4CorePromise?t.step4CorePromise:v!=null&&v.corePromise?v.corePromise:""),[S,j]=i.useState(()=>t.step4FinalPromise?t.step4FinalPromise:v!=null&&v.finalPromise?v.finalPromise:""),[k,C]=i.useState(null),[W,B]=i.useState(null),[U,Q]=i.useState((d==null?void 0:d.currentInputValue)||""),[V,P]=i.useState((d==null?void 0:d.currentQuestionKey)||null),[K,G]=i.useState(()=>new Set((d==null?void 0:d.answeredQuestions)||[])),[q,A]=i.useState({}),[E,R]=i.useState(new Set),L=i.useRef(t),I=i.useCallback(D=>["skip","no","n","leave it","leave","none","not needed","pass"].includes(D.trim().toLowerCase()),[]),_=i.useMemo(()=>[{key:"corePromise",label:"What is your core product promise?",placeholder:"Describe your core product promise (minimum 20 characters)...",isOptional:!1},{key:"finalPromise",label:"What is your final refined promise? (Optional  you can skip this)",placeholder:"Enter your refined promise, or type 'skip' to use core promise...",isOptional:!0,skipHint:"You can skip by typing 'skip' or leave it blank."}],[]),$=i.useRef(""),F=i.useRef("");i.useEffect(()=>{L.current=t;const D=JSON.stringify({step4CorePromise:t.step4CorePromise,step4FinalPromise:t.step4FinalPromise});if($.current===D)return;$.current=D;const ue=t.step4CorePromise||(v==null?void 0:v.corePromise)||"",O=t.step4FinalPromise||(v==null?void 0:v.finalPromise)||"";N(ue),j(O),t.step4FinalPromise===""||t.step4FinalPromise===t.step4CorePromise&&t.step4CorePromise?R(de=>de.has("finalPromise")?de:new Set([...de,"finalPromise"])):t.step4FinalPromise&&t.step4FinalPromise!==t.step4CorePromise&&R(de=>{if(!de.has("finalPromise"))return de;const re=new Set(de);return re.delete("finalPromise"),re}),f&&(ue.trim()||O.trim())&&f.getState().setStep4FormData({corePromise:ue,finalPromise:O});const H=new Set;ue.trim()&&H.add("corePromise"),O.trim()&&H.add("finalPromise");const ae=JSON.stringify(Array.from(H).sort());F.current!==ae&&(F.current=ae,G(H))},[t.step4CorePromise,t.step4FinalPromise,w,v,f]),i.useEffect(()=>{var D,ue,O,H;if(!w&&!d){(b.trim()||S.trim())&&(N(""),j(""),G(new Set),P(null),Q(""),R(new Set));return}if(d&&!w&&v){const ae=((D=v.corePromise)==null?void 0:D.trim())||((ue=v.finalPromise)==null?void 0:ue.trim()),de=b.trim()||S.trim();if(ae&&!de){N(v.corePromise||""),j(v.finalPromise||"");const re=new Set;(O=v.corePromise)!=null&&O.trim()&&re.add("corePromise"),(H=v.finalPromise)!=null&&H.trim()&&re.add("finalPromise"),G(re)}}},[d,w,b,S,v]),i.useEffect(()=>{if(n&&!r){if(!d){let ue=null;b.trim()?S.trim()||(ue=_[1]):ue=_[0],ue&&ue.key!==V?(P(ue.key),Q(ue.key==="corePromise"?b:S)):ue||(P(null),Q(""));return}if(d.currentQuestionKey){const ue=d.currentQuestionKey==="corePromise"?b:S;if(!ue||!ue.trim()){V!==d.currentQuestionKey&&(P(d.currentQuestionKey),Q(d.currentInputValue||""));return}}let D=null;b.trim()?S.trim()||(D=_[1]):D=_[0],D&&D.key!==V?(P(D.key),Q(D.key==="corePromise"?b:S)):D||(P(null),Q(""))}},[n,r,d,b,S,V,_]);const M=i.useRef(b),T=i.useRef(S),ie=i.useRef(x);i.useEffect(()=>{M.current=b,T.current=S,ie.current=x},[b,S,x]);const Z=i.useCallback(async(D,ue)=>{if(ie.current)return;const O=L.current||t;if(!(O!=null&&O.id)){p({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const H=ue.trim(),ae=M.current,de=T.current;if(D==="corePromise"){if(!H){B("Core Product Promise is required");return}if(H.length<20){B("Core Product Promise must be at least 20 characters");return}N(H),M.current=H,G(re=>new Set([...re,"corePromise"])),f&&f.getState().setStep4FormData({corePromise:H,finalPromise:de}),de.trim()?await le(H,de):(P("finalPromise"),Q(""))}else D==="finalPromise"&&(y(!0),B(null),I(H)||!H?(j(""),T.current="",G(re=>new Set([...re,"finalPromise"])),R(re=>new Set([...re,"finalPromise"])),f&&f.getState().setStep4FormData({corePromise:ae,finalPromise:""}),await le(ae.trim(),ae.trim())):(y(!0),j(H),T.current=H,G(re=>new Set([...re,"finalPromise"])),R(re=>{const fe=new Set(re);return fe.delete("finalPromise"),fe}),f&&f.getState().setStep4FormData({corePromise:ae,finalPromise:H}),await le(ae.trim(),H)))},[t,p,I,f]),le=async(D,ue)=>{const O=L.current||t;if(O!=null&&O.id){B(null),y(!0),o==null||o(null);try{const H=await k5(O.id,{corePromise:D,finalPromise:ue!==D?ue:void 0});H.suggestion&&C(H.suggestion);const ae={...O,step4CorePromise:D,step4FinalPromise:ue!==D?ue:D,step4Completed:!0,currentStep:5};a(ae),P(null),Q("")}catch(H){const ae=(H==null?void 0:H.message)||"Failed to submit promise";o==null||o(ae),p({title:"Submission failed",description:ae,variant:"destructive"})}finally{y(!1)}}},oe=i.useRef(null),z=i.useRef(g);i.useEffect(()=>{z.current=g},[g]),i.useEffect(()=>{const D=z.current;if(!D)return;if(r||!n){const de=oe.current;de&&(de.isCompleted!==r||de.isActive!==n)&&(oe.current=null,D(null));return}const ue=Array.from(K).sort(),O={currentQuestionKey:V,currentInputValue:U,answeredQuestions:ue},H=oe.current;(!H||H.currentQuestionKey!==O.currentQuestionKey||H.currentInputValue!==O.currentInputValue||H.answeredQuestions.length!==O.answeredQuestions.length||H.answeredQuestions.some((de,re)=>de!==O.answeredQuestions[re])||H.isCompleted!==r||H.isActive!==n)&&(oe.current={currentQuestionKey:O.currentQuestionKey,currentInputValue:O.currentInputValue,answeredQuestions:[...O.answeredQuestions],isCompleted:r,isActive:n},D(O))},[V,U,K,r,n]);const ee=i.useRef(u),ne=i.useRef(""),me=i.useRef(!1),ve=i.useRef(Z);return i.useEffect(()=>{ee.current=u,ve.current=Z},[u,Z]),i.useEffect(()=>{if(!ee.current)return;const D=n&&!r&&V!==null,ue=JSON.stringify({shouldProvideHandlers:D,isActive:n,isCompleted:r,currentQuestionKey:V,currentInputValue:U,isSubmitting:x,validationError:W});if(ne.current===ue)return;const O=me.current;if(ne.current=ue,D){const H=_.find(Se=>Se.key===V),ae=()=>{if(V){const Se=U.trim(),he=(H==null?void 0:H.isOptional)||!1;he&&(I(Se)||!Se)||Se?ve.current(V,Se):he||B("This field is required")}},de=Se=>{Q(Se),W&&V==="corePromise"&&Se.trim().length>=20&&B(null)},re=U.trim(),fe=V==="corePromise"&&re.length>0&&re.length<20;ee.current({inputValue:U,onInputChange:de,onInputSubmit:ae,isSubmitting:x,placeholder:(H==null?void 0:H.placeholder)||"",currentQuestionKey:V,currentQuestionLabel:(H==null?void 0:H.label)||null,validationError:W,validationHint:fe?"Core Product Promise  minimum 20 characters":H!=null&&H.isOptional&&(H!=null&&H.skipHint)?H.skipHint:null}),me.current=!0}else O&&ee.current(null),me.current=!1},[n,r,V,U,x,W,_]),i.useEffect(()=>{V&&V==="corePromise"&&c&&A(D=>D.corePromise?D:{...D,corePromise:!0})},[V,c]),!l&&!n&&!r?null:s.jsxs(s.Fragment,{children:[(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:"Now let's refine your core product promise. A strong promise is clear, compelling, results-focused, and aligned with your target audience's needs.",staggerMs:30})})}),_.map(D=>{const ue=D.key==="corePromise"?v==null?void 0:v.corePromise:v==null?void 0:v.finalPromise,O=D.key==="corePromise"?b:S,H=D.key==="corePromise"?t.step4CorePromise:t.step4FinalPromise,ae=ue||O||H||"",re=!!(ae&&ae.trim())||K.has(D.key),fe=D.key===V;return r||re||fe?s.jsxs("div",{className:"space-y-1",children:[(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-1",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:D.label}):s.jsx(Ge,{text:D.label,chunkClassName:"text-base text-gray-900",staggerMs:30}),D.isOptional&&!r&&s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:D.skipHint||"You can skip this by typing 'skip' or leaving it blank."}),re&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})}),fe&&D.key==="corePromise"&&c&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content p-0",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Example Inspiration"})]}),s.jsx("button",{type:"button",onClick:()=>{A(he=>({...he,corePromise:!he.corePromise}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":q.corePromise?"Hide example":"Show example",children:q.corePromise?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]}),q.corePromise&&c&&s.jsxs("div",{className:"px-4 py-4 space-y-3",children:[s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:c}),s.jsx("div",{className:"text-xs text-gray-500",children:"Feel free to personalize this example before submitting."})]})]})})}),re&&D.isOptional&&E.has(D.key)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})}),re&&ae&&ae.trim()&&!E.has(D.key)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:ae})})}),fe&&x&&!r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),s.jsx("p",{className:"text-sm",children:"Saving..."})]})})})]},D.key):null}),x&&!r&&V===null&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),s.jsx("p",{className:"text-sm",children:"Saving..."})]})})}),k&&(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content bg-blue-50 border border-blue-200",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"AI Suggestion"}),k.improvedPromise&&s.jsx("p",{className:"text-sm text-blue-800 mb-2",children:k.improvedPromise}),k.reasoning&&s.jsx("p",{className:"text-sm text-blue-700 mb-2",children:k.reasoning}),k.keyImprovements&&Array.isArray(k.keyImprovements)&&s.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-blue-700",children:k.keyImprovements.map((D,ue)=>s.jsx("li",{children:D},ue))})]})}),r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:" Step 4 completed - Product Promise Refined"}),s.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Great! Your product promise is now clear and compelling. Let's define the specific outcomes your product delivers."})]})}),n&&!r&&s.jsx("div",{className:"h-4","aria-hidden":!0})]})},_5=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1,example:c,onInputHandlersReady:u,persistedState:d,onPersistedStateChange:g})=>{const m={outcome:5,change:15,whyItMatters:15,howProductProduces:15},{toast:p}=yt(),f=Ra(e),w=!!(t.step5Outcomes&&Array.isArray(t.step5Outcomes)&&t.step5Outcomes.length>0),v=(w||!!d)&&(f==null?void 0:f.getState().formData.step5)?(f==null?void 0:f.getState().formData.step5)??null:null,[x,y]=i.useState(!1),[b,N]=i.useState(null),[S,j]=i.useState((d==null?void 0:d.currentInputValue)||""),[k,C]=i.useState((d==null?void 0:d.currentOutcomeIndex)??0),[W,B]=i.useState((d==null?void 0:d.currentFieldKey)||null),[U,Q]=i.useState(()=>t.step5Outcomes&&Array.isArray(t.step5Outcomes)&&t.step5Outcomes.length>0?t.step5Outcomes:v&&Array.isArray(v)&&v.length>0?v:[{outcome:"",change:"",whyItMatters:"",howProductProduces:""},{outcome:"",change:"",whyItMatters:"",howProductProduces:""},{outcome:"",change:"",whyItMatters:"",howProductProduces:""}]),[V,P]=i.useState(new Set),[K,G]=i.useState({}),q=i.useRef(t),A=i.useRef(!1),E=i.useRef(null),R=i.useRef(null),L=i.useRef(!1),I=i.useRef(""),_=i.useRef(""),$=i.useRef(""),F=i.useRef(""),M=i.useMemo(()=>({outcome:"What is the outcome?",change:"What change does this create?",whyItMatters:"Why does this matter to the client?",howProductProduces:"How does the product produce this outcome?"}),[]),T=i.useMemo(()=>["outcome","change","whyItMatters","howProductProduces"],[]);i.useEffect(()=>{if(q.current=t,!w&&!d){U.some(H=>{var ae,de,re,fe;return((ae=H.outcome)==null?void 0:ae.trim())||((de=H.change)==null?void 0:de.trim())||((re=H.whyItMatters)==null?void 0:re.trim())||((fe=H.howProductProduces)==null?void 0:fe.trim())})&&(Q([{outcome:"",change:"",whyItMatters:"",howProductProduces:""},{outcome:"",change:"",whyItMatters:"",howProductProduces:""},{outcome:"",change:"",whyItMatters:"",howProductProduces:""}]),P(new Set),C(0),B(null),j(""));return}if(d&&!w&&v){const O=v.some(ae=>{var de,re,fe,Se;return((de=ae.outcome)==null?void 0:de.trim())||((re=ae.change)==null?void 0:re.trim())||((fe=ae.whyItMatters)==null?void 0:fe.trim())||((Se=ae.howProductProduces)==null?void 0:Se.trim())}),H=U.some(ae=>{var de,re,fe,Se;return((de=ae.outcome)==null?void 0:de.trim())||((re=ae.change)==null?void 0:re.trim())||((fe=ae.whyItMatters)==null?void 0:fe.trim())||((Se=ae.howProductProduces)==null?void 0:Se.trim())});if(O&&!H){Q(v);const ae=new Set;v.forEach((de,re)=>{T.forEach(fe=>{var Se;(Se=de[fe])!=null&&Se.trim()&&ae.add(`${re}-${fe}`)})}),P(ae),L.current=!0}}},[d,w,U,v,T]),i.useEffect(()=>{if(A.current)return;const O=JSON.stringify(U);if(I.current===O)return;I.current=O;const H=new Set;U.forEach((re,fe)=>{T.forEach(Se=>{var he;(he=re[Se])!=null&&he.trim()&&H.add(`${fe}-${Se}`)})});const ae=Array.from(H).sort(),de=JSON.stringify(ae);_.current!==de&&(_.current=de,P(H)),L.current=!0},[U,T]),i.useEffect(()=>{if(A.current)return;const O=JSON.stringify(t.step5Outcomes);if($.current===O)return;$.current=O;const H=t.step5Outcomes&&Array.isArray(t.step5Outcomes)&&t.step5Outcomes.length>0?t.step5Outcomes:null,ae=w?H:v&&d?v:H,de=JSON.stringify(ae||[]),re=JSON.stringify(U);if(de!==re&&de!==F.current){if(F.current=de,ae)Q(ae);else if(re===JSON.stringify([{outcome:"",change:"",whyItMatters:"",howProductProduces:""},{outcome:"",change:"",whyItMatters:"",howProductProduces:""},{outcome:"",change:"",whyItMatters:"",howProductProduces:""}]))return;f&&w&&H&&f.getState().setStep5FormData(H)}},[t.step5Outcomes,w,v,d,f,U]),i.useEffect(()=>{if(A.current&&E.current){const O=E.current;k===O.outcomeIndex&&W===O.field&&(console.log("[ProductRefinerStep5] Navigation confirmed, resetting flags"),A.current=!1,E.current=null,x&&y(!1))}if(A.current){const O=setTimeout(()=>{A.current&&(console.log("[ProductRefinerStep5] Fallback: resetting navigation flag after timeout"),A.current=!1,E.current=null,x&&y(!1))},1e3);return()=>clearTimeout(O)}},[k,W,x]);const ie=(O,H)=>`${O}-${H}`,Z=i.useCallback(async O=>{const H=q.current||t;if(H!=null&&H.id){N(null),y(!0),R.current=null,o==null||o(null);try{await P5(H.id,{outcomes:O});const ae={...H,step5Outcomes:O,step5Completed:!0,currentStep:6};a(ae),C(-1),B(null),j("")}catch(ae){const de=(ae==null?void 0:ae.message)||"Failed to submit outcomes";o==null||o(de),p({title:"Submission failed",description:de,variant:"destructive"})}finally{y(!1),R.current=null}}},[t,a,o,p]),le=i.useCallback(async(O,H,ae)=>{var Se,he,se,J,Pe,$e,Ae,Ee,ce;if(console.log("[ProductRefinerStep5] handleFieldSubmit called",{outcomeIndex:O,field:H,valueLength:ae.trim().length,isSubmitting:x}),x){console.log("[ProductRefinerStep5] Already submitting, returning");return}const de=q.current||t;if(!(de!=null&&de.id)){p({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const re=ae.trim(),fe=m[H];if(!re){N(`${M[H]} is required`);return}if(re.length<fe){N(`${M[H]} must be at least ${fe} characters`);return}N(null),y(!0),R.current=ie(O,H);try{const we=[...U];we[O]||(we[O]={outcome:"",change:"",whyItMatters:"",howProductProduces:""}),we[O]={...we[O],[H]:re};const Te=we[O],Ue=((Se=Te.outcome)==null?void 0:Se.trim())&&((he=Te.change)==null?void 0:he.trim())&&((se=Te.whyItMatters)==null?void 0:se.trim())&&((J=Te.howProductProduces)==null?void 0:J.trim()),lt=we.filter(Ze=>{var ge,pe,ke,be;return((ge=Ze.outcome)==null?void 0:ge.trim())&&((pe=Ze.change)==null?void 0:pe.trim())&&((ke=Ze.whyItMatters)==null?void 0:ke.trim())&&((be=Ze.howProductProduces)==null?void 0:be.trim())});if(A.current=!0,Q(we),f&&f.getState().setStep5FormData(we),P(Ze=>new Set([...Ze,ie(O,H)])),lt.length>=3&&Ue)await Z(we.filter(Ze=>{var ge,pe,ke,be;return((ge=Ze.outcome)==null?void 0:ge.trim())&&((pe=Ze.change)==null?void 0:pe.trim())&&((ke=Ze.whyItMatters)==null?void 0:ke.trim())&&((be=Ze.howProductProduces)==null?void 0:be.trim())}));else{const Ze=T.indexOf(H);if(console.log("[ProductRefinerStep5] Moving to next question",{currentFieldIndex:Ze,fieldOrderLength:T.length,completeOutcomes:lt.length}),Ze<T.length-1){const ge=T[Ze+1],pe=Te[ge]||"";console.log("[ProductRefinerStep5] Moving to next field in same outcome",{nextField:ge,nextFieldValue:pe,outcomeIndex:O}),E.current={outcomeIndex:O,field:ge},C(O),B(ge),j(pe)}else if(lt.length<3){let ge=-1;for(let pe=0;pe<we.length;pe++){const ke=we[pe];if(!(((Pe=ke.outcome)==null?void 0:Pe.trim())&&(($e=ke.change)==null?void 0:$e.trim())&&((Ae=ke.whyItMatters)==null?void 0:Ae.trim())&&((Ee=ke.howProductProduces)==null?void 0:Ee.trim()))){ge=pe;break}}if(ge===-1&&we.length<3){const pe=we.length,ke=[...we,{outcome:"",change:"",whyItMatters:"",howProductProduces:""}];console.log("[ProductRefinerStep5] Adding new outcome",{newOutcomeIndex:pe,totalOutcomes:ke.length}),E.current={outcomeIndex:pe,field:"outcome"},Q(ke),C(pe),B("outcome"),j(""),setTimeout(()=>{y(!1),R.current=null},150);return}else if(ge>=0){console.log("[ProductRefinerStep5] Moving to existing incomplete outcome",{nextOutcomeIndex:ge}),E.current={outcomeIndex:ge,field:"outcome"},C(ge),B("outcome"),j(((ce=we[ge])==null?void 0:ce.outcome)||""),setTimeout(()=>{y(!1),R.current=null},150);return}else{console.log("[ProductRefinerStep5] All outcomes complete, submitting"),C(-1),B(null),j(""),await Z(lt);return}}else console.log("[ProductRefinerStep5] All outcomes complete, submitting"),C(-1),B(null),j(""),await Z(lt);setTimeout(()=>{y(!1),R.current=null},150)}}catch(we){y(!1),R.current=null;const Te=(we==null?void 0:we.message)||"Failed to save answer";N(Te),p({title:"Error",description:Te,variant:"destructive"})}},[U,t,p,M,T,Z,x,f]),oe=i.useRef(u),z=i.useRef(""),ee=i.useRef(!1),ne=i.useRef(le);i.useEffect(()=>{oe.current=u,ne.current=le},[u,le]),i.useEffect(()=>{if(!oe.current)return;const O=n&&!r&&W!==null&&k>=0,H=`${k}-${W}`,ae=JSON.stringify({shouldProvideHandlers:O,isActive:n,isCompleted:r,currentFieldKey:W,currentOutcomeIndex:k,currentQuestionKey:H,isSubmitting:x,validationError:b,outcomesLength:U.length}),de=z.current?JSON.parse(z.current):null,re=de==null?void 0:de.currentQuestionKey,fe=H!==re;if(z.current===ae&&!fe){if((de==null?void 0:de.currentInputValue)!==S&&W!==null){const he=M[W],se=m[W],J=k+1,Pe=Math.max(3,U.length),$e=S.trim(),Ae=$e.length>0&&$e.length<se;oe.current({inputValue:S,onInputChange:Ee=>{j(Ee),b&&Ee.trim().length>=se&&N(null)},onInputSubmit:()=>{W&&k>=0&&ne.current(k,W,S)},isSubmitting:x,placeholder:`Answer ${he.toLowerCase()} (Outcome ${J} of ${Pe})...`,currentQuestionKey:`${k}-${W}`,currentQuestionLabel:he,validationError:b,validationHint:Ae?`${he}  minimum ${se} characters`:null})}return}const Se=ee.current;if(z.current=ae,O){const he=M[W],se=m[W],J=k+1,Pe=Math.max(3,U.length),$e=()=>{W&&k>=0&&ne.current(k,W,S)},Ae=we=>{j(we),b&&we.trim().length>=se&&N(null)},Ee=S.trim(),ce=Ee.length>0&&Ee.length<se;oe.current({inputValue:S,onInputChange:Ae,onInputSubmit:$e,isSubmitting:x,placeholder:`Answer ${he.toLowerCase()} (Outcome ${J} of ${Pe})...`,currentQuestionKey:`${k}-${W}`,currentQuestionLabel:he,validationError:b,validationHint:ce?`${he}  minimum ${se} characters`:null}),ee.current=!0}else Se&&oe.current(null),ee.current=!1},[n,r,W,k,S,x,b,M,U.length]);const me=i.useRef(null),ve=i.useRef(g);if(i.useEffect(()=>{ve.current=g},[g]),i.useEffect(()=>{const O=ve.current;if(!O)return;if(r||!n){const Se=me.current;Se&&(Se.isCompleted!==r||Se.isActive!==n)&&(me.current=null,O(null));return}const H=W?`${k}-${W}`:null,ae=Array.from(V).sort(),de={currentQuestionKey:H,currentInputValue:S,answeredQuestions:ae,currentOutcomeIndex:k,currentFieldKey:W},re=me.current;(!re||re.currentQuestionKey!==de.currentQuestionKey||re.currentInputValue!==de.currentInputValue||re.answeredQuestions.length!==de.answeredQuestions.length||re.answeredQuestions.some((Se,he)=>Se!==de.answeredQuestions[he])||re.currentOutcomeIndex!==de.currentOutcomeIndex||re.currentFieldKey!==de.currentFieldKey||re.isCompleted!==r||re.isActive!==n)&&(me.current={currentQuestionKey:de.currentQuestionKey,currentInputValue:de.currentInputValue,answeredQuestions:[...de.answeredQuestions],currentOutcomeIndex:de.currentOutcomeIndex??0,currentFieldKey:de.currentFieldKey??null,isCompleted:r,isActive:n},O(de))},[k,W,S,V,r,n]),i.useEffect(()=>{var O,H,ae,de,re;if(!A.current){if(k>=0&&W!==null){const fe=(O=U[k])==null?void 0:O[W];if(!fe||!fe.trim())return}if(n&&!r){if(!d){for(let fe=0;fe<U.length;fe++)for(const Se of T)if(!((H=U[fe][Se])!=null&&H.trim())){`${fe}-${Se}`!==`${k}-${W}`&&(C(fe),B(Se),j(""));return}return}if(d.currentQuestionKey){const fe=d.currentQuestionKey.split("-");if(fe.length===2){const Se=parseInt(fe[0]),he=fe[1];if(!isNaN(Se)&&T.includes(he)){const se=(ae=U[Se])==null?void 0:ae[he];if(!se||!se.trim()){(k!==Se||W!==he)&&(C(Se),B(he),j(d.currentInputValue||""));return}}}}else if((d.currentOutcomeIndex!==void 0||d.currentFieldKey!==void 0)&&d.currentOutcomeIndex!==void 0){const fe=d.currentFieldKey?`${d.currentOutcomeIndex}-${d.currentFieldKey}`:null;if(fe){const Se=fe.split("-");if(Se.length===2){const he=parseInt(Se[0]),se=Se[1];if(!isNaN(he)&&T.includes(se)){const J=(de=U[he])==null?void 0:de[se];if(!J||!J.trim()){(k!==he||W!==se)&&(C(he),B(se),j(d.currentInputValue||""));return}}}}}for(let fe=0;fe<U.length;fe++)for(const Se of T)if(!((re=U[fe][Se])!=null&&re.trim())){`${fe}-${Se}`!==`${k}-${W}`&&(C(fe),B(Se),j(U[fe][Se]||""));return}}}},[n,r,d,U,T,k,W]),i.useEffect(()=>{if(!W||!c)return;const O=ie(k,W);G(H=>H[O]?H:{...H,[O]:!0})},[W,k,c]),!l&&!n&&!r)return null;const D=3,ue=T.length;return s.jsxs(s.Fragment,{children:[(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:r?s.jsx("p",{children:"Great! Your outcomes have been saved. Now let's translate your features into meaningful benefits."}):s.jsx(Ge,{text:"Now let's identify the outcomes your product delivers. We'll collect at least 3 outcomes, each with 4 details.",staggerMs:30})})}),U.map((O,H)=>{var he,se,J,Pe,$e,Ae,Ee,ce;const ae=H+1,de=H===k,re=v==null?void 0:v[H],fe=((he=O.outcome)==null?void 0:he.trim())||((se=O.change)==null?void 0:se.trim())||((J=O.whyItMatters)==null?void 0:J.trim())||((Pe=O.howProductProduces)==null?void 0:Pe.trim()),Se=re&&((($e=re.outcome)==null?void 0:$e.trim())||((Ae=re.change)==null?void 0:Ae.trim())||((Ee=re.whyItMatters)==null?void 0:Ee.trim())||((ce=re.howProductProduces)==null?void 0:ce.trim()));return s.jsxs("div",{className:"space-y-4",children:[(n||r)&&(de||fe||Se)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Outcome ",ae]})})}),T.map(we=>{var Ne;const Te=ie(H,we),Ue=v==null?void 0:v[H],lt=Ue==null?void 0:Ue[we],Ze=O[we],ge=(Ne=t.step5Outcomes)==null?void 0:Ne[H],pe=ge==null?void 0:ge[we],ke=lt||Ze||pe||"",je=!!(ke&&ke.trim())||V.has(Te),Re=de&&we===W,Y=M[we],te=H*ue+T.indexOf(we)+1,X=D*ue;return r||je||Re?s.jsxs("div",{className:"space-y-1",children:[(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",te," of ",X]}),r?s.jsx("p",{className:"text-base text-gray-900",children:Y}):s.jsx(Ge,{text:Y,chunkClassName:"text-base text-gray-900",staggerMs:30}),je&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})}),Re&&!r&&c&&we==="outcome"&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content p-0",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Example Inspiration"})]}),s.jsx("button",{type:"button",onClick:()=>{const Ce=ie(H,we);G(Ve=>({...Ve,[Ce]:!Ve[Ce]}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":K[ie(H,we)]?"Hide example":"Show example",children:K[ie(H,we)]?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]}),K[ie(H,we)]&&c&&s.jsxs("div",{className:"px-4 py-4 space-y-3",children:[s.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[s.jsxs("p",{children:[s.jsx("strong",{children:"Outcome:"})," ",c.outcome]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Change:"})," ",c.change]}),s.jsxs("p",{children:[s.jsx("strong",{children:"Why it matters:"})," ",c.whyItMatters]}),s.jsxs("p",{children:[s.jsx("strong",{children:"How product produces:"})," ",c.howProductProduces]})]}),s.jsx("div",{className:"text-xs text-gray-500",children:"Feel free to personalize this example before submitting."})]})]})})}),je&&ke&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:ke})})}),je&&x&&!r&&Te===R.current&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),s.jsx("p",{className:"text-sm",children:"Saving..."})]})})})]},we):null})]},H)}),r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 5 completed - Outcomes saved"})})}),!r&&n&&s.jsx("div",{className:"h-4","aria-hidden":!0})]})},L5=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1,onInputHandlersReady:c,persistedState:u,onPersistedStateChange:d})=>{const{toast:p}=yt(),f=Ra(e),w=!!(t.step6FeatureBenefitTable&&Array.isArray(t.step6FeatureBenefitTable)&&t.step6FeatureBenefitTable.length>0),v=(w||!!u)&&(f==null?void 0:f.getState().formData.step6)?(f==null?void 0:f.getState().formData.step6)??null:null,[x,y]=i.useState(!1),[b,N]=i.useState(null),[S,j]=i.useState((u==null?void 0:u.currentInputValue)||""),[k,C]=i.useState((u==null?void 0:u.currentEntryIndex)??0),[W,B]=i.useState((u==null?void 0:u.currentFieldKey)||null),[U,Q]=i.useState(()=>t.step6FeatureBenefitTable&&Array.isArray(t.step6FeatureBenefitTable)&&t.step6FeatureBenefitTable.length>0?t.step6FeatureBenefitTable:v&&Array.isArray(v)&&v.length>0?v:[{feature:"",benefit:"",emotionalBenefit:""}]),[V,P]=i.useState(u!=null&&u.answeredQuestions?new Set(u.answeredQuestions):new Set),K=i.useRef(t),G=i.useRef(!1),q=i.useMemo(()=>({feature:"What is the feature?",benefit:"What is the practical benefit?",emotionalBenefit:"What is the emotional benefit? (Optional  you can skip this)"}),[]),A=i.useMemo(()=>["feature","benefit","emotionalBenefit"],[]),E=i.useCallback(z=>["skip","no","n","leave it","leave","none","not needed","pass"].includes(z.trim().toLowerCase()),[]),R=(z,ee)=>`${z}-${ee}`;i.useEffect(()=>{K.current=t;const z=t.step6FeatureBenefitTable&&Array.isArray(t.step6FeatureBenefitTable)&&t.step6FeatureBenefitTable.length>0?t.step6FeatureBenefitTable:null,ee=(w||u)&&v&&Array.isArray(v)&&v.length>0?v:null,ne=z||ee;if(ne){Q(ne),f&&z&&f.getState().setStep6FormData(z);const me=new Set;ne.forEach((ve,D)=>{A.forEach(ue=>{var O;(O=ve[ue])!=null&&O.trim()&&me.add(`${D}-${ue}`)})}),u!=null&&u.answeredQuestions&&u.answeredQuestions.forEach(ve=>me.add(ve)),P(me)}},[t.step6FeatureBenefitTable,t,v,f,A,w,u]),i.useEffect(()=>{if((w||u)&&v&&Array.isArray(v)&&v.length>0){const z=v.some(ne=>{var me,ve,D;return((me=ne.feature)==null?void 0:me.trim())||((ve=ne.benefit)==null?void 0:ve.trim())||((D=ne.emotionalBenefit)==null?void 0:D.trim())}),ee=U.some(ne=>{var me,ve,D;return((me=ne.feature)==null?void 0:me.trim())||((ve=ne.benefit)==null?void 0:ve.trim())||((D=ne.emotionalBenefit)==null?void 0:D.trim())});if(z&&!ee){Q(v);const ne=new Set;v.forEach((me,ve)=>{A.forEach(D=>{var ue;(ue=me[D])!=null&&ue.trim()&&ne.add(`${ve}-${D}`)})}),P(ne)}}},[w,U,v,A,u]),i.useEffect(()=>{var z,ee,ne,me,ve,D,ue;if(G.current){G.current=!1;return}if(n&&!r){let O=0,H=null;for(let ae=0;ae<U.length;ae++){const de=U[ae];for(const re of A)if(re==="emotionalBenefit"){if(!((z=de.feature)!=null&&z.trim())||!((ee=de.benefit)!=null&&ee.trim()))if((ne=de.feature)!=null&&ne.trim()){if(!((me=de.benefit)!=null&&me.trim())){O=ae,H="benefit";break}}else{O=ae,H="feature";break}else if(!((ve=de.emotionalBenefit)!=null&&ve.trim())&&!V.has(R(ae,"emotionalBenefit"))){O=ae,H="emotionalBenefit";break}}else if(!((D=de[re])!=null&&D.trim())){O=ae,H=re;break}if(H)break}H&&(O!==k||H!==W)?(C(O),B(H),j(((ue=U[O])==null?void 0:ue[H])||"")):!H&&U.length>0&&U.filter(de=>{var re,fe;return((re=de.feature)==null?void 0:re.trim())&&((fe=de.benefit)==null?void 0:fe.trim())}).length>0&&(C(-1),B(null),j(""))}},[n,r,U,k,W,V,A]);const L=i.useCallback(async(z,ee,ne)=>{if(x)return;const me=K.current||t;if(!(me!=null&&me.id)){p({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const ve=ne.trim(),D=ee==="emotionalBenefit";if(!D){const fe=ee==="feature"?3:10;if(!ve){N(`${q[ee]} is required`);return}if(ve.length<fe){N(`${q[ee]} must be at least ${fe} characters`);return}}const ue=D&&(E(ve)||!ve);N(null),y(!0);const O=[...U];O[z]||(O[z]={feature:"",benefit:"",emotionalBenefit:""}),O[z]={...O[z],[ee]:ue?"":ve};const H=O.filter(fe=>{var Se,he;return((Se=fe.feature)==null?void 0:Se.trim())&&((he=fe.benefit)==null?void 0:he.trim())}),ae=A.indexOf(ee),de=ee==="emotionalBenefit"||ae===A.length-1,re=H.length>0&&de;G.current=!0,Q(O),f&&f.getState().setStep6FormData(O),P(fe=>new Set([...fe,R(z,ee)])),await I(O,z,ee,H.length>0),re||setTimeout(()=>{G.current=!1,y(!1)},200)},[U,t,p,q,A,E,x,f]),I=async(z,ee,ne,me)=>{var ve;if(ne){const D=A.indexOf(ne);if(ne==="emotionalBenefit"||D===A.length-1)if(me)C(-1),B(null),j(""),setTimeout(async()=>{await _(z.filter(ue=>{var O,H;return((O=ue.feature)==null?void 0:O.trim())&&((H=ue.benefit)==null?void 0:H.trim())}))},500);else{const ue=z.length,O={feature:"",benefit:"",emotionalBenefit:""},H=[...z,O];G.current=!0,Q(H),f&&f.getState().setStep6FormData(H),C(ue),B("feature"),j("")}else{const ue=A[D+1];G.current=!0,C(ee),B(ue),j(((ve=z[ee])==null?void 0:ve[ue])||"")}}else{const D=z.filter(ue=>{var O,H;return((O=ue.feature)==null?void 0:O.trim())&&((H=ue.benefit)==null?void 0:H.trim())});if(D.length>0)C(-1),B(null),j(""),await _(D);else{const ue=z.length,O={feature:"",benefit:"",emotionalBenefit:""};G.current=!0,Q([...z,O]),C(ue),B("feature"),j("")}}},_=async z=>{const ee=K.current||t;if(ee!=null&&ee.id){N(null),y(!0),o==null||o(null);try{await A5(ee.id,{featureBenefitTable:z});const ne={...ee,step6FeatureBenefitTable:z,step6Completed:!0,currentStep:7};a(ne),C(-1),B(null),j("")}catch(ne){const me=(ne==null?void 0:ne.message)||"Failed to submit feature-benefit table";o==null||o(me),p({title:"Submission failed",description:me,variant:"destructive"})}finally{y(!1)}}},$=i.useRef(c),F=i.useRef(""),M=i.useRef(!1),T=i.useRef(L);i.useEffect(()=>{$.current=c,T.current=L},[c,L]),i.useEffect(()=>{if(!$.current)return;const z=n&&!r&&W!==null&&k>=0,ee=JSON.stringify({shouldProvideHandlers:z,isActive:n,isCompleted:r,currentFieldKey:W,currentEntryIndex:k,currentInputValue:S,isSubmitting:x,validationError:b,featureBenefitTableLength:U.length});if(F.current===ee)return;const ne=M.current;if(F.current=ee,z){const me=q[W],ve=W==="emotionalBenefit",D=W==="feature"?3:10,ue=k+1,O=Math.max(1,U.length),H=()=>{W&&k>=0&&T.current(k,W,S)},ae=fe=>{j(fe),b&&(!ve||!E(fe))&&(fe.trim().length>=D||ve&&!fe.trim())&&N(null)},de=S.trim(),re=!ve&&de.length>0&&de.length<D;$.current({inputValue:S,onInputChange:ae,onInputSubmit:H,isSubmitting:x,placeholder:`Answer ${me.toLowerCase()} (Entry ${ue} of ${O})...`,currentQuestionKey:`${k}-${W}`,currentQuestionLabel:me,validationError:b,validationHint:re?`${me}  minimum ${D} characters`:null}),M.current=!0}else ne&&$.current(null),M.current=!1},[n,r,W,k,S,x,b,q,U.length,E]);const ie=i.useRef(null),Z=i.useRef(d);if(i.useEffect(()=>{Z.current=d},[d]),i.useEffect(()=>{const z=Z.current;if(!z)return;if(r||!n){const ue=ie.current;ue&&(ue.isCompleted!==r||ue.isActive!==n)&&(ie.current=null,z(null));return}const ee=W?`${k}-${W}`:null,ne=Array.from(V).sort(),me={currentQuestionKey:ee,currentInputValue:S,answeredQuestions:ne,currentEntryIndex:k,currentFieldKey:W},ve=ie.current;(!ve||ve.currentQuestionKey!==me.currentQuestionKey||ve.currentInputValue!==me.currentInputValue||ve.answeredQuestions.length!==me.answeredQuestions.length||ve.answeredQuestions.some((ue,O)=>ue!==me.answeredQuestions[O])||ve.currentEntryIndex!==me.currentEntryIndex||ve.currentFieldKey!==me.currentFieldKey||ve.isCompleted!==r||ve.isActive!==n)&&(ie.current={currentQuestionKey:me.currentQuestionKey,currentInputValue:me.currentInputValue,answeredQuestions:[...me.answeredQuestions],currentEntryIndex:me.currentEntryIndex??0,currentFieldKey:me.currentFieldKey??null,isCompleted:r,isActive:n},z(me))},[k,W,S,V,r,n]),i.useEffect(()=>{if(u&&n&&!r){const z=new Set;if(U.forEach((ee,ne)=>{A.forEach(me=>{var ve;(ve=ee[me])!=null&&ve.trim()&&z.add(`${ne}-${me}`)})}),u.answeredQuestions&&u.answeredQuestions.forEach(ee=>z.add(ee)),P(z),u.currentQuestionKey){const ee=u.currentQuestionKey.split("-");if(ee.length===2){const ne=parseInt(ee[0]),me=ee[1];!isNaN(ne)&&A.includes(me)&&(z.has(u.currentQuestionKey)||(C(ne),B(me),j(u.currentInputValue||"")))}}else if((u.currentEntryIndex!==void 0||u.currentFieldKey!==void 0)&&u.currentEntryIndex!==void 0){const ee=u.currentFieldKey?`${u.currentEntryIndex}-${u.currentFieldKey}`:null;if((!ee||!z.has(ee))&&(C(u.currentEntryIndex),u.currentFieldKey!==void 0&&u.currentFieldKey!==null)){const ne=u.currentFieldKey;A.includes(ne)&&(B(ne),j(u.currentInputValue||""))}}}},[u,n,r,U,A]),!l&&!n&&!r)return null;const le=A.length,oe=Math.max(1,U.length)*le;return s.jsxs(s.Fragment,{children:[(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:r?s.jsx("p",{children:"Excellent! Your feature-to-benefit translations are saved. Now let's build your complete value stack."}):s.jsx(Ge,{text:"Now let's translate your features into meaningful benefits. We'll collect at least one feature-benefit entry.",staggerMs:30})})}),U.map((z,ee)=>{const ne=ee+1,me=ee===k;return s.jsxs("div",{className:"space-y-4",children:[(()=>{var O,H,ae,de,re,fe;const ve=v==null?void 0:v[ee],D=((O=z.feature)==null?void 0:O.trim())||((H=z.benefit)==null?void 0:H.trim())||((ae=z.emotionalBenefit)==null?void 0:ae.trim()),ue=ve&&(((de=ve.feature)==null?void 0:de.trim())||((re=ve.benefit)==null?void 0:re.trim())||((fe=ve.emotionalBenefit)==null?void 0:fe.trim()));return(n||r)&&(me||D||ue)})()&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Entry ",ne]})})}),A.map(ve=>{var ce,we,Te;const D=R(ee,ve),ue=ve==="emotionalBenefit",O=v==null?void 0:v[ee],H=O==null?void 0:O[ve],ae=z[ve],de=(ce=t.step6FeatureBenefitTable)==null?void 0:ce[ee],re=de==null?void 0:de[ve],fe=H||ae||re||"";let he=!!(fe&&fe.trim())||V.has(D);!he&&r&&ue&&(he=!!((we=z.feature)!=null&&we.trim()&&((Te=z.benefit)!=null&&Te.trim())));const se=me&&ve===W,J=ee*le+A.indexOf(ve)+1,Pe=W?A.indexOf(W):-1,$e=k>=0&&Pe>=0?k*le+Pe+1:0;if(!(r||he||se||n&&$e>0&&J<=$e))return null;const Ee=q[ve];return s.jsxs("div",{className:"space-y-2",children:[(n||r||se)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",J," of ",oe]}),r?s.jsx("p",{className:"text-base text-gray-900",children:Ee}):s.jsx(Ge,{text:Ee,chunkClassName:"text-base text-gray-900",staggerMs:30}),ue&&!r&&s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."}),he&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})}),he&&s.jsxs(s.Fragment,{children:[fe&&fe.trim()?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:fe})})}):ue?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})}):null,x&&!r&&D===`${ee}-${ve}`&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),s.jsx("p",{className:"text-sm",children:"Saving..."})]})})})]})]},ve)})]},ee)}),r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 6 completed - Feature-benefit table saved"})})}),!r&&n&&s.jsx("div",{className:"h-8","aria-hidden":!0})]})},V5=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1,onInputHandlersReady:c,persistedState:u,onPersistedStateChange:d})=>{const{toast:m}=yt(),p=Ra(e),f=!!t.step7ValueStack,h=(f||!!u)&&(p==null?void 0:p.getState().formData.step7)?(p==null?void 0:p.getState().formData.step7)??null:null,[v,x]=i.useState(!1),[y,b]=i.useState(null),[N,S]=i.useState((u==null?void 0:u.currentInputValue)||""),[j,k]=i.useState((u==null?void 0:u.currentQuestionKey)||null),[C,W]=i.useState(()=>t.step7ValueStack?t.step7ValueStack:h||{components:[""],bonuses:[],supportElements:[],logistics:""}),[B,U]=i.useState(u!=null&&u.answeredQuestions?new Set(u.answeredQuestions):new Set),[Q,V]=i.useState(()=>u!=null&&u.questionOrder?u.questionOrder:[]),[P,K]=i.useState(()=>u!=null&&u.questionAnswers?u.questionAnswers:{}),[G,q]=i.useState(()=>{const D=new Set;return u!=null&&u.questionAnswers&&Object.entries(u.questionAnswers).forEach(([ue,O])=>{(!O||O.trim()===""||O.toLowerCase()==="no")&&(ue.startsWith("bonus-")||ue.startsWith("support-")||ue==="logistics"||ue==="ask-more-bonuses"||ue==="ask-more-support")&&D.add(ue)}),D}),A=i.useRef(t),E=i.useRef(!1),R=i.useCallback(D=>["skip","no","n","leave it","leave","none","not needed","pass","done"].includes(D.trim().toLowerCase()),[]),L=i.useCallback(D=>{const ue=D.trim().toLowerCase();return["yes","y","yeah","yep","yup","sure","ok","okay","add","add more","please","let's do it","continue"].includes(ue)},[]);i.useEffect(()=>{var H,ae,de,re;if(E.current)return;A.current=t;const D=t.step7ValueStack?t.step7ValueStack:null,O=D||((f||u)&&h?h:null);if(O){const fe=JSON.stringify(C),Se=JSON.stringify(O);if(fe!==Se){W(O),p&&D&&p.getState().setStep7FormData(D);const he=new Set;(H=O.components)==null||H.forEach((se,J)=>{se.trim()&&he.add(`component-${J}`)}),(ae=O.bonuses)==null||ae.forEach((se,J)=>{se.trim()&&he.add(`bonus-${J}`)}),(de=O.supportElements)==null||de.forEach((se,J)=>{se.trim()&&he.add(`support-${J}`)}),((re=O.logistics)!=null&&re.trim()||he.has("logistics-skipped"))&&he.add("logistics"),u!=null&&u.answeredQuestions&&u.answeredQuestions.forEach(se=>he.add(se)),U(he)}}},[t.step7ValueStack,t,h,p,f,u,C]),i.useEffect(()=>{var D,ue,O,H,ae,de,re,fe,Se,he,se,J;if((f||u)&&h){const Pe=((D=h.components)==null?void 0:D.some(Ae=>Ae.trim()))||((ue=h.bonuses)==null?void 0:ue.some(Ae=>Ae.trim()))||((O=h.supportElements)==null?void 0:O.some(Ae=>Ae.trim()))||((H=h.logistics)==null?void 0:H.trim()),$e=((ae=C.components)==null?void 0:ae.some(Ae=>Ae.trim()))||((de=C.bonuses)==null?void 0:de.some(Ae=>Ae.trim()))||((re=C.supportElements)==null?void 0:re.some(Ae=>Ae.trim()))||((fe=C.logistics)==null?void 0:fe.trim());if(Pe&&!$e){W(h);const Ae=new Set,Ee=h;(Se=Ee.components)==null||Se.forEach((ce,we)=>{ce.trim()&&Ae.add(`component-${we}`)}),(he=Ee.bonuses)==null||he.forEach((ce,we)=>{ce.trim()&&Ae.add(`bonus-${we}`)}),(se=Ee.supportElements)==null||se.forEach((ce,we)=>{ce.trim()&&Ae.add(`support-${we}`)}),(J=Ee.logistics)!=null&&J.trim()&&Ae.add("logistics"),U(Ae)}}},[f,C,h,u]),i.useEffect(()=>{if(!E.current&&n&&!r){const D=C.components||[""];if(D.filter(O=>O.trim().length>=5).length===0){const O=D.findIndex(H=>!H.trim());O>=0?(k(`component-${O}`),S(D[O]||"")):(k(`component-${D.length}`),S(""))}else I()}},[n,r,C]);const I=()=>{if((C.components||[]).filter(re=>re.trim().length>=5).length===0)return;if(!B.has("ask-more-bonuses")){k("ask-more-bonuses"),S("");return}const O=C.bonuses||[];if(O.some(re=>re.trim())&&!B.has(`bonus-${O.length-1}`)&&O[O.length-1].trim()){k("ask-more-bonuses"),S("");return}if(!B.has("ask-more-support")){k("ask-more-support"),S("");return}const ae=C.supportElements||[];if(ae.some(re=>re.trim())&&!B.has(`support-${ae.length-1}`)&&ae[ae.length-1].trim()){k("ask-more-support"),S("");return}if(!B.has("logistics")){k("logistics"),S(C.logistics||"");return}k(null),S(""),$()},_=i.useCallback(async(D,ue)=>{const O=A.current||t;if(!(O!=null&&O.id)){m({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const H=ue.trim();if(D.startsWith("component-")){const ae=parseInt(D.split("-")[1]);if(!H){b("Component is required");return}if(H.length<5){b("Component must be at least 5 characters");return}b(null),x(!0);try{const de=[...C.components||[]];de[ae]=H;const re={...C,components:de};W(re),p&&p.getState().setStep7FormData(re),U(fe=>new Set([...fe,D])),V(fe=>fe.includes(D)?fe:[...fe,D]),K(fe=>({...fe,[D]:H})),setTimeout(()=>{I(),x(!1)},100)}catch(de){x(!1),b((de==null?void 0:de.message)||"Failed to save component")}return}if(D==="ask-more-bonuses"){if(!H){b(null),x(!0),U(J=>new Set([...J,"ask-more-bonuses"]));const se="no";V(J=>J.includes("ask-more-bonuses")?J:[...J,"ask-more-bonuses"]),K(J=>({...J,"ask-more-bonuses":se})),q(J=>new Set([...J,"ask-more-bonuses"])),setTimeout(()=>{B.has("ask-more-support")?I():(k("ask-more-support"),S("")),x(!1)},100);return}const ae=R(H),de=L(H);if(!ae&&!de){b("Please respond with yes to add bonuses or no/skip to continue.");return}b(null),x(!0),U(se=>new Set([...se,"ask-more-bonuses"]));const re=ae?"no":"yes";if(V(se=>se.includes("ask-more-bonuses")?se:[...se,"ask-more-bonuses"]),K(se=>({...se,"ask-more-bonuses":re})),q(ae?se=>new Set([...se,"ask-more-bonuses"]):se=>{const J=new Set(se);return J.delete("ask-more-bonuses"),J}),ae){setTimeout(()=>{B.has("ask-more-support")?I():(k("ask-more-support"),S("")),x(!1)},100);return}E.current=!0;const fe=C.bonuses||[],Se=fe.length,he={...C,bonuses:[...fe,""]};W(he),k(`bonus-${Se}`),S(""),p&&p.getState().setStep7FormData(he),setTimeout(()=>{E.current=!1,x(!1)},200);return}if(D.startsWith("bonus-")){E.current=!0,x(!0),b(null);const ae=parseInt(D.split("-")[1]),re=[...C.bonuses||[]],fe=R(H)||!H;re[ae]=fe?"":H;const Se={...C,bonuses:re};W(Se),U(se=>new Set([...se,D]));const he=fe?"":H;V(se=>se.includes(D)?se:[...se,D]),K(se=>({...se,[D]:he})),q(fe?se=>new Set([...se,D]):se=>{const J=new Set(se);return J.delete(D),J}),p&&p.getState().setStep7FormData(Se),setTimeout(()=>{k("ask-more-bonuses"),S(""),E.current=!1,x(!1)},200);return}if(D==="ask-more-support"){if(!H){b(null),x(!0),U(J=>new Set([...J,"ask-more-support"]));const se="no";V(J=>J.includes("ask-more-support")?J:[...J,"ask-more-support"]),K(J=>({...J,"ask-more-support":se})),q(J=>new Set([...J,"ask-more-support"])),setTimeout(()=>{k("logistics"),S(C.logistics||""),x(!1)},100);return}const ae=R(H),de=L(H);if(!ae&&!de){b("Please respond with yes to add support elements or no/skip to continue.");return}b(null),x(!0),U(se=>new Set([...se,"ask-more-support"]));const re=ae?"no":"yes";if(V(se=>se.includes("ask-more-support")?se:[...se,"ask-more-support"]),K(se=>({...se,"ask-more-support":re})),q(ae?se=>new Set([...se,"ask-more-support"]):se=>{const J=new Set(se);return J.delete("ask-more-support"),J}),ae){setTimeout(()=>{k("logistics"),S(C.logistics||""),x(!1)},100);return}E.current=!0;const fe=C.supportElements||[],Se=fe.length,he={...C,supportElements:[...fe,""]};W(he),k(`support-${Se}`),S(""),p&&p.getState().setStep7FormData(he),setTimeout(()=>{E.current=!1,x(!1)},200);return}if(D.startsWith("support-")){E.current=!0,x(!0),b(null);const ae=parseInt(D.split("-")[1]),re=[...C.supportElements||[]],fe=R(H)||!H;re[ae]=fe?"":H;const Se={...C,supportElements:re};W(Se),U(se=>new Set([...se,D]));const he=fe?"":H;V(se=>se.includes(D)?se:[...se,D]),K(se=>({...se,[D]:he})),q(fe?se=>new Set([...se,D]):se=>{const J=new Set(se);return J.delete(D),J}),p&&p.getState().setStep7FormData(Se),setTimeout(()=>{k("ask-more-support"),S(""),E.current=!1,x(!1)},200);return}if(D==="logistics"){E.current=!0,b(null),x(!0);const ae=R(H)||!H,de=ae?"":H,re={...C,logistics:de};W(re),U(Se=>new Set([...Se,"logistics"]));const fe=de;V(Se=>Se.includes("logistics")?Se:[...Se,"logistics"]),K(Se=>({...Se,logistics:fe})),q(ae?Se=>new Set([...Se,"logistics"]):Se=>{const he=new Set(Se);return he.delete("logistics"),he}),p&&p.getState().setStep7FormData(re),setTimeout(()=>{E.current=!1,$()},300)}},[C,t,m,R,B]),$=async()=>{const D=A.current||t;if(!(D!=null&&D.id))return;const ue=(C.components||[]).filter(O=>O.trim().length>=5);if(ue.length===0){b("At least one component is required");const O=C.components||[""];k(`component-${O.length}`),S("");return}b(null),x(!0),o==null||o(null);try{await C5(D.id,{valueStack:{...C,components:ue}});const O={...D,step7ValueStack:{...C,components:ue},step7Completed:!0,currentStep:8};a(O),k(null),S("")}catch(O){const H=(O==null?void 0:O.message)||"Failed to submit value stack";o==null||o(H),m({title:"Submission failed",description:H,variant:"destructive"})}finally{E.current=!1,x(!1)}},F=i.useRef(c),M=i.useRef(""),T=i.useRef(!1),ie=i.useRef(_);i.useEffect(()=>{F.current=c,ie.current=_},[c,_]),i.useEffect(()=>{if(!F.current)return;const D=n&&!r&&j!==null,ue=JSON.stringify({shouldProvideHandlers:D,isActive:n,isCompleted:r,currentQuestionKey:j,currentInputValue:N,isSubmitting:v,validationError:y});if(M.current===ue)return;const O=T.current;if(M.current=ue,D){const H=se=>se.startsWith("component-")?`What is core component ${parseInt(se.split("-")[1])+1}?`:se==="ask-more-bonuses"?"Do you want to add any bonuses? (Optional  you can skip this)":se.startsWith("bonus-")?`What is bonus ${parseInt(se.split("-")[1])+1}? (Optional  you can skip this)`:se==="ask-more-support"?"Do you want to add any support elements? (Optional  you can skip this)":se.startsWith("support-")?`What is support element ${parseInt(se.split("-")[1])+1}? (Optional  you can skip this)`:se==="logistics"?"What are the logistics and delivery details? (Optional  you can skip this)":"",ae=j==="logistics"||j==="ask-more-bonuses"||j==="ask-more-support"||(j==null?void 0:j.startsWith("bonus-"))||(j==null?void 0:j.startsWith("support-")),de=j==="ask-more-bonuses"||j==="ask-more-support",re=()=>{j&&ie.current(j,N)},fe=se=>{if(S(se),!!y){if(de){(L(se)||R(se))&&b(null);return}(!ae||!R(se))&&b(null)}},Se=H(j);F.current({inputValue:N,onInputChange:fe,onInputSubmit:re,isSubmitting:v,placeholder:"Enter your answer...",currentQuestionKey:j,currentQuestionLabel:Se,validationError:y,validationHint:de?"Type yes to add more or no to continue.":null}),T.current=!0}else O&&F.current(null),T.current=!1},[n,r,j,N,v,y,R,L]);const Z=i.useRef(null),le=i.useRef(d);if(i.useEffect(()=>{le.current=d},[d]),i.useEffect(()=>{const D=le.current;if(!D)return;const ue=Array.from(B).sort();if(!(ue.length>0||j!=null||N&&N.trim().length>0||Q.length>0||Object.keys(P??{}).length>0)){Z.current&&(Z.current=null,D(null));return}const H={currentQuestionKey:j,currentInputValue:N,answeredQuestions:ue,questionOrder:Q,questionAnswers:P},ae=Z.current;(!ae||ae.currentQuestionKey!==H.currentQuestionKey||ae.currentInputValue!==H.currentInputValue||ae.answeredQuestions.length!==H.answeredQuestions.length||ae.answeredQuestions.some((re,fe)=>re!==H.answeredQuestions[fe])||JSON.stringify(ae.questionOrder)!==JSON.stringify(H.questionOrder)||JSON.stringify(ae.questionAnswers)!==JSON.stringify(H.questionAnswers)||ae.isCompleted!==r||ae.isActive!==n)&&(Z.current={currentQuestionKey:H.currentQuestionKey,currentInputValue:H.currentInputValue,answeredQuestions:[...H.answeredQuestions],questionOrder:H.questionOrder?[...H.questionOrder]:[],questionAnswers:H.questionAnswers?{...H.questionAnswers}:{},isCompleted:r,isActive:n},D(H))},[j,N,B,Q,P,r,n]),i.useEffect(()=>{var D;if(!E.current&&u){if(u.questionOrder&&u.questionOrder.length>0&&V(u.questionOrder),u.questionAnswers&&Object.keys(u.questionAnswers).length>0){K(u.questionAnswers);const de=new Set;Object.entries(u.questionAnswers).forEach(([re,fe])=>{(!fe||fe.trim()===""||fe.toLowerCase()==="no")&&(re.startsWith("bonus-")||re.startsWith("support-")||re==="logistics"||re==="ask-more-bonuses"||re==="ask-more-support")&&de.add(re)}),q(de)}const ue=new Set,O=C.components||[],H=C.bonuses||[],ae=C.supportElements||[];O.forEach((de,re)=>{de.trim()&&ue.add(`component-${re}`)}),H.forEach((de,re)=>{de.trim()&&ue.add(`bonus-${re}`)}),ae.forEach((de,re)=>{de.trim()&&ue.add(`support-${re}`)}),(D=C.logistics)!=null&&D.trim()&&ue.add("logistics"),u.questionAnswers&&(u.questionAnswers["ask-more-bonuses"]&&ue.add("ask-more-bonuses"),u.questionAnswers["ask-more-support"]&&ue.add("ask-more-support")),u.answeredQuestions&&u.answeredQuestions.forEach(de=>ue.add(de)),U(ue),u.currentQuestionKey&&!ue.has(u.currentQuestionKey)&&(k(u.currentQuestionKey),S(u.currentInputValue||""))}},[u,n,r,C]),!l&&!n&&!r)return null;const oe=C.components||[],z=C.bonuses||[],ee=C.supportElements||[],ne=D=>D.startsWith("component-")?`What is core component ${parseInt(D.split("-")[1])+1}?`:D.startsWith("bonus-")?`What is bonus ${parseInt(D.split("-")[1])+1}? (Optional  you can skip this)`:D.startsWith("support-")?`What is support element ${parseInt(D.split("-")[1])+1}? (Optional  you can skip this)`:D==="ask-more-bonuses"?"Do you want to add any bonuses? (Optional  you can skip this)":D==="ask-more-support"?"Do you want to add any support elements? (Optional  you can skip this)":D==="logistics"?"What are the logistics and delivery details? (Optional  you can skip this)":"",me=D=>{if(D.startsWith("component-")){const ue=parseInt(D.split("-")[1]);return oe[ue]||""}if(D.startsWith("bonus-")){const ue=parseInt(D.split("-")[1]);return z[ue]||""}if(D.startsWith("support-")){const ue=parseInt(D.split("-")[1]);return ee[ue]||""}return D==="logistics"?C.logistics||"":P[D]||""},ve=()=>{const D=[],ue=new Set;return r&&B.forEach(O=>{ue.has(O)||(D.push(O),ue.add(O))}),Q.forEach(O=>{ue.has(O)||(D.push(O),ue.add(O))}),oe.forEach((O,H)=>{const ae=`component-${H}`;!ue.has(ae)&&(B.has(ae)||n&&j===ae)&&(D.push(ae),ue.add(ae))}),(B.has("ask-more-bonuses")||n&&j==="ask-more-bonuses")&&!ue.has("ask-more-bonuses")&&(D.push("ask-more-bonuses"),ue.add("ask-more-bonuses")),z.forEach((O,H)=>{const ae=`bonus-${H}`;!ue.has(ae)&&(B.has(ae)||n&&j===ae)&&(D.push(ae),ue.add(ae))}),(B.has("ask-more-support")||n&&j==="ask-more-support")&&!ue.has("ask-more-support")&&(D.push("ask-more-support"),ue.add("ask-more-support")),ee.forEach((O,H)=>{const ae=`support-${H}`;!ue.has(ae)&&(B.has(ae)||n&&j===ae)&&(D.push(ae),ue.add(ae))}),(B.has("logistics")||n&&j==="logistics")&&!ue.has("logistics")&&(D.push("logistics"),ue.add("logistics")),j&&!ue.has(j)&&D.push(j),D.map((O,H)=>{const ae=B.has(O),de=n&&O===j,re=me(O),fe=P[O],Se=!!(re&&re.trim())||!!(fe&&fe.trim()),he=G.has(O)||ae&&!Se||O==="ask-more-bonuses"&&fe==="no"||O==="ask-more-support"&&fe==="no",se=O.startsWith("bonus-")||O.startsWith("support-")||O==="logistics"||O==="ask-more-bonuses"||O==="ask-more-support";if(!(r||ae||de||Q.includes(O)||fe!==void 0)&&!r)return null;const Pe=ne(O),$e=fe||re,Ae=O==="ask-more-bonuses"||O.startsWith("bonus-")&&parseInt(O.split("-")[1])===0,Ee=O==="ask-more-support"||O.startsWith("support-")&&parseInt(O.split("-")[1])===0,ce=Ae&&H===D.findIndex(lt=>lt==="ask-more-bonuses"||lt.startsWith("bonus-")),we=Ee&&H===D.findIndex(lt=>lt==="ask-more-support"||lt.startsWith("support-")),Te=O.startsWith("bonus-")&&parseInt(O.split("-")[1])===0&&z.length>0&&!ce,Ue=O.startsWith("support-")&&parseInt(O.split("-")[1])===0&&ee.length>0&&!we;return s.jsxs("div",{className:"space-y-4",children:[ce&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Bonuses"})})}),we&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Support Elements"})})}),Te&&z.length>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Bonuses"})})}),Ue&&ee.length>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Support Elements"})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:Pe}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:Pe,chunkClassName:"text-base text-gray-900",staggerMs:30}),se&&!r&&s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}),ae&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),ae&&s.jsx(s.Fragment,{children:he||se&&!$e.trim()?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:(O==="ask-more-bonuses"||O==="ask-more-support")&&fe==="no"?"No":"Skipped"})})}):$e.trim()?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:$e})})}):null})]},`${O}-${H}`)})};return s.jsxs(s.Fragment,{children:[(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:r?s.jsx("p",{children:"Perfect! Your value stack is complete. Now let's add proof and credibility elements to support your offer."}):s.jsx(Ge,{text:"Now let's build your complete value stack. We'll start with core components, then optionally add bonuses, support elements, and logistics.",staggerMs:30})})}),ve(),r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 7 completed - Value stack saved"})})}),!r&&n&&s.jsx("div",{className:"h-24","aria-hidden":!0})]})},ra=["testimonial","screenshot","case_study","visual","track_record"],jr={testimonial:"Testimonial",screenshot:"Screenshot",case_study:"Case Study",visual:"Visual",track_record:"Track Record"},B5=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1,onInputHandlersReady:c,persistedState:u,onPersistedStateChange:d})=>{var ge;const{toast:m}=yt(),[p,f]=i.useState(!1),w=Ra(e),h=!!(t.step8ProofElements&&t.step8ProofElements.proofElements&&t.step8ProofElements.proofElements.length>0),x=(h||!!u)&&(w==null?void 0:w.getState().formData.step8)?(w==null?void 0:w.getState().formData.step8)??null:null,[y,b]=i.useState(null),[N,S]=i.useState((u==null?void 0:u.currentInputValue)||""),[j,k]=i.useState((u==null?void 0:u.currentQuestionKey)||null),[C,W]=i.useState(()=>h&&t.step8ProofElements?t.step8ProofElements.proofElements||[{type:"",description:"",url:""}]:x!=null&&x.proofElements&&x.proofElements.length>0?x.proofElements:[{type:"",description:"",url:""}]),[B,U]=i.useState(()=>h&&t.step8ProofElements?t.step8ProofElements.notes||"":x!=null&&x.notes?x.notes:""),[Q,V]=i.useState(u!=null&&u.answeredQuestions?new Set(u.answeredQuestions):new Set),[P,K]=i.useState([]),[G,q]=i.useState(!0),[A,E]=i.useState(!1),[R,L]=i.useState({}),[I,_]=i.useState(()=>u!=null&&u.questionAnswers?u.questionAnswers:{}),[$,F]=i.useState(()=>{const pe=new Set;return u!=null&&u.questionAnswers&&Object.entries(u.questionAnswers).forEach(([ke,be])=>{(!be||be.trim()===""||be.toLowerCase()==="no")&&(ke.endsWith("-url")||ke==="notes"||ke==="ask-more-proof")&&pe.add(ke)}),pe}),M=i.useRef(t),T=i.useRef(C),ie=i.useRef(Q),Z=i.useRef($),le=i.useRef(I),oe=i.useRef(null),z=i.useRef(!1),ee=i.useRef(null),ne=i.useRef(!1),[me,ve]=i.useState(()=>!!(u!=null&&u.isFinalizing&&!t.step8Completed)),D=i.useRef(null);i.useEffect(()=>{if(w)return D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{w.getState().setStep8FormData({proofElements:C,notes:B})},100),()=>{D.current&&clearTimeout(D.current)}},[w,C,B]),i.useEffect(()=>{T.current=C},[C]),i.useEffect(()=>{ie.current=Q},[Q]),i.useEffect(()=>{Z.current=$},[$]),i.useEffect(()=>{le.current=I},[I]);const ue=i.useCallback(pe=>["skip","no","n","leave it","leave","none","not needed","pass","done"].includes(pe.trim().toLowerCase()),[]),O=i.useCallback(pe=>{const ke=pe.trim().toLowerCase();return["yes","y","yeah","yep","yup","sure","ok","okay","add","add more","please","let's do it","continue"].includes(ke)},[]),H=i.useRef(""),ae=i.useRef(!1);i.useEffect(()=>{var Re;if(z.current)return;M.current=t;const pe=x?JSON.stringify(x):"",ke=u?JSON.stringify({currentQuestionKey:u.currentQuestionKey,answeredQuestionsLength:(Re=u.answeredQuestions)==null?void 0:Re.length}):"",be=`${(t==null?void 0:t.id)||""}-${h}-${pe}-${ke}`;if(H.current===be&&ae.current)return;H.current=be,ae.current=!0;const je=Y=>{var X,ye;const te=new Set;return(X=Y.proofElements)==null||X.forEach((Ne,Ce)=>{var Ve,tt;Ne.type&&te.add(`proof-${Ce}-type`),(Ve=Ne.description)!=null&&Ve.trim()&&te.add(`proof-${Ce}-description`),(tt=Ne.url)!=null&&tt.trim()&&te.add(`proof-${Ce}-url`)}),(ye=Y.notes)!=null&&ye.trim()&&te.add("notes"),u!=null&&u.answeredQuestions&&u.answeredQuestions.forEach(Ne=>te.add(Ne)),u!=null&&u.questionAnswers&&Object.keys(u.questionAnswers).forEach(Ne=>{te.add(Ne)}),te};if(h&&t.step8ProofElements){const Y=t.step8ProofElements,te=Y.proofElements||[],X=Y.notes||"",ye=JSON.stringify(C),Ne=JSON.stringify(te.length>0?te:[{type:"testimonial",description:"",url:""}]);(ye!==Ne||(B||"")!==X)&&(W(te.length>0?te:[{type:"testimonial",description:"",url:""}]),U(X),V(je({proofElements:te,notes:X})),w&&w.getState().setStep8FormData({proofElements:te,notes:X}));return}if(u&&x){const Y=x.proofElements||[],te=x.notes||"",X=JSON.stringify(C),ye=JSON.stringify(Y.length>0?Y:[{type:"testimonial",description:"",url:""}]);(X!==ye||(B||"")!==te)&&(W(Y.length>0?Y:[{type:"testimonial",description:"",url:""}]),U(te),V(je({proofElements:Y,notes:te})));return}if(!u&&!ae.current){const Y=JSON.stringify(C),te=JSON.stringify([{type:"testimonial",description:"",url:""}]);(Y!==te||B!=="")&&(W([{type:"testimonial",description:"",url:""}]),U(""),V(new Set),k(null),S(""))}},[t==null?void 0:t.id,h]);const de=i.useCallback(()=>{for(let ke=0;ke<C.length;ke++){const be=C[ke];if(!Q.has(`proof-${ke}-type`)){k(`proof-${ke}-type`),S("");return}if(!Q.has(`proof-${ke}-description`)){k(`proof-${ke}-description`),S(be.description||"");return}if(!Q.has(`proof-${ke}-url`)){k(`proof-${ke}-url`),S(be.url||"");return}}const pe=C.filter(ke=>{var be;return ke.type&&((be=ke.description)==null?void 0:be.trim())&&ke.description.trim().length>=10});if(pe.length!==0){if(!Q.has("review-proof")&&pe.length>0){k("review-proof"),S("");return}if(!Q.has("ask-more-proof")&&Q.has("review-proof")){k("ask-more-proof"),S("");return}if(!Q.has("notes")){k("notes"),S(B||"");return}k(null),S(""),$e.current&&$e.current()}},[C,Q,B]),re=i.useRef(de);i.useEffect(()=>{re.current=de},[de]);const fe=i.useCallback(pe=>{V(ke=>{const be=new Set(ke);return be.delete(`proof-${pe}-type`),be.delete(`proof-${pe}-description`),be.delete(`proof-${pe}-url`),be}),F(ke=>{if(!ke.has(`proof-${pe}-url`))return ke;const be=new Set(ke);return be.delete(`proof-${pe}-url`),be}),_(ke=>{const be={...ke};return delete be[`proof-${pe}-type`],delete be[`proof-${pe}-description`],delete be[`proof-${pe}-url`],be})},[]),Se=i.useCallback((pe,ke)=>{const be=`proof-${pe}-${ke}`;if(!ie.current.has(be)){const je=T.current[pe],Re=ke==="description"?(je==null?void 0:je.description)||"":(je==null?void 0:je.url)||"";return k(be),S(Re),!0}return!1},[]),he=i.useRef(!1),se=i.useRef(null);i.useEffect(()=>{z.current||he.current||j!==null&&(!Q.has(j)||se.current===j)||n&&!r&&(he.current=!0,re.current(),se.current=j,setTimeout(()=>{he.current=!1},100))},[n,r,C,B,Q,j]);const J=i.useCallback(async(pe,ke)=>{if(p||ee.current===pe)return;const be=M.current||t;if(!(be!=null&&be.id)){m({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const je=ke.trim();if(pe.startsWith("proof-")&&pe.endsWith("-type")){const Re=parseInt(pe.split("-")[1]),Y=je.toLowerCase().replace(/[_\s]/g,"_"),te=ra.find(X=>X===Y||X.replace(/_/g," ")===je.toLowerCase()||jr[X].toLowerCase()===je.toLowerCase());if(!te){b(`Please enter one of: ${ra.map(X=>jr[X]).join(", ")}`);return}b(null),f(!0),ee.current=pe,z.current=!0;try{const X=[...C];X[Re]={...X[Re],type:te},W(X),V(ye=>new Set([...ye,pe])),w&&w.getState().setStep8FormData({proofElements:X,notes:B}),setTimeout(()=>{z.current=!1,f(!1),ee.current=null,Se(Re,"description")||(he.current=!0,re.current(),setTimeout(()=>{he.current=!1},100))},200)}catch(X){z.current=!1,f(!1),ee.current=null,b((X==null?void 0:X.message)||"Failed to save proof type")}return}if(pe.startsWith("proof-")&&pe.endsWith("-description")){const Re=parseInt(pe.split("-")[1]);if(!je){b("Description is required");return}if(je.length<10){b("Description must be at least 10 characters");return}b(null),f(!0),ee.current=pe,z.current=!0;try{const Y=[...C];Y[Re]={...Y[Re],description:je},W(Y),V(te=>new Set([...te,pe])),w&&w.getState().setStep8FormData({proofElements:Y,notes:B}),setTimeout(()=>{z.current=!1,f(!1),ee.current=null,Se(Re,"url")||(he.current=!0,re.current(),setTimeout(()=>{he.current=!1},100))},200)}catch(Y){z.current=!1,f(!1),ee.current=null,b((Y==null?void 0:Y.message)||"Failed to save description")}return}if(pe.startsWith("proof-")&&pe.endsWith("-url")){z.current=!0;const Re=parseInt(pe.split("-")[1]);f(!0),b(null),ee.current=pe;const Y=ue(je)||!je,te=[...C];te[Re]={...te[Re],url:Y?"":je},Y?(F(X=>new Set([...X,pe])),_(X=>({...X,[pe]:""}))):(F(X=>{const ye=new Set(X);return ye.delete(pe),ye}),_(X=>({...X,[pe]:je}))),W(te),V(X=>new Set([...X,pe])),setTimeout(()=>{if(z.current=!1,f(!1),ee.current=null,oe.current==="yes"){oe.current=null,V(X=>{const ye=new Set(X);return ye.delete("ask-more-proof"),ye}),F(X=>{if(!X.has("ask-more-proof"))return X;const ye=new Set(X);return ye.delete("ask-more-proof"),ye}),k("ask-more-proof"),S("");return}he.current=!0,re.current(),setTimeout(()=>{he.current=!1},100)},200);return}if(pe==="review-proof"){z.current=!0,b(null),f(!0);const Re=new Set(C.map(ye=>ye.type).filter(Boolean)),te=ra.map(ye=>ye).filter(ye=>!Re.has(ye)),X=[];te.includes("testimonial")&&X.push("Consider adding customer testimonials to build trust and credibility"),te.includes("case_study")&&X.push("Case studies showing real results can significantly increase conversion"),te.includes("screenshot")&&X.push("Screenshots of your product or results provide visual proof"),te.includes("visual")&&X.push("Visual elements like charts or infographics make your proof more compelling"),te.includes("track_record")&&X.push("Track record information (years in business, clients served) establishes authority"),K(X),V(ye=>new Set([...ye,"review-proof"])),_(ye=>({...ye,"review-proof":"reviewed"})),setTimeout(()=>{k("ask-more-proof"),S(""),z.current=!1,f(!1)},200);return}if(pe==="ask-more-proof"){const Re=O(je),Y=ue(je)||!je&&!Re;if(!Y&&!Re){b("Please respond with yes to add more proof or no/skip to continue.");return}b(null),f(!0),ee.current=pe,V(X=>new Set([...X,"ask-more-proof"]));const te=Re?"yes":"no";if(_(X=>({...X,"ask-more-proof":te})),oe.current=Re?"yes":null,F(Y?X=>new Set([...X,"ask-more-proof"]):X=>{const ye=new Set(X);return ye.delete("ask-more-proof"),ye}),z.current=!0,Re){const X=C.length,ye=[...C,{type:"",description:"",url:""}];W(ye),fe(X),w&&w.getState().setStep8FormData({proofElements:ye,notes:B}),setTimeout(()=>{k(`proof-${X}-type`),S(""),z.current=!1,f(!1),ee.current=null},200)}else setTimeout(()=>{k("notes"),S(B||""),z.current=!1,f(!1),ee.current=null},200);return}if(pe==="notes"){z.current=!0,b(null),f(!0),ee.current=pe;const Re=ue(je)||!je,Y=Re?"":je;Re?(F(te=>new Set([...te,"notes"])),_(te=>({...te,notes:""}))):(F(te=>{const X=new Set(te);return X.delete("notes"),X}),_(te=>({...te,notes:je}))),U(Y),V(te=>new Set([...te,"notes"])),w&&w.getState().setStep8FormData({proofElements:C,notes:Y}),setTimeout(()=>{ee.current=null,Ae()},200);return}},[C,B,t,m,ue,Q,p,O]),Pe=i.useRef(J);i.useEffect(()=>{Pe.current=J},[J]),i.useEffect(()=>{if(n&&!r&&j==="review-proof"&&!Q.has("review-proof")&&!p){const pe=setTimeout(()=>{Pe.current("review-proof","")},500);return()=>clearTimeout(pe)}},[n,r,j,Q,p]);const $e=i.useRef(),Ae=i.useCallback(async()=>{const pe=M.current||t;if(!(pe!=null&&pe.id)){z.current=!1;return}const ke=C.filter(be=>{var je;return be.type&&((je=be.description)==null?void 0:je.trim())&&be.description.trim().length>=10});if(ke.length===0){z.current=!1,b("At least one complete proof element is required"),C.length===0&&W([{type:"",description:"",url:""}]),k("proof-0-type"),S(""),f(!1);return}b(null),f(!0),ve(!0),o==null||o(null);try{const be=await E5(pe.id,{proofElements:ke,notes:B.trim()||void 0});if(be.missingProof&&Array.isArray(be.missingProof)){const Re=be.missingProof.map(Y=>typeof Y=="string"?Y:Y.suggestion||Y.type||"").filter(Boolean);Re.length>0&&K(Re)}const je={...pe,step8ProofElements:{proofElements:ke,notes:B.trim()||void 0},step8Completed:!0,currentStep:9};a(je),k(null),S("")}catch(be){const je=(be==null?void 0:be.message)||"Failed to submit proof elements";o==null||o(je),m({title:"Submission failed",description:je,variant:"destructive"})}finally{z.current=!1,f(!1),ve(!1),ee.current=null,ne.current=!1}},[t,a,o,m,C,B]);i.useEffect(()=>{$e.current=Ae},[Ae]),i.useEffect(()=>{var pe;n&&!r&&(u!=null&&u.isFinalizing)&&!t.step8Completed&&!ne.current&&(ne.current=!0,ve(!0),(pe=$e.current)==null||pe.call($e))},[n,r,u==null?void 0:u.isFinalizing,t.step8Completed]);const Ee=i.useRef(c),ce=i.useRef(J);i.useEffect(()=>{Ee.current=c,ce.current=J},[c,J]),i.useEffect(()=>{if(!Ee.current)return;if(n&&!r&&j!==null&&!me){const ke=Ne=>Ne.startsWith("proof-")&&Ne.endsWith("-type")?`What type of proof is element ${parseInt(Ne.split("-")[1])+1}? You can type: ${ra.map(Ve=>jr[Ve]).join(", ")}`:Ne.startsWith("proof-")&&Ne.endsWith("-description")?`What is the description for proof element ${parseInt(Ne.split("-")[1])+1}?`:Ne.startsWith("proof-")&&Ne.endsWith("-url")?`What is the URL for proof element ${parseInt(Ne.split("-")[1])+1}? (Optional  you can skip this)`:Ne==="review-proof"?"Let me review your proof elements and suggest what might be missing...":Ne==="ask-more-proof"?"Would you like to add more proof elements? (Optional  you can skip this)":Ne==="notes"?"Any additional notes? (Optional  you can skip this)":"",be=(j==null?void 0:j.endsWith("-url"))||j==="notes"||j==="ask-more-proof",je=j==="ask-more-proof",Re=j==="review-proof",Y=()=>{if(j){if(Re){ce.current(j,"");return}ce.current(j,N)}},te=Ne=>{if(S(Ne),!!y){if(je){(O(Ne)||ue(Ne))&&b(null);return}(!be||!ue(Ne))&&b(null)}},X=ke(j),ye=j!=null&&j.endsWith("-type")?`Type one of: ${ra.map(Ne=>jr[Ne]).join(", ")}`:"Enter your answer...";Ee.current({inputValue:Re?"":N,onInputChange:te,onInputSubmit:Y,isSubmitting:p,placeholder:Re?"":ye,currentQuestionKey:j,currentQuestionLabel:X,validationError:y,validationHint:je?"Type yes to add more or no to continue.":null})}else Ee.current(null)},[n,r,j,N,p,y,ue,O]);const we=i.useRef(null),Te=i.useRef(d);i.useEffect(()=>{Te.current=d},[d]);const Ue=i.useRef(0),lt=i.useRef("");i.useEffect(()=>{const pe=Te.current;if(!pe)return;const ke=Array.from(Q).sort(),be=JSON.stringify(ke);if(!(ke.length>0||j!=null||N&&N.trim().length>0||Object.keys(I??{}).length>0||me)){we.current&&(we.current=null,pe(null));return}if(Q.size===Ue.current&&be===lt.current&&we.current){const X=we.current;if(X.currentQuestionKey===j&&X.currentInputValue===N&&X.isCompleted===r&&X.isActive===n&&X.isFinalizing===me&&JSON.stringify(X.questionAnswers)===JSON.stringify(I))return}Ue.current=Q.size,lt.current=be;const Re={currentQuestionKey:j,currentInputValue:N,answeredQuestions:ke,questionAnswers:I,isFinalizing:me},Y=we.current;(!Y||Y.currentQuestionKey!==Re.currentQuestionKey||Y.currentInputValue!==Re.currentInputValue||Y.answeredQuestions.length!==Re.answeredQuestions.length||Y.answeredQuestions.some((X,ye)=>X!==Re.answeredQuestions[ye])||JSON.stringify(Y.questionAnswers)!==JSON.stringify(Re.questionAnswers)||Y.isCompleted!==r||Y.isActive!==n||Y.isFinalizing!==me)&&(we.current={currentQuestionKey:Re.currentQuestionKey,currentInputValue:Re.currentInputValue,answeredQuestions:[...Re.answeredQuestions],questionAnswers:Re.questionAnswers?{...Re.questionAnswers}:{},isCompleted:r,isActive:n,isFinalizing:me},pe(Re))},[j,N,Q.size,I,r,n,me]);const Ze=i.useRef("");return i.useEffect(()=>{var pe;if(!z.current&&u){const ke=JSON.stringify({currentQuestionKey:u.currentQuestionKey,answeredQuestions:(pe=u.answeredQuestions)==null?void 0:pe.sort()});if(Ze.current===ke)return;if(Ze.current=ke,u.questionAnswers&&Object.keys(u.questionAnswers).length>0){_(u.questionAnswers);const Y=new Set;Object.entries(u.questionAnswers).forEach(([te,X])=>{(!X||X.trim()===""||X.toLowerCase()==="no")&&(te.endsWith("-url")||te==="notes"||te==="ask-more-proof")&&Y.add(te)}),F(Y)}const be=new Set;C.forEach((Y,te)=>{var X,ye;Y.type&&be.add(`proof-${te}-type`),(X=Y.description)!=null&&X.trim()&&be.add(`proof-${te}-description`),(ye=Y.url)!=null&&ye.trim()&&be.add(`proof-${te}-url`)}),B!=null&&B.trim()&&be.add("notes"),u.questionAnswers&&(u.questionAnswers["review-proof"]&&be.add("review-proof"),u.questionAnswers["ask-more-proof"]&&be.add("ask-more-proof")),u.answeredQuestions&&u.answeredQuestions.forEach(Y=>be.add(Y));const je=Array.from(Q).sort(),Re=Array.from(be).sort();JSON.stringify(je)!==JSON.stringify(Re)&&V(be),u.currentQuestionKey&&!be.has(u.currentQuestionKey)&&(k(u.currentQuestionKey),S(u.currentInputValue||""))}},[u==null?void 0:u.currentQuestionKey,(ge=u==null?void 0:u.answeredQuestions)==null?void 0:ge.length,n,r]),!l&&!n&&!r?null:(i.useEffect(()=>{n&&!r&&!A&&E(!0)},[n,r,A]),s.jsxs(s.Fragment,{children:[(n||r)&&G&&!r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-3",children:[s.jsx(Ge,{text:"Why proof matters: Evidence builds trust and credibility. When prospects see real testimonials, case studies, screenshots, or track records, they're more likely to believe your claims and take action. Let's collect proof elements to support your offer.",staggerMs:30}),s.jsx("button",{onClick:()=>q(!1),className:"mt-2 text-xs text-gray-500 hover:text-gray-700 underline",children:"Got it, continue"})]})})}),(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:r?s.jsx("p",{children:"Perfect! Your proof elements are saved. Now let's set up your pricing structure."}):s.jsx(Ge,{text:"Now let's add proof and credibility elements. We'll collect proof elements such as testimonials, screenshots, case studies, visuals, or track record information.",staggerMs:30})})}),C.map((pe,ke)=>{const be=ke+1,je=(j==null?void 0:j.startsWith(`proof-${ke}-`))||!1,Re=!!pe.type||!!(pe.description&&pe.description.trim())||!!(pe.url&&pe.url.trim());return s.jsxs("div",{className:"space-y-4",children:[(n||r)&&(je||Re)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Proof Element ",be]})})}),(()=>{const Y=`proof-${ke}-type`,te=!!pe.type,X=Q.has(Y)||te,ye=n&&Y===j;return r||ye||X?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What type of proof is element ",be,"? You can type: ",ra.map(Ce=>jr[Ce]).join(", ")]}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:`What type of proof is element ${be}?`,chunkClassName:"text-base text-gray-900",staggerMs:30}),ye&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:ra.map(Ce=>s.jsx("button",{onClick:()=>{p||J(Y,jr[Ce])},className:"px-3 py-1 text-xs font-medium rounded-full bg-gray-100 hover:bg-gray-200 text-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:p,children:jr[Ce]},Ce))}),s.jsx("p",{className:"text-xs text-gray-500 mt-2 italic",children:"Click a button above or type the name"})]})]}),X&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),te&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700",children:jr[pe.type]||pe.type})})})]},Y):null})(),(()=>{const Y=`proof-${ke}-description`,te=!!(pe.description&&pe.description.trim()),X=Q.has(Y)||te;return r||n&&Y===j||X?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What is the description for proof element ",be,"?"]}):s.jsx(Ge,{text:`What is the description for proof element ${be}?`,chunkClassName:"text-base text-gray-900",staggerMs:30}),X&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),te&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:pe.description})})})]},Y):null})(),(()=>{const Y=`proof-${ke}-url`,te=!!(pe.url&&pe.url.trim()),ye=Q.has(Y)||te,Ne=n&&Y===j,Ce=$.has(Y)||ye&&!te;return r||Ne||ye?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What is the URL for proof element ",be,"? (Optional  you can skip this)"]}):Y===j?s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:`What is the URL for proof element ${be}? (Optional  you can skip this)`,chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}):null,ye&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),ye&&s.jsx(s.Fragment,{children:te&&!Ce?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:pe.url})})}):Ce?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})}):null})]},Y):null})()]},ke)}),(()=>{const pe=I==null?void 0:I["review-proof"],ke=P.length>0,be=Q.has("review-proof")||!!pe||ke,je=n&&j==="review-proof";return r||be||je?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"Let me review your proof elements and suggest what might be missing..."}):je?s.jsx(Ge,{text:"Let me review your proof elements and suggest what might be missing...",chunkClassName:"text-base text-gray-900",staggerMs:30}):null,be&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Reviewed"})]})})}),ke&&(be||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content p-0",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Proof Suggestions"})]}),s.jsx("button",{type:"button",onClick:()=>{L(Y=>({...Y,suggestions:!Y.suggestions}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":R.suggestions?"Hide suggestions":"Show suggestions",children:R.suggestions?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]}),R.suggestions&&s.jsxs("div",{className:"px-4 py-4 space-y-3",children:[s.jsx("div",{className:"space-y-2 text-sm text-gray-700",children:P.map((Y,te)=>s.jsxs("p",{children:[" ",Y]},te))}),s.jsx("div",{className:"text-xs text-gray-500",children:"Consider adding these types of proof to strengthen your offer."})]})]})})}),(()=>{const Y=I==null?void 0:I["ask-more-proof"],te=Q.has("ask-more-proof"),X=n&&j==="ask-more-proof",ye=!!Y;return r||te||X||$.has("ask-more-proof")||ye?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"Would you like to add more proof elements? (Optional  you can skip this)"}):X?s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:"Would you like to add more proof elements? (Optional  you can skip this)",chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"Type yes to add more or no to continue."})]}):null,te&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),te&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:(()=>{const Ce=(I==null?void 0:I["ask-more-proof"])||"";return $.has("ask-more-proof")||Ce==="no"?"No, continue":O(Ce)?"Yes, add more":"No, continue"})()})})})]}):null})()]}):null})(),B!==void 0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"Any additional notes? (Optional  you can skip this)"}):j==="notes"?s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:"Any additional notes? (Optional  you can skip this)",chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}):null,Q.has("notes")||$.has("notes")||!!(B&&B.trim())?s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"}):null]})})}),(()=>{if(!(Q.has("notes")||$.has("notes")||!!(B&&B.trim())))return null;const ke=$.has("notes")||!(B!=null&&B.trim());return B!=null&&B.trim()&&!ke?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:B})})}):s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})})})()]}),me&&!r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Saving your proof elements..."}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Please wait while we save your proof elements and move to the next step."})]})]})})}),r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 8 completed - Proof elements saved"})})}),!r&&n&&!me&&s.jsx("div",{className:"h-24","aria-hidden":!0})]}))},W5=({workspaceId:e,session:t,isActive:n,isCompleted:r,onSessionChange:a,onError:o,isUnlocked:l=!1,pricingNarrative:c,onInputHandlersReady:u,persistedState:d,onPersistedStateChange:g})=>{const{toast:m}=yt(),[p,f]=i.useState(!1),w=Ra(e),h=!!t.step9Pricing,x=(h||!!d)&&(w==null?void 0:w.getState().formData.step9)?(w==null?void 0:w.getState().formData.step9)??null:null,[y,b]=i.useState(null),[N,S]=i.useState((d==null?void 0:d.currentInputValue)||""),[j,k]=i.useState((d==null?void 0:d.currentQuestionKey)||null),C=(h&&t.step9Pricing?t.step9Pricing:x)??null,[W,B]=i.useState(()=>(C==null?void 0:C.standardPrice)!=null&&C.standardPrice!==""?String(C.standardPrice):""),[U,Q]=i.useState(()=>(C==null?void 0:C.standardPriceDescription)||""),[V,P]=i.useState(()=>C!=null&&C.paymentPlans?[...C.paymentPlans]:[]),[K,G]=i.useState(()=>C!=null&&C.tiers?[...C.tiers]:[]),[q,A]=i.useState(()=>(C==null?void 0:C.pricingNarrative)||""),[E,R]=i.useState(d!=null&&d.answeredQuestions?new Set(d.answeredQuestions):new Set),[L,I]=i.useState(()=>d!=null&&d.questionAnswers?d.questionAnswers:{}),[_,$]=i.useState(()=>{const J=new Set;return d!=null&&d.questionAnswers&&Object.entries(d.questionAnswers).forEach(([Pe,$e])=>{(!$e||$e.trim()===""||$e.toLowerCase()==="no")&&(Pe==="standard-price"||Pe==="standard-price-description"||Pe==="ask-payment-plans"||Pe==="ask-tiers"||Pe==="pricing-narrative"||Pe.startsWith("payment-plan-")&&Pe.endsWith("-description"))&&J.add(Pe)}),J}),[F,M]=i.useState(()=>(d==null?void 0:d.isFinalizing)??!1),T=i.useRef(t),ie=i.useRef(!1),Z=i.useRef(null),le=i.useRef(!1),oe=i.useRef(!1),z=i.useRef(!1),ee=i.useRef(null);i.useEffect(()=>{if(w)return ee.current&&clearTimeout(ee.current),ee.current=setTimeout(()=>{w.getState().setStep9FormData({standardPrice:W,standardPriceDescription:U,paymentPlans:V,tiers:K,pricingNarrative:q})},100),()=>{ee.current&&clearTimeout(ee.current)}},[w,W,U,V,K,q]);const ne=i.useCallback(J=>["skip","no","n","leave it","leave","none","not needed","pass","done"].includes(J.trim().toLowerCase()),[]),me=i.useCallback(J=>{const Pe=J.trim().toLowerCase();return["yes","y","yeah","yep","yup","sure","ok","okay","add","add more","please","let's do it","continue"].includes(Pe)},[]),ve=i.useRef(""),D=i.useRef(!1);i.useEffect(()=>{var Ee;if(ie.current)return;T.current=t;const J=x?JSON.stringify(x):"",Pe=d?JSON.stringify({currentQuestionKey:d.currentQuestionKey,answeredQuestionsLength:(Ee=d.answeredQuestions)==null?void 0:Ee.length}):"",$e=`${(t==null?void 0:t.id)||""}-${h}-${J}-${Pe}`;if(ve.current===$e&&D.current)return;ve.current=$e,D.current=!0;const Ae=ce=>{var Te,Ue,lt,Ze;const we=new Set;return ce.standardPrice&&we.add("standard-price"),ce.standardPriceDescription&&we.add("standard-price-description"),((Te=ce.paymentPlans)==null?void 0:Te.length)>0&&we.add("ask-payment-plans"),((Ue=ce.tiers)==null?void 0:Ue.length)>0&&we.add("ask-tiers"),ce.pricingNarrative&&we.add("pricing-narrative"),(lt=ce.paymentPlans)==null||lt.forEach((ge,pe)=>{ge.name&&we.add(`payment-plan-${pe}-name`),ge.price>0&&we.add(`payment-plan-${pe}-price`),ge.description&&we.add(`payment-plan-${pe}-description`)}),(Ze=ce.tiers)==null||Ze.forEach((ge,pe)=>{ge.name&&we.add(`tier-${pe}-name`),ge.price>0&&we.add(`tier-${pe}-price`)}),d!=null&&d.answeredQuestions&&d.answeredQuestions.forEach(ge=>we.add(ge)),we};if(h&&t.step9Pricing){const ce=t.step9Pricing,we=ce.standardPrice?String(ce.standardPrice):"",Te=ce.standardPriceDescription||"",Ue=ce.paymentPlans?[...ce.paymentPlans]:[],lt=ce.tiers?[...ce.tiers]:[],Ze=ce.pricingNarrative||"",ge=JSON.stringify({standardPrice:W,standardPriceDescription:U,paymentPlans:V,tiers:K,pricingNarrativeText:q}),pe=JSON.stringify({standardPrice:we,standardPriceDescription:Te,paymentPlans:Ue,tiers:lt,pricingNarrativeText:Ze});ge!==pe&&(B(we),Q(Te),P(Ue),G(lt),A(Ze),R(Ae(ce)),w&&w.getState().setStep9FormData({standardPrice:we,standardPriceDescription:Te,paymentPlans:Ue,tiers:lt,pricingNarrative:Ze}));return}if(d&&x){const ce=x,we=ce.standardPrice?String(ce.standardPrice):"",Te=ce.standardPriceDescription||"",Ue=ce.paymentPlans?[...ce.paymentPlans]:[],lt=ce.tiers?[...ce.tiers]:[],Ze=ce.pricingNarrative||"",ge=JSON.stringify({standardPrice:W,standardPriceDescription:U,paymentPlans:V,tiers:K,pricingNarrativeText:q}),pe=JSON.stringify({standardPrice:we,standardPriceDescription:Te,paymentPlans:Ue,tiers:lt,pricingNarrativeText:Ze});ge!==pe&&(B(we),Q(Te),P(Ue),G(lt),A(Ze),R(Ae(ce)));return}if(!d&&!D.current){const ce=JSON.stringify({standardPrice:W,standardPriceDescription:U,paymentPlans:V,tiers:K,pricingNarrativeText:q}),we=JSON.stringify({standardPrice:"",standardPriceDescription:"",paymentPlans:[],tiers:[],pricingNarrativeText:""});ce!==we&&(B(""),Q(""),P([]),G([]),A(""),R(new Set),k(null),S(""))}},[t==null?void 0:t.id,h]),i.useEffect(()=>{typeof(d==null?void 0:d.isFinalizing)=="boolean"&&!t.step9Completed&&M(d.isFinalizing)},[d==null?void 0:d.isFinalizing,t.step9Completed]);const ue=i.useCallback(()=>{if(!F){if(!E.has("standard-price")){k("standard-price"),S(W||"");return}if(W&&!E.has("standard-price-description")){k("standard-price-description"),S(U||"");return}if(!E.has("ask-payment-plans")){console.log("[ProductRefinerStep9] Setting currentQuestionKey to ask-payment-plans"),k("ask-payment-plans"),S("");return}if(V.length>0)for(let J=0;J<V.length;J++){const Pe=V[J];if(!E.has(`payment-plan-${J}-name`)){k(`payment-plan-${J}-name`),S(Pe.name||"");return}if(!E.has(`payment-plan-${J}-price`)){k(`payment-plan-${J}-price`),S(Pe.price?String(Pe.price):"");return}if(!E.has(`payment-plan-${J}-description`)){k(`payment-plan-${J}-description`),S(Pe.description||"");return}}if(!E.has("ask-tiers")){k("ask-tiers"),S("");return}if(K.length>0)for(let J=0;J<K.length;J++){const Pe=K[J];if(!E.has(`tier-${J}-name`)){k(`tier-${J}-name`),S(Pe.name||"");return}if(!E.has(`tier-${J}-price`)){k(`tier-${J}-price`),S(Pe.price?String(Pe.price):"");return}}if(!E.has("pricing-narrative")){k("pricing-narrative"),S(q||"");return}F||M(!0),k(null),S(""),ae.current&&ae.current()}},[E,W,U,V,K,q,F]),O=i.useRef(ue);i.useEffect(()=>{O.current=ue},[ue]),i.useEffect(()=>{!n||r||ie.current||F||j===null&&O.current()},[n,r,j,F]);const H=i.useCallback(async(J,Pe)=>{if(p||Z.current===J||F)return;const $e=T.current||t;if(!($e!=null&&$e.id)){m({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}const Ae=Pe.trim();if(J==="standard-price"){if(f(!0),b(null),Z.current=J,ie.current=!0,ne(Ae)||!Ae){B(""),R(we=>new Set([...we,"standard-price"])),$(we=>new Set([...we,"standard-price"])),I(we=>({...we,"standard-price":""})),setTimeout(()=>{ie.current=!1,f(!1),Z.current=null,O.current()},100);return}const ce=parseFloat(Ae);if(isNaN(ce)||ce<0){b("Please enter a valid positive number"),f(!1),Z.current=null,ie.current=!1;return}B(Ae),R(we=>new Set([...we,"standard-price"])),$(we=>{const Te=new Set(we);return Te.delete("standard-price"),Te}),I(we=>({...we,"standard-price":Ae})),setTimeout(()=>{ie.current=!1,ue(),f(!1),Z.current=null},100);return}if(J==="standard-price-description"){ie.current=!0,f(!0),b(null),Z.current=J;const Ee=ne(Ae)||!Ae;Q(Ee?"":Ae),R(ce=>new Set([...ce,"standard-price-description"])),Ee?($(ce=>new Set([...ce,"standard-price-description"])),I(ce=>({...ce,"standard-price-description":""}))):($(ce=>{const we=new Set(ce);return we.delete("standard-price-description"),we}),I(ce=>({...ce,"standard-price-description":Ae}))),setTimeout(()=>{ue(),ie.current=!1,f(!1),Z.current=null},200);return}if(J==="ask-payment-plans"){if(ie.current=!0,f(!0),Z.current=J,!Ae){b(null),R(Te=>new Set([...Te,"ask-payment-plans"])),I(Te=>({...Te,"ask-payment-plans":"no"})),setTimeout(()=>{ie.current=!1,O.current(),f(!1),Z.current=null},200);return}const Ee=ne(Ae),ce=me(Ae);if(!Ee&&!ce){b("Please respond with yes to add payment plans or no/skip to continue."),f(!1),Z.current=null,ie.current=!1;return}b(null),R(Te=>new Set([...Te,"ask-payment-plans"]));const we=Ee?"no":"yes";if(I(Te=>({...Te,"ask-payment-plans":we})),oe.current=ce,$(Ee?Te=>new Set([...Te,"ask-payment-plans"]):Te=>{const Ue=new Set(Te);return Ue.delete("ask-payment-plans"),Ue}),Ee){setTimeout(()=>{ie.current=!1,O.current(),f(!1),Z.current=null},200);return}P([{name:"",price:0,description:""}]),k("payment-plan-0-name"),S(""),setTimeout(()=>{ie.current=!1,f(!1),Z.current=null},200);return}if(J.startsWith("payment-plan-")&&J.endsWith("-name")){ie.current=!0,f(!0),Z.current=J;const Ee=parseInt(J.split("-")[2]),ce=[...V];ce[Ee]={...ce[Ee],name:Ae},P(ce),R(we=>new Set([...we,J])),setTimeout(()=>{k(`payment-plan-${Ee}-price`),S(ce[Ee].price?String(ce[Ee].price):""),ie.current=!1,f(!1),Z.current=null},150);return}if(J.startsWith("payment-plan-")&&J.endsWith("-price")){ie.current=!0,f(!0),Z.current=J;const Ee=parseInt(J.split("-")[2]),ce=parseFloat(Ae);if(isNaN(ce)||ce<0){b("Please enter a valid positive number"),f(!1),Z.current=null,ie.current=!1;return}const we=[...V];we[Ee]={...we[Ee],price:ce},P(we),R(Te=>new Set([...Te,J])),setTimeout(()=>{k(`payment-plan-${Ee}-description`),S(we[Ee].description||""),ie.current=!1,f(!1),Z.current=null},150);return}if(J.startsWith("payment-plan-")&&J.endsWith("-description")){ie.current=!0,f(!0),b(null);const Ee=parseInt(J.split("-")[2]),ce=[...V],we=ne(Ae)||!Ae;ce[Ee]={...ce[Ee],description:we?"":Ae},we?($(Te=>new Set([...Te,J])),I(Te=>({...Te,[J]:""}))):($(Te=>{const Ue=new Set(Te);return Ue.delete(J),Ue}),I(Te=>({...Te,[J]:Ae}))),P(ce),R(Te=>new Set([...Te,J])),setTimeout(()=>{ie.current=!1,f(!1),Z.current=null,oe.current?(oe.current=!1,R(Te=>{const Ue=new Set(Te);return Ue.delete("ask-payment-plans"),Ue}),$(Te=>{if(!Te.has("ask-payment-plans"))return Te;const Ue=new Set(Te);return Ue.delete("ask-payment-plans"),Ue}),k("ask-payment-plans"),S("")):O.current()},200);return}if(J==="ask-tiers"){if(ie.current=!0,f(!0),Z.current=J,!Ae){b(null),R(Te=>new Set([...Te,"ask-tiers"])),I(Te=>({...Te,"ask-tiers":"no"})),setTimeout(()=>{ie.current=!1,O.current(),f(!1),Z.current=null},200);return}const Ee=ne(Ae),ce=me(Ae);if(!Ee&&!ce){b("Please respond with yes to add pricing tiers or no/skip to continue."),f(!1),Z.current=null,ie.current=!1;return}b(null),R(Te=>new Set([...Te,"ask-tiers"]));const we=Ee?"no":"yes";if(I(Te=>({...Te,"ask-tiers":we})),z.current=ce,$(Ee?Te=>new Set([...Te,"ask-tiers"]):Te=>{const Ue=new Set(Te);return Ue.delete("ask-tiers"),Ue}),Ee){setTimeout(()=>{ie.current=!1,O.current(),f(!1),Z.current=null},200);return}G([{name:"",price:0,features:[""]}]),k("tier-0-name"),S(""),setTimeout(()=>{ie.current=!1,f(!1),Z.current=null},200);return}if(J.startsWith("tier-")&&J.endsWith("-name")){ie.current=!0,f(!0),Z.current=J;const Ee=parseInt(J.split("-")[1]),ce=[...K];ce[Ee]={...ce[Ee],name:Ae},G(ce),R(we=>new Set([...we,J])),setTimeout(()=>{k(`tier-${Ee}-price`),S(ce[Ee].price?String(ce[Ee].price):""),ie.current=!1,f(!1),Z.current=null},150);return}if(J.startsWith("tier-")&&J.endsWith("-price")){ie.current=!0,f(!0),Z.current=J;const Ee=parseInt(J.split("-")[1]),ce=parseFloat(Ae);if(isNaN(ce)||ce<0){b("Please enter a valid positive number"),f(!1),Z.current=null,ie.current=!1;return}const we=[...K];we[Ee]={...we[Ee],price:ce},G(we),R(Te=>new Set([...Te,J])),setTimeout(()=>{ie.current=!1,f(!1),Z.current=null,z.current?(z.current=!1,R(Te=>{const Ue=new Set(Te);return Ue.delete("ask-tiers"),Ue}),$(Te=>{if(!Te.has("ask-tiers"))return Te;const Ue=new Set(Te);return Ue.delete("ask-tiers"),Ue}),k("ask-tiers"),S("")):O.current()},150);return}if(J==="pricing-narrative"){ie.current=!0,f(!0),b(null);const Ee=ne(Ae)||!Ae,ce=Ee?"":Ae;Ee?($(we=>new Set([...we,"pricing-narrative"])),I(we=>({...we,"pricing-narrative":""}))):($(we=>{const Te=new Set(we);return Te.delete("pricing-narrative"),Te}),I(we=>({...we,"pricing-narrative":Ae}))),A(ce),R(we=>new Set([...we,"pricing-narrative"])),w&&w.getState().setStep9FormData({standardPrice:W,standardPriceDescription:U,paymentPlans:V,tiers:K,pricingNarrative:ce}),setTimeout(()=>{Z.current=null,de()},200);return}},[W,U,V,K,q,t,m,ne,E,p,F]),ae=i.useRef(),de=i.useCallback(async()=>{var Pe,$e,Ae;const J=T.current||t;if(J!=null&&J.id){b(null),f(!0),M(!0),o==null||o(null);try{const Ee=await I5(J.id,{standardPrice:W?parseFloat(W):void 0,standardPriceDescription:U.trim()||void 0,paymentPlans:V.filter(we=>we.name.trim()&&we.price>0),tiers:K.filter(we=>we.name.trim()&&we.price>0),pricingNarrative:q.trim()||void 0}),ce={...J,step9Pricing:{standardPrice:W?parseFloat(W):void 0,standardPriceDescription:U.trim()||void 0,paymentPlans:V.filter(we=>we.name.trim()&&we.price>0),tiers:K.filter(we=>we.name.trim()&&we.price>0),pricingNarrative:((Pe=Ee.pricingNarrative)==null?void 0:Pe.narrative)||q.trim()||void 0,justification:($e=Ee.pricingNarrative)==null?void 0:$e.justification,recommendations:(Ae=Ee.pricingNarrative)==null?void 0:Ae.recommendations},step9Completed:!0,currentStep:10};a(ce),k(null),S("")}catch(Ee){const ce=(Ee==null?void 0:Ee.message)||"Failed to submit pricing";o==null||o(ce),m({title:"Submission failed",description:ce,variant:"destructive"})}finally{f(!1),Z.current=null,ie.current=!1,M(!1),le.current=!1}}},[t,a,o,m,W,U,V,K,q]);i.useEffect(()=>{ae.current=de},[de]),i.useEffect(()=>{var J;n&&!r&&(d!=null&&d.isFinalizing)&&!t.step9Completed&&!le.current&&(le.current=!0,M(!0),(J=ae.current)==null||J.call(ae))},[n,r,d==null?void 0:d.isFinalizing,t.step9Completed]);const re=i.useRef(u),fe=i.useRef(H);i.useEffect(()=>{re.current=u,fe.current=H},[u,H]),i.useEffect(()=>{if(!re.current)return;if(n&&!r&&j!==null&&!F){const Pe=Te=>Te==="standard-price"?"What is your standard price? (Optional  you can skip this)":Te==="standard-price-description"?"What's included at this price? (Optional  you can skip this)":Te==="ask-payment-plans"?"Do you want to add any payment plans? (Optional  you can skip this)":Te.startsWith("payment-plan-")&&Te.endsWith("-name")?`What is the name of payment plan ${parseInt(Te.split("-")[2])+1}?`:Te.startsWith("payment-plan-")&&Te.endsWith("-price")?`What is the price of payment plan ${parseInt(Te.split("-")[2])+1}?`:Te.startsWith("payment-plan-")&&Te.endsWith("-description")?`What is the description of payment plan ${parseInt(Te.split("-")[2])+1}? (Optional  you can skip this)`:Te==="ask-tiers"?"Do you want to add any pricing tiers? (Optional  you can skip this)":Te.startsWith("tier-")&&Te.endsWith("-name")?`What is the name of tier ${parseInt(Te.split("-")[1])+1}?`:Te.startsWith("tier-")&&Te.endsWith("-price")?`What is the price of tier ${parseInt(Te.split("-")[1])+1}?`:Te==="pricing-narrative"?"Describe your pricing structure and justification? (Optional  you can skip this, AI will generate)":"",$e=j==="ask-payment-plans"||j==="ask-tiers",Ae=()=>{j&&fe.current(j,N)},Ee=Te=>{S(Te),y&&($e?(me(Te)||ne(Te)||Te.trim().length===0)&&b(null):b(null))},ce=Pe(j);re.current({inputValue:N,onInputChange:Ee,onInputSubmit:Ae,isSubmitting:p,placeholder:"Enter your answer...",currentQuestionKey:j,currentQuestionLabel:ce,validationError:y,validationHint:$e?"Type yes to add or no to skip.":null})}else re.current(null)},[n,r,j,N,p,y,ne,me,F]);const Se=i.useRef(null),he=i.useRef(g);i.useEffect(()=>{he.current=g},[g]),i.useEffect(()=>{const J=he.current;if(!J)return;const Pe=Array.from(E).sort();if(!(Pe.length>0||j!=null||N&&N.trim().length>0||Object.keys(L??{}).length>0||F)){Se.current&&(Se.current=null,J(null));return}const Ae={currentQuestionKey:j,currentInputValue:N,answeredQuestions:Pe,questionAnswers:L,isFinalizing:F},Ee=Se.current;(!Ee||Ee.currentQuestionKey!==Ae.currentQuestionKey||Ee.currentInputValue!==Ae.currentInputValue||Ee.answeredQuestions.length!==Ae.answeredQuestions.length||Ee.answeredQuestions.some((we,Te)=>we!==Ae.answeredQuestions[Te])||JSON.stringify(Ee.questionAnswers)!==JSON.stringify(Ae.questionAnswers)||Ee.isFinalizing!==Ae.isFinalizing||Ee.isCompleted!==r||Ee.isActive!==n)&&(Se.current={currentQuestionKey:Ae.currentQuestionKey,currentInputValue:Ae.currentInputValue,answeredQuestions:[...Ae.answeredQuestions],questionAnswers:Ae.questionAnswers?{...Ae.questionAnswers}:void 0,isFinalizing:F,isCompleted:r,isActive:n},J(Ae))},[j,N,E,r,n,L,F]);const se=i.useRef("");return i.useEffect(()=>{if(!ie.current&&d){const J=JSON.stringify({standardPrice:W,standardPriceDescription:U,paymentPlans:V,tiers:K,pricingNarrativeText:q});if(J===se.current)return;if(se.current=J,d.questionAnswers&&Object.keys(d.questionAnswers).length>0){I(d.questionAnswers);const Ee=new Set;Object.entries(d.questionAnswers).forEach(([ce,we])=>{(!we||we.trim()===""||we.toLowerCase()==="no")&&(ce==="standard-price"||ce==="standard-price-description"||ce==="ask-payment-plans"||ce==="ask-tiers"||ce==="pricing-narrative"||ce.startsWith("payment-plan-")&&ce.endsWith("-description"))&&Ee.add(ce)}),$(Ee)}const Pe=new Set;W&&Pe.add("standard-price"),U&&Pe.add("standard-price-description"),V.length>0&&Pe.add("ask-payment-plans"),K.length>0&&Pe.add("ask-tiers"),q&&Pe.add("pricing-narrative"),V.forEach((Ee,ce)=>{Ee.name&&Pe.add(`payment-plan-${ce}-name`),Ee.price>0&&Pe.add(`payment-plan-${ce}-price`),Ee.description&&Pe.add(`payment-plan-${ce}-description`)}),K.forEach((Ee,ce)=>{Ee.name&&Pe.add(`tier-${ce}-name`),Ee.price>0&&Pe.add(`tier-${ce}-price`)}),d.answeredQuestions&&d.answeredQuestions.forEach(Ee=>Pe.add(Ee)),d.questionAnswers&&Object.keys(d.questionAnswers).forEach(Ee=>Pe.add(Ee));const $e=Array.from(E).sort(),Ae=Array.from(Pe).sort();JSON.stringify($e)!==JSON.stringify(Ae)&&R(Pe),d.currentQuestionKey&&!Pe.has(d.currentQuestionKey)&&(k(d.currentQuestionKey),S(d.currentInputValue||""))}},[d,n,r]),!l&&!n&&!r?null:s.jsxs(s.Fragment,{children:[(n||r)&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:r?s.jsx("p",{children:"Perfect! Your pricing structure is saved. Generating your final product specification..."}):s.jsx(Ge,{text:"Now let's structure your pricing. All fields are optional  you can skip any section by typing 'skip' or leaving it blank.",staggerMs:30})})}),(()=>{const J="standard-price",$e=!!W||E.has(J);return!r&&!$e&&!(n&&J===j)&&!_.has(J)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"What is your standard price? (Optional  you can skip this)"}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:"What is your standard price? (Optional  you can skip this)",chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}),$e&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),$e&&s.jsxs(s.Fragment,{children:[W&&!_.has("standard-price")?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm text-gray-700",children:["$",W]})})}):_.has("standard-price")?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})}):null,p&&!r&&J===j&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),s.jsx("p",{className:"text-sm",children:"Saving..."})]})})})]})]},J)})(),W&&(()=>{const J="standard-price-description",$e=!!U||E.has(J);return!r&&!$e&&!(n&&J===j)&&!_.has(J)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"What's included at this price? (Optional  you can skip this)"}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:"What's included at this price? (Optional  you can skip this)",chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}),$e&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),$e&&s.jsx(s.Fragment,{children:U&&!_.has("standard-price-description")?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:U})})}):_.has("standard-price-description")?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})}):null})]},J)})(),(()=>{const J="ask-payment-plans",Pe=V.length>0,$e=L==null?void 0:L["ask-payment-plans"],Ae=E.has(J),Ee=n&&J===j,ce=Pe||!!$e;return r||Ae||Ee||_.has(J)||ce?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"Do you want to add any payment plans? (Optional  you can skip this)"}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:"Do you want to add any payment plans? (Optional  you can skip this)",chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}),Ae&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),Ae&&(V.length===0||_.has("ask-payment-plans"))&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:L["ask-payment-plans"]==="no"?"No":"Skipped"})})})]},J):null})(),V.map((J,Pe)=>{const $e=Pe+1;return s.jsxs("div",{className:"space-y-4",children:[Pe===0&&V.length>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Payment Plans"})})}),(()=>{const Ae=`payment-plan-${Pe}-name`,ce=!!J.name||E.has(Ae);return!r&&!ce&&!(n&&Ae===j)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What is the name of payment plan ",$e,"?"]}):s.jsx(Ge,{text:`What is the name of payment plan ${$e}?`,chunkClassName:"text-base text-gray-900",staggerMs:30}),ce&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),ce&&J.name&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700",children:J.name})})})]},Ae)})(),(()=>{const Ae=`payment-plan-${Pe}-price`,ce=J.price>0||E.has(Ae);return!r&&!ce&&!(n&&Ae===j)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What is the price of payment plan ",$e,"?"]}):s.jsx(Ge,{text:`What is the price of payment plan ${$e}?`,chunkClassName:"text-base text-gray-900",staggerMs:30}),ce&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),ce&&J.price>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm text-gray-700",children:["$",J.price]})})})]},Ae)})(),(()=>{const Ae=`payment-plan-${Pe}-description`,ce=!!J.description||E.has(Ae);return!r&&!ce&&!(n&&Ae===j)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What is the description of payment plan ",$e,"? (Optional  you can skip this)"]}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:`What is the description of payment plan ${$e}? (Optional  you can skip this)`,chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}),ce&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),ce&&s.jsx(s.Fragment,{children:J.description&&!_.has(Ae)?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:J.description})})}):_.has(Ae)?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})}):null})]},Ae)})()]},`payment-plan-${Pe}`)}),(()=>{const J="ask-tiers",Pe=K.length>0,$e=L==null?void 0:L["ask-tiers"],Ae=E.has(J),Ee=n&&J===j,ce=Pe||!!$e;return r||Ae||Ee||_.has(J)||ce?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"Do you want to add any pricing tiers? (Optional  you can skip this)"}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:"Do you want to add any pricing tiers? (Optional  you can skip this)",chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}),Ae&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),Ae&&(K.length===0||_.has("ask-tiers"))&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:L["ask-tiers"]==="no"?"No":"Skipped"})})})]},J):null})(),K.map((J,Pe)=>{const $e=Pe+1;return s.jsxs("div",{className:"space-y-4",children:[Pe===0&&K.length>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Pricing Tiers"})})}),(()=>{const Ae=`tier-${Pe}-name`,ce=!!J.name||E.has(Ae);return!r&&!ce&&!(n&&Ae===j)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What is the name of tier ",$e,"?"]}):s.jsx(Ge,{text:`What is the name of tier ${$e}?`,chunkClassName:"text-base text-gray-900",staggerMs:30}),ce&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),ce&&J.name&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700",children:J.name})})})]},Ae)})(),(()=>{const Ae=`tier-${Pe}-price`,ce=J.price>0||E.has(Ae);return!r&&!ce&&!(n&&Ae===j)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsxs("p",{className:"text-base text-gray-900",children:["What is the price of tier ",$e,"?"]}):s.jsx(Ge,{text:`What is the price of tier ${$e}?`,chunkClassName:"text-base text-gray-900",staggerMs:30}),ce&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),ce&&J.price>0&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm text-gray-700",children:["$",J.price]})})})]},Ae)})()]},`tier-${Pe}`)}),(()=>{const J="pricing-narrative",$e=!!q||E.has(J);return!r&&!$e&&!(n&&J===j)&&!_.has(J)?null:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-2",children:[r?s.jsx("p",{className:"text-base text-gray-900",children:"Describe your pricing structure and justification? (Optional  you can skip this, AI will generate)"}):s.jsxs(s.Fragment,{children:[s.jsx(Ge,{text:"Describe your pricing structure and justification? (Optional  you can skip this, AI will generate)",chunkClassName:"text-base text-gray-900",staggerMs:30}),s.jsx("p",{className:"text-xs text-gray-500 mt-1 italic",children:"You can skip this by typing 'skip' or leaving it blank."})]}),$e&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2",children:" Saved"})]})})}),$e&&s.jsxs(s.Fragment,{children:[q&&q.trim()&&!_.has("pricing-narrative")?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:q})})}):_.has("pricing-narrative")?s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-500 italic",children:"Skipped"})})}):null,p&&!r&&J===j&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[s.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-gray-600 rounded-full animate-spin"}),s.jsx("p",{className:"text-sm",children:"Saving..."})]})})})]})]},J)})(),r&&s.jsxs(s.Fragment,{children:[W&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-base text-gray-900",children:"What is your standard price? (Optional)"})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm text-gray-700",children:["$",W,U&&` - ${U}`]})})})]}),V.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Payment Plans"})})}),V.map((J,Pe)=>s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("p",{className:"text-sm text-gray-700",children:[J.name,": $",J.price,J.description&&` - ${J.description}`]})})},Pe))]}),K.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm font-bold text-gray-700",children:"Pricing Tiers"})})}),K.map((J,Pe)=>{var $e;return s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsxs("p",{className:"text-sm text-gray-700",children:[J.name,": $",J.price]}),(($e=J.features)==null?void 0:$e.length)>0&&J.features.some(Ae=>Ae.trim())&&s.jsx("ul",{className:"text-xs text-gray-600 mt-1 list-disc list-inside",children:J.features.filter(Ae=>Ae.trim()).map((Ae,Ee)=>s.jsx("li",{children:Ae},Ee))})]})},Pe)})]}),q&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-base text-gray-900",children:"Describe your pricing structure and justification? (Optional)"})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:q})})})]}),c&&c.narrative&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content bg-blue-50 border border-blue-200",children:[s.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"AI-Generated Pricing Narrative"}),s.jsx("p",{className:"text-sm text-blue-800 mb-2",children:c.narrative}),c.justification&&s.jsxs("p",{className:"text-sm text-blue-700 mb-2",children:[s.jsx("strong",{children:"Justification:"})," ",c.justification]}),c.recommendations&&Array.isArray(c.recommendations)&&s.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-blue-700",children:c.recommendations.map((J,Pe)=>s.jsx("li",{children:J},Pe))})]})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 9 completed - Pricing structure saved"})})})]}),F&&!r&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:"Saving your pricing details..."})})}),!r&&n&&s.jsx("div",{className:"h-24","aria-hidden":!0})]})},U5=({session:e,isActive:t,isCompleted:n,onSessionChange:r,onError:a,isUnlocked:o=!1})=>{const{toast:l}=yt(),[c,u]=i.useState(!1),[d,g]=i.useState(!1),[m,p]=i.useState(!1),[f,w]=i.useState(!1);i.useEffect(()=>{t&&!n&&!d&&e.step9Completed&&h()},[t,n,d,e.step9Completed]);const h=async()=>{if(!(!e.id||d||c)){u(!0),g(!0),a==null||a(null);try{const y=await T5(e.id),b={...e,step10FinalSpecification:y.finalSpecification||null,step10Completed:!0,status:"completed",completedAt:new Date().toISOString()};r(b)}catch(y){const b=(y==null?void 0:y.message)||"Failed to generate final specification";a==null||a(b),g(!1),l({title:"Generation failed",description:b,variant:"destructive"})}finally{u(!1)}}},v=async()=>{if(!e.id){l({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}p(!0);try{const y=await _j(e.id),b=window.URL.createObjectURL(y),N=document.createElement("a"),S=e.completedAt?new Date(e.completedAt).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],k=`Product-Refiner-${e.userName||e.sessionName||"Client"}-${S}.pdf`;N.href=b,N.download=k,document.body.appendChild(N),N.click(),document.body.removeChild(N),window.URL.revokeObjectURL(b),l({title:"Profile Downloaded",description:`Downloaded ${k}`})}catch(y){console.error("Failed to download PDF:",y),l({title:"Download Failed",description:(y==null?void 0:y.message)||"Failed to download Product Specification PDF",variant:"destructive"})}finally{p(!1)}},x=async()=>{var y;if(!e.id){l({title:"Session missing",description:"Please refresh and try again.",variant:"destructive"});return}w(!0);try{const b=await M5(e.id),N=window.URL.createObjectURL(b),S=document.createElement("a"),j=((y=e.sessionName)==null?void 0:y.trim().replace(/[^\w\d-_]+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""))||"product-specification";S.href=N,S.download=`${j}.docx`,document.body.appendChild(S),S.click(),document.body.removeChild(S),window.URL.revokeObjectURL(N),l({title:"Download started",description:"Your Product Specification DOCX is downloading."})}catch(b){l({title:"Download failed",description:(b==null?void 0:b.message)||"Unable to download the Product Specification.",variant:"destructive"})}finally{w(!1)}};return!o&&!t&&!n?null:s.jsxs(s.Fragment,{children:[t&&!n&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx(Ge,{text:"Pricing structure saved! Now let's generate your final Product Specification document that compiles all the refined elements.",staggerMs:30})})}),c&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Generating your Product Specification..."}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Compiling all refined elements into a complete document."})]})]})})}),n&&s.jsxs(s.Fragment,{children:[e.step10FinalSpecification&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"font-semibold text-gray-900",children:"Product Specification"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(Ie,{onClick:v,disabled:m||f,size:"sm",variant:"outline",children:[m?s.jsx(Qe,{className:"h-4 w-4 animate-spin mr-2"}):s.jsx(ln,{className:"h-4 w-4 mr-2"}),"PDF"]}),s.jsxs(Ie,{onClick:x,disabled:m||f,size:"sm",variant:"outline",children:[f?s.jsx(Qe,{className:"h-4 w-4 animate-spin mr-2"}):s.jsx(Pn,{className:"h-4 w-4 mr-2"}),"DOCX"]})]})]}),s.jsx("div",{className:"prose prose-sm max-w-none",children:s.jsx("div",{className:"whitespace-pre-wrap text-sm text-gray-700",children:e.step10FinalSpecification})})]})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsx("p",{className:"text-sm text-gray-600",children:" Step 10 completed - Final Product Specification generated"})})}),s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content bg-green-50 border border-green-200",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold text-green-900 mb-2",children:" Your product refinement journey is now complete!"}),s.jsxs("p",{className:"text-sm text-green-800",children:["You've successfully refined your product into a complete, strong, and confidently positioned offer.",e.step10FinalSpecification?" Review your Product Specification above and download it in PDF or Word format.":" Download your Product Specification in PDF or Word format below."]})]}),s.jsxs("div",{className:"flex gap-2 pt-2",children:[s.jsx(Ie,{onClick:v,disabled:m||f,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:m?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin mr-2"}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ln,{className:"h-4 w-4 mr-2"}),"Download PDF"]})}),s.jsx(Ie,{onClick:x,disabled:m||f,size:"sm",variant:"outline",className:"border-green-600 text-green-700 hover:bg-green-50",children:f?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin mr-2"}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Pn,{className:"h-4 w-4 mr-2"}),"Download DOCX"]})})]})]})})})]})]})},z5="product-refiner-state",H5="product-refiner-scroll",Td=e=>`${z5}-${e}`,Rd=e=>`${H5}-${e}`,Q5=()=>{const e=Lt(),{currentWorkspace:t,isLoading:n}=ls(),[r,a]=i.useState(null),[o,l]=i.useState({}),[c,u]=i.useState(!1),[d,g]=i.useState(null),[m,p]=i.useState(!0),[f,w]=i.useState(null),[h,v]=i.useState(null),[x,y]=i.useState(null),[b,N]=i.useState(null),[S,j]=i.useState(null),[k,C]=i.useState(null),[W,B]=i.useState(null),[U,Q]=i.useState(null),[V,P]=i.useState(!0),[K,G]=i.useState(!1),q=U||W||k||S||b||x||h||f;i.useEffect(()=>{console.log("[ProductRefiner] step1InputHandlers changed:",{hasHandlers:!!f,inputValue:f==null?void 0:f.inputValue,placeholder:f==null?void 0:f.placeholder,isSubmitting:f==null?void 0:f.isSubmitting})},[f]),i.useEffect(()=>{console.log("[ProductRefiner] step2InputHandlers changed:",{hasHandlers:!!h,inputValue:h==null?void 0:h.inputValue,placeholder:h==null?void 0:h.placeholder,isSubmitting:h==null?void 0:h.isSubmitting,currentQuestionKey:h==null?void 0:h.currentQuestionKey})},[h]);const A=i.useRef(null),E=i.useRef(null),R=i.useRef(null),L=i.useRef(null),I=i.useRef(null),_=i.useRef(null),$=i.useRef(0),[F,M]=i.useState(0),T=(t==null?void 0:t.id)??null;i.useEffect(()=>{if(n)return;if(typeof window>"u"){p(!1);return}if(!T){u(!0),a(null),g(null),R.current=null,p(!1);return}if(u(!1),g(null),R.current===T){p(!1);return}p(!0);const Y=Td(T);try{const te=localStorage.getItem(Y);if(te){const X=JSON.parse(te);a((X==null?void 0:X.session)??null),l((X==null?void 0:X.uiState)??{})}else a(null),l({})}catch(te){console.error("Failed to restore Product Refiner state from storage:",te),a(null),l({})}finally{R.current=T,p(!1)}},[T,n]),i.useEffect(()=>{if(m||!T||typeof window>"u")return;const Y=Td(T);if(!r){try{localStorage.removeItem(Y)}catch(X){console.error("Failed to clear persisted Product Refiner state:",X)}return}const te={session:r,lastUpdated:new Date().toISOString(),uiState:o};try{localStorage.setItem(Y,JSON.stringify(te))}catch(X){console.error("Failed to persist Product Refiner state:",X)}},[r,T,m,o]);const ie=i.useCallback(()=>{if(!(!T||typeof window>"u"))try{localStorage.removeItem(Td(T))}catch(Y){console.error("Failed to clear persisted Product Refiner state:",Y)}},[T]),Z=i.useCallback(Y=>{if(typeof window>"u")return;const te=A.current;te&&te.scrollHeight>te.clientHeight+1&&te?te.scrollTo({top:Y,behavior:"auto"}):window.scrollTo({top:Y,behavior:"auto"})},[]),le=i.useCallback((Y="smooth")=>{var ye,Ne;if(typeof window>"u")return;const te=A.current;te&&te.scrollHeight>te.clientHeight+1&&te?te.scrollTo({top:te.scrollHeight,behavior:Y}):window.scrollTo({top:((ye=document.scrollingElement)==null?void 0:ye.scrollHeight)??document.documentElement.scrollHeight,behavior:Y}),(Ne=E.current)==null||Ne.scrollIntoView({behavior:Y,block:"end"})},[]),oe=(r==null?void 0:r.step1Completed)??!1,z=(r==null?void 0:r.step2Completed)??!1,ee=(r==null?void 0:r.step3Completed)??!1,ne=(r==null?void 0:r.step4Completed)??!1,me=(r==null?void 0:r.step5Completed)??!1,ve=(r==null?void 0:r.step6Completed)??!1,D=(r==null?void 0:r.step7Completed)??!1,ue=(r==null?void 0:r.step8Completed)??!1,O=(r==null?void 0:r.step9Completed)??!1,H=(r==null?void 0:r.step10Completed)??!1,ae=i.useMemo(()=>!r||z?!1:oe&&r.currentStep>=2,[r,oe,z]),de=i.useMemo(()=>!r||ee?!1:z&&!ee,[r,z,ee]),re=i.useMemo(()=>!r||ne?!1:ee&&r.currentStep>=4,[r,ee,ne]),fe=i.useMemo(()=>!r||me?!1:ne&&r.currentStep>=5,[r,ne,me]),Se=i.useMemo(()=>!r||ve?!1:me&&r.currentStep>=6,[r,me,ve]),he=i.useMemo(()=>!r||D?!1:ve&&r.currentStep>=7,[r,ve,D]),se=i.useMemo(()=>!r||ue?!1:D&&r.currentStep>=8,[r,D,ue]),J=i.useMemo(()=>!r||O?!1:ue&&r.currentStep>=9,[r,ue,O]),Pe=i.useMemo(()=>!r||H?!1:O&&r.currentStep>=10,[r,O,H]),$e=10,Ae=i.useMemo(()=>{if(Pe||H)return 10;if(J)return 9;if(se)return 8;if(he)return 7;if(Se)return 6;if(fe)return 5;if(re)return 4;if(de)return 3;if(ae)return 2;let Y=1;oe&&(Y=Math.max(Y,2)),z&&(Y=Math.max(Y,3)),ee&&(Y=Math.max(Y,4)),ne&&(Y=Math.max(Y,5)),me&&(Y=Math.max(Y,6)),ve&&(Y=Math.max(Y,7)),D&&(Y=Math.max(Y,8)),ue&&(Y=Math.max(Y,9)),O&&(Y=Math.max(Y,10)),H&&(Y=Math.max(Y,10));const te=Math.min((r==null?void 0:r.currentStep)??1,$e);return Math.max(Y,te)},[ae,de,re,fe,Se,he,se,J,Pe,oe,z,ee,ne,me,ve,D,ue,O,H,r==null?void 0:r.currentStep]),Ee=i.useMemo(()=>Math.min(Math.max(Ae,1),$e),[Ae,$e]),ce=(t==null?void 0:t.name)??"Select a workspace",we=i.useMemo(()=>{if(!r)return 0;let Y=0;oe&&Y++,z&&Y++,ee&&Y++,ne&&Y++,me&&Y++,ve&&Y++,D&&Y++,ue&&Y++,O&&Y++,H&&Y++;const te=Y/$e*100;return Math.min(100,Math.max(0,te))},[r,oe,z,ee,ne,me,ve,D,ue,O,H,$e]);i.useEffect(()=>{if(!T||typeof window>"u"){L.current=null;return}const Y=Rd(T);try{const te=localStorage.getItem(Y);if(te){const X=JSON.parse(te);typeof(X==null?void 0:X.scrollTop)=="number"&&(L.current=X.scrollTop)}else L.current=null}catch(te){console.error("Failed to restore Product Refiner scroll position:",te),L.current=null}},[T]),i.useEffect(()=>{if(n||c||m)return;const Y=L.current;requestAnimationFrame(()=>{typeof Y=="number"?(Z(Y),L.current=null):le()})},[n,c,m,r==null?void 0:r.id,r==null?void 0:r.currentStep,Z,le]),i.useEffect(()=>{if(!T||typeof window>"u")return;const Y=Rd(T),te=()=>{const Ve=A.current;return Ve&&Ve.scrollHeight>Ve.clientHeight+1&&Ve?Ve.scrollTop:window.scrollY||document.documentElement.scrollTop||0},X=Ve=>{const tt={scrollTop:Math.max(Ve,0),lastUpdated:new Date().toISOString()};try{localStorage.setItem(Y,JSON.stringify(tt))}catch(Je){console.error("Failed to persist Product Refiner scroll position:",Je)}};let ye=null;const Ne=()=>{ye||(ye=window.requestAnimationFrame(()=>{X(te()),ye=null}))},Ce=A.current;return Ce==null||Ce.addEventListener("scroll",Ne,{passive:!0}),window.addEventListener("scroll",Ne,{passive:!0}),()=>{Ce==null||Ce.removeEventListener("scroll",Ne),window.removeEventListener("scroll",Ne),ye&&window.cancelAnimationFrame(ye)}},[T]),i.useEffect(()=>{if(!A.current)return;const Y=new ResizeObserver(()=>{const te=document.activeElement,X=te&&(te.tagName==="INPUT"||te.tagName==="TEXTAREA"||te.closest("input")||te.closest("textarea")),ye=A.current;if(ye)if(ye.scrollHeight>ye.clientHeight+1){const Ce=ye.scrollHeight-ye.scrollTop-ye.clientHeight<100;!X&&Ce&&le("auto")}else{const Ce=document.documentElement.scrollHeight-window.scrollY-window.innerHeight<100;!X&&Ce&&le("auto")}});return Y.observe(A.current),()=>Y.disconnect()},[le]),i.useEffect(()=>{let Y=null,te=0;const X=()=>{if(_.current){const Ce=_.current.getBoundingClientRect().height;Math.abs(Ce-te)>.5&&(te=Ce,M(Ce))}},ye=()=>{Y!==null&&cancelAnimationFrame(Y),Y=requestAnimationFrame(X)};X();const Ne=new ResizeObserver(ye);return _.current&&Ne.observe(_.current),window.addEventListener("resize",ye),()=>{Y!==null&&cancelAnimationFrame(Y),Ne.disconnect(),window.removeEventListener("resize",ye)}},[]),i.useEffect(()=>{const Y=A.current;let te=!1;const X=()=>Y&&Y.scrollHeight>Y.clientHeight+1&&Y?Y.scrollTop:window.scrollY||document.documentElement.scrollTop||0,ye=()=>{te||(window.requestAnimationFrame(()=>{const Ne=X(),Ce=$.current;Ne<60?P(!0):Ne>Ce&&Ne>120&&P(!1),G(Ne>0),$.current=Ne,te=!1}),te=!0)};return ye(),Y==null||Y.addEventListener("scroll",ye,{passive:!0}),window.addEventListener("scroll",ye,{passive:!0}),()=>{Y==null||Y.removeEventListener("scroll",ye),window.removeEventListener("scroll",ye)}},[]);const Te=Y=>{const te=Y.currentTarget;te.style.height="auto",te.style.height=te.scrollHeight+"px"},Ue=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step2,X}return{...te,step2:Y}})},[]),lt=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step3,X}return{...te,step3:Y}})},[]),Ze=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step4,X}return{...te,step4:Y}})},[]),ge=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step5,X}return{...te,step5:Y}})},[]),pe=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step6,X}return{...te,step6:Y}})},[]),ke=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step7,X}return{...te,step7:Y}})},[]),be=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step8,X}return{...te,step8:Y}})},[]),je=i.useCallback(Y=>{l(te=>{if(!Y){const X={...te};return delete X.step9,X}return{...te,step9:Y}})},[]),Re=i.useCallback(async()=>{if(m)return;const Y=r==null?void 0:r.id;if(Y)try{await R5(Y),console.log(" Product Refiner session deleted via API")}catch(te){console.error(" Failed to delete session:",te)}if(w(null),v(null),y(null),N(null),j(null),C(null),B(null),Q(null),l({}),T)try{if(v5(T),typeof window<"u"){const te=`product-refiner-store-${T}`;localStorage.removeItem(te)}}catch(te){console.error("Failed to clear Zustand store:",te)}if(ie(),T&&typeof window<"u")try{const te=Rd(T);localStorage.removeItem(te)}catch(te){console.error("Failed to clear scroll storage:",te)}a(null),g(null),R.current=null},[m,T,ie,r==null?void 0:r.id]);return s.jsx("div",{className:"min-h-[calc(100vh-80px)] bg-white",children:s.jsxs("div",{className:"mx-auto flex h-full w-full flex-col",children:[s.jsxs("header",{ref:_,className:`sticky top-0 z-30 border-b border-gray-200 bg-white/95 backdrop-blur transition-transform duration-300 ${K?"shadow-sm":""}`,style:{backfaceVisibility:"hidden",willChange:"transform",transform:`translate3d(0, ${V?"0px":`-${F+12}px`}, 0)`},children:[s.jsx("div",{className:"mx-16 px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>e("/tools/products"),className:"border-[#ff1f6c]/20 bg-white text-foreground hover:bg-[#ffe8f1] hover:text-[#ff1f6c] hover:border-[#ff1f6c]/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-[#ff1f6c]/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full overflow-hidden bg-gray-100",children:s.jsx("img",{src:wt,alt:"Product Refiner Avatar",className:"h-full w-full object-cover"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-sm font-semibold text-gray-900",children:"Product Refiner"}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Step ",Ee," / ",$e]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:ce}),s.jsxs(Ie,{type:"button",variant:"ghost",size:"icon",onClick:Re,disabled:n||c||m,title:"Reset Product Refiner progress",className:"h-8 w-8 text-gray-500 hover:text-gray-700",children:[s.jsx(fu,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Reset Product Refiner progress"})]})]})]})}),r&&s.jsxs("div",{className:"mx-16 px-4 pb-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Progress"}),s.jsxs("span",{className:"text-xs font-bold bg-gradient-to-r from-vox-pink to-vox-orange bg-clip-text text-transparent",children:[Math.round(we),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-vox-pink via-vox-purple to-vox-orange transition-all duration-500 ease-out",style:{width:`${we}%`}})})]})]}),s.jsx("main",{className:"flex flex-1 flex-col overflow-hidden bg-white mx-16",style:{"--ava-avatar-url":`url(${wt})`},children:s.jsx("div",{ref:A,className:"flex-1 overflow-y-auto px-4",style:{paddingBottom:q?"120px":"0"},children:s.jsxs("div",{className:"mx-auto flex w-full flex-col",children:[s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:"I'll guide you through refining your product into a complete, strong, and confidently positioned offer."})}),n&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Loading workspace"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Preparing your Product Refiner environment."})]})]})})}),!n&&c&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content",children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Select a workspace to continue"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Product Refiner works inside a specific workspace. Choose one from the workspace switcher to activate this journey."})]})}),!n&&d&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsxs("div",{className:"margo-message-content bg-red-50 border-red-200",children:[s.jsx("p",{className:"font-medium text-red-700",children:"We ran into an issue"}),s.jsx("p",{className:"text-sm text-red-600 mt-1",children:d}),s.jsx(Ie,{onClick:()=>window.location.reload(),className:"mt-3 margo-soft-button margo-soft-button--sm",children:"Try again"})]})}),!n&&!c&&s.jsxs(s.Fragment,{children:[m&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--bot",children:s.jsx("div",{className:"margo-message-content",children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin text-gray-400 mt-0.5"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:"Restoring your progress"}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fetching your saved Product Refiner session for this workspace."})]})]})})}),!m&&s.jsxs(s.Fragment,{children:[T&&s.jsx("div",{className:"mb-4 pb-20",children:s.jsx($5,{workspaceId:T,session:r,onSessionChange:a,onErrorChange:g,isCompleted:oe,onInputHandlersReady:w},`product-refiner-step1-${T}`)}),T&&r&&oe&&s.jsx("div",{className:"mb-2",children:s.jsx(D5,{workspaceId:T,session:r,isActive:ae,isCompleted:z,isUnlocked:oe,onSessionChange:a,onError:g,onInputHandlersReady:v,persistedState:o.step2??null,onPersistedStateChange:Ue},`product-refiner-step2-${r.id}`)}),T&&r&&z&&s.jsx("div",{className:"mb-2",children:s.jsx(O5,{workspaceId:T,session:r,isActive:de,isCompleted:ee,isUnlocked:z,onSessionChange:a,onError:g,persistedState:o.step3??null,onPersistedStateChange:lt},`product-refiner-step3-${r.id}`)}),T&&r&&ee&&s.jsx("div",{className:"mb-2",children:s.jsx(F5,{workspaceId:T,session:r,isActive:re,isCompleted:ne,isUnlocked:ee,onSessionChange:a,onError:g,onInputHandlersReady:y,persistedState:o.step4??null,onPersistedStateChange:Ze},`product-refiner-step4-${r.id}`)}),T&&r&&ne&&s.jsx("div",{className:"mb-2",children:s.jsx(_5,{workspaceId:T,session:r,isActive:fe,isCompleted:me,isUnlocked:ne,onSessionChange:a,onError:g,onInputHandlersReady:N,persistedState:o.step5??null,onPersistedStateChange:ge},`product-refiner-step5-${r.id}`)}),T&&r&&me&&s.jsx("div",{className:"mb-5",children:s.jsx(L5,{workspaceId:T,session:r,isActive:Se,isCompleted:ve,isUnlocked:me,onSessionChange:a,onError:g,onInputHandlersReady:j,persistedState:o.step6??null,onPersistedStateChange:pe},`product-refiner-step6-${r.id}`)}),T&&r&&ve&&s.jsx("div",{className:"mb-5",children:s.jsx(V5,{workspaceId:T,session:r,isActive:he,isCompleted:D,isUnlocked:ve,onSessionChange:a,onError:g,onInputHandlersReady:C,persistedState:o.step7??null,onPersistedStateChange:ke},`product-refiner-step7-${r.id}`)}),T&&r&&D&&s.jsx("div",{className:"mb-5",children:s.jsx(B5,{workspaceId:T,session:r,isActive:se,isCompleted:ue,isUnlocked:D,onSessionChange:a,onError:g,onInputHandlersReady:B,persistedState:o.step8??null,onPersistedStateChange:be},`product-refiner-step8-${r.id}`)}),T&&r&&ue&&s.jsx("div",{className:"mb-5",children:s.jsx(W5,{workspaceId:T,session:r,isActive:J,isCompleted:O,isUnlocked:ue,onSessionChange:a,onError:g,onInputHandlersReady:Q,persistedState:o.step9??null,onPersistedStateChange:je},`product-refiner-step9-${r.id}`)}),T&&r&&O&&s.jsx("div",{className:"mb-5",children:s.jsx(U5,{workspaceId:T,session:r,isActive:Pe,isCompleted:H,isUnlocked:O,onSessionChange:a,onError:g},`product-refiner-step10-${r.id}`)})]})]}),s.jsx("div",{ref:E})]})})}),q&&s.jsx("div",{className:"fixed bottom-0 right-0 z-50 w-[82%] bg-white px-16 border-t border-gray-200",children:s.jsx("div",{className:"px-4 py-4",children:s.jsxs("div",{className:"mx-auto flex flex-col",style:{alignItems:"flex-start",justifyContent:"flex-start"},children:[s.jsxs("div",{className:"flex gap-3 w-full",style:{alignItems:"flex-start"},children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("div",{style:{maxHeight:"220px",overflowY:"auto"},children:s.jsx(fs,{id:"product-refiner-unified-input",ref:I,value:q.inputValue||"",onChange:Y=>{q.onInputChange(Y.target.value)},onInput:Te,onKeyDown:Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),console.log("[ProductRefiner] Enter key pressed, calling onInputSubmit"),(q.inputValue||q.currentQuestionKey)&&!q.isSubmitting&&q.onInputSubmit())},placeholder:q.placeholder||"",disabled:q.isSubmitting||!1,className:"flex w-full px-3 py-2 ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed resize-none bg-white border-2 rounded-xl text-sm pr-14 shadow-sm transition-all disabled:bg-gray-50 disabled:opacity-50",style:{height:"auto",minHeight:"56px",maxHeight:"200px",overflowY:"hidden",...q.validationError?{borderColor:"#ef4444"}:{borderColor:"#d1d5db"}},rows:1})}),s.jsx("div",{className:"text-xs mt-1 ml-1 text-red-600 min-h-[18px]",children:(q.validationError||q.validationHint)&&s.jsx("span",{children:q.validationError||q.validationHint})})]}),s.jsx(Ie,{onClick:()=>{console.log("[ProductRefiner] Button clicked!",{hasHandler:!!q.onInputSubmit,inputValue:q.inputValue,isSubmitting:q.isSubmitting,currentQuestionKey:q.currentQuestionKey}),!q.isSubmitting&&(q.inputValue||q.currentQuestionKey)&&q.onInputSubmit()},disabled:q.isSubmitting,size:"icon",className:"h-14 w-14 bg-gray-900 hover:bg-gray-800 text-white shrink-0 rounded-xl shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",style:{alignSelf:"flex-start"},children:q.isSubmitting?s.jsx(Qe,{className:"w-5 h-5 animate-spin"}):s.jsx(hu,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-2 text-center w-full",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px] border border-gray-300",children:"Enter"})," to send  ",s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px] border border-gray-300",children:"Shift+Enter"})," new line"]})]})})})]})})},G5=()=>{const e=Lt(),{currentWorkspace:t}=ls(),{toast:n}=yt(),[r,a]=i.useState(!0),[o,l]=i.useState([]),[c,u]=i.useState(new Set);i.useEffect(()=>{if(!(t!=null&&t.id)){n({title:"No Workspace Selected",description:"Please select a workspace to view previous Product Refiner sessions",variant:"destructive"}),e("/tools/products");return}d()},[t==null?void 0:t.id]);const d=async()=>{if(t!=null&&t.id){a(!0);try{const f=(await y5(t.id)||[]).filter(w=>w.status==="completed"||w.step10Completed===!0||!!w.completedAt);l(f)}catch(p){console.error("Failed to load Product Refiner sessions:",p),n({title:"Error",description:(p==null?void 0:p.message)||"Failed to load previous Product Refiner sessions",variant:"destructive"})}finally{a(!1)}}},g=async p=>{if(!c.has(p.id)){u(f=>new Set(f).add(p.id));try{const f=await _j(p.id),w=URL.createObjectURL(f),h=document.createElement("a");h.href=w;const x=(p.completedAt?new Date(p.completedAt):new Date(p.updatedAt||p.createdAt)).toISOString().replace(/[:.]/g,"-").replace("T","-").slice(0,-5),b=`Product-Refiner-${p.sessionName||p.userName||"Product"}-${x}.pdf`;h.download=b,h.click(),URL.revokeObjectURL(w),n({title:"PDF Downloaded",description:`Downloaded ${b}`})}catch(f){console.error("Failed to download Product Refiner PDF:",f),n({title:"Download Failed",description:(f==null?void 0:f.message)||"Failed to download product specification PDF",variant:"destructive"})}finally{u(f=>{const w=new Set(f);return w.delete(p.id),w})}}},m=p=>(typeof p=="string"?new Date(p):p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return s.jsx("div",{className:"h-[calc(100vh-80px)] overflow-hidden bg-gradient-to-br from-background via-background to-vox-orange/5 flex items-center justify-center p-6",children:s.jsxs("div",{className:"max-w-6xl w-full max-h-full flex flex-col space-y-6 overflow-hidden",children:[s.jsx("div",{className:"flex items-center justify-between flex-shrink-0",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>e("/tools/products"),className:"border-vox-orange/20 bg-background hover:!bg-gradient-to-r hover:!from-vox-orange/80 hover:!to-vox-pink/80 hover:!text-white hover:!border-vox-orange/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-vox-orange/20 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back to Product Tools"]}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-vox-orange via-vox-pink to-vox-orange bg-clip-text text-transparent",children:"Previous Product Refiner Sessions"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"View and download completed product specifications"})]})]})}),r?s.jsx(qe,{className:"border-vox-orange/20 flex-1 flex items-center justify-center",children:s.jsxs(Xe,{className:"p-12 flex items-center justify-center",children:[s.jsx(Qe,{className:"w-8 h-8 animate-spin text-vox-orange"}),s.jsx("span",{className:"ml-3 text-muted-foreground",children:"Loading sessions..."})]})}):o.length===0?s.jsx(qe,{className:"border-vox-orange/20 flex-1 flex items-center justify-center",children:s.jsxs(Xe,{className:"p-12 text-center",children:[s.jsx(Pn,{className:"w-16 h-16 mx-auto text-muted-foreground mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Completed Sessions"}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"You haven't completed any Product Refiner sessions yet. Start a session to see it here."}),s.jsx(Ie,{onClick:()=>{e("/tools/product-refiner",{state:{scrollToBottom:!0}})},className:"bg-gradient-to-r from-vox-orange to-vox-pink text-white",children:"Create New Session"})]})}):s.jsx("div",{className:"grid gap-4 overflow-y-auto flex-1 pr-2",children:o.map(p=>{const f=c.has(p.id),h=(p.completedAt?new Date(p.completedAt):new Date(p.createdAt)).toISOString().replace(/[:.]/g,"-").replace("T","-").slice(0,-5),x=`Product-Refiner-${p.sessionName||p.userName||"Product"}-${h}.pdf`;return s.jsx(qe,{className:"border-vox-orange/20 hover:border-vox-orange/40 transition-all duration-300 hover:shadow-lg",children:s.jsx(Xe,{className:"p-6",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-semibold text-foreground mb-1",children:p.sessionName||p.userName||"Product Refinement Session"}),s.jsx("p",{className:"text-sm text-muted-foreground font-mono",children:x})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-muted-foreground",children:[p.userName&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(zr,{className:"w-4 h-4"}),s.jsx("span",{children:p.userName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(mu,{className:"w-4 h-4"}),s.jsxs("span",{children:["Completed: ",m(p.completedAt||p.updatedAt||p.createdAt)]})]})]})]}),s.jsx(Ie,{onClick:()=>g(p),disabled:f,className:"bg-gradient-to-r from-vox-orange to-vox-pink text-white hover:shadow-lg transition-all duration-300 shrink-0",children:f?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Downloading..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ln,{className:"w-4 h-4 mr-2"}),"Download PDF"]})})]})})},p.id)})})]})})},mt=(e,t,n)=>{var c;const r=typeof import.meta<"u"?(c=import.meta)==null?void 0:c.env:void 0;if((r==null?void 0:r.MODE)==="test"||(r==null?void 0:r.VITEST))return;const o=new Date().toISOString(),l=`[VERA API][${e.toUpperCase()}][${t}]`;n&&Object.keys(n).length>0?console.log(l,{...n,timestamp:o}):console.log(l,{timestamp:o})},jx=async(e,t)=>{const n=`${Fe}/vera-profiles`,r="createVeraProfile";mt("request",r,{endpoint:n,workspaceId:e,name:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify({workspaceId:e,name:t})});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to create Vera profile"}));throw mt("failure",r,{endpoint:n,workspaceId:e,name:t,status:a.status,error:l}),new Error(l.message||"Failed to create Vera profile")}const o=await a.json();return mt("success",r,{endpoint:n,workspaceId:e,name:t,status:a.status,response:o}),o}catch(a){throw mt("failure",r,{endpoint:n,workspaceId:e,name:t,error:(a==null?void 0:a.message)||a}),a}},Yi=async e=>{const t=`${Fe}/vera-profiles/workspace/${e}`,n="getVeraProfiles";mt("request",n,{endpoint:t,workspaceId:e});try{const r=await Oe.makeAuthenticatedRequest(t,{method:"GET"});if(!r.ok){const o=await r.json().catch(()=>({message:"Failed to get Vera profiles"}));throw mt("failure",n,{endpoint:t,workspaceId:e,status:r.status,error:o}),new Error(o.message||"Failed to get Vera profiles")}const a=await r.json();return mt("success",n,{endpoint:t,workspaceId:e,status:r.status}),a}catch(r){throw mt("failure",n,{endpoint:t,workspaceId:e,error:(r==null?void 0:r.message)||r}),r}},q5=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step1/welcome`,r="submitVeraStep1";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 1"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 1")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},Y5=async e=>{const t=`${Fe}/vera-profiles/${e}/step1/confirm-ready`,n="confirmVeraReady";mt("request",n,{endpoint:t,profileId:e});try{const r=await Oe.makeAuthenticatedRequest(t,{method:"POST"});if(!r.ok){const o=await r.json().catch(()=>({message:"Failed to confirm ready"}));throw mt("failure",n,{endpoint:t,profileId:e,status:r.status,error:o}),new Error(o.message||"Failed to confirm ready")}const a=await r.json();return mt("success",n,{endpoint:t,profileId:e,status:r.status}),a}catch(r){throw mt("failure",n,{endpoint:t,profileId:e,error:(r==null?void 0:r.message)||r}),r}},J5=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step2/foundation`,r="submitVeraStep2";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 2"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 2")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},K5=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step3/personality`,r="submitVeraStep3";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 3"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 3")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},X5=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step4/style`,r="submitVeraStep4";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 4"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 4")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},Z5=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step5/dos-donts`,r="submitVeraStep5";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 5"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 5")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},e3=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step6/relationship`,r="submitVeraStep6";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 6"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 6")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},t3=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step7/scenarios`,r="submitVeraStep7";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 7"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 7")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},Sx=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step8/samples`,r="submitVeraStep8";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 8"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 8")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},kx=async(e,t)=>{const n=`${Fe}/vera-profiles/${e}/step9/calibrate`,r="submitVeraStep9";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to submit Step 9"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to submit Step 9")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},Px=async(e,t={})=>{const n=`${Fe}/vera-profiles/${e}/step10/finalize`,r="submitVeraStep10";mt("request",r,{endpoint:n,profileId:e,payload:t});try{const a=await Oe.makeAuthenticatedRequest(n,{method:"POST",body:JSON.stringify(t)});if(!a.ok){const l=await a.json().catch(()=>({message:"Failed to finalize profile"}));throw mt("failure",r,{endpoint:n,profileId:e,status:a.status,error:l}),new Error(l.message||"Failed to finalize profile")}const o=await a.json();return mt("success",r,{endpoint:n,profileId:e,status:a.status}),o}catch(a){throw mt("failure",r,{endpoint:n,profileId:e,error:(a==null?void 0:a.message)||a}),a}},s3=({workspaceId:e,profile:t,onProfileChange:n,onLoadingChange:r,onErrorChange:a,isCompleted:o=!1,onInputHandlersReady:l,persistedState:c,onPersistedStateChange:u})=>{const{toast:d}=yt(),[g,m]=i.useState(!1),[p,f]=i.useState(!1),[w,h]=i.useState((t==null?void 0:t.userName)??""),[v,x]=i.useState("I'm ready"),[y,b]=i.useState(!1),[N,S]=i.useState((c==null?void 0:c.roleExplanationMessage)??null),j=i.useRef(!1),k=i.useRef(!1),[C,W]=i.useState(!1),[B,U]=i.useState(!1),[Q,V]=i.useState(!1),[P,K]=i.useState(!1);i.useEffect(()=>{h((t==null?void 0:t.userName)??"")},[t==null?void 0:t.userName]),i.useEffect(()=>{S((c==null?void 0:c.roleExplanationMessage)??null)},[c==null?void 0:c.roleExplanationMessage]),i.useEffect(()=>{t!=null&&t.isComplete&&x("I'm ready")},[t==null?void 0:t.isComplete]);const G=!!(t!=null&&t.userName);i.useEffect(()=>{t||(j.current=!1)},[t]),i.useEffect(()=>{t||(k.current=!1,m(!1),r==null||r(!1))},[e,t,r]),i.useEffect(()=>{G||(S(null),u==null||u(null))},[G,u]),i.useEffect(()=>{const L=!t||t.currentStep===1;if(!t||o||!L||G){W(!0),U(!0),V(!0),K(!0);return}W(!1),U(!1),V(!1),K(!1);const I=setTimeout(()=>{W(!0)},300),_=setTimeout(()=>{U(!0),V(!0),K(!0)},1800);return()=>{clearTimeout(I),clearTimeout(_)}},[t,o,G]),i.useEffect(()=>{if(!e){m(!1),r==null||r(!1);return}if(t){m(!1),r==null||r(!1);return}if(k.current){m(!1),r==null||r(!1);return}let L=!1;return k.current=!0,(async()=>{var _,$,F;m(!0),r==null||r(!0),a==null||a(null);try{const M=await Yi(e);if(L)return;const ie=((M==null?void 0:M.data)||[]).find(ne=>!ne.isComplete);if(ie){if(ie.currentStep===1&&!ie.userName){n(ie),m(!1),r==null||r(!1);return}const me=`My Voice Identity ${new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5)}`,ve=await jx(e,me);if(L)return;const D=ve==null?void 0:ve.data;if(!D||!D.id)throw new Error("Failed to create profile - invalid response");const ue={...D,currentStep:1,status:D.status||"active"};n(ue),m(!1),r==null||r(!1);return}const le=`My Voice Identity ${new Date().toISOString().replace(/[:.]/g,"-").slice(0,-5)}`,oe=await jx(e,le);if(L)return;const z=oe==null?void 0:oe.data;if(!z||!z.id)throw new Error("Failed to create profile - invalid response");const ee={...z,currentStep:z.currentStep||1,status:z.status||"active"};n(ee),m(!1),r==null||r(!1)}catch(M){if(L)return;if((_=M==null?void 0:M.message)!=null&&_.includes("409")||($=M==null?void 0:M.message)!=null&&$.toLowerCase().includes("already exists")||(F=M==null?void 0:M.message)!=null&&F.toLowerCase().includes("conflict"))try{const ie=await Yi(e);if(L)return;const Z=(ie==null?void 0:ie.data)||[],le=Z.find(oe=>!oe.isComplete);if(le){n(le);return}if(Z.length>0){const oe=Z.sort((z,ee)=>new Date(ee.updatedAt).getTime()-new Date(z.updatedAt).getTime())[0];n(oe);return}}catch(ie){console.error("Failed to fetch existing profiles:",ie)}const T=(M==null?void 0:M.message)||"Failed to initialize Vera profile";a==null||a(T),d({title:"Error",description:T,variant:"destructive"}),k.current=!1}finally{m(!1),r==null||r(!1)}})(),()=>{L=!0}},[e,t]);const q=i.useCallback(async()=>{var I;if(!t||p)return;const L=w.trim();if(!L){d({title:"Name required",description:"Please enter your name.",variant:"destructive"});return}if(L.length<2){d({title:"Name too short",description:"Name must be at least 2 characters long.",variant:"destructive"});return}f(!0),a==null||a(null);try{const _=await q5(t.id,{userName:L}),$=((I=_==null?void 0:_.data)==null?void 0:I.message)||(_==null?void 0:_.message)||"";S($),u==null||u({roleExplanationMessage:$});const F={...t,userName:L};n(F)}catch(_){const $=(_==null?void 0:_.message)||"Failed to submit name";a==null||a($),d({title:"Error",description:$,variant:"destructive"})}finally{f(!1)}},[t,p,w,d,a,n]),A=async()=>{if(!(!t||y)){b(!0),a==null||a(null);try{await Y5(t.id);const L={...t,currentStep:2};n(L),d({title:"Step 1 completed",description:"Welcome and introduction completed."})}catch(L){const I=(L==null?void 0:L.message)||"Failed to confirm ready";a==null||a(I),d({title:"Error",description:I,variant:"destructive"})}finally{b(!1)}}};if(i.useEffect(()=>{if(!l)return;if(t&&t.currentStep===1&&!G&&!o){const I=w.trim(),_=I.length>0&&I.length<2;l({inputValue:w,onInputChange:h,onInputSubmit:q,isSubmitting:p,placeholder:"Enter your name",validationHint:_?"Required  minimum 2 characters":null,validationError:_?null:void 0})}else l(null)},[l,t,G,o,w,p,q]),g||!t)return s.jsx("div",{className:"flex items-center justify-center py-12",children:s.jsx(Qe,{className:"w-6 h-6 animate-spin text-vox-pink"})});const E=`Welcome to Vera  Your Voice Identity System

I'm here to help you define, refine, and stabilize the tone, style, personality, communication principles, and expression of your brand voice.`,R=G&&t.currentStep===1&&!o;return s.jsxs("div",{className:"space-y-6",children:[C&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:Q?s.jsx(gs,{text:E}):s.jsx(Ge,{text:E,onComplete:()=>V(!0)})})]}),B&&t.currentStep===1&&!G&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:P?s.jsx("p",{className:"text-gray-800",children:" What's your name?"}):s.jsx(Ge,{text:" What's your name?",onComplete:()=>K(!0)})})]}),N&&G&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx(gs,{text:N})})]}),R&&s.jsx("div",{className:"margo-chat-bubble margo-chat-bubble--user w-full",style:{maxWidth:"100%"},children:s.jsx("div",{className:"margo-message-content",style:{padding:0},children:s.jsx(Ie,{onClick:A,disabled:y,className:"margo-soft-button w-full text-lg font-semibold justify-center",style:{height:"auto"},children:y?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin mr-2"}),"Processing..."]}):v})})}),o&&t.userName&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:"Step 1 completed: Welcome and introduction"})})]})]})},n3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a,onInputHandlersReady:o})=>{const l={brandStandsFor:10,valuesToExpress:10,targetEmotions:10,desiredPerception:10},{toast:c}=yt(),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(!1),[w,h]=i.useState(""),[v,x]=i.useState(null),[y,b]=i.useState(new Set),[N,S]=i.useState(null),[j,k]=i.useState({}),C=i.useRef(null),W=i.useRef(e);i.useEffect(()=>{W.current=e},[e]);const B=i.useCallback(A=>{if(!W.current)return;const E={...W.current,...A};W.current=E,r(E)},[r]),U=i.useMemo(()=>[{key:"brandStandsFor",label:"What does your brand stand for?",example:"Example: 'We stand for empowering small business owners to build sustainable, profitable businesses without sacrificing their personal lives. We believe that success should enhance life, not consume it.'"},{key:"valuesToExpress",label:"What values do you want your communication to express?",example:"Example: 'We want our communication to express authenticity, transparency, and genuine care. We value honesty over perfection, and we want our audience to feel understood and supported.'"},{key:"targetEmotions",label:"What emotions should the audience feel when interacting with your brand?",example:"Example: 'We want our audience to feel inspired, confident, and empowered. They should feel like they're part of a community that understands their challenges and believes in their potential.'"},{key:"desiredPerception",label:"How should your communication make the audience perceive you?",example:"Example: 'We want to be perceived as trusted advisors who are both knowledgeable and approachable. We're experts who remember what it's like to be a beginner, and we're here to guide, not to intimidate.'"}],[]),Q=U.length,[V,P]=i.useState({brandStandsFor:(e==null?void 0:e.brandStandsFor)||"",valuesToExpress:(e==null?void 0:e.valuesToExpress)||"",targetEmotions:(e==null?void 0:e.targetEmotions)||"",desiredPerception:(e==null?void 0:e.desiredPerception)||""});i.useEffect(()=>{v&&C.current&&setTimeout(()=>{var A;(A=C.current)==null||A.scrollIntoView({behavior:"smooth",block:"start"})},100)},[v]),i.useEffect(()=>{P({brandStandsFor:(e==null?void 0:e.brandStandsFor)||"",valuesToExpress:(e==null?void 0:e.valuesToExpress)||"",targetEmotions:(e==null?void 0:e.targetEmotions)||"",desiredPerception:(e==null?void 0:e.desiredPerception)||""})},[e]),i.useEffect(()=>{const A=new Set;U.forEach(E=>{const R=V[E.key];R&&R.trim()&&A.add(E.key)}),b(A)},[V,U]);const K=i.useCallback(A=>{const E=A||V;for(const R of U){const L=E[R.key];if(!L||!L.trim())return R}return null},[V,U]);i.useEffect(()=>{if(t&&!n){const A=K();A&&U.findIndex(R=>R.key===A.key)>=0&&(x(A.key),h(V[A.key]||""))}},[t,n,K,U,V]),i.useEffect(()=>{v&&k(A=>A[v]?A:{...A,[v]:!0})},[v]);const G=(A,E)=>{const R=E.replace(/^Example:\s*/i,"").replace(/^['"]|['"]$/g,"").trim();x(A),h(R),requestAnimationFrame(()=>{var L;(L=document.getElementById("vera-unified-input"))==null||L.scrollIntoView({behavior:"smooth",block:"center"})})};i.useEffect(()=>{if(!v){C.current=null;return}if(!t)return;const A=C.current;A&&A.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},[v,t]),i.useEffect(()=>{t&&!n?setTimeout(()=>m(!0),300):(m(!0),f(!0))},[t,n]);const q=i.useCallback(async(A,E)=>{var I;if(!((I=W.current)!=null&&I.id)){c({title:"Profile missing",description:"Please refresh and try again.",variant:"destructive"});return}const R=E.trim(),L=l[A]??3;if(!R){const _=U.find($=>$.key===A);S(`${(_==null?void 0:_.label)||"This field"} is required`);return}if(R.length<L){const _=U.find(M=>M.key===A),F=`${(_==null?void 0:_.label)||"This field"} must be at least ${L} characters`;S(F);return}S(null),d(!0),a==null||a(null);try{const _={...V,[A]:E.trim()};if(P(_),_.brandStandsFor.trim()&&_.valuesToExpress.trim()&&_.targetEmotions.trim()&&_.desiredPerception.trim()){await J5(W.current.id,{brandStandsFor:_.brandStandsFor.trim(),valuesToExpress:_.valuesToExpress.trim(),targetEmotions:_.targetEmotions.trim(),desiredPerception:_.desiredPerception.trim()});const F={...W.current,brandStandsFor:_.brandStandsFor.trim(),valuesToExpress:_.valuesToExpress.trim(),targetEmotions:_.targetEmotions.trim(),desiredPerception:_.desiredPerception.trim(),currentStep:3};W.current=F,r(F),x(null),h("")}else{B(_);const F=K(_);F&&U.findIndex(T=>T.key===F.key)>=0?(b(T=>new Set([...T,A])),k(T=>({...T,[A]:!1})),x(F.key),h(""),setTimeout(()=>{C.current&&C.current.scrollIntoView({behavior:"smooth",block:"start"})},300)):(x(null),h(""))}}catch(_){const $=(_==null?void 0:_.message)||"Failed to submit answer";a==null||a($),c({title:"Submission failed",description:$,variant:"destructive"})}finally{d(!1)}},[V,K,a,r,U,c]);return i.useEffect(()=>{if(!o)return;if(t&&!n&&v!==null){const E=U.find(M=>M.key===v),R=()=>{if(v&&w.trim())q(v,w);else if(v){const M=l[v]??3,T=(E==null?void 0:E.label)||"This field",ie=w.trim();ie?ie.length<M&&S(`${T} must be at least ${M} characters`):S(`${T} is required`)}},L=M=>{h(M),N&&M.trim().length>=(l[v??""]??3)&&S(null)},I=v?l[v]??10:10,_=(E==null?void 0:E.label)||"Answer",$=w.trim(),F=$.length>0&&$.length<I;o({inputValue:w,onInputChange:L,onInputSubmit:R,isSubmitting:u,placeholder:E?`Answer question ${(U.findIndex(M=>M.key===v)||0)+1} of ${Q}...`:"Enter your answer",currentQuestionKey:v,currentQuestionLabel:(E==null?void 0:E.label)||null,validationError:N,validationHint:F?`${_}  minimum ${I} characters`:null})}else o(null)},[o,t,n,v,w,u,q,U,N,Q]),e?s.jsxs(s.Fragment,{children:[t&&!n&&s.jsxs(s.Fragment,{children:[g&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:p?s.jsx(gs,{text:`Great, ${e.userName||"there"}!

Step 2: Communication Identity Foundation

Before we dive into specific voice characteristics, let's establish the foundation of your brand's communication identity. This foundation will guide all the decisions we make in the steps ahead.

I'll ask you four foundational questions. Take your time to think about each one, and provide detailed, thoughtful answers. I'll provide examples to help guide you.

Let's begin:`}):s.jsx(Ge,{text:`Great, ${e.userName||"there"}!

Step 2: Communication Identity Foundation

Before we dive into specific voice characteristics, let's establish the foundation of your brand's communication identity. This foundation will guide all the decisions we make in the steps ahead.

I'll ask you four foundational questions. Take your time to think about each one, and provide detailed, thoughtful answers. I'll provide examples to help guide you.

Let's begin:`,onComplete:()=>f(!0)})})]}),U.map((A,E)=>{const R=y.has(A.key),L=A.key===v;if(!R&&!L)return null;const I=E+1,_=V[A.key];return s.jsxs("div",{className:"space-y-3 mb-2",ref:L?$=>{$&&(C.current=$)}:void 0,children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",I," of ",Q]}),s.jsx(Ge,{text:A.label,chunkClassName:"text-base text-gray-900",staggerMs:30}),R&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})]}),L&&!R&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Example Inspiration"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{type:"button",onClick:()=>G(A.key,A.example||""),className:"text-sm font-semibold text-vox-pink hover:text-vox-pink/80 transition-colors",children:"Use this example"}),s.jsx("button",{type:"button",onClick:$=>{$.preventDefault(),k(F=>({...F,[A.key]:!F[A.key]}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":j[A.key]?"Hide example":"Show example",children:j[A.key]?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]})]}),j[A.key]&&A.example&&s.jsxs("div",{className:"px-4 py-3 space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:A.example}),s.jsx("div",{className:"text-xs text-gray-500",children:"Feel free to personalize this example before submitting."})]})]})})]}),R&&_&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"bg-vox-pink/5 border border-vox-pink/20 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_})})})]})]},A.key)}),s.jsx("div",{className:"h-12","aria-hidden":!0})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:" Step 2 completed - Communication Identity Foundation saved"})})]})]}):null},r3=["Authoritative","Warm","Bold","Direct","Calm","Grounded","Inspirational","Energetic","Professional","Friendly","Empathetic","Confident"],a3=["Supportive","Encouraging","Analytical","Creative","Practical","Visionary","Humble","Ambitious"],o3=["Condescending","Overly casual","Jargon-heavy","Vague","Aggressive","Passive"],i3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a})=>{const{toast:o}=yt(),[l,c]=i.useState(!1),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState((e==null?void 0:e.traitDescriptions)||null),[w,h]=i.useState(e!=null&&e.primaryTraits?JSON.parse(JSON.stringify(e.primaryTraits)):[]),[v,x]=i.useState(e!=null&&e.secondaryTraits?JSON.parse(JSON.stringify(e.secondaryTraits)):[]),[y,b]=i.useState(e!=null&&e.traitsToAvoid?JSON.parse(JSON.stringify(e.traitsToAvoid)):[]),[N,S]=i.useState((e==null?void 0:e.emotionalToneRange)||"");i.useEffect(()=>{e!=null&&e.primaryTraits&&h(JSON.parse(JSON.stringify(e.primaryTraits))),e!=null&&e.secondaryTraits&&x(JSON.parse(JSON.stringify(e.secondaryTraits))),e!=null&&e.traitsToAvoid&&b(JSON.parse(JSON.stringify(e.traitsToAvoid))),S((e==null?void 0:e.emotionalToneRange)||""),e!=null&&e.traitDescriptions&&f(e.traitDescriptions)},[e]),i.useEffect(()=>{t&&!n?setTimeout(()=>d(!0),300):(d(!0),m(!0))},[t,n]);const j=R=>{const L=R!=null&&R.trait?R.trait.trim():"",I=R!=null&&R.description?R.description.trim():"";return{name:L,description:I}},k=R=>{const{name:L}=j(R);return L.length===0||L.length<2},C=R=>{const{description:L}=j(R);return L.length===0||L.length<10},W=R=>{const{name:L}=j(R);return L.length>0&&L.length<2},B=R=>{const{name:L,description:I}=j(R);return L.length>0&&(I.length===0||I.length<10)},U=()=>{h([...w,{trait:"",description:""}])},Q=(R,L,I)=>{const _=[...w];_[R]={..._[R],[L]:I},h(_)},V=R=>{h(w.filter((L,I)=>I!==R))},P=()=>{x([...v,{trait:"",description:""}])},K=(R,L,I)=>{const _=[...v];_[R]={..._[R],[L]:I},x(_)},G=R=>{x(v.filter((L,I)=>I!==R))},q=R=>{y.includes(R)||b([...y,R])},A=R=>{b(y.filter(L=>L!==R))},E=async()=>{var _;if(!e||l)return;if(w.length===0){o({title:"Please add at least one primary trait",description:"You must define at least one primary personality trait.",variant:"destructive"});return}if(w.filter($=>!$.trait.trim()||!$.description.trim()).length>0){o({title:"Please complete all trait descriptions",description:"All primary traits must have both a name and description.",variant:"destructive"});return}if(w.filter($=>$.trait.trim().length<2||$.description.trim().length<10).length>0){o({title:"Trait descriptions too short",description:"Trait names must be at least 2 characters and descriptions must be at least 10 characters.",variant:"destructive"});return}if(v.filter($=>$.trait.trim()&&($.trait.trim().length<2||$.description.trim().length<10)).length>0){o({title:"Secondary trait descriptions too short",description:"Secondary trait names must be at least 2 characters and descriptions must be at least 10 characters.",variant:"destructive"});return}c(!0),a==null||a(null);try{const $=await K5(e.id,{primaryTraits:w.filter(T=>T.trait.trim()&&T.description.trim()),secondaryTraits:v.filter(T=>T.trait.trim()&&T.description.trim()),traitsToAvoid:y,emotionalToneRange:N.trim()}),F=(_=$==null?void 0:$.data)==null?void 0:_.refinedDescriptions;F&&f(F);const M={...e,primaryTraits:w.filter(T=>T.trait.trim()&&T.description.trim()),secondaryTraits:v.filter(T=>T.trait.trim()&&T.description.trim()),traitsToAvoid:y,emotionalToneRange:N.trim(),traitDescriptions:F||e.traitDescriptions,currentStep:4};r(M),o({title:"Step 3 completed",description:"Voice personality traits saved and refined."})}catch($){const F=($==null?void 0:$.message)||"Failed to submit Step 3";a==null||a(F),o({title:"Error",description:F,variant:"destructive"})}finally{c(!1)}};return e?s.jsxs("div",{className:"space-y-6",children:[u&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:g?s.jsx(gs,{text:`Excellent work, ${e.userName||"there"}!

Step 3: Voice Personality Definition

Now that we have your communication foundation, let's give your brand voice depth through personality traits and expression qualities.

Your brand voice should have a distinct personalityjust like a person. This personality will make your communication more memorable, relatable, and authentic.

Here are some example personality combinations:
 Authoritative but warm
 Bold and direct
 Calm and grounded
 Inspirational and energetic

You'll select and define:
1. Primary personality traits (the core characteristics)
2. Secondary traits (supporting characteristics)
3. Traits to avoid (what you don't want to be)
4. Emotional tone range (the spectrum of emotions you express)

For each trait you choose, you'll write a description. I'll then help refine these descriptions for clarity and consistency.

Let's start by selecting your primary personality traits.`}):s.jsx(Ge,{text:`Excellent work, ${e.userName||"there"}!

Step 3: Voice Personality Definition

Now that we have your communication foundation, let's give your brand voice depth through personality traits and expression qualities.

Your brand voice should have a distinct personalityjust like a person. This personality will make your communication more memorable, relatable, and authentic.

Here are some example personality combinations:
 Authoritative but warm
 Bold and direct
 Calm and grounded
 Inspirational and energetic

You'll select and define:
1. Primary personality traits (the core characteristics)
2. Secondary traits (supporting characteristics)
3. Traits to avoid (what you don't want to be)
4. Emotional tone range (the spectrum of emotions you express)

For each trait you choose, you'll write a description. I'll then help refine these descriptions for clarity and consistency.

Let's start by selecting your primary personality traits.`,onComplete:()=>m(!0)})})]}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Primary Personality Traits"}),w.map((R,L)=>s.jsxs("div",{className:"mb-4 p-4 border rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ft,{value:R.trait,onChange:I=>Q(L,"trait",I.target.value),placeholder:"Trait name (e.g., Authoritative)",className:"flex-1",disabled:n||!t}),s.jsx(Ie,{variant:"ghost",size:"icon",onClick:()=>V(L),disabled:n||!t,children:s.jsx(Es,{className:"w-4 h-4"})})]}),t&&!n&&k(R)&&s.jsx("p",{className:"text-xs text-red-600",children:"Required  minimum 2 characters"}),s.jsx(fs,{value:R.description,onChange:I=>Q(L,"description",I.target.value),placeholder:"Describe what this trait means for your brand voice...",className:"min-h-[80px]",disabled:n||!t}),t&&!n&&C(R)&&s.jsx("p",{className:"text-xs text-red-600",children:"Required  minimum 10 characters"})]},L)),t&&!n&&s.jsxs(Ie,{variant:"outline",onClick:U,className:"w-full",children:[s.jsx(Na,{className:"w-4 h-4 mr-2"}),"Add Primary Trait"]}),s.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:r3.map(R=>s.jsx(Ie,{variant:"ghost",size:"sm",onClick:()=>{t&&!n&&(U(),Q(w.length,"trait",R))},disabled:n||!t,className:"text-xs",children:R},R))})]})]})}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Secondary Traits (Optional)"}),v.map((R,L)=>s.jsxs("div",{className:"mb-4 p-4 border rounded-lg space-y-2",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ft,{value:R.trait,onChange:I=>K(L,"trait",I.target.value),placeholder:"Trait name",className:"flex-1",disabled:n||!t}),s.jsx(Ie,{variant:"ghost",size:"icon",onClick:()=>G(L),disabled:n||!t,children:s.jsx(Es,{className:"w-4 h-4"})})]}),t&&!n&&W(R)&&s.jsx("p",{className:"text-xs text-red-600",children:"Optional  minimum 2 characters when provided"}),s.jsx(fs,{value:R.description,onChange:I=>K(L,"description",I.target.value),placeholder:"Describe this trait...",className:"min-h-[80px]",disabled:n||!t}),t&&!n&&B(R)&&s.jsx("p",{className:"text-xs text-red-600",children:"Optional  minimum 10 characters when provided"})]},L)),t&&!n&&s.jsxs(Ie,{variant:"outline",onClick:P,className:"w-full",children:[s.jsx(Na,{className:"w-4 h-4 mr-2"}),"Add Secondary Trait"]}),s.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:a3.map(R=>s.jsx(Ie,{variant:"ghost",size:"sm",onClick:()=>{t&&!n&&(P(),K(v.length,"trait",R))},disabled:n||!t,className:"text-xs",children:R},R))})]})]})}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Traits to Avoid"}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:y.map(R=>s.jsxs("div",{className:"flex items-center gap-2 px-3 py-1 bg-red-50 border border-red-200 rounded-full",children:[s.jsx("span",{className:"text-sm",children:R}),t&&!n&&s.jsx("button",{onClick:()=>A(R),className:"text-red-600 hover:text-red-800",children:s.jsx(Es,{className:"w-3 h-3"})})]},R))}),s.jsx("div",{className:"flex flex-wrap gap-2",children:o3.map(R=>s.jsx(Ie,{variant:"outline",size:"sm",onClick:()=>q(R),disabled:n||!t||y.includes(R),className:"text-xs",children:R},R))})]})]})}),s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg mb-3",children:"Emotional Tone Range (Optional)"}),s.jsx(fs,{value:N,onChange:R=>S(R.target.value),placeholder:"Describe the range of emotions your brand voice expresses (e.g., 'From confident and energetic to calm and reassuring')",className:"min-h-[100px]",disabled:n||!t}),t&&!n&&N.trim().length>0&&N.trim().length<10&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Optional  aim for at least 10 characters when provided"})]})]})}),p&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsxs("div",{className:"flex-1 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Refined Trait Descriptions"}),s.jsx("div",{className:"space-y-2 text-sm",children:Object.entries(p).map(([R,L])=>s.jsxs("div",{children:[s.jsxs("strong",{children:[R,":"]})," ",L]},R))})]})]}),t&&!n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx(Ie,{onClick:E,disabled:l||w.length===0,className:"bg-vox-pink hover:bg-vox-pink/90",children:l?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing & Refining..."]}):"Continue to Step 4"})})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:"Step 3 completed: Voice Personality Definition"})})]})]}):null},l3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a,onInputHandlersReady:o})=>{const l={sentenceStyle:10,vocabularyPreferences:10,pacingAndRhythm:10,useOfMetaphors:10,degreeOfDirectness:10,formalityLevel:10,useOfExamples:10,useOfEncouragement:10},{toast:c}=yt(),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(!1),[w,h]=i.useState(""),[v,x]=i.useState(null),[y,b]=i.useState(new Set),[N,S]=i.useState(null),[j,k]=i.useState({}),C=i.useRef(null),W=i.useRef(e);i.useEffect(()=>{W.current=e},[e]);const B=i.useCallback(A=>{if(!W.current)return;const E={...W.current,...A};W.current=E,r(E)},[r]),U=i.useMemo(()=>[{key:"sentenceStyle",label:"Sentence Style",example:"Example: 'We use short, punchy sentences for impact. Our sentences are clear and direct, avoiding unnecessary complexity. We prefer active voice over passive voice.'"},{key:"vocabularyPreferences",label:"Vocabulary Preferences",example:"Example: 'Our vocabulary is plain and accessibleno jargon. We use everyday language that our audience understands. When technical terms are necessary, we explain them clearly.'"},{key:"pacingAndRhythm",label:"Pacing and Rhythm",example:"Example: 'Our communication has a moderate, balanced pace. We vary sentence length to create rhythm. We use pauses (commas, periods) strategically to guide the reader's attention.'"},{key:"useOfMetaphors",label:"Use of Metaphors or Storytelling",example:"Example: 'We tell stories to illustrate points and make concepts relatable. We use metaphors sparingly but effectively. We prefer real-world examples over abstract comparisons.'"},{key:"degreeOfDirectness",label:"Degree of Directness",example:"Example: 'We're direct but warm. We get to the point quickly while maintaining a supportive tone. We don't beat around the bush, but we're never harsh or dismissive.'"},{key:"formalityLevel",label:"Formality Level",example:"Example: 'We maintain a moderately formal toneprofessional but approachable. We avoid overly casual language, but we're not stiff or corporate-sounding. We strike a balance between friendly and authoritative.'"},{key:"useOfExamples",label:"Use of Examples, Analogies, or Visuals",example:"Example: 'We use examples liberally to clarify concepts. We prefer concrete examples over abstract explanations. We use analogies when they help simplify complex ideas. We reference visuals when appropriate.'"},{key:"useOfEncouragement",label:"Use of Encouragement or Reinforcement",example:"Example: 'We reinforce key points through repetition and positive reinforcement. We celebrate progress and acknowledge effort. We use encouraging language to motivate our audience without being patronizing.'"}],[]),Q=U.length,[V,P]=i.useState({sentenceStyle:(e==null?void 0:e.sentenceStyle)||"",vocabularyPreferences:(e==null?void 0:e.vocabularyPreferences)||"",pacingAndRhythm:(e==null?void 0:e.pacingAndRhythm)||"",useOfMetaphors:(e==null?void 0:e.useOfMetaphors)||"",degreeOfDirectness:(e==null?void 0:e.degreeOfDirectness)||"",formalityLevel:(e==null?void 0:e.formalityLevel)||"",useOfExamples:(e==null?void 0:e.useOfExamples)||"",useOfEncouragement:(e==null?void 0:e.useOfEncouragement)||""});i.useEffect(()=>{P({sentenceStyle:(e==null?void 0:e.sentenceStyle)||"",vocabularyPreferences:(e==null?void 0:e.vocabularyPreferences)||"",pacingAndRhythm:(e==null?void 0:e.pacingAndRhythm)||"",useOfMetaphors:(e==null?void 0:e.useOfMetaphors)||"",degreeOfDirectness:(e==null?void 0:e.degreeOfDirectness)||"",formalityLevel:(e==null?void 0:e.formalityLevel)||"",useOfExamples:(e==null?void 0:e.useOfExamples)||"",useOfEncouragement:(e==null?void 0:e.useOfEncouragement)||""})},[e]),i.useEffect(()=>{const A=new Set;U.forEach(E=>{const R=V[E.key];R&&R.trim()&&A.add(E.key)}),b(A)},[V,U]);const K=i.useCallback(A=>{const E=A||V;for(const R of U){const L=E[R.key];if(!L||!L.trim())return R}return null},[V,U]);i.useEffect(()=>{if(t&&!n){const A=K();A&&U.findIndex(R=>R.key===A.key)>=0&&(x(A.key),h(V[A.key]||""))}},[t,n,K,U,V]),i.useEffect(()=>{v&&k(A=>A[v]?A:{...A,[v]:!0})},[v]);const G=(A,E)=>{const R=E.replace(/^Example:\s*/i,"").replace(/^['"]|['"]$/g,"").trim();x(A),h(R),requestAnimationFrame(()=>{var L;(L=document.getElementById("vera-unified-input"))==null||L.scrollIntoView({behavior:"smooth",block:"center"})})};i.useEffect(()=>{if(!v){C.current=null;return}if(!t)return;const A=C.current;A&&A.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},[v,t]),i.useEffect(()=>{t&&!n?setTimeout(()=>m(!0),300):(m(!0),f(!0))},[t,n]);const q=i.useCallback(async(A,E)=>{var I;if(!((I=W.current)!=null&&I.id)){c({title:"Profile missing",description:"Please refresh and try again.",variant:"destructive"});return}const R=E.trim(),L=l[A]??3;if(!R){const _=U.find($=>$.key===A);S(`${(_==null?void 0:_.label)||"This field"} is required`);return}if(R.length<L){const _=U.find(M=>M.key===A),F=`${(_==null?void 0:_.label)||"This field"} must be at least ${L} characters`;S(F);return}S(null),d(!0),a==null||a(null);try{const _={...V,[A]:E.trim()};if(P(_),_.sentenceStyle.trim()&&_.vocabularyPreferences.trim()&&_.pacingAndRhythm.trim()&&_.useOfMetaphors.trim()&&_.degreeOfDirectness.trim()&&_.formalityLevel.trim()&&_.useOfExamples.trim()&&_.useOfEncouragement.trim()){await X5(W.current.id,{sentenceStyle:_.sentenceStyle.trim(),vocabularyPreferences:_.vocabularyPreferences.trim(),pacingAndRhythm:_.pacingAndRhythm.trim(),useOfMetaphors:_.useOfMetaphors.trim(),degreeOfDirectness:_.degreeOfDirectness.trim(),formalityLevel:_.formalityLevel.trim(),useOfExamples:_.useOfExamples.trim(),useOfEncouragement:_.useOfEncouragement.trim()});const F={...W.current,..._,currentStep:5};W.current=F,r(F),x(null),h("")}else{B(_);const F=K(_);F&&U.findIndex(T=>T.key===F.key)>=0?(b(T=>new Set([...T,A])),k(T=>({...T,[A]:!1})),x(F.key),h(""),setTimeout(()=>{C.current&&C.current.scrollIntoView({behavior:"smooth",block:"start"})},300)):(x(null),h(""))}}catch(_){const $=(_==null?void 0:_.message)||"Failed to submit answer";a==null||a($),c({title:"Submission failed",description:$,variant:"destructive"})}finally{d(!1)}},[V,K,a,r,U,c]);return i.useEffect(()=>{if(!o)return;if(t&&!n&&v!==null){const E=U.find(M=>M.key===v),R=()=>{if(v&&w.trim())q(v,w);else if(v){const M=l[v]??3,T=(E==null?void 0:E.label)||"This field",ie=w.trim();ie?ie.length<M&&S(`${T} must be at least ${M} characters`):S(`${T} is required`)}},L=M=>{h(M),N&&M.trim().length>=(l[v??""]??3)&&S(null)},I=v?l[v]??10:10,_=(E==null?void 0:E.label)||"Answer",$=w.trim(),F=$.length>0&&$.length<I;o({inputValue:w,onInputChange:L,onInputSubmit:R,isSubmitting:u,placeholder:E?`Answer question ${(U.findIndex(M=>M.key===v)||0)+1} of ${Q}...`:"Enter your answer",currentQuestionKey:v,currentQuestionLabel:(E==null?void 0:E.label)||null,validationError:N,validationHint:F?`${_}  minimum ${I} characters`:null})}else o(null)},[o,t,n,v,w,u,q,U,N,Q]),e?s.jsxs(s.Fragment,{children:[t&&!n&&s.jsxs(s.Fragment,{children:[g&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:p?s.jsx(gs,{text:`Well done, ${e.userName||"there"}!

Step 4: Voice Style Principles

Now let's establish the rules, patterns, and preferences that define how your brand communicates. These style principles will ensure consistency in your messaging.

I'll ask you about:
 Sentence style (short and punchy, rhythmic, structured, etc.)
 Vocabulary preferences (plain language, technical terms, poetic, energetic, etc.)
 Pacing and rhythm
 Use of metaphors or storytelling
 Degree of directness
 Formality level
 Use of examples, analogies, or visuals
 Use of encouragement or reinforcement

I'll provide examples to help guide you.

Let's begin:`}):s.jsx(Ge,{text:`Well done, ${e.userName||"there"}!

Step 4: Voice Style Principles

Now let's establish the rules, patterns, and preferences that define how your brand communicates. These style principles will ensure consistency in your messaging.

I'll ask you about:
 Sentence style (short and punchy, rhythmic, structured, etc.)
 Vocabulary preferences (plain language, technical terms, poetic, energetic, etc.)
 Pacing and rhythm
 Use of metaphors or storytelling
 Degree of directness
 Formality level
 Use of examples, analogies, or visuals
 Use of encouragement or reinforcement

I'll provide examples to help guide you.

Let's begin:`,onComplete:()=>f(!0)})})]}),U.map((A,E)=>{const R=y.has(A.key),L=A.key===v;if(!R&&!L)return null;const I=E+1,_=V[A.key];return s.jsxs("div",{className:"space-y-3 mb-2",ref:L?$=>{C.current=$}:void 0,children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",I," of ",Q]}),s.jsx(Ge,{text:A.label,chunkClassName:"text-base text-gray-900",staggerMs:30}),R&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})]}),L&&!R&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Example Inspiration"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{type:"button",onClick:()=>G(A.key,A.example||""),className:"text-sm font-semibold text-vox-pink hover:text-vox-pink/80 transition-colors",children:"Use this example"}),s.jsx("button",{type:"button",onClick:$=>{$.preventDefault(),k(F=>({...F,[A.key]:!F[A.key]}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":j[A.key]?"Hide example":"Show example",children:j[A.key]?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]})]}),j[A.key]&&A.example&&s.jsxs("div",{className:"px-4 py-3 space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:A.example}),s.jsx("div",{className:"text-xs text-gray-500",children:"Feel free to personalize this example before submitting."})]})]})})]}),R&&_&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"bg-vox-pink/5 border border-vox-pink/20 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:_})})})]})]},A.key)}),s.jsx("div",{className:"h-12","aria-hidden":!0})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:" Step 4 completed - Voice Style Principles saved"})})]})]}):null},c3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a})=>{const{toast:o}=yt(),[l,c]=i.useState(!1),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(e!=null&&e.dos?JSON.parse(JSON.stringify(e.dos)):[]),[w,h]=i.useState(e!=null&&e.donts?JSON.parse(JSON.stringify(e.donts)):[]),[v,x]=i.useState(""),[y,b]=i.useState(""),N=p.length>0||w.length>0,S=v.trim(),j=y.trim(),k=S.length>0&&S.length<5,C=j.length>0&&j.length<5;i.useEffect(()=>{e!=null&&e.dos&&f(JSON.parse(JSON.stringify(e.dos))),e!=null&&e.donts&&h(JSON.parse(JSON.stringify(e.donts)))},[e]),i.useEffect(()=>{t&&!n?setTimeout(()=>d(!0),300):(d(!0),m(!0))},[t,n]);const W=()=>{const P=v.trim();if(!P){o({title:"Do item required",description:"Please enter a Do item.",variant:"destructive"});return}if(P.length<5){o({title:"Do item too short",description:"Do item must be at least 5 characters long.",variant:"destructive"});return}f([...p,P]),x("")},B=P=>{f(p.filter((K,G)=>G!==P))},U=()=>{const P=y.trim();if(!P){o({title:"Don't item required",description:"Please enter a Don't item.",variant:"destructive"});return}if(P.length<5){o({title:"Don't item too short",description:"Don't item must be at least 5 characters long.",variant:"destructive"});return}h([...w,P]),b("")},Q=P=>{h(w.filter((K,G)=>G!==P))},V=async()=>{if(!e||l)return;if(p.length===0&&w.length===0){o({title:"Please add at least one Do or Don't",description:"You must define at least one Do or Don't for your brand voice.",variant:"destructive"});return}if(p.filter(G=>G.trim().length<5).length>0){o({title:"Do items too short",description:"Each Do item must be at least 5 characters long.",variant:"destructive"});return}if(w.filter(G=>G.trim().length<5).length>0){o({title:"Don't items too short",description:"Each Don't item must be at least 5 characters long.",variant:"destructive"});return}c(!0),a==null||a(null);try{await Z5(e.id,{dos:p,donts:w});const G={...e,dos:p,donts:w,currentStep:6};r(G),o({title:"Step 5 completed",description:"Voice Do's and Don'ts saved."})}catch(G){const q=(G==null?void 0:G.message)||"Failed to submit Step 5";a==null||a(q),o({title:"Error",description:q,variant:"destructive"})}finally{c(!1)}};return e?s.jsxs("div",{className:"space-y-6",children:[u&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:g?s.jsx(gs,{text:`Great progress, ${e.userName||"there"}!

Step 5: Voice Do's and Don'ts

Now let's create clear behavioral instructions for how your brand should and should not communicate. These boundaries are essential for maintaining consistent voice.

Think about:
 Preferred tones
 Preferred behaviors
 Language patterns to use
 Communication philosophies
 Tones to avoid
 Behaviors to avoid
 Words or structures that break brand identity

I'll organize these into a clear two-column table for easy reference.

Let's start with your Do's:`}):s.jsx(Ge,{text:`Great progress, ${e.userName||"there"}!

Step 5: Voice Do's and Don'ts

Now let's create clear behavioral instructions for how your brand should and should not communicate. These boundaries are essential for maintaining consistent voice.

Think about:
 Preferred tones
 Preferred behaviors
 Language patterns to use
 Communication philosophies
 Tones to avoid
 Behaviors to avoid
 Words or structures that break brand identity

I'll organize these into a clear two-column table for easy reference.

Let's start with your Do's:`,onComplete:()=>m(!0)})})]}),t&&!n&&!N&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-xs text-red-600",children:"Add at least one Do or Don't  each entry must be 5+ characters."})})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg mb-3 text-green-700",children:"Do's"}),s.jsx("div",{className:"space-y-2 mb-3",children:p.map((P,K)=>s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("span",{className:"flex-1",children:P}),t&&!n&&s.jsx(Ie,{variant:"ghost",size:"icon",onClick:()=>B(K),className:"h-8 w-8",children:s.jsx(Es,{className:"w-4 h-4"})})]},K))}),t&&!n&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ft,{value:v,onChange:P=>x(P.target.value),onKeyDown:P=>{P.key==="Enter"&&(P.preventDefault(),W())},placeholder:"Add a Do...",className:"flex-1"}),s.jsx(Ie,{onClick:W,variant:"outline",children:s.jsx(Na,{className:"w-4 h-4"})})]}),t&&!n&&k&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Minimum 5 characters before adding"})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"font-semibold text-lg mb-3 text-red-700",children:"Don'ts"}),s.jsx("div",{className:"space-y-2 mb-3",children:w.map((P,K)=>s.jsxs("div",{className:"flex items-center gap-2 p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsx("span",{className:"flex-1",children:P}),t&&!n&&s.jsx(Ie,{variant:"ghost",size:"icon",onClick:()=>Q(K),className:"h-8 w-8",children:s.jsx(Es,{className:"w-4 h-4"})})]},K))}),t&&!n&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ft,{value:y,onChange:P=>b(P.target.value),onKeyDown:P=>{P.key==="Enter"&&(P.preventDefault(),U())},placeholder:"Add a Don't...",className:"flex-1"}),s.jsx(Ie,{onClick:U,variant:"outline",children:s.jsx(Na,{className:"w-4 h-4"})})]}),t&&!n&&C&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Minimum 5 characters before adding"})]})]}),t&&!n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx(Ie,{onClick:V,disabled:l||p.length===0&&w.length===0,className:"bg-vox-pink hover:bg-vox-pink/90",children:l?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Continue to Step 6"})})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:"Step 5 completed: Voice Do's and Don'ts"})})]})]}):null},u3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a,onInputHandlersReady:o})=>{const l={supportApproach:10,challengeApproach:10,reassuranceApproach:10,consistentUnderstanding:10},{toast:c}=yt(),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(!1),[w,h]=i.useState(""),[v,x]=i.useState(null),[y,b]=i.useState(new Set),[N,S]=i.useState(null),[j,k]=i.useState({}),[C,W]=i.useState(null),B=i.useRef(null),U=i.useRef(e);i.useEffect(()=>{U.current=e,W((e==null?void 0:e.relationshipPrinciples)||null)},[e]);const Q=i.useCallback(R=>{if(!U.current)return;const L={...U.current,...R};U.current=L,r(L)},[r]),V=i.useMemo(()=>[{key:"supportApproach",label:"How do you want your audience to feel supported?",example:"Example: 'We support our audience by acknowledging their challenges, providing clear guidance, and celebrating their progress. We're always available to answer questions and offer encouragement.'"},{key:"challengeApproach",label:"How do you want your audience to feel challenged?",example:"Example: 'We challenge our audience by asking thought-provoking questions, pushing them to think deeper, and encouraging them to step outside their comfort zonesalways in a supportive way.'"},{key:"reassuranceApproach",label:"How do you want to reassure your audience?",example:"Example: 'We reassure our audience by being transparent about what to expect, sharing success stories, and reminding them that growth is a journey, not a destination.'"},{key:"consistentUnderstanding",label:"What should your audience consistently understand about you?",example:"Example: 'Our audience should consistently understand that we're here to help them succeed, that we genuinely care about their progress, and that we're committed to providing value in every interaction.'"}],[]),P=V.length,[K,G]=i.useState({supportApproach:(e==null?void 0:e.supportApproach)||"",challengeApproach:(e==null?void 0:e.challengeApproach)||"",reassuranceApproach:(e==null?void 0:e.reassuranceApproach)||"",consistentUnderstanding:(e==null?void 0:e.consistentUnderstanding)||""});i.useEffect(()=>{G({supportApproach:(e==null?void 0:e.supportApproach)||"",challengeApproach:(e==null?void 0:e.challengeApproach)||"",reassuranceApproach:(e==null?void 0:e.reassuranceApproach)||"",consistentUnderstanding:(e==null?void 0:e.consistentUnderstanding)||""})},[e]),i.useEffect(()=>{const R=new Set;V.forEach(L=>{const I=K[L.key];I&&I.trim()&&R.add(L.key)}),b(R)},[K,V]);const q=i.useCallback(R=>{const L=R||K;for(const I of V){const _=L[I.key];if(!_||!_.trim())return I}return null},[K,V]);i.useEffect(()=>{if(t&&!n){const R=q();R&&V.findIndex(I=>I.key===R.key)>=0&&(x(R.key),h(K[R.key]||""))}},[t,n,q,V,K]),i.useEffect(()=>{v&&k(R=>R[v]?R:{...R,[v]:!0})},[v]);const A=(R,L)=>{const I=L.replace(/^Example:\s*/i,"").replace(/^['"]|['"]$/g,"").trim();x(R),h(I),requestAnimationFrame(()=>{var _;(_=document.getElementById("vera-unified-input"))==null||_.scrollIntoView({behavior:"smooth",block:"center"})})};i.useEffect(()=>{if(!v){B.current=null;return}if(!t)return;const R=B.current;R&&R.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},[v,t]),i.useEffect(()=>{t&&!n?setTimeout(()=>m(!0),300):(m(!0),f(!0))},[t,n]);const E=i.useCallback(async(R,L)=>{var $,F;if(!(($=U.current)!=null&&$.id)){c({title:"Profile missing",description:"Please refresh and try again.",variant:"destructive"});return}const I=L.trim(),_=l[R]??3;if(!I){const M=V.find(T=>T.key===R);S(`${(M==null?void 0:M.label)||"This field"} is required`);return}if(I.length<_){const M=V.find(Z=>Z.key===R),ie=`${(M==null?void 0:M.label)||"This field"} must be at least ${_} characters`;S(ie);return}S(null),d(!0),a==null||a(null);try{const M={...K,[R]:L.trim()};if(G(M),M.supportApproach.trim()&&M.challengeApproach.trim()&&M.reassuranceApproach.trim()&&M.consistentUnderstanding.trim()){const ie=await e3(U.current.id,{supportApproach:M.supportApproach.trim(),challengeApproach:M.challengeApproach.trim(),reassuranceApproach:M.reassuranceApproach.trim(),consistentUnderstanding:M.consistentUnderstanding.trim()}),Z=(F=ie==null?void 0:ie.data)==null?void 0:F.relationshipPrinciples;Z&&W(Z);const le={...U.current,...M,relationshipPrinciples:Z||U.current.relationshipPrinciples,currentStep:7};U.current=le,r(le),x(null),h("")}else{Q(M);const ie=q(M);ie&&V.findIndex(le=>le.key===ie.key)>=0?(b(le=>new Set([...le,R])),k(le=>({...le,[R]:!1})),x(ie.key),h(""),setTimeout(()=>{B.current&&B.current.scrollIntoView({behavior:"smooth",block:"start"})},300)):(x(null),h(""))}}catch(M){const T=(M==null?void 0:M.message)||"Failed to submit answer";a==null||a(T),c({title:"Submission failed",description:T,variant:"destructive"})}finally{d(!1)}},[K,q,a,r,V,c]);return i.useEffect(()=>{if(!o)return;if(t&&!n&&v!==null){const L=V.find(ie=>ie.key===v),I=()=>{if(v&&w.trim())E(v,w);else if(v){const ie=l[v]??3,Z=(L==null?void 0:L.label)||"This field",le=w.trim();le?le.length<ie&&S(`${Z} must be at least ${ie} characters`):S(`${Z} is required`)}},_=ie=>{h(ie),N&&ie.trim().length>=(l[v??""]??3)&&S(null)},$=v?l[v]??10:10,F=(L==null?void 0:L.label)||"Answer",M=w.trim(),T=M.length>0&&M.length<$;o({inputValue:w,onInputChange:_,onInputSubmit:I,isSubmitting:u,placeholder:L?`Answer question ${(V.findIndex(ie=>ie.key===v)||0)+1} of ${P}...`:"Enter your answer",currentQuestionKey:v,currentQuestionLabel:(L==null?void 0:L.label)||null,validationError:N,validationHint:T?`${F}  minimum ${$} characters`:null})}else o(null)},[o,t,n,v,w,u,E,V,N,P]),e?s.jsxs(s.Fragment,{children:[t&&!n&&s.jsxs(s.Fragment,{children:[g&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:p?s.jsx(gs,{text:`Excellent, ${e.userName||"there"}!

Step 6: Audience Relationship Mapping

Now let's define how your brand relates to its audience through voice and tone. The way you communicate shapes the relationship dynamic.

I'll ask you four questions:
1. How do you want your audience to feel supported?
2. How do you want your audience to feel challenged?
3. How do you want to reassure your audience?
4. What should your audience consistently understand about you?

I'll then refine these into clear relationship principles that will guide all your communications.

Let's begin:`}):s.jsx(Ge,{text:`Excellent, ${e.userName||"there"}!

Step 6: Audience Relationship Mapping

Now let's define how your brand relates to its audience through voice and tone. The way you communicate shapes the relationship dynamic.

I'll ask you four questions:
1. How do you want your audience to feel supported?
2. How do you want your audience to feel challenged?
3. How do you want to reassure your audience?
4. What should your audience consistently understand about you?

I'll then refine these into clear relationship principles that will guide all your communications.

Let's begin:`,onComplete:()=>f(!0)})})]}),V.map((R,L)=>{const I=y.has(R.key),_=R.key===v;if(!I&&!_)return null;const $=L+1,F=K[R.key];return s.jsxs("div",{className:"space-y-3 mb-2",ref:_?M=>{B.current=M}:void 0,children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",$," of ",P]}),s.jsx(Ge,{text:R.label,chunkClassName:"text-base text-gray-900",staggerMs:30}),I&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})]}),_&&!I&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Example Inspiration"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{type:"button",onClick:()=>A(R.key,R.example||""),className:"text-sm font-semibold text-vox-pink hover:text-vox-pink/80 transition-colors",children:"Use this example"}),s.jsx("button",{type:"button",onClick:M=>{M.preventDefault(),k(T=>({...T,[R.key]:!T[R.key]}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":j[R.key]?"Hide example":"Show example",children:j[R.key]?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]})]}),j[R.key]&&R.example&&s.jsxs("div",{className:"px-4 py-3 space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:R.example}),s.jsx("div",{className:"text-xs text-gray-500",children:"Feel free to personalize this example before submitting."})]})]})})]}),I&&F&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"bg-vox-pink/5 border border-vox-pink/20 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:F})})})]})]},R.key)}),C&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsxs("div",{className:"flex-1 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsx("h4",{className:"font-semibold mb-2",children:"Synthesized Relationship Principles"}),s.jsx("div",{className:"text-sm whitespace-pre-wrap",children:C})]})]}),s.jsx("div",{className:"h-12","aria-hidden":!0})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:" Step 6 completed - Audience Relationship Mapping saved"})})]})]}):null},d3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a,onInputHandlersReady:o})=>{const l={educationalContent:10,socialMediaPosts:10,salesMessaging:10,coachingInteractions:10,problemResolution:10,onboardingCommunication:10},{toast:c}=yt(),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(!1),[w,h]=i.useState(""),[v,x]=i.useState(null),[y,b]=i.useState(new Set),[N,S]=i.useState(null),[j,k]=i.useState({}),C=i.useRef(null),W=i.useRef(e);i.useEffect(()=>{W.current=e},[e]);const B=i.useCallback(E=>{if(!W.current)return;const R={...W.current,...E};W.current=R,r(R)},[r]),U=i.useMemo(()=>[{key:"educationalContent",label:"Educational Content",example:"Example: 'In educational content, we maintain our warm and authoritative tone. We break down complex concepts into digestible pieces. We use examples and analogies. We encourage questions and engagement.'"},{key:"socialMediaPosts",label:"Social Media Posts",example:"Example: 'On social media, we're more conversational but still maintain our core personality. We use shorter sentences. We're more direct and punchy. We engage authentically with our community.'"},{key:"salesMessaging",label:"Sales Messaging",example:"Example: 'In sales messaging, we're confident and clear about value. We address objections directly. We use social proof. We maintain our supportive tone while being persuasive.'"},{key:"coachingInteractions",label:"Coaching or Client Interactions",example:"Example: 'In coaching interactions, we're empathetic and encouraging. We ask thoughtful questions. We provide constructive feedback. We celebrate progress and acknowledge challenges.'"},{key:"problemResolution",label:"Problem Resolution",example:"Example: 'When resolving problems, we're calm and solution-focused. We acknowledge the issue clearly. We take responsibility. We communicate next steps transparently.'"},{key:"onboardingCommunication",label:"Onboarding Communication",example:"Example: 'In onboarding, we're welcoming and clear. We set expectations. We provide step-by-step guidance. We check in regularly. We make people feel supported from day one.'"}],[]),Q=U.length,V=()=>{const E=e!=null&&e.scenarios?JSON.parse(JSON.stringify(e.scenarios)):{};return{educationalContent:E.educationalContent||"",socialMediaPosts:E.socialMediaPosts||"",salesMessaging:E.salesMessaging||"",coachingInteractions:E.coachingInteractions||"",problemResolution:E.problemResolution||"",onboardingCommunication:E.onboardingCommunication||""}},[P,K]=i.useState(V());i.useEffect(()=>{K(V())},[e]),i.useEffect(()=>{const E=new Set;U.forEach(R=>{const L=P[R.key];L&&L.trim()&&E.add(R.key)}),b(E)},[P,U]);const G=i.useCallback(E=>{const R=E||P;for(const L of U){const I=R[L.key];if(!I||!I.trim())return L}return null},[P,U]);i.useEffect(()=>{if(t&&!n){const E=G();E&&U.findIndex(L=>L.key===E.key)>=0&&(x(E.key),h(P[E.key]||""))}},[t,n,G,U,P]),i.useEffect(()=>{v&&k(E=>E[v]?E:{...E,[v]:!0})},[v]);const q=(E,R)=>{const L=R.replace(/^Example:\s*/i,"").replace(/^['"]|['"]$/g,"").trim();x(E),h(L),requestAnimationFrame(()=>{var I;(I=document.getElementById("vera-unified-input"))==null||I.scrollIntoView({behavior:"smooth",block:"center"})})};i.useEffect(()=>{if(!v){C.current=null;return}if(!t)return;const E=C.current;E&&E.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})},[v,t]),i.useEffect(()=>{t&&!n?setTimeout(()=>m(!0),300):(m(!0),f(!0))},[t,n]);const A=i.useCallback(async(E,R)=>{var _,$;if(!((_=W.current)!=null&&_.id)){c({title:"Profile missing",description:"Please refresh and try again.",variant:"destructive"});return}const L=R.trim(),I=l[E]??3;if(!L){const F=U.find(M=>M.key===E);S(`${(F==null?void 0:F.label)||"This field"} is required`);return}if(L.length<I){const F=U.find(ie=>ie.key===E),T=`${(F==null?void 0:F.label)||"This field"} must be at least ${I} characters`;S(T);return}S(null),d(!0),a==null||a(null);try{const F={...P,[E]:R.trim()};if(K(F),F.educationalContent.trim()&&F.socialMediaPosts.trim()&&F.salesMessaging.trim()&&F.coachingInteractions.trim()&&F.problemResolution.trim()&&F.onboardingCommunication.trim()){await t3(W.current.id,{educationalContent:F.educationalContent.trim(),socialMediaPosts:F.socialMediaPosts.trim(),salesMessaging:F.salesMessaging.trim(),coachingInteractions:F.coachingInteractions.trim(),problemResolution:F.problemResolution.trim(),onboardingCommunication:F.onboardingCommunication.trim()});const T={...W.current,scenarios:F,currentStep:8};W.current=T,r(T),x(null),h("")}else{B({scenarios:{...(($=W.current)==null?void 0:$.scenarios)||{},...F}});const T=G(F);T&&U.findIndex(Z=>Z.key===T.key)>=0?(b(Z=>new Set([...Z,E])),k(Z=>({...Z,[E]:!1})),x(T.key),h(""),setTimeout(()=>{C.current&&C.current.scrollIntoView({behavior:"smooth",block:"start"})},300)):(x(null),h(""))}}catch(F){const M=(F==null?void 0:F.message)||"Failed to submit answer";a==null||a(M),c({title:"Submission failed",description:M,variant:"destructive"})}finally{d(!1)}},[P,G,a,r,U,c]);return i.useEffect(()=>{if(!o)return;if(t&&!n&&v!==null){const R=U.find(T=>T.key===v),L=()=>{if(v&&w.trim())A(v,w);else if(v){const T=l[v]??3,ie=(R==null?void 0:R.label)||"This field",Z=w.trim();Z?Z.length<T&&S(`${ie} must be at least ${T} characters`):S(`${ie} is required`)}},I=T=>{h(T),N&&T.trim().length>=(l[v??""]??3)&&S(null)},_=v?l[v]??10:10,$=(R==null?void 0:R.label)||"Answer",F=w.trim(),M=F.length>0&&F.length<_;o({inputValue:w,onInputChange:I,onInputSubmit:L,isSubmitting:u,placeholder:R?`Answer question ${(U.findIndex(T=>T.key===v)||0)+1} of ${Q}...`:"Enter your answer",currentQuestionKey:v,currentQuestionLabel:(R==null?void 0:R.label)||null,validationError:N,validationHint:M?`${$}  minimum ${_} characters`:null})}else o(null)},[o,t,n,v,w,u,A,U,N,Q]),e?s.jsxs(s.Fragment,{children:[t&&!n&&s.jsxs(s.Fragment,{children:[g&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:p?s.jsx(gs,{text:`Well done, ${e.userName||"there"}!

Step 7: Voice Application Scenarios

Now let's understand how your brand voice should appear across different communication contexts. Your voice should be consistent, but it may adapt slightly to different situations.

We'll define voice behavior for:
 Educational content
 Social media posts
 Sales messaging
 Coaching or client interactions
 Problem resolution
 Onboarding communication

I'll provide examples for each scenario to guide you.

Let's start:`}):s.jsx(Ge,{text:`Well done, ${e.userName||"there"}!

Step 7: Voice Application Scenarios

Now let's understand how your brand voice should appear across different communication contexts. Your voice should be consistent, but it may adapt slightly to different situations.

We'll define voice behavior for:
 Educational content
 Social media posts
 Sales messaging
 Coaching or client interactions
 Problem resolution
 Onboarding communication

I'll provide examples for each scenario to guide you.

Let's start:`,onComplete:()=>f(!0)})})]}),U.map((E,R)=>{const L=y.has(E.key),I=E.key===v;if(!L&&!I)return null;const _=R+1,$=P[E.key];return s.jsxs("div",{className:"space-y-3 mb-2",ref:I?F=>{C.current=F}:void 0,children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"space-y-1.5",children:[s.jsxs("p",{className:"text-sm font-bold text-gray-700",children:["Question ",_," of ",Q]}),s.jsx(Ge,{text:E.label,chunkClassName:"text-base text-gray-900",staggerMs:30}),L&&s.jsx("span",{className:"inline-block rounded-full bg-green-50 px-2 py-1 text-xs font-medium text-green-700 mt-2 transition-opacity duration-300 opacity-100",children:" Saved"})]})})]}),I&&!L&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-2.5 border-b border-gray-100",children:[s.jsxs("div",{className:"flex items-center gap-2 text-gray-900 font-medium",children:[s.jsx(pr,{className:"w-4 h-4 text-vox-pink"}),s.jsx("span",{children:"Example Inspiration"})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{type:"button",onClick:()=>q(E.key,E.example||""),className:"text-sm font-semibold text-vox-pink hover:text-vox-pink/80 transition-colors",children:"Use this example"}),s.jsx("button",{type:"button",onClick:F=>{F.preventDefault(),k(M=>({...M,[E.key]:!M[E.key]}))},className:"p-1 rounded-full text-gray-400 hover:text-gray-600 transition-colors","aria-label":j[E.key]?"Hide example":"Show example",children:j[E.key]?s.jsx(Hn,{className:"w-5 h-5"}):s.jsx(Gs,{className:"w-5 h-5"})})]})]}),j[E.key]&&E.example&&s.jsxs("div",{className:"px-4 py-3 space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-700 leading-relaxed whitespace-pre-wrap",children:E.example}),s.jsx("div",{className:"text-xs text-gray-500",children:"Feel free to personalize this example before submitting."})]})]})})]}),L&&$&&s.jsxs("div",{className:"flex gap-3",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("div",{className:"bg-vox-pink/5 border border-vox-pink/20 rounded-lg p-4",children:s.jsx("p",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:$})})})]})]},E.key)}),s.jsx("div",{className:"h-12","aria-hidden":!0})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:" Step 7 completed - Voice Application Scenarios saved"})})]})]}):null},m3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a})=>{const{toast:o}=yt(),[l,c]=i.useState(!1),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState([]),[w,h]=i.useState([]),[v,x]=i.useState(e!=null&&e.userSamples?JSON.parse(JSON.stringify(e.userSamples)):[]),[y,b]=i.useState(""),N=v.length>0,S=y.trim(),j=S.length>0&&S.length<10;i.useEffect(()=>{e!=null&&e.userSamples&&x(JSON.parse(JSON.stringify(e.userSamples))),e!=null&&e.modelParagraphs&&f(JSON.parse(JSON.stringify(e.modelParagraphs))),e!=null&&e.approvedSamples&&h(JSON.parse(JSON.stringify(e.approvedSamples)))},[e]),i.useEffect(()=>{t&&!n?setTimeout(()=>d(!0),300):(d(!0),m(!0))},[t,n]);const k=()=>{const Q=y.trim();if(!Q){o({title:"Sample required",description:"Please enter a sample statement or message.",variant:"destructive"});return}if(Q.length<10){o({title:"Sample too short",description:"Sample must be at least 10 characters long.",variant:"destructive"});return}x([...v,Q]),b("")},C=Q=>{x(v.filter((V,P)=>P!==Q))},W=Q=>{p[Q]&&!w.includes(p[Q])&&h([...w,p[Q]])},B=async()=>{var V;if(!e||l)return;if(v.length===0){o({title:"Please add at least one sample",description:"You must provide at least one sample statement or message.",variant:"destructive"});return}if(v.filter(P=>P.trim().length<10).length>0){o({title:"Samples too short",description:"Each sample must be at least 10 characters long.",variant:"destructive"});return}if(p.length===0){o({title:"Please wait for AI rewriting",description:"The AI is rewriting your samples. Please wait...",variant:"destructive"});return}c(!0),a==null||a(null);try{const P=await Sx(e.id,{userSamples:v,approvedSamples:w.length>0?w:p}),K=(V=P==null?void 0:P.data)==null?void 0:V.modelParagraphs;K&&Array.isArray(K)&&(f(K),w.length===0&&h(K));const G={...e,userSamples:v,modelParagraphs:K||p,approvedSamples:w.length>0?w:K||p,currentStep:9};r(G),o({title:"Step 8 completed",description:"Voice examples and model paragraphs saved."})}catch(P){const K=(P==null?void 0:P.message)||"Failed to submit Step 8";a==null||a(K),o({title:"Error",description:K,variant:"destructive"})}finally{c(!1)}},U=async()=>{var Q;if(!(!e||v.length===0)){c(!0),a==null||a(null);try{const V=await Sx(e.id,{userSamples:v}),P=(Q=V==null?void 0:V.data)==null?void 0:Q.modelParagraphs;P&&Array.isArray(P)&&(f(P),o({title:"Samples rewritten",description:"Your samples have been rewritten in your brand voice."}))}catch(V){const P=(V==null?void 0:V.message)||"Failed to rewrite samples";a==null||a(P),o({title:"Error",description:P,variant:"destructive"})}finally{c(!1)}}};return e?s.jsxs("div",{className:"space-y-6",children:[u&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:g?s.jsx(gs,{text:`Excellent work, ${e.userName||"there"}!

Step 8: Voice Examples and Model Paragraphs

Now let's create concrete voice samples demonstrating your brand's style in action. These model paragraphs will create voice stability and serve as reference material for all future assets.

Here's how this works:
1. You'll provide sample statements or messages (these can be existing content or new ideas)
2. I'll rewrite them in your defined brand voice
3. You'll review and confirm or adjust the samples
4. These approved samples become your reference material

Why this matters: Model paragraphs create voice stability. When you or your team need to create new content, you can reference these samples to ensure consistency.

Let's start. Please provide a sample statement or message:`}):s.jsx(Ge,{text:`Excellent work, ${e.userName||"there"}!

Step 8: Voice Examples and Model Paragraphs

Now let's create concrete voice samples demonstrating your brand's style in action. These model paragraphs will create voice stability and serve as reference material for all future assets.

Here's how this works:
1. You'll provide sample statements or messages (these can be existing content or new ideas)
2. I'll rewrite them in your defined brand voice
3. You'll review and confirm or adjust the samples
4. These approved samples become your reference material

Why this matters: Model paragraphs create voice stability. When you or your team need to create new content, you can reference these samples to ensure consistency.

Let's start. Please provide a sample statement or message:`,onComplete:()=>m(!0)})})]}),t&&!n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1 space-y-3",children:s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold mb-2",children:"Your Sample Statements"}),!N&&s.jsx("p",{className:"text-xs text-red-600 mb-2",children:"Add at least one sample  each must be 10+ characters."}),s.jsx("div",{className:"space-y-2 mb-3",children:v.map((Q,V)=>s.jsxs("div",{className:"flex items-start gap-2 p-3 bg-gray-50 border rounded-lg",children:[s.jsx("p",{className:"flex-1 text-sm",children:Q}),s.jsx(Ie,{variant:"ghost",size:"icon",onClick:()=>C(V),className:"h-8 w-8",children:s.jsx(Es,{className:"w-4 h-4"})})]},V))}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(fs,{value:y,onChange:Q=>b(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&(Q.metaKey||Q.ctrlKey)&&(Q.preventDefault(),k())},placeholder:"Type a sample statement or message...",className:"min-h-[80px]"}),s.jsx(Ie,{onClick:k,variant:"outline",className:"h-[80px]",children:s.jsx(Na,{className:"w-4 h-4"})})]}),j&&s.jsx("p",{className:"text-xs text-red-600 mt-1",children:"Minimum 10 characters before adding"}),v.length>0&&s.jsx(Ie,{onClick:U,disabled:l,className:"mt-3 bg-vox-pink hover:bg-vox-pink/90",children:l?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Rewriting..."]}):"Rewrite Samples in Brand Voice"})]})})]}),p.length>0&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsxs("div",{className:"flex-1 space-y-4",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Rewritten in Your Brand Voice"}),p.map((Q,V)=>{const P=w.includes(Q);return s.jsxs("div",{className:`p-4 border rounded-lg ${P?"bg-green-50 border-green-200":"bg-blue-50 border-blue-200"}`,children:[s.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[s.jsxs("p",{className:"text-sm font-medium",children:["Sample ",V+1]}),t&&!n&&s.jsx(Ie,{variant:P?"default":"outline",size:"sm",onClick:()=>W(V),disabled:P,className:P?"bg-green-600 hover:bg-green-700":"",children:P?s.jsxs(s.Fragment,{children:[s.jsx(Bi,{className:"w-4 h-4 mr-2"}),"Approved"]}):"Approve"})]}),s.jsx("p",{className:"text-sm whitespace-pre-wrap",children:Q})]},V)})]})]}),t&&!n&&p.length>0&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx(Ie,{onClick:B,disabled:l,className:"bg-vox-pink hover:bg-vox-pink/90",children:l?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Continue to Step 9"})})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:"Step 8 completed: Voice Examples and Model Paragraphs"})})]})]}):null},f3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a})=>{const{toast:o}=yt(),[l,c]=i.useState(!1),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(!1),[w,h]=i.useState([]),[v,x]=i.useState(null),[y,b]=i.useState(!1);i.useEffect(()=>{e!=null&&e.calibrationNotes&&h(JSON.parse(JSON.stringify(e.calibrationNotes))),(e==null?void 0:e.consistencyScore)!==null&&(e==null?void 0:e.consistencyScore)!==void 0&&x(e.consistencyScore),b((e==null?void 0:e.isCalibrated)||!1)},[e]),i.useEffect(()=>{t&&!n?(setTimeout(()=>m(!0),300),e&&!y&&N()):(m(!0),f(!0))},[t,n]);const N=async()=>{var C,W;if(!(!e||u)){d(!0),a==null||a(null);try{const B=await kx(e.id,{isCalibrated:!1}),U=(C=B==null?void 0:B.data)==null?void 0:C.calibrationNotes,Q=(W=B==null?void 0:B.data)==null?void 0:W.consistencyScore;U&&Array.isArray(U)&&h(U),Q!=null&&x(Q);const V={...e,calibrationNotes:U||e.calibrationNotes,consistencyScore:Q??e.consistencyScore};r(V)}catch(B){const U=(B==null?void 0:B.message)||"Failed to check consistency";a==null||a(U)}finally{d(!1)}}},S=async()=>{var C,W;if(!(!e||l)){c(!0),a==null||a(null);try{const B=await kx(e.id,{isCalibrated:!0}),U=(C=B==null?void 0:B.data)==null?void 0:C.calibrationNotes,Q=(W=B==null?void 0:B.data)==null?void 0:W.consistencyScore,V={...e,calibrationNotes:U||e.calibrationNotes,consistencyScore:Q??e.consistencyScore,isCalibrated:!0,currentStep:10};r(V),b(!0),o({title:"Step 9 completed",description:"Voice calibration and consistency check completed."})}catch(B){const U=(B==null?void 0:B.message)||"Failed to submit Step 9";a==null||a(U),o({title:"Error",description:U,variant:"destructive"})}finally{c(!1)}}};if(!e)return null;const j=C=>C===null?"text-gray-500":C>=80?"text-green-600":C>=60?"text-yellow-600":"text-red-600",k=C=>C===null?"Not calculated":C>=80?"Excellent":C>=60?"Good":"Needs Improvement";return s.jsxs("div",{className:"space-y-6",children:[g&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:p?s.jsx(gs,{text:`Great job, ${e.userName||"there"}!

Step 9: Voice Calibration and Consistency Check

Now let's ensure your voice identity is coherent, aligned, and internally consistent. I'll review all your previous inputs and identify any inconsistencies or unclear areas.

This step involves:
1. Reviewing all previous inputs
2. Identifying inconsistencies or unclear areas
3. Allowing you to refine and clarify final voice elements
4. Confirming that the voice identity is complete and ready to use

Let me analyze your voice identity...`}):s.jsx(Ge,{text:`Great job, ${e.userName||"there"}!

Step 9: Voice Calibration and Consistency Check

Now let's ensure your voice identity is coherent, aligned, and internally consistent. I'll review all your previous inputs and identify any inconsistencies or unclear areas.

This step involves:
1. Reviewing all previous inputs
2. Identifying inconsistencies or unclear areas
3. Allowing you to refine and clarify final voice elements
4. Confirming that the voice identity is complete and ready to use

Let me analyze your voice identity...`,onComplete:()=>f(!0)})})]}),t&&!n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-xs text-red-600",children:"Review every calibration note and ensure inconsistencies are resolved before confirming completion."})})]}),u&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qe,{className:"w-5 h-5 animate-spin text-vox-pink"}),s.jsx("p",{className:"text-gray-700",children:"Analyzing your voice identity for consistency..."})]})})]}),v!==null&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsxs("div",{className:"flex-1 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h4",{className:"font-semibold",children:"Consistency Score"}),s.jsxs("span",{className:`text-2xl font-bold ${j(v)}`,children:[v,"/100"]})]}),s.jsx("p",{className:`text-sm ${j(v)}`,children:k(v)})]})]}),w.length>0&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsxs("div",{className:"flex-1 space-y-3",children:[s.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[s.jsx(ph,{className:"w-5 h-5 text-yellow-600"}),"Calibration Notes"]}),s.jsx("div",{className:"space-y-2",children:w.map((C,W)=>s.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-sm",children:C},W))}),s.jsx("p",{className:"text-sm text-gray-600",children:"Please review these notes and refine any areas that need clarification before proceeding."})]})]}),w.length===0&&v!==null&&v>=80&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1 p-4 bg-green-50 border border-green-200 rounded-lg",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Bi,{className:"w-5 h-5 text-green-600"}),s.jsx("p",{className:"text-green-800 font-medium",children:"Your voice identity is consistent and well-aligned!"})]})})]}),t&&!n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsxs("div",{className:"flex-1 space-y-3",children:[v===null&&s.jsx(Ie,{onClick:N,disabled:u,variant:"outline",children:u?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Checking..."]}):"Check Consistency"}),s.jsx(Ie,{onClick:S,disabled:l||u,className:"bg-vox-pink hover:bg-vox-pink/90",children:l?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Continue to Final Step"})]})]}),n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-gray-600 italic",children:"Step 9 completed: Voice Calibration and Consistency Check"})})]})]})},h3=({profile:e,isActive:t,isCompleted:n,onProfileChange:r,onError:a})=>{const{toast:o}=yt(),[l,c]=i.useState(!1),[u,d]=i.useState(!1),[g,m]=i.useState(!1),[p,f]=i.useState(!1),[w,h]=i.useState(null);i.useEffect(()=>{h((e==null?void 0:e.finalProfile)||null)},[e]),i.useEffect(()=>{t&&!n?(setTimeout(()=>m(!0),300),e&&!w&&v()):(m(!0),f(!0))},[t,n]);const v=async()=>{var N;if(!(!e||u)){d(!0),a==null||a(null);try{const S=await Px(e.id,{approve:!1}),j=(N=S==null?void 0:S.data)==null?void 0:N.finalProfile;if(j){h(j);const k={...e,finalProfile:j};r(k)}}catch(S){const j=(S==null?void 0:S.message)||"Failed to generate final profile";a==null||a(j)}finally{d(!1)}}},x=async()=>{var N;if(!(!e||l)){c(!0),a==null||a(null);try{const S=await Px(e.id,{approve:!0}),j=((N=S==null?void 0:S.data)==null?void 0:N.finalProfile)||w,k={...e,finalProfile:j||e.finalProfile,isComplete:!0,completedAt:new Date().toISOString(),status:"completed"};r(k),o({title:"Congratulations!",description:"Your Voice Identity Profile is now complete."})}catch(S){const j=(S==null?void 0:S.message)||"Failed to finalize profile";a==null||a(j),o({title:"Error",description:j,variant:"destructive"})}finally{c(!1)}}},y=async()=>{if(e)try{const N=await Oe.makeAuthenticatedRequest(`${Fe}/vera-profiles/${e.id}/export/pdf`,{method:"GET"});if(!N.ok)throw new Error("Failed to download PDF");const S=await N.blob(),j=URL.createObjectURL(S),k=document.createElement("a");k.href=j;const C=e.completedAt?new Date(e.completedAt).toISOString().split("T")[0]:new Date(e.createdAt).toISOString().split("T")[0],W=e.userName||"Client";k.download=`Vera-Profile-${W}-${C}.pdf`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(j),o({title:"PDF Downloaded",description:"Your Voice Identity Profile has been downloaded as PDF."})}catch(N){o({title:"Download Failed",description:(N==null?void 0:N.message)||"Failed to download PDF",variant:"destructive"})}},b=async()=>{if(e)try{const N=await Oe.makeAuthenticatedRequest(`${Fe}/vera-profiles/${e.id}/export/docx`,{method:"GET"});if(!N.ok)throw new Error("Failed to download Word document");const S=await N.blob(),j=URL.createObjectURL(S),k=document.createElement("a");k.href=j;const C=e.completedAt?new Date(e.completedAt).toISOString().split("T")[0]:new Date(e.createdAt).toISOString().split("T")[0],W=e.userName||"Client";k.download=`Vera-Profile-${W}-${C}.docx`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(j),o({title:"Word Document Downloaded",description:"Your Voice Identity Profile has been downloaded as Word document."})}catch(N){o({title:"Download Failed",description:(N==null?void 0:N.message)||"Failed to download Word document",variant:"destructive"})}};return e?s.jsxs("div",{className:"space-y-6",children:[g&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:p?s.jsx(gs,{text:`Congratulations, ${e.userName||"there"}!

Step 10: Final Voice Identity Profile

We're at the final step! I'll now compile your complete voice identity into a polished, structured document.

Your final profile will include:
 Communication identity foundation
 Personality traits
 Style principles
 Do's and Don'ts
 Audience relationship map
 Scenario guidelines
 Model paragraphs
 Calibration summary

Once you approve this final profile, your Voice Identity Profile will be complete and ready to use across all VoxBox tools.

Generating your final profile...`}):s.jsx(Ge,{text:`Congratulations, ${e.userName||"there"}!

Step 10: Final Voice Identity Profile

We're at the final step! I'll now compile your complete voice identity into a polished, structured document.

Your final profile will include:
 Communication identity foundation
 Personality traits
 Style principles
 Do's and Don'ts
 Audience relationship map
 Scenario guidelines
 Model paragraphs
 Calibration summary

Once you approve this final profile, your Voice Identity Profile will be complete and ready to use across all VoxBox tools.

Generating your final profile...`,onComplete:()=>f(!0)})})]}),t&&!n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx("p",{className:"text-xs text-red-600",children:"Final profile must be generated and reviewed before approving and downloading."})})]}),u&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Qe,{className:"w-5 h-5 animate-spin text-vox-pink"}),s.jsx("p",{className:"text-gray-700",children:"Compiling your complete Voice Identity Profile..."})]})})]}),w&&t&&!n&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"p-6 bg-white border-2 border-vox-pink rounded-lg",children:[s.jsx("h3",{className:"font-bold text-xl mb-4 text-center",children:"Your Voice Identity Profile is Ready!"}),s.jsx("p",{className:"text-gray-600 mb-6 text-center",children:"Download your complete Voice Identity Profile in your preferred format."}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsxs(Ie,{variant:"outline",onClick:y,className:"flex-1 max-w-xs",size:"lg",children:[s.jsx(ln,{className:"w-5 h-5 mr-2"}),"Download PDF"]}),s.jsxs(Ie,{variant:"outline",onClick:b,className:"flex-1 max-w-xs",size:"lg",children:[s.jsx(ln,{className:"w-5 h-5 mr-2"}),"Download Word"]})]})]})})]}),t&&!n&&w&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("div",{className:"w-10 flex-shrink-0"}),s.jsx("div",{className:"flex-1",children:s.jsx(Ie,{onClick:x,disabled:l,className:"bg-vox-pink hover:bg-vox-pink/90 w-full",size:"lg",children:l?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"w-5 h-5 mr-2 animate-spin"}),"Finalizing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Bi,{className:"w-5 h-5 mr-2"}),"Approve & Complete Voice Identity Profile"]})})})]}),n&&w&&s.jsxs("div",{className:"flex gap-4",children:[s.jsx("img",{src:wt,alt:"Vera",className:"w-10 h-10 rounded-full flex-shrink-0"}),s.jsxs("div",{className:"flex-1 p-6 bg-green-50 border-2 border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[s.jsx(Bi,{className:"w-6 h-6 text-green-600"}),s.jsx("h3",{className:"font-bold text-lg text-green-900",children:"Your Voice Identity Profile is now complete."})]}),s.jsx("p",{className:"text-green-800 mb-4",children:"Your voice identity has been saved and is ready to use across all VoxBox tools. You can export it as a PDF or Word document, or use it directly when creating content through Amplifiers and other tools."}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(Ie,{variant:"outline",onClick:y,className:"border-green-300 text-green-700 hover:bg-green-100",children:[s.jsx(ln,{className:"w-4 h-4 mr-2"}),"Download PDF"]}),s.jsxs(Ie,{variant:"outline",onClick:b,className:"border-green-300 text-green-700 hover:bg-green-100",children:[s.jsx(ln,{className:"w-4 h-4 mr-2"}),"Download Word"]})]})]})]})]}):null},p3="vera-state",g3="vera-scroll",Md=e=>`${p3}-${e}`,Ax=e=>`${g3}-${e}`,x3=()=>{const e=Lt(),{currentWorkspace:t,isLoading:n}=ls(),{toast:r}=yt(),[a,o]=i.useState(null),[l,c]=i.useState({}),[u,d]=i.useState(!1),[g,m]=i.useState(null),[p,f]=i.useState(!0),[w,h]=i.useState(null),[v,x]=i.useState(null),[y,b]=i.useState(null),[N,S]=i.useState(null),[j,k]=i.useState(null),[C,W]=i.useState(!0),[B,U]=i.useState(!1),Q=i.useRef(null),V=i.useRef(null),P=i.useRef(null),K=i.useRef(null),G=i.useRef(null),q=i.useRef(null),A=i.useRef(0),[E,R]=i.useState(0),L=(t==null?void 0:t.id)??null,I=(t==null?void 0:t.name)??"Select a workspace";i.useEffect(()=>{if(n)return;if(typeof window>"u"){f(!1);return}if(!L){d(!0),o(null),m(null),P.current=null,f(!1);return}if(d(!1),m(null),P.current===L){f(!1);return}f(!0);const O=Md(L);try{const H=localStorage.getItem(O);if(H){const ae=JSON.parse(H);o((ae==null?void 0:ae.profile)??null),c((ae==null?void 0:ae.uiState)??{})}else o(null),c({})}catch(H){console.error("Failed to restore Vera state from storage:",H),o(null),c({})}finally{P.current=L,f(!1)}},[L,n]),i.useEffect(()=>{if(p||!L||typeof window>"u")return;const O=Md(L);if(!a){try{localStorage.removeItem(O)}catch(ae){console.error("Failed to clear persisted Vera state:",ae)}return}const H={profile:a,lastUpdated:new Date().toISOString(),uiState:l};try{localStorage.setItem(O,JSON.stringify(H))}catch(ae){console.error("Failed to persist Vera state:",ae)}},[a,L,p,l]);const _=i.useCallback((O="smooth")=>{var de,re;if(typeof window>"u")return;const H=Q.current;H&&H.scrollHeight>H.clientHeight+1&&H?H.scrollTo({top:H.scrollHeight,behavior:O}):window.scrollTo({top:((de=document.scrollingElement)==null?void 0:de.scrollHeight)??document.documentElement.scrollHeight,behavior:O}),(re=V.current)==null||re.scrollIntoView({behavior:O,block:"end"})},[]),$=i.useCallback(O=>{if(typeof window>"u")return;const H=Q.current;H&&H.scrollHeight>H.clientHeight+1&&H?H.scrollTo({top:O,behavior:"auto"}):window.scrollTo({top:O,behavior:"auto"})},[]);i.useEffect(()=>{if(n||u||p)return;const O=K.current;requestAnimationFrame(()=>{typeof O=="number"?($(O),K.current=null):_()})},[n,u,p,a==null?void 0:a.id,a==null?void 0:a.currentStep,$,_]),i.useEffect(()=>{if(!Q.current)return;const O=new ResizeObserver(()=>{_("auto")});return O.observe(Q.current),()=>O.disconnect()},[_]),i.useEffect(()=>{const O=()=>{q.current&&R(q.current.getBoundingClientRect().height)};O();const H=new ResizeObserver(()=>O());return q.current&&H.observe(q.current),window.addEventListener("resize",O),()=>{H.disconnect(),window.removeEventListener("resize",O)}},[a]),i.useEffect(()=>{if(!L||typeof window>"u"){K.current=null;return}const O=Ax(L);try{const H=localStorage.getItem(O);if(H){const ae=JSON.parse(H);typeof(ae==null?void 0:ae.scrollTop)=="number"&&(K.current=ae.scrollTop)}else K.current=null}catch(H){console.error("Failed to restore Vera scroll position:",H),K.current=null}},[L]),i.useEffect(()=>{if(!L||typeof window>"u")return;const O=Ax(L),H=()=>{const Se=Q.current;return Se&&Se.scrollHeight>Se.clientHeight+1&&Se?Se.scrollTop:window.scrollY||document.documentElement.scrollTop||0},ae=Se=>{const he={scrollTop:Math.max(Se,0),lastUpdated:new Date().toISOString()};try{localStorage.setItem(O,JSON.stringify(he))}catch(se){console.error("Failed to persist Vera scroll position:",se)}};let de=null;const re=()=>{de||(de=window.requestAnimationFrame(()=>{ae(H()),de=null}))},fe=Q.current;return fe==null||fe.addEventListener("scroll",re,{passive:!0}),window.addEventListener("scroll",re,{passive:!0}),()=>{fe==null||fe.removeEventListener("scroll",re),window.removeEventListener("scroll",re),de&&window.cancelAnimationFrame(de)}},[L]),i.useEffect(()=>{const O=Q.current;let H=!1;const ae=()=>O&&O.scrollHeight>O.clientHeight+1&&O?O.scrollTop:window.scrollY||document.documentElement.scrollTop||0,de=()=>{H||(window.requestAnimationFrame(()=>{const re=ae(),fe=A.current;re<60?W(!0):re>fe&&re>120&&W(!1),U(re>0),A.current=re,H=!1}),H=!0)};return de(),O==null||O.addEventListener("scroll",de,{passive:!0}),window.addEventListener("scroll",de,{passive:!0}),()=>{O==null||O.removeEventListener("scroll",de),window.removeEventListener("scroll",de)}},[]);const F=i.useCallback(O=>{o(O),m(null)},[]),M=i.useCallback(O=>{m(O),O&&r({title:"Error",description:O,variant:"destructive"})},[r]),T=i.useCallback(()=>{if(!(!L||typeof window>"u")){try{const O=Md(L);localStorage.removeItem(O)}catch(O){console.error("Failed to clear persisted Vera state:",O)}c({})}},[L]),ie=i.useCallback(()=>{T(),o(null),m(null),c({}),P.current=null},[T]),Z=i.useCallback(()=>{p||(h(null),x(null),b(null),S(null),k(null),ie(),P.current=null)},[p,ie]),le=i.useCallback(O=>{c(H=>{if(!O){const ae={...H};return delete ae.step1,ae}return{...H,step1:O}})},[]),oe=(a==null?void 0:a.currentStep)??1,z=(a==null?void 0:a.isComplete)??!1,ee=Math.min(Math.max(oe,1),10),ne=a?Math.round(ee/10*100):0,me=O=>z?!0:O<oe,ve=O=>z?!1:O===oe,D=oe===1?w:oe===2?v:oe===4?y:oe===6?N:oe===7?j:null;i.useEffect(()=>{const O=G.current;if(!O)return;const H=()=>{O.style.height="auto";const fe=Math.min(Math.max(O.scrollHeight,56),200);O.style.height=`${fe}px`};H();const ae=()=>H();return O.addEventListener("input",ae),()=>{O.removeEventListener("input",ae)}},[D==null?void 0:D.inputValue,D]);const ue=i.useCallback(()=>{D&&!D.isSubmitting&&D.onInputSubmit()},[D]);return p||n?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx(Qe,{className:"w-8 h-8 animate-spin text-vox-pink"})}):u?s.jsx("div",{className:"flex flex-col items-center justify-center min-h-screen p-4",children:s.jsxs("div",{className:"text-center max-w-md",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Workspace Required"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Please select a workspace to start creating your Voice Identity Profile."})]})}):L?s.jsxs("div",{className:"flex flex-col min-h-screen bg-white",children:[s.jsxs("header",{ref:q,className:`sticky top-0 z-50 border-b border-gray-200 bg-white/95 backdrop-blur-md transition-transform duration-300 ${B?"shadow-sm":""}`,style:{backfaceVisibility:"hidden",willChange:"transform",transform:`translate3d(0, ${C?"0px":`-${E+12}px`}, 0)`},children:[s.jsx("div",{className:"mx-4 md:mx-8 lg:mx-16 px-4 py-3",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>e("/dashboard"),className:"border-[#ff1f6c]/20 bg-white text-foreground hover:bg-[#ffe8f1] hover:text-[#ff1f6c] hover:border-[#ff1f6c]/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-[#ff1f6c]/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full overflow-hidden bg-gray-100 flex-shrink-0",children:s.jsx("img",{src:wt,alt:"Vera Avatar",className:"h-full w-full object-cover"})}),s.jsxs("div",{className:"min-w-0",children:[s.jsx("h1",{className:"text-sm font-semibold text-gray-900 truncate",children:"Vera Creator"}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Step ",ee," / 10"]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[s.jsx(Ie,{variant:"outline",size:"sm",onClick:()=>e("/tools/vera/previous-profiles"),className:"hidden sm:inline-flex items-center gap-2 px-3 h-8 text-sm font-medium border rounded-md bg-white text-foreground hover:bg-[#ffe8f1] hover:text-[#ff1f6c] hover:border-[#ff1f6c]/40 transition-all",children:"Previous Profiles"}),s.jsx("span",{className:"text-xs text-gray-500 hidden lg:inline-block",children:I}),s.jsxs(Ie,{type:"button",variant:"ghost",size:"icon",onClick:Z,disabled:n||u||p,title:"Reset Vera progress",className:"h-8 w-8 text-gray-500 hover:text-gray-700",children:[s.jsx(fu,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Reset Vera progress"})]})]})]})}),a&&s.jsxs("div",{className:"mx-4 md:mx-8 lg:mx-16 px-4 pb-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Progress"}),s.jsxs("span",{className:"text-xs font-bold bg-gradient-to-r from-vox-pink to-vox-orange bg-clip-text text-transparent",children:[ne,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 overflow-hidden",children:s.jsx("div",{className:"h-full bg-gradient-to-r from-vox-pink via-vox-purple to-vox-orange transition-all duration-500 ease-out",style:{width:`${ne}%`}})})]})]}),s.jsx("div",{ref:Q,className:"w-full",children:s.jsxs("div",{className:"w-full px-6 sm:px-8 lg:px-12 xl:px-16 py-8",children:[g&&s.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg text-red-700",children:g}),s.jsx(s3,{workspaceId:L,profile:a,onProfileChange:F,onLoadingChange:()=>{},onErrorChange:M,isCompleted:me(1),onInputHandlersReady:h,persistedState:l.step1??null,onPersistedStateChange:le}),a&&oe>=2&&s.jsx(n3,{workspaceId:L,profile:a,isActive:ve(2),isCompleted:me(2),onProfileChange:F,onError:M,onInputHandlersReady:x}),a&&oe>=3&&s.jsx(i3,{workspaceId:L,profile:a,isActive:ve(3),isCompleted:me(3),onProfileChange:F,onError:M}),a&&oe>=4&&s.jsx(l3,{workspaceId:L,profile:a,isActive:ve(4),isCompleted:me(4),onProfileChange:F,onError:M,onInputHandlersReady:b}),a&&oe>=5&&s.jsx(c3,{workspaceId:L,profile:a,isActive:ve(5),isCompleted:me(5),onProfileChange:F,onError:M}),a&&oe>=6&&s.jsx(u3,{workspaceId:L,profile:a,isActive:ve(6),isCompleted:me(6),onProfileChange:F,onError:M,onInputHandlersReady:S}),a&&oe>=7&&s.jsx(d3,{workspaceId:L,profile:a,isActive:ve(7),isCompleted:me(7),onProfileChange:F,onError:M,onInputHandlersReady:k}),a&&oe>=8&&s.jsx(m3,{workspaceId:L,profile:a,isActive:ve(8),isCompleted:me(8),onProfileChange:F,onError:M}),a&&oe>=9&&s.jsx(f3,{workspaceId:L,profile:a,isActive:ve(9),isCompleted:me(9),onProfileChange:F,onError:M}),a&&oe>=10&&s.jsx(h3,{workspaceId:L,profile:a,isActive:ve(10),isCompleted:me(10),onProfileChange:F,onError:M}),s.jsx("div",{ref:V}),D&&!z&&s.jsx("div",{className:"h-24","aria-hidden":!0})]})}),D&&!z&&s.jsx("div",{className:"fixed bottom-0 right-0 z-50 w-full md:w-[82%] bg-white px-6 sm:px-8 lg:px-12 xl:px-16",children:s.jsx("div",{className:"px-4 py-4",children:s.jsxs("div",{className:"mx-auto flex flex-col",children:[s.jsxs("div",{className:"flex gap-3 items-end",children:[s.jsxs("div",{className:"flex-1 relative w-[40%] rounded-xl",children:[s.jsx(fs,{id:"vera-unified-input",ref:G,value:D.inputValue||"",onChange:O=>{D.onInputChange(O.target.value)},onKeyDown:O=>{O.key==="Enter"&&!O.shiftKey&&(O.preventDefault(),D.inputValue.trim()&&!D.isSubmitting&&D.onInputSubmit())},placeholder:D.placeholder||"",disabled:D.isSubmitting||!1,className:`min-h-[56px] max-h-[200px] resize-none bg-white border-2 rounded-xl text-sm pr-4 shadow-sm transition-all disabled:bg-gray-50 disabled:opacity-50 ${D.validationError?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-gray-400 focus:ring-gray-400"}`,rows:1}),(D.validationError||D.validationHint)&&s.jsx("p",{className:"text-xs mt-1 ml-1 text-red-600",children:D.validationError||D.validationHint})]}),s.jsx(Ie,{onClick:ue,disabled:!D.inputValue.trim()||D.isSubmitting,size:"icon",className:"h-14 w-14 bg-gray-900 hover:bg-gray-800 text-white shrink-0 rounded-xl shadow-md hover:shadow-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:D.isSubmitting?s.jsx(Qe,{className:"w-5 h-5 animate-spin"}):s.jsx(hu,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-2 text-center",children:[s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px] border border-gray-300",children:"Enter"})," to send  ",s.jsx("kbd",{className:"px-1.5 py-0.5 bg-gray-100 rounded text-[10px] border border-gray-300",children:"Shift+Enter"})," new line"]})]})})}),z&&(a==null?void 0:a.finalProfile)&&s.jsx("div",{className:"border-t bg-green-50 p-4",children:s.jsxs("div",{className:"max-w-4xl mx-auto flex items-center gap-3",children:[s.jsx(Bi,{className:"w-6 h-6 text-green-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-green-900",children:"Your Voice Identity Profile is now complete."}),s.jsx("p",{className:"text-sm text-green-700",children:"Your voice identity has been saved and is ready to use across all VoxBox tools."})]})]})})]}):null},v3=()=>{const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState([]),[o,l]=i.useState(!0),[c,u]=i.useState(new Set);i.useEffect(()=>{if(!(e!=null&&e.id)){t({title:"No Workspace Selected",description:"Please select a workspace to view previous profiles",variant:"destructive"}),n("/tools/vera");return}d()},[e==null?void 0:e.id]);const d=async()=>{if(e!=null&&e.id){l(!0);try{const w=await Yi(e.id),v=((w==null?void 0:w.data)||[]).filter(x=>x.isComplete).sort((x,y)=>new Date(y.updatedAt).getTime()-new Date(x.updatedAt).getTime());a(v)}catch(w){console.error("Failed to load profiles:",w),t({title:"Error",description:(w==null?void 0:w.message)||"Failed to load previous profiles",variant:"destructive"})}finally{l(!1)}}},g=async w=>{if(!c.has(w.id)){u(h=>new Set(h).add(w.id));try{const h=await Oe.makeAuthenticatedRequest(`${Fe}/vera-profiles/${w.id}/export/pdf`,{method:"GET"});if(!h.ok)throw new Error("Failed to download PDF");const v=await h.blob(),x=URL.createObjectURL(v),y=document.createElement("a");y.href=x;const b=w.completedAt?new Date(w.completedAt).toISOString().split("T")[0]:new Date(w.createdAt).toISOString().split("T")[0],N=w.userName||"Client";y.download=`Vera-Profile-${N}-${b}.pdf`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(x),t({title:"PDF Downloaded",description:`Downloaded ${y.download}`})}catch(h){console.error("Failed to download PDF:",h),t({title:"Download Failed",description:(h==null?void 0:h.message)||"Failed to download profile PDF",variant:"destructive"})}finally{u(h=>{const v=new Set(h);return v.delete(w.id),v})}}},m=w=>new Date(w).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),p=()=>s.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Complete"}),f=w=>{n("/tools/vera",{state:{profileId:w.id}})};return o?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx(Qe,{className:"w-8 h-8 animate-spin text-vox-pink"})}):s.jsx("div",{className:"min-h-screen bg-white",children:s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[s.jsxs("div",{className:"mb-6",children:[s.jsxs(Ie,{variant:"ghost",onClick:()=>n("/tools/vera"),className:"mb-4",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back to Vera Creator"]}),s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Previous Voice Identity Profiles"}),s.jsx("p",{className:"text-gray-600",children:"View and download your completed voice identity profiles."})]}),r.length===0?s.jsx(qe,{children:s.jsxs(Xe,{className:"py-12 text-center",children:[s.jsx(Pn,{className:"w-16 h-16 mx-auto text-gray-400 mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No Completed Profiles Yet"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Finish a Vera journey to see it listed here."}),s.jsx(Ie,{onClick:()=>n("/tools/vera"),className:"bg-vox-pink hover:bg-vox-pink/90",children:"Create Your First Profile"})]})}):s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:r.map(w=>s.jsx(qe,{className:"hover:shadow-lg transition-shadow",children:s.jsxs(Xe,{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold flex-1",children:w.name}),p()]}),s.jsxs("div",{className:"space-y-2 mb-4 text-sm text-gray-600",children:[w.userName&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(zr,{className:"w-4 h-4"}),s.jsx("span",{children:w.userName})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(mu,{className:"w-4 h-4"}),s.jsx("span",{children:w.isComplete&&w.completedAt?`Completed ${m(w.completedAt)}`:`Updated ${m(w.updatedAt)}`})]}),w.consistencyScore!==null&&s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"font-medium",children:"Consistency Score:"}),s.jsxs("span",{className:w.consistencyScore>=80?"text-green-600 font-semibold":w.consistencyScore>=60?"text-yellow-600 font-semibold":"text-red-600 font-semibold",children:[w.consistencyScore,"/100"]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(Ie,{variant:"outline",size:"sm",onClick:()=>g(w),disabled:c.has(w.id),className:"flex-1",children:c.has(w.id)?s.jsx(Qe,{className:"w-4 h-4 animate-spin"}):s.jsxs(s.Fragment,{children:[s.jsx(ln,{className:"w-4 h-4 mr-2"}),"PDF"]})}),s.jsx(Ie,{variant:"outline",size:"sm",onClick:()=>f(w),className:"flex-1",children:"View"})]})]})},w.id))})]})})},y3=[{id:"email_sequence",title:"Email Sequence",description:"Craft persuasive email campaigns",icon:s.jsx(Zs,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/email-sequence"},{id:"social_media",title:"Social Media Posts",description:"Engaging social content",icon:s.jsx(xh,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/social-media"},{id:"sales_page",title:"Sales Page",description:"High-converting landing pages",icon:s.jsx(Pn,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/sales-page"},{id:"video_script",title:"Video Script",description:"Compelling video scripts",icon:s.jsx(qP,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/video-script"},{id:"ad_copy",title:"Ad Copy",description:"Attention-grabbing ads",icon:s.jsx(Mw,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/ad-copy"},{id:"value_proposition",title:"Value Proposition",description:"Clear positioning statements",icon:s.jsx(Rg,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/value-proposition"},{id:"blog_post",title:"Blog Post",description:"SEO-optimized articles",icon:s.jsx(zm,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/blog-post"},{id:"webinar_script",title:"Webinar Script",description:"Educational presentations",icon:s.jsx(BP,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/webinar-script"},{id:"lead_magnet",title:"Lead Magnet Content",description:"Valuable free resources",icon:s.jsx(kP,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!1},{id:"case_study",title:"Case Study",description:"Proof-driven stories",icon:s.jsx(Rg,{className:"h-5 w-5 text-white"}),accent:"bg-black",isAvailable:!0,link:"/amplifiers/case-study"}],w3=()=>{const e=Lt(),t=i.useMemo(()=>y3,[]);return s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsxs("header",{className:"space-y-2",children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground md:text-4xl",children:"Content Amplifiers"}),s.jsx("p",{className:"text-base text-muted-foreground",children:"Transform your profiles into persuasive content across multiple formats."})]}),s.jsx("section",{className:"grid gap-5 md:grid-cols-2 xl:grid-cols-3",children:t.map(n=>{const r=!n.isAvailable;return s.jsxs(qe,{className:`group flex cursor-pointer items-center gap-5 rounded-2xl border border-border/60 bg-white px-6 py-7 shadow-sm transition-all hover:-translate-y-1 hover:shadow-lg ${r?"pointer-events-none opacity-60":""}`,onClick:()=>{n.link&&e(n.link)},children:[s.jsx("div",{className:`${n.accent} flex h-12 w-12 items-center justify-center rounded-xl`,children:n.icon}),s.jsxs("div",{className:"space-y-1",children:[s.jsx(pt,{className:"text-lg",children:n.title}),s.jsx(gt,{className:"text-sm text-gray-400",children:n.description})]})]},n.id)})})]})};function qt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function qr(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}const Lj=6048e5,b3=864e5,$l=43200,Cx=1440;let N3={};function il(){return N3}function Ji(e,t){var c,u,d,g;const n=il(),r=(t==null?void 0:t.weekStartsOn)??((u=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??n.weekStartsOn??((g=(d=n.locale)==null?void 0:d.options)==null?void 0:g.weekStartsOn)??0,a=qt(e),o=a.getDay(),l=(o<r?7:0)+o-r;return a.setDate(a.getDate()-l),a.setHours(0,0,0,0),a}function Uc(e){return Ji(e,{weekStartsOn:1})}function Vj(e){const t=qt(e),n=t.getFullYear(),r=qr(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const a=Uc(r),o=qr(e,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const l=Uc(o);return t.getTime()>=a.getTime()?n+1:t.getTime()>=l.getTime()?n:n-1}function Ex(e){const t=qt(e);return t.setHours(0,0,0,0),t}function zc(e){const t=qt(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function j3(e,t){const n=Ex(e),r=Ex(t),a=+n-zc(n),o=+r-zc(r);return Math.round((a-o)/b3)}function S3(e){const t=Vj(e),n=qr(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Uc(n)}function sc(e,t){const n=qt(e),r=qt(t),a=n.getTime()-r.getTime();return a<0?-1:a>0?1:a}function k3(e){return qr(e,Date.now())}function P3(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function A3(e){if(!P3(e)&&typeof e!="number")return!1;const t=qt(e);return!isNaN(Number(t))}function C3(e,t){const n=qt(e),r=qt(t),a=n.getFullYear()-r.getFullYear(),o=n.getMonth()-r.getMonth();return a*12+o}function E3(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function I3(e,t){return+qt(e)-+qt(t)}function T3(e){const t=qt(e);return t.setHours(23,59,59,999),t}function R3(e){const t=qt(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function M3(e){const t=qt(e);return+T3(t)==+R3(t)}function $3(e,t){const n=qt(e),r=qt(t),a=sc(n,r),o=Math.abs(C3(n,r));let l;if(o<1)l=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-a*o);let c=sc(n,r)===-a;M3(qt(e))&&o===1&&sc(e,r)===1&&(c=!1),l=a*(o-Number(c))}return l===0?0:l}function D3(e,t,n){const r=I3(e,t)/1e3;return E3(n==null?void 0:n.roundingMethod)(r)}function O3(e){const t=qt(e),n=qr(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}const F3={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},_3=(e,t,n)=>{let r;const a=F3[e];return typeof a=="string"?r=a:t===1?r=a.one:r=a.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function $d(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const L3={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},V3={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},B3={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},W3={date:$d({formats:L3,defaultWidth:"full"}),time:$d({formats:V3,defaultWidth:"full"}),dateTime:$d({formats:B3,defaultWidth:"full"})},U3={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},z3=(e,t,n,r)=>U3[e];function Go(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let a;if(r==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=n!=null&&n.width?String(n.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=n!=null&&n.width?String(n.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(t):t;return a[o]}}const H3={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Q3={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},G3={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},q3={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Y3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},J3={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},K3=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},X3={ordinalNumber:K3,era:Go({values:H3,defaultWidth:"wide"}),quarter:Go({values:Q3,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Go({values:G3,defaultWidth:"wide"}),day:Go({values:q3,defaultWidth:"wide"}),dayPeriod:Go({values:Y3,defaultWidth:"wide",formattingValues:J3,defaultFormattingWidth:"wide"})};function qo(e){return(t,n={})=>{const r=n.width,a=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],o=t.match(a);if(!o)return null;const l=o[0],c=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(c)?e$(c,m=>m.test(l)):Z3(c,m=>m.test(l));let d;d=e.valueCallback?e.valueCallback(u):u,d=n.valueCallback?n.valueCallback(d):d;const g=t.slice(l.length);return{value:d,rest:g}}}function Z3(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function e$(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function t$(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const a=r[0],o=t.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=n.valueCallback?n.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}const s$=/^(\d+)(th|st|nd|rd)?/i,n$=/\d+/i,r$={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},a$={any:[/^b/i,/^(a|c)/i]},o$={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},i$={any:[/1/i,/2/i,/3/i,/4/i]},l$={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},c$={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},u$={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},d$={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},m$={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},f$={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},h$={ordinalNumber:t$({matchPattern:s$,parsePattern:n$,valueCallback:e=>parseInt(e,10)}),era:qo({matchPatterns:r$,defaultMatchWidth:"wide",parsePatterns:a$,defaultParseWidth:"any"}),quarter:qo({matchPatterns:o$,defaultMatchWidth:"wide",parsePatterns:i$,defaultParseWidth:"any",valueCallback:e=>e+1}),month:qo({matchPatterns:l$,defaultMatchWidth:"wide",parsePatterns:c$,defaultParseWidth:"any"}),day:qo({matchPatterns:u$,defaultMatchWidth:"wide",parsePatterns:d$,defaultParseWidth:"any"}),dayPeriod:qo({matchPatterns:m$,defaultMatchWidth:"any",parsePatterns:f$,defaultParseWidth:"any"})},Bj={code:"en-US",formatDistance:_3,formatLong:W3,formatRelative:z3,localize:X3,match:h$,options:{weekStartsOn:0,firstWeekContainsDate:1}};function p$(e){const t=qt(e);return j3(t,O3(t))+1}function g$(e){const t=qt(e),n=+Uc(t)-+S3(t);return Math.round(n/Lj)+1}function Wj(e,t){var g,m,p,f;const n=qt(e),r=n.getFullYear(),a=il(),o=(t==null?void 0:t.firstWeekContainsDate)??((m=(g=t==null?void 0:t.locale)==null?void 0:g.options)==null?void 0:m.firstWeekContainsDate)??a.firstWeekContainsDate??((f=(p=a.locale)==null?void 0:p.options)==null?void 0:f.firstWeekContainsDate)??1,l=qr(e,0);l.setFullYear(r+1,0,o),l.setHours(0,0,0,0);const c=Ji(l,t),u=qr(e,0);u.setFullYear(r,0,o),u.setHours(0,0,0,0);const d=Ji(u,t);return n.getTime()>=c.getTime()?r+1:n.getTime()>=d.getTime()?r:r-1}function x$(e,t){var c,u,d,g;const n=il(),r=(t==null?void 0:t.firstWeekContainsDate)??((u=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??n.firstWeekContainsDate??((g=(d=n.locale)==null?void 0:d.options)==null?void 0:g.firstWeekContainsDate)??1,a=Wj(e,t),o=qr(e,0);return o.setFullYear(a,0,r),o.setHours(0,0,0,0),Ji(o,t)}function v$(e,t){const n=qt(e),r=+Ji(n,t)-+x$(n,t);return Math.round(r/Lj)+1}function Wt(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Sr={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return Wt(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):Wt(n+1,2)},d(e,t){return Wt(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return Wt(e.getHours()%12||12,t.length)},H(e,t){return Wt(e.getHours(),t.length)},m(e,t){return Wt(e.getMinutes(),t.length)},s(e,t){return Wt(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),a=Math.trunc(r*Math.pow(10,n-3));return Wt(a,t.length)}},_a={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Ix={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),a=r>0?r:1-r;return n.ordinalNumber(a,{unit:"year"})}return Sr.y(e,t)},Y:function(e,t,n,r){const a=Wj(e,r),o=a>0?a:1-a;if(t==="YY"){const l=o%100;return Wt(l,2)}return t==="Yo"?n.ordinalNumber(o,{unit:"year"}):Wt(o,t.length)},R:function(e,t){const n=Vj(e);return Wt(n,t.length)},u:function(e,t){const n=e.getFullYear();return Wt(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return Wt(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return Wt(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Sr.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return Wt(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const a=v$(e,r);return t==="wo"?n.ordinalNumber(a,{unit:"week"}):Wt(a,t.length)},I:function(e,t,n){const r=g$(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):Wt(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Sr.d(e,t)},D:function(e,t,n){const r=p$(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):Wt(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(o);case"ee":return Wt(o,2);case"eo":return n.ordinalNumber(o,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});case"eeee":default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const a=e.getDay(),o=(a-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(o);case"cc":return Wt(o,t.length);case"co":return n.ordinalNumber(o,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});case"cccc":default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),a=r===0?7:r;switch(t){case"i":return String(a);case"ii":return Wt(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let a;switch(r===12?a=_a.noon:r===0?a=_a.midnight:a=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let a;switch(r>=17?a=_a.evening:r>=12?a=_a.afternoon:r>=4?a=_a.morning:a=_a.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Sr.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Sr.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):Wt(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):Wt(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Sr.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Sr.s(e,t)},S:function(e,t){return Sr.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Rx(r);case"XXXX":case"XX":return la(r);case"XXXXX":case"XXX":default:return la(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Rx(r);case"xxxx":case"xx":return la(r);case"xxxxx":case"xxx":default:return la(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Tx(r,":");case"OOOO":default:return"GMT"+la(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Tx(r,":");case"zzzz":default:return"GMT"+la(r,":")}},t:function(e,t,n){const r=Math.trunc(e.getTime()/1e3);return Wt(r,t.length)},T:function(e,t,n){const r=e.getTime();return Wt(r,t.length)}};function Tx(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=Math.trunc(r/60),o=r%60;return o===0?n+String(a):n+String(a)+t+Wt(o,2)}function Rx(e,t){return e%60===0?(e>0?"-":"+")+Wt(Math.abs(e)/60,2):la(e,t)}function la(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),a=Wt(Math.trunc(r/60),2),o=Wt(r%60,2);return n+a+t+o}const Mx=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Uj=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},y$=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],a=n[2];if(!a)return Mx(e,t);let o;switch(r){case"P":o=t.dateTime({width:"short"});break;case"PP":o=t.dateTime({width:"medium"});break;case"PPP":o=t.dateTime({width:"long"});break;case"PPPP":default:o=t.dateTime({width:"full"});break}return o.replace("{{date}}",Mx(r,t)).replace("{{time}}",Uj(a,t))},w$={p:Uj,P:y$},b$=/^D+$/,N$=/^Y+$/,j$=["D","DD","YY","YYYY"];function S$(e){return b$.test(e)}function k$(e){return N$.test(e)}function P$(e,t,n){const r=A$(e,t,n);if(console.warn(r),j$.includes(e))throw new RangeError(r)}function A$(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const C$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,E$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,I$=/^'([^]*?)'?$/,T$=/''/g,R$=/[a-zA-Z]/;function M$(e,t,n){var g,m,p,f;const r=il(),a=r.locale??Bj,o=r.firstWeekContainsDate??((m=(g=r.locale)==null?void 0:g.options)==null?void 0:m.firstWeekContainsDate)??1,l=r.weekStartsOn??((f=(p=r.locale)==null?void 0:p.options)==null?void 0:f.weekStartsOn)??0,c=qt(e);if(!A3(c))throw new RangeError("Invalid time value");let u=t.match(E$).map(w=>{const h=w[0];if(h==="p"||h==="P"){const v=w$[h];return v(w,a.formatLong)}return w}).join("").match(C$).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const h=w[0];if(h==="'")return{isToken:!1,value:$$(w)};if(Ix[h])return{isToken:!0,value:w};if(h.match(R$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+h+"`");return{isToken:!1,value:w}});a.localize.preprocessor&&(u=a.localize.preprocessor(c,u));const d={firstWeekContainsDate:o,weekStartsOn:l,locale:a};return u.map(w=>{if(!w.isToken)return w.value;const h=w.value;(k$(h)||S$(h))&&P$(h,t,String(e));const v=Ix[h[0]];return v(c,h,a.localize,d)}).join("")}function $$(e){const t=e.match(I$);return t?t[1].replace(T$,"'"):e}function D$(e,t,n){const r=il(),a=(n==null?void 0:n.locale)??r.locale??Bj,o=2520,l=sc(e,t);if(isNaN(l))throw new RangeError("Invalid time value");const c=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:l});let u,d;l>0?(u=qt(t),d=qt(e)):(u=qt(e),d=qt(t));const g=D3(d,u),m=(zc(d)-zc(u))/1e3,p=Math.round((g-m)/60);let f;if(p<2)return n!=null&&n.includeSeconds?g<5?a.formatDistance("lessThanXSeconds",5,c):g<10?a.formatDistance("lessThanXSeconds",10,c):g<20?a.formatDistance("lessThanXSeconds",20,c):g<40?a.formatDistance("halfAMinute",0,c):g<60?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",1,c):p===0?a.formatDistance("lessThanXMinutes",1,c):a.formatDistance("xMinutes",p,c);if(p<45)return a.formatDistance("xMinutes",p,c);if(p<90)return a.formatDistance("aboutXHours",1,c);if(p<Cx){const w=Math.round(p/60);return a.formatDistance("aboutXHours",w,c)}else{if(p<o)return a.formatDistance("xDays",1,c);if(p<$l){const w=Math.round(p/Cx);return a.formatDistance("xDays",w,c)}else if(p<$l*2)return f=Math.round(p/$l),a.formatDistance("aboutXMonths",f,c)}if(f=$3(d,u),f<12){const w=Math.round(p/$l);return a.formatDistance("xMonths",w,c)}else{const w=f%12,h=Math.trunc(f/12);return w<3?a.formatDistance("aboutXYears",h,c):w<9?a.formatDistance("overXYears",h,c):a.formatDistance("almostXYears",h+1,c)}}function Ht(e,t){return D$(e,k3(e),t)}const fn=e=>{if(!e||Array.isArray(e))return e;if(typeof e=="object"){const t=e.data;if(t!==void 0)return fn(t)}return e},Yn=e=>{const t=fn(e),n=typeof t.workspaceId=="string"?t.workspaceId:typeof t.workspace_id=="string"?t.workspace_id:"",r=typeof t.createdAt=="string"?t.createdAt:typeof t.created_at=="string"?t.created_at:new Date().toISOString(),a=typeof t.updatedAt=="string"?t.updatedAt:typeof t.updated_at=="string"?t.updated_at:r;return{id:t.id,workspaceId:n,type:t.type,status:t.status,title:t.title,language:t.language,inputs:t.inputs??{},output:t.output,createdAt:r,updatedAt:a}},O$=async e=>{const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify({amplifierType:"email_sequence",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:e.cta,inputs:{sequenceGoal:e.sequenceGoal,numberOfEmails:e.numberOfEmails,cta:e.cta}})});if(!n.ok){const o=await n.json().catch(()=>({message:"Failed to generate email sequence"}));throw new Error(o.message||"Failed to generate email sequence")}const r=await n.json(),a=fn(r);return Yn(a)},F$=async e=>{const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n={amplifierType:"sales_page",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:e.cta,inputs:{pageLength:e.pageLength,cta:e.cta}},r=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(n)});if(!r.ok){const l=await r.json().catch(()=>({message:"Failed to generate sales page"}));throw new Error(l.message||"Failed to generate sales page")}const a=await r.json(),o=fn(a);return Yn(o)},_$="Subscribe for more insights",L$=async e=>{var c;const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n=((c=e.cta)==null?void 0:c.trim())||_$,r={amplifierType:"video_script",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:n,inputs:{videoTopic:e.videoTopic,videoDuration:e.videoDuration,videoStyle:e.videoStyle,cta:n}},a=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(r)});if(!a.ok){const u=await a.json().catch(()=>({message:"Failed to generate video script"}));throw new Error(u.message||"Failed to generate video script")}const o=await a.json(),l=fn(o);return Yn(l)},V$="Register for our next webinar",B$=async e=>{var c;const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n=((c=e.cta)==null?void 0:c.trim())||V$,r={amplifierType:"webinar_script",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:n,inputs:{webinarTitle:e.webinarTitle.trim(),webinarTopic:e.webinarTopic.trim(),duration:e.duration,offerAtEnd:e.offerAtEnd,cta:n}},a=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(r)});if(!a.ok){const u=await a.json().catch(()=>({message:"Failed to generate webinar script"}));throw new Error(u.message||"Failed to generate webinar script")}const o=await a.json(),l=fn(o);return Yn(l)},W$=async e=>{const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n={amplifierType:"social_media",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:e.cta,inputs:{platform:e.platform,topicOrTheme:e.topicOrTheme,numberOfPosts:e.numberOfPosts}},r=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(n)});if(!r.ok){const l=await r.json().catch(()=>({message:"Failed to generate social media posts"}));throw new Error(l.message||"Failed to generate social media posts")}const a=await r.json(),o=fn(a);return Yn(o)},U$=async e=>{const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n={amplifierType:"ad_copy",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:e.cta,inputs:{platform:e.platform,adFormat:e.adFormat,campaignGoal:e.campaignGoal,cta:e.cta}},r=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(n)});if(!r.ok){const l=await r.json().catch(()=>({message:"Failed to generate ad copy"}));throw new Error(l.message||"Failed to generate ad copy")}const a=await r.json(),o=fn(a);return Yn(o)},z$=async e=>{const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n=e.keyPointsToCover.map(c=>c.trim()).filter((c,u,d)=>!!c&&d.indexOf(c)===u),r={amplifierType:"blog_post",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:e.cta,inputs:{blogTopic:e.blogTopic.trim(),keyPointsToCover:n,wordCount:e.wordCount,cta:e.cta}};console.log("[BlogPostAmplifier]  Creating blog post run"),console.log("[BlogPostAmplifier] Endpoint:",t),console.log("[BlogPostAmplifier] Payload:",{...r,inputs:{...r.inputs,keyPointsToCover:n}});const a=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(r)});if(!a.ok){const c=await a.json().catch(()=>({message:"Failed to generate blog post"}));throw console.error("[BlogPostAmplifier]  Request failed:",c),new Error(c.message||"Failed to generate blog post")}const o=await a.json();console.log("[BlogPostAmplifier]  Received blog post run:",o);const l=fn(o);return Yn(l)},H$="Learn more",Q$=async e=>{var c;const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n=((c=e.cta)==null?void 0:c.trim())||H$,r={amplifierType:"value_proposition",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:n,inputs:{format:e.format}},a=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(r)});if(!a.ok){const u=await a.json().catch(()=>({message:"Failed to generate value proposition"}));throw new Error(u.message||"Failed to generate value proposition")}const o=await a.json(),l=fn(o);return Yn(l)},G$="See how we can help you",q$=async e=>{var c;const t=`${Fe}/workspaces/${e.workspaceId}/amplifiers`,n=((c=e.cta)==null?void 0:c.trim())||G$,r={amplifierType:"case_study",avaSessionId:e.avaSessionId,margoProfileId:e.margoProfileId,cta:n,inputs:{clientName:e.clientName.trim(),challenge:e.challenge.trim(),solution:e.solution.trim(),results:e.results.trim(),format:e.format,cta:n}},a=await Oe.makeAuthenticatedRequest(t,{method:"POST",body:JSON.stringify(r)});if(!a.ok){const u=await a.json().catch(()=>({message:"Failed to generate case study"}));throw new Error(u.message||"Failed to generate case study")}const o=await a.json(),l=fn(o);return Yn(l)},vr=async(e,t="email_sequence")=>{const n=new URL(`${Fe}/workspaces/${e}/amplifiers`);t&&n.searchParams.set("type",t);const r=await Oe.makeAuthenticatedRequest(n.toString(),{method:"GET"});if(!r.ok){const l=await r.json().catch(()=>({message:"Failed to load amplifier runs"}));throw new Error(l.message||"Failed to load amplifier runs")}const a=await r.json(),o=fn(a);return Array.isArray(o)?o.map(l=>Yn(l)):[]},ps=(e,t)=>{for(const n of e)if(typeof n=="string"){const r=n.trim();if(r.length>0)return r}return t},Y$=e=>{let t=null;const n=()=>{if(t!==null&&typeof window<"u"&&window.cancelAnimationFrame(t),typeof window>"u"){e();return}t=window.requestAnimationFrame(()=>{t=null,e()})};return n.cancel=()=>{t!==null&&typeof window<"u"&&(window.cancelAnimationFrame(t),t=null)},n},ct=(e,t,n)=>{const r=Li(i.useCallback(d=>{var g,m;return(m=(g=d.states[e])==null?void 0:g.formValues)==null?void 0:m[t]},[e,t])),a=Li(d=>d.updateFormState),[o,l]=i.useState(()=>r!==void 0?r:n);i.useEffect(()=>{r!==void 0&&l(r)},[r]);const c=i.useRef(!1);i.useEffect(()=>{c.current||(a(e,{[t]:o}),c.current=!0)},[e,t,a,o]);const u=i.useCallback(d=>{l(g=>{const m=typeof d=="function"?d(g):d;return a(e,{[t]:m}),m})},[e,t,a]);return[o,u]},yr=e=>{const t=Li(i.useCallback(r=>{var a;return((a=r.states[e])==null?void 0:a.scrollPosition)??0},[e])),n=Li(r=>r.setScrollPosition);i.useLayoutEffect(()=>{typeof window>"u"||t>0&&window.scrollTo({top:t,behavior:"auto"})},[t]),i.useEffect(()=>{if(typeof window>"u")return;const r=Y$(()=>n(e,window.scrollY)),a=()=>n(e,window.scrollY);return window.addEventListener("scroll",r,{passive:!0}),window.addEventListener("beforeunload",a),()=>{r.cancel(),n(e,window.scrollY),window.removeEventListener("scroll",r),window.removeEventListener("beforeunload",a)}},[e,n])},J$=e=>{const t=parseInt(e,10);return Number.isNaN(t)?1:Math.min(Math.max(t,1),20)},K$=e=>e.status==="completed"||e.currentPhase==="completed",X$=e=>["completed","ready_for_export"].includes((e.status||"").toLowerCase()),Z$=e=>{if(!e)return[];const t=r=>{if(!r)return null;if(Array.isArray(r))return r;if(typeof r=="object"){const a=["content","emails","emailSequence","sequence","items","messages","data"];for(const o of a){const l=r[o];if(Array.isArray(l))return l}for(const o of Object.values(r))if(Array.isArray(o))return o}if(typeof r=="string")try{const a=JSON.parse(r),o=t(a);if(o)return o}catch{}return null},n=t(e);return n||[]},eD=e=>{var t;return Z$((t=e.output)==null?void 0:t.content)},$x=e=>e instanceof Error&&e.message?e.message:typeof e=="string"&&e?e:"Something went wrong. Please try again.",tD=Array.from({length:10}).map((e,t)=>String(t+1)),sD=()=>{const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState([]),[m,p]=i.useState([]),[f,w]=i.useState([]),h="emailSequence",[v,x]=ct(h,"selectedAvaSessionId",""),[y,b]=ct(h,"selectedMargoBriefId",""),[N,S]=ct(h,"sequenceGoal",""),[j,k]=ct(h,"numberOfEmails","5"),[C]=i.useState("Start your free trial today!");yr(h);const W=e==null?void 0:e.id,B=i.useCallback(async()=>{if(W){a(!0),u(null);try{const[P,K,G]=await Promise.all([Tn(W),qn(W),vr(W,"email_sequence")]),q=[...(P==null?void 0:P.completed)??[],...((P==null?void 0:P.active)??[]).filter(E=>K$(E))],A=(K??[]).filter(E=>X$(E));g(q),p(A),w(G??[]),x(E=>{var R;return E||((R=q[0])==null?void 0:R.id)||""}),b(E=>{var R;return E||((R=A[0])==null?void 0:R.id)||""})}catch(P){console.error(P);const K=$x(P);u(K),t({title:"Unable to load amplifier data",description:K,variant:"destructive"})}finally{a(!1)}}},[t,W]);i.useEffect(()=>{B()},[B]);const U=i.useCallback(async P=>{if(P.preventDefault(),!W){t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}const K=N.trim(),G=J$(j);if(!v){t({title:"Select an AVA profile",description:"Complete an AVA session and select it to power the amplifier.",variant:"destructive"});return}if(!y){t({title:"Select a MARGO product brief",description:"Complete a MARGO product brief and select it to power the amplifier.",variant:"destructive"});return}if(!K){t({title:"Sequence goal required",description:"Describe what you want this email sequence to accomplish.",variant:"destructive"});return}l(!0);try{const q=await O$({workspaceId:W,avaSessionId:v,margoProfileId:y,cta:C,sequenceGoal:K,numberOfEmails:G});w(A=>[q,...A]),t({title:"Email sequence generated",description:"Scroll down to review the freshly generated sequence."}),S(""),k(String(G))}catch(q){console.error(q),t({title:"Generation failed",description:$x(q),variant:"destructive"})}finally{l(!1)}},[W,t,v,y,N,j,C]),Q=i.useMemo(()=>d.length>0&&m.length>0,[d.length,m.length]),V=i.useMemo(()=>N.trim().length>=10,[N]);return W?s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-[#ff1f6c]/20 bg-white text-foreground hover:bg-[#ffe8f1] hover:text-[#ff1f6c] hover:border-[#ff1f6c]/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-[#ff1f6c]/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(Zs,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground",children:"Email Sequence Generator"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Create engaging email sequences"})]})]})}),s.jsxs(qe,{className:"rounded-2xl",children:[s.jsxs(vt,{className:"pb-2",children:[s.jsx(pt,{className:"text-xl",children:"Configure Email Sequence"}),s.jsx(gt,{children:"Select profiles and configure your sequence"})]}),s.jsx(Xe,{className:"space-y-6",children:s.jsxs("form",{className:"space-y-6",onSubmit:U,children:[s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Client Profile"}),s.jsxs($t,{value:v,onValueChange:x,disabled:d.length===0,children:[s.jsx(Et,{className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{children:d.map(P=>s.jsxs(Tt,{value:P.id,children:[ps([P.userName,P.sessionName],"Client Profile")," "," ",Ht(new Date(P.completedAt??P.createdAt),{addSuffix:!0})]},P.id))})]}),!r&&d.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete an AVA session to activate this amplifier."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Product Profile"}),s.jsxs($t,{value:y,onValueChange:b,disabled:m.length===0,children:[s.jsx(Et,{className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{children:m.map(P=>s.jsxs(Tt,{value:P.id,children:[ps([P.userName,P.productName,P.sessionName],"Product Profile")," "," ",Ht(new Date(P.updatedAt??P.createdAt),{addSuffix:!0})]},P.id))})]}),!r&&m.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete a MARGO product brief to activate this amplifier."})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Sequence Goal"}),s.jsx(fs,{placeholder:"What's the goal of this email sequence? (e.g., nurture leads, promote launch, onboard customers)",minLength:10,rows:4,value:N,onChange:P=>S(P.target.value),disabled:o||!Q,className:"rounded-2xl border-border/70 bg-white resize-none"}),N.trim().length<10&&s.jsxs("p",{className:"text-xs text-destructive",children:[N.trim().length," / 10 characters minimum required"]})]}),s.jsx("div",{className:"grid gap-5 md:w-1/2",children:s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Number of Emails"}),s.jsxs($t,{value:j,onValueChange:k,disabled:o||!Q,children:[s.jsx(Et,{className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select number"})}),s.jsx(It,{children:tD.map(P=>s.jsx(Tt,{value:P,children:P},P))})]})]})}),s.jsx(Ie,{type:"submit",disabled:!Q||!V||o,className:"h-12 rounded-xl bg-[#ff1f6c] text-base font-semibold text-white transition hover:bg-[#e51860]",children:o?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin"}),"Generating Email Sequence"]}):"Generate Email Sequence"})]})})]}),s.jsxs(qe,{className:"rounded-2xl",children:[s.jsxs(vt,{className:"pb-2",children:[s.jsx(pt,{className:"text-xl",children:"Generated Output"}),s.jsx(gt,{children:"Your generated email sequence will appear here"})]}),s.jsx(Xe,{className:"space-y-6",children:r?s.jsx("div",{className:"flex items-center justify-center py-14",children:s.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):c?s.jsx("div",{className:"rounded-xl border border-destructive/40 bg-destructive/10 px-5 py-6 text-destructive",children:c}):f.length===0?s.jsx("div",{className:"rounded-xl border border-dashed border-border/60 px-6 py-12 text-center text-sm text-muted-foreground",children:"Your generated email sequence will appear here once ready."}):f.map(P=>{var G,q;const K=eD(P);return s.jsxs(qe,{className:"rounded-xl border border-border/70 bg-white shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-lg font-semibold",children:P.title||((G=P.output)==null?void 0:G.title)||"Email Sequence"}),s.jsxs(gt,{className:"text-xs uppercase tracking-wide text-muted-foreground",children:["Generated ",Ht(new Date(P.createdAt),{addSuffix:!0})]})]}),s.jsx(Xe,{className:"space-y-4",children:K.length>0?s.jsx(Ij,{type:"multiple",className:"rounded-xl border border-border/60",children:K.map((A,E)=>{const R=A.emailNumber?A.emailNumber-1:E,L=`${P.id}-email-${R}`;return s.jsxs(Zh,{value:L,children:[s.jsxs(ep,{className:"px-4 py-3 text-left text-sm font-medium",children:["Email ",A.emailNumber??E+1,": ",A.subject||"Untitled email"]}),s.jsxs(tp,{className:"px-4 pb-4 text-sm leading-relaxed",children:[A.preheader&&s.jsxs("p",{className:"mb-3 text-xs text-muted-foreground",children:["Preheader: ",A.preheader]}),s.jsx("div",{className:"whitespace-pre-line rounded-lg bg-muted px-4 py-3",children:A.body||"No email body provided."})]})]},L)})}):typeof((q=P.output)==null?void 0:q.content)=="string"?s.jsx("div",{className:"rounded-lg bg-muted px-4 py-4 text-sm whitespace-pre-wrap leading-relaxed",children:P.output.content}):s.jsx("div",{className:"rounded-lg border border-dashed border-border px-4 py-4 text-sm text-muted-foreground",children:"The amplifier returned an unexpected format. Please regenerate the sequence."})})]},P.id)})})]})]}):s.jsx("div",{className:"mx-auto max-w-4xl",children:s.jsx(qe,{children:s.jsxs(vt,{children:[s.jsx(pt,{children:"Select a workspace"}),s.jsx(gt,{children:"Choose a workspace to access Amplifiers and generate marketing content."})]})})})},nD=e=>{if(!e||typeof e!="string")return null;const t=[];let n=[],r=null;const a=()=>{n.length>0&&(t.push({type:"paragraph",text:n.join(" ")}),n=[])},o=()=>{r&&r.length>0&&(t.push({type:"list",items:r}),r=null)},l=e.split(/\r?\n/);for(const w of l){const h=w.trim();if(!h){a(),o();continue}if(/^#{1,6}\s+/.test(h)){a(),o();const v=h.match(/^#{1,6}/),x=v?v[0].length:1,y=h.replace(/^#{1,6}\s*/,"").trim();t.push({type:"heading",level:x,text:y});continue}if(/^[-*]\s+/.test(h)||/^[]\s*/.test(h)){a(),r||(r=[]);const v=h.replace(/^[-*]\s+/,"").replace(/^[]\s*/,"").trim();r.push(v);continue}if(/^---+$/.test(h)){a(),o(),t.push({type:"separator"});continue}if(h.startsWith(">")){a(),o();const v=h.replace(/^>\s*/,"").trim();t.push({type:"paragraph",text:v});continue}o(),n.push(h)}a(),o();let c="",u;const d=[],g=[];let m=null,p=!0;const f=w=>{var h;p?d.push(w):m?m.blocks.push(w):g.length>0?(h=g[g.length-1])==null||h.blocks.push(w):d.push(w)};for(const w of t){if(w.type==="heading"){if(w.level===1&&!c){c=w.text??"";continue}if(w.level===2&&p&&!u){u=w.text;continue}p=!1,m={title:w.text??"",level:w.level??2,blocks:[]},g.push(m);continue}if(w.type==="separator"){p=!1,m=null;continue}if(w.type==="paragraph"&&w.text){f({type:"paragraph",text:w.text});continue}if(w.type==="list"&&w.items){f({type:"list",items:w.items});continue}}return!c&&d.length===0&&g.length===0?null:{title:c,subtitle:u,heroBlocks:d,sections:g}},Dx=e=>e instanceof Error&&e.message?e.message:typeof e=="string"?e:"Something went wrong. Please try again.",rD=[{value:"short",label:"Short (300 words)"},{value:"medium",label:"Medium (600 words)"},{value:"long",label:"Long (1,000 words)"}],aD=()=>{const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState([]),[m,p]=i.useState([]),[f,w]=i.useState([]),h="salesPage",[v,x]=ct(h,"selectedAvaSessionId",""),[y,b]=ct(h,"selectedMargoBriefId",""),[N,S]=ct(h,"pageLength","medium"),[j,k]=ct(h,"cta","Buy now for $99");yr(h);const C=e==null?void 0:e.id,W=i.useCallback(async()=>{if(C){a(!0),u(null);try{const[G,q,A]=await Promise.all([Tn(C),qn(C),vr(C,"sales_page")]),E=[...(G==null?void 0:G.completed)??[],...((G==null?void 0:G.active)??[]).filter(L=>L.status==="completed"||L.currentPhase==="completed")],R=(q??[]).filter(L=>["completed","ready_for_export"].includes((L.status||"").toLowerCase()));g(E),p(R),w(A??[]),x(L=>{var I;return L||((I=E[0])==null?void 0:I.id)||""}),b(L=>{var I;return L||((I=R[0])==null?void 0:I.id)||""})}catch(G){console.error(G);const q=Dx(G);u(q),t({title:"Unable to load sales page data",description:q,variant:"destructive"})}finally{a(!1)}}},[t,C]);i.useEffect(()=>{W()},[W]);const B=i.useMemo(()=>d.length>0&&m.length>0,[d.length,m.length]),U=i.useMemo(()=>j.trim().length>=5,[j]),Q=i.useCallback(async G=>{if(G.preventDefault(),!C){t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!v){t({title:"Select an AVA profile",description:"Complete an AVA session and select it to power the amplifier.",variant:"destructive"});return}if(!y){t({title:"Select a MARGO product brief",description:"Complete a MARGO product brief and select it to power the amplifier.",variant:"destructive"});return}l(!0);try{const q=await F$({workspaceId:C,avaSessionId:v,margoProfileId:y,pageLength:N,cta:j.trim()});w(A=>[q,...A]),t({title:"Sales page generated",description:"Scroll down to review the generated sales page."})}catch(q){console.error(q),t({title:"Generation failed",description:Dx(q),variant:"destructive"})}finally{l(!1)}},[C,t,v,y,N,j]);let V=0;const P=G=>{const q=()=>`inline-${V++}`,A=_=>{const $=[],F=/\*\*([^*]+)\*\*/g;let M=0,T;for(;(T=F.exec(_))!==null;)T.index>M&&$.push(_.slice(M,T.index)),$.push(s.jsx("span",{className:"font-semibold text-foreground",children:T[1]},q())),M=T.index+T[0].length;return M<_.length&&$.push(_.slice(M)),$},E=[],R=/\[([^\]]+)\]\(([^)]+)\)/g;let L=0,I;for(;(I=R.exec(G))!==null;){I.index>L&&E.push(...A(G.slice(L,I.index)));const _=I[1]??"",$=(I[2]??"").trim(),F=_.replace(/\*\*/g,"").trim().toLowerCase(),M=/buy|save|start|join|enroll|get|book/.test(F),T=A(_);E.push(s.jsx("a",{href:$||void 0,target:$?"_blank":void 0,rel:$?"noopener noreferrer":void 0,className:M?"inline-flex items-center justify-center rounded-xl bg-[#ff1f6c] px-4 py-2 font-semibold text-white shadow-sm transition hover:bg-[#e51860]":"font-semibold text-[#ff1f6c] underline decoration-2 underline-offset-4 hover:text-[#e51860]",children:T},q())),L=I.index+I[0].length}return L<G.length&&E.push(...A(G.slice(L))),E},K=(G,q)=>G.type==="paragraph"?s.jsx("p",{className:"text-sm leading-relaxed text-muted-foreground",children:P(G.text)},`paragraph-${q}`):G.type==="list"?s.jsx("ul",{className:"space-y-2",children:G.items.map((A,E)=>s.jsxs("li",{className:"relative pl-5 text-sm text-muted-foreground",children:[s.jsx("span",{className:"absolute left-0 top-[0.65rem] h-2 w-2 -translate-y-1/2 rounded-full bg-[#ff1f6c]"}),s.jsx("span",{children:P(A)})]},`list-${q}-item-${E}`))},`list-${q}`):null;return C?s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-[#ff1f6c]/20 bg-white text-foreground hover:bg-[#ffe8f1] hover:text-[#ff1f6c] hover:border-[#ff1f6c]/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-[#ff1f6c]/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(Pn,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground",children:"Sales Page Generator"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate high-converting sales pages using your AVA and product profiles."})]})]})}),s.jsxs(qe,{className:"rounded-2xl",children:[s.jsxs(vt,{className:"pb-2",children:[s.jsx(pt,{className:"text-xl",children:"Configure Sales Page"}),s.jsx(gt,{children:"Create compelling sales copy"})]}),s.jsx(Xe,{children:s.jsxs("form",{className:"space-y-6",onSubmit:Q,children:[s.jsxs("div",{className:"grid gap-5 md:grid-cols-2 lg:grid-cols-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Client Profile"}),s.jsxs($t,{value:v,onValueChange:x,disabled:d.length===0,children:[s.jsx(Et,{className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{children:d.map(G=>s.jsxs(Tt,{value:G.id,children:[ps([G.userName,G.sessionName],"Client Profile")," "," ",Ht(new Date(G.completedAt??G.createdAt),{addSuffix:!0})]},G.id))})]}),!r&&d.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete an AVA session to activate this amplifier."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Product Profile"}),s.jsxs($t,{value:y,onValueChange:b,disabled:m.length===0,children:[s.jsx(Et,{className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{children:m.map(G=>s.jsxs(Tt,{value:G.id,children:[ps([G.userName,G.productName,G.sessionName],"Product Profile")," ",""," ",Ht(new Date(G.updatedAt??G.createdAt),{addSuffix:!0})]},G.id))})]}),!r&&m.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete a MARGO product brief to activate this amplifier."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Page Length"}),s.jsxs($t,{value:N,onValueChange:G=>S(G),children:[s.jsx(Et,{className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select length"})}),s.jsx(It,{children:rD.map(G=>s.jsx(Tt,{value:G.value,children:G.label},G.value))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Primary Call-To-Action"}),s.jsx(Ft,{value:j,onChange:G=>k(G.target.value),placeholder:"Buy now for $99",disabled:o||!B,className:"h-12 rounded-xl border-border/80 bg-white",minLength:5}),j.trim().length<5&&s.jsxs("p",{className:"text-xs text-destructive",children:[j.trim().length," / 5 characters minimum required"]})]}),s.jsx(Ie,{type:"submit",disabled:!B||!U||o,className:"h-12 rounded-xl bg-[#ff1f6c] text-base font-semibold text-white transition hover:bg-[#e51860]",children:o?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin"}),"Generating Sales Page"]}):"Generate Sales Page"})]})})]}),s.jsxs(qe,{className:"rounded-2xl",children:[s.jsxs(vt,{className:"pb-2",children:[s.jsx(pt,{className:"text-xl",children:"Generated Sales Copy"}),s.jsx(gt,{children:"Complete sales page structure and content"})]}),s.jsx(Xe,{className:"space-y-6",children:r?s.jsx("div",{className:"flex items-center justify-center py-14",children:s.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):c?s.jsx("div",{className:"rounded-xl border border-destructive/40 bg-destructive/10 px-5 py-6 text-destructive",children:c}):f.length===0?s.jsx("div",{className:"rounded-xl border border-dashed border-border/60 px-6 py-12 text-center text-sm text-muted-foreground",children:"Your generated sales page will appear here once ready."}):f.map(G=>{var E,R,L,I,_,$,F;const q=nD(((E=G.output)==null?void 0:E.content)??""),A=(Array.isArray((L=(R=G.output)==null?void 0:R.metadata)==null?void 0:L.sections)?(_=(I=G.output)==null?void 0:I.metadata)==null?void 0:_.sections:[])??[];return s.jsxs(qe,{className:"rounded-xl border border-border/70 bg-white shadow-sm",children:[s.jsx(vt,{className:"space-y-2",children:s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx(pt,{className:"text-lg font-semibold",children:G.title||(($=G.output)==null?void 0:$.title)||"Sales Page"}),s.jsxs(gt,{className:"text-xs uppercase tracking-wide text-muted-foreground",children:["Generated ",Ht(new Date(G.createdAt),{addSuffix:!0})]})]}),A.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:A.map(M=>s.jsx("span",{className:"rounded-full bg-[#fff3f9] px-3 py-1 text-xs font-medium text-[#ff1f6c]",children:M},`${G.id}-chip-${M}`))})]})}),s.jsx(Xe,{className:"space-y-6",children:q?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("section",{className:"space-y-4 rounded-3xl border border-[#ffe4f1] bg-[#fff8fb] px-6 py-7",children:[q.title&&s.jsx("h2",{className:"text-2xl font-semibold text-foreground md:text-3xl",children:P(q.title)}),q.subtitle&&s.jsx("p",{className:"text-base font-medium text-[#ff1f6c]",children:P(q.subtitle)}),s.jsx("div",{className:"space-y-3",children:q.heroBlocks.map((M,T)=>K(M,T))})]}),q.sections.map((M,T)=>s.jsxs("section",{className:"space-y-4 rounded-3xl border border-border/60 bg-[#fcfdfd] px-6 py-6 shadow-sm",children:[s.jsx("h3",{className:"text-lg font-semibold uppercase tracking-wide text-foreground",children:P(M.title)}),s.jsx("div",{className:"space-y-3",children:M.blocks.map((ie,Z)=>K(ie,T*100+Z))})]},`${G.id}-section-${T}`))]}):typeof((F=G.output)==null?void 0:F.content)=="string"?s.jsx("div",{className:"whitespace-pre-line rounded-xl bg-muted px-4 py-4 text-sm leading-relaxed text-muted-foreground",children:G.output.content}):s.jsx("div",{className:"rounded-xl border border-dashed border-border px-4 py-4 text-sm text-muted-foreground",children:"The amplifier returned an unexpected format. Please regenerate the sales page."})})]},G.id)})})]})]}):s.jsx("div",{className:"mx-auto max-w-4xl",children:s.jsx(qe,{children:s.jsxs(vt,{children:[s.jsx(pt,{children:"Select a workspace"}),s.jsx(gt,{children:"Choose a workspace to access Amplifiers and generate marketing content."})]})})})},Dd=[{value:"instagram",label:"Instagram"},{value:"linkedin",label:"LinkedIn"},{value:"facebook",label:"Facebook"},{value:"twitter",label:"X / Twitter"},{value:"tiktok",label:"TikTok"}],oD=Array.from({length:10}).map((e,t)=>String(t+1)),iD=e=>e.status==="completed"||e.currentPhase==="completed",lD=e=>["completed","ready_for_export"].includes((e.status||"").toLowerCase()),cD=e=>{if(!e)return[];const t=r=>{if(!r)return null;if(Array.isArray(r))return r;if(typeof r=="object"){const a=["content","posts","items","data"];for(const o of a){const l=r[o];if(Array.isArray(l))return l}for(const o of Object.values(r))if(Array.isArray(o))return o}if(typeof r=="string")try{const a=JSON.parse(r),o=t(a);if(o)return o}catch{}return null},n=t(e);return n||[]},uD=e=>!e||e.length===0?"":e.map(t=>{if(!t)return"";const n=t.trim();return n?n.startsWith("#")?n:`#${n}`:""}).filter(Boolean).join(" "),dD=()=>{var ie;const e=i.useRef(null),{currentWorkspace:t}=ls(),{toast:n}=yt(),r=Lt(),[a,o]=i.useState(!0),[l,c]=i.useState(!1),[u,d]=i.useState(null),[g,m]=i.useState([]),[p,f]=i.useState([]),[w,h]=i.useState([]),[v,x]=i.useState([]),y="socialMedia",[b,N]=ct(y,"selectedAvaSessionId",""),[S,j]=ct(y,"selectedMargoBriefId",""),[k,C]=ct(y,"platform",((ie=Dd[0])==null?void 0:ie.value)??"instagram"),[W,B]=ct(y,"topicOrTheme",""),[U,Q]=ct(y,"numberOfPosts","3"),[V,P]=ct(y,"selectedVoiceProfileId",""),[K]=i.useState("Start your free trial today!"),[G,q]=i.useState("");yr(y);const A=t==null?void 0:t.id,E=i.useMemo(()=>new Map(Dd.map(Z=>[Z.value,Z.label])),[]),R=i.useMemo(()=>v.filter(Z=>Z.isComplete&&!!Z.finalProfile).map(Z=>{var le;return{value:Z.id,label:((le=Z.name)==null?void 0:le.trim())||"Untitled voice profile"}}),[v]),L=R.length>0,I=i.useCallback(async()=>{if(A){o(!0),d(null);try{const[Z,le,oe]=await Promise.all([Tn(A),qn(A),vr(A,"social_media")]),z=[...(Z==null?void 0:Z.completed)??[],...((Z==null?void 0:Z.active)??[]).filter(ne=>iD(ne))],ee=(le??[]).filter(ne=>lD(ne));m(z),f(ee),h(oe??[]),N(ne=>{var me;return ne||((me=z[0])==null?void 0:me.id)||""}),j(ne=>{var me;return ne||((me=ee[0])==null?void 0:me.id)||""})}catch(Z){console.error(Z);const le=Z instanceof Error&&Z.message?Z.message:"Failed to load amplifier data";d(le),n({title:"Unable to load amplifier data",description:le,variant:"destructive"})}finally{o(!1)}}},[n,A]);i.useEffect(()=>{I()},[I]),i.useEffect(()=>{if(!A){x([]),P("");return}let Z=!0;return(async()=>{try{const oe=await Yi(A);if(!Z)return;const z=((oe==null?void 0:oe.data)??[]).filter(ee=>ee.isComplete&&!!ee.finalProfile);x(z),P(ee=>{var ne;return ee||((ne=z[0])==null?void 0:ne.id)||""})}catch(oe){if(!Z)return;console.error("[SocialMediaGenerator] Failed to load voice profiles",oe),n({title:"Could not load voice profiles",description:oe instanceof Error&&oe.message?oe.message:"Please refresh and try again.",variant:"destructive"}),x([])}})(),()=>{Z=!1}},[A,P,n]),i.useEffect(()=>{if(!G)return;const Z=window.setTimeout(()=>{q("")},2e3);return()=>{window.clearTimeout(Z)}},[G]);const _=i.useCallback(async(Z,le)=>{if(!Z){n({title:"Nothing to copy",description:"This post does not include any text yet.",variant:"destructive"});return}try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(Z);else{const oe=document.createElement("textarea");oe.value=Z,oe.setAttribute("readonly",""),oe.style.position="absolute",oe.style.left="-9999px",document.body.appendChild(oe),oe.select(),document.execCommand("copy"),document.body.removeChild(oe)}q(le)}catch(oe){console.error(oe),n({title:"Copy failed",description:"We could not copy this post to your clipboard. Please try again.",variant:"destructive"})}},[n]),$=i.useCallback(()=>{e.current&&e.current.scrollIntoView({behavior:"smooth",block:"start"})},[]),F=i.useCallback(async Z=>{if(Z.preventDefault(),!A){n({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!b){n({title:"Select an AVA session",description:"You need a completed AVA session to generate content.",variant:"destructive"});return}if(!S){n({title:"Select a MARGO brief",description:"You need a completed product brief to generate content.",variant:"destructive"});return}const le=W.trim();if(!le){n({title:"Add a topic or theme",description:"Provide a topic or theme for the social media posts.",variant:"destructive"});return}const oe=Number.parseInt(U,10),z=Number.isNaN(oe)?3:Math.min(Math.max(oe,1),10);try{c(!0);const ee=await W$({workspaceId:A,avaSessionId:b,margoProfileId:S,cta:K,platform:k,topicOrTheme:le,numberOfPosts:z});h(ne=>[ee,...ne]),n({title:"Social media posts generated",description:"Your social media content is ready."})}catch(ee){console.error(ee);const ne=ee instanceof Error&&ee.message?ee.message:"Failed to generate social media posts. Please try again.";n({title:"Generation failed",description:ne,variant:"destructive"})}finally{c(!1)}},[K,k,U,b,S,W,n,A]),M=i.useMemo(()=>W.trim().length>=10,[W]),T=i.useMemo(()=>l||!b||!S||!M||!k||!U,[l,M,U,k,b,S]);return s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>r("/amplifiers"),className:"border-pink/20 bg-white text-foreground hover:bg-pink/10 hover:text-[#ff1f6c] hover:border-pink/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-pink/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(xh,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground md:text-4xl",children:"Social Media Posts"}),s.jsx("p",{className:"text-base text-muted-foreground",children:"Generate scroll-stopping social content powered by your AVA profiles and MARGO briefs."})]})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(qe,{className:"border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-xl font-semibold text-foreground",children:"Configure Social Posts"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Create platform-optimized content"})]}),s.jsx(Xe,{children:s.jsxs("form",{ref:e,className:"space-y-6",onSubmit:F,children:[s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"ava-session",children:"Client Profile"}),s.jsxs($t,{value:b,onValueChange:N,disabled:a||g.length===0,children:[s.jsx(Et,{id:"ava-session",className:"h-12 rounded-2xl border border-pink/20 bg-white text-left shadow-sm focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{className:"rounded-2xl border border-pink/20 bg-white shadow-lg",children:g.map(Z=>{const le=Z.completedAt??Z.createdAt,oe=le&&!Number.isNaN(new Date(le).getTime())?Ht(new Date(le),{addSuffix:!0}):null,z=ps([Z.userName,Z.sessionName,Z.id],"Client Profile");return s.jsx(Tt,{value:Z.id,children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{children:z}),oe?s.jsx("span",{className:"text-xs text-muted-foreground",children:oe}):null]})},Z.id)})})]}),g.length===0&&!a?s.jsx("p",{className:"text-xs text-muted-foreground",children:"No completed AVA sessions found. Complete one to power this amplifier."}):null]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"margo-brief",children:"Product Profile"}),s.jsxs($t,{value:S,onValueChange:j,disabled:a||p.length===0,children:[s.jsx(Et,{id:"margo-brief",className:"h-12 rounded-2xl border border-pink/20 bg-white text-left shadow-sm focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{className:"rounded-2xl border border-pink/20 bg-white shadow-lg",children:p.map(Z=>{const le=Z.updatedAt??Z.createdAt,oe=le&&!Number.isNaN(new Date(le).getTime())?Ht(new Date(le),{addSuffix:!0}):null,z=ps([Z.userName,typeof Z.productName=="string"?Z.productName:null,Z.sessionName],"Product Profile");return s.jsx(Tt,{value:Z.id,children:s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{children:z}),oe?s.jsx("span",{className:"text-xs text-muted-foreground",children:oe}):null]})},Z.id)})})]}),p.length===0&&!a?s.jsx("p",{className:"text-xs text-muted-foreground",children:"Finish a MARGO product brief to unlock social content generation."}):null]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"voice-profile",children:"Voice profile"}),s.jsxs($t,{value:V,onValueChange:P,disabled:!L,children:[s.jsx(Et,{id:"voice-profile",className:"h-12 rounded-2xl border border-pink/20 bg-white text-left shadow-sm focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:L?"Select voice":"No voice profiles yet"})}),L?s.jsx(It,{className:"rounded-2xl border border-pink/20 bg-white shadow-lg",children:R.map(Z=>s.jsx(Tt,{value:Z.value,children:Z.label},Z.value))}):null]}),L?null:s.jsx("p",{className:"text-xs text-muted-foreground",children:"Voice personalization support is coming soon to this amplifier."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"platform",children:"Platform"}),s.jsxs($t,{value:k,onValueChange:C,children:[s.jsx(Et,{id:"platform",className:"h-12 rounded-2xl border border-pink/20 bg-white text-left shadow-sm focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select platform"})}),s.jsx(It,{className:"rounded-2xl border border-pink/20 bg-white shadow-lg",children:Dd.map(Z=>s.jsx(Tt,{value:Z.value,children:Z.label},Z.value))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"topic",children:"Topic or theme"}),s.jsx(fs,{id:"topic",placeholder:"What should the posts be about?",value:W,onChange:Z=>B(Z.target.value),rows:3,minLength:10,className:"min-h-[112px] resize-none rounded-2xl border border-pink/20 bg-white shadow-sm focus:border-[#ff1f6c]"}),W.trim().length<10&&s.jsxs("p",{className:"text-xs text-destructive",children:[W.trim().length," / 10 characters minimum required"]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"number-of-posts",children:"Number of posts"}),s.jsxs($t,{value:U,onValueChange:Q,children:[s.jsx(Et,{id:"number-of-posts",className:"h-12 rounded-2xl border border-pink/20 bg-white text-left shadow-sm focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select number"})}),s.jsx(It,{className:"rounded-2xl border border-pink/20 bg-white shadow-lg",children:oD.map(Z=>s.jsx(Tt,{value:Z,children:Z},Z))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"cta",children:"Call to action"}),s.jsx(Ft,{id:"cta",value:K,disabled:!0,className:"h-12 rounded-2xl border border-pink/20 bg-white shadow-sm"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Customize CTAs soonthis default keeps campaigns consistent for now."})]})]}),s.jsx(Ie,{className:"w-full rounded-full bg-[#ff1f6c] px-6 py-6 text-base font-semibold text-white shadow-sm transition hover:bg-[#e51860]",type:"submit",disabled:T,children:l?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):"Generate Posts"})]})})]}),s.jsxs(qe,{className:"border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-xl font-semibold text-foreground",children:"Generated Social Posts"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Ready-to-publish content for your audience"})]}),s.jsx(Xe,{children:a?s.jsx("div",{className:"flex items-center justify-center py-10",children:s.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):u?s.jsx("div",{className:"rounded-2xl border border-destructive/40 bg-destructive/10 p-4 text-sm text-destructive",children:u}):w.length===0?s.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate your first batch of posts to see them appear here instantly."}):s.jsx("div",{className:"space-y-5",children:w.map(Z=>{var ue,O;const le=cD((ue=Z.output)==null?void 0:ue.content),oe=Z.createdAt?new Date(Z.createdAt):null,z=Z.inputs??{},ee=typeof z.platform=="string"?z.platform:void 0,ne=typeof z.topicOrTheme=="string"?z.topicOrTheme:void 0,me=ee?E.get(ee)??ee:void 0,ve=typeof z.numberOfPosts=="number"?z.numberOfPosts:typeof z.numberOfPosts=="string"?Number.parseInt(z.numberOfPosts,10):le.length,D=ne?`Ready-to-publish content for ${me??"your audience"} about ${ne}.`:"Ready-to-publish content for your audience.";return s.jsxs("div",{className:"overflow-hidden rounded-3xl border border-[#f3e6ff] bg-white shadow-sm transition hover:shadow-md",children:[s.jsx("div",{className:"border-b border-pink/20 bg-pink/5 px-6 py-5",children:s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-[0.35em] text-[#ff1f6c]",children:"Generated Social Posts"}),s.jsx("h3",{className:"text-xl font-semibold text-foreground",children:Z.title||"Social media campaign"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:D})]}),s.jsxs("div",{className:"flex flex-col items-end gap-2 text-right",children:[s.jsx("span",{className:"rounded-full bg-[#ff1f6c]/10 px-3 py-1 text-xs font-semibold uppercase text-[#ff1f6c]",children:Z.status}),oe&&!Number.isNaN(oe.getTime())?s.jsxs("span",{className:"text-xs text-muted-foreground",children:["Generated ",Ht(oe,{addSuffix:!0})]}):null,ve?s.jsxs("span",{className:"text-xs text-muted-foreground",children:[ve," ",ve===1?"post":"posts"]}):null]})]})}),s.jsx("div",{className:"px-6 py-6",children:le.length>0?s.jsx("div",{className:"space-y-5",children:le.map((H,ae)=>{const de=`${Z.id}-${H.postNumber??ae+1}`,re=typeof H.caption=="string"?H.caption:"",fe=typeof H.platform=="string"&&H.platform?H.platform:ee,Se=fe?E.get(fe)??fe:me,he=typeof H.characterCount=="number"?H.characterCount:re.length,se=Array.isArray(H.hashtags)&&H.hashtags.length>0?H.hashtags.filter($e=>typeof $e=="string"&&$e.trim()!==""):[],J=[];Se&&J.push(`Platform: ${Se}`),he>0&&J.push(`Character count: ${he}`);const Pe=J.join("  ");return s.jsxs("div",{className:"space-y-3 rounded-2xl border border-pink/20 bg-white p-5 shadow-sm",children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-sm font-semibold text-foreground",children:["Post ",H.postNumber??ae+1]}),H.notes?s.jsx("p",{className:"text-xs font-medium uppercase tracking-wide text-[#ff1f6c]",children:H.notes}):null]}),s.jsx("button",{type:"button",className:"inline-flex items-center rounded-full border border-pink/30 bg-white px-3 py-1 text-xs font-semibold text-[#ff1f6c] shadow-sm transition hover:bg-pink/10",onClick:()=>{_(re,de)},children:G===de?"Copied!":"Copy"})]}),re?s.jsx("p",{className:"text-base leading-relaxed text-foreground whitespace-pre-wrap",children:re}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"This post does not include text content yet."}),se.length>0?s.jsx("p",{className:"text-sm font-medium text-[#ff1f6c]",children:uD(se)}):null,Pe?s.jsx("p",{className:"text-xs text-muted-foreground",children:Pe}):null]},de)})}):typeof((O=Z.output)==null?void 0:O.content)=="string"?s.jsx("pre",{className:"max-h-72 overflow-auto rounded-2xl border border-pink/20 bg-white p-4 text-sm text-foreground whitespace-pre-wrap",children:Z.output.content}):s.jsx("p",{className:"text-sm text-muted-foreground",children:"No structured posts were returned. The raw output might not be in the expected format."})})]},Z.id)})})}),w.length>0?s.jsx("div",{className:"px-6 pb-6 pt-2",children:s.jsx(Ie,{type:"button",variant:"ghost",className:"w-full rounded-full border border-pink/30 bg-pink/5 px-6 py-3 text-sm font-semibold text-[#ff1f6c] shadow-sm transition hover:bg-pink/10",onClick:$,children:"Generate More Posts"})}):null]})]})]})},Od=[{value:"facebook",label:"Facebook"},{value:"instagram",label:"Instagram"},{value:"linkedin",label:"LinkedIn"},{value:"youtube",label:"YouTube"},{value:"google_display",label:"Google Display"},{value:"tiktok",label:"TikTok"}],Ox=[{value:"image_ad",label:"Image Ad"},{value:"video_ad",label:"Video Ad"},{value:"carousel_ad",label:"Carousel Ad"},{value:"story_ad",label:"Story / Reels Ad"},{value:"search_ad",label:"Search Ad"}],mD="Shop now",fD=e=>e.status==="completed"||e.currentPhase==="completed",hD=e=>["completed","ready_for_export"].includes((e.status||"").toLowerCase()),xs=e=>typeof e=="string"?e.trim():"",Fd=e=>e?Array.isArray(e)?e.map(t=>typeof t=="string"?t.trim():t&&typeof t=="object"?xs(t.value):"").filter(Boolean):typeof e=="string"?e.split(`
`).map(t=>t.trim()).filter(Boolean):[]:[],pD=e=>typeof e=="object"&&e!==null&&!Array.isArray(e),nc=e=>{if(!e)return null;if(Array.isArray(e))return e.length===0?[]:e.every(t=>typeof t=="string")?e.map(t=>({primaryText:t})):e;if(pD(e)){const t=e,n=["variations","ads","items","content","data","adVariations","results","entries"];for(const o of n)if(t[o]!==void 0){const l=nc(t[o]);if(l&&l.length>0)return l}if(["headline","headlineText","primaryText","description","body","hook","cta","callToAction"].some(o=>xs(t[o])))return[t];const a=Object.values(t).map(o=>nc(o)).filter(o=>Array.isArray(o)&&o.length>0);return a.length>0?a.flat():null}if(typeof e=="string"){const t=e.trim();if(!t)return null;try{const n=JSON.parse(t),r=nc(n);if(r)return r}catch{}return[{primaryText:t}]}return null},gD=e=>{const t=nc(e);return t||[]},xD=(e,t)=>{const n=xs(e.variationName)||xs(e.name)||xs(e.angle)||xs(e.title),r=xs(e.headline)||xs(e.headlineText)||xs(e.hook)||xs(e.subheadline),a=xs(e.primaryText)||xs(e.body)||xs(e.description),o=xs(e.callToAction)||xs(e.cta),l=Array.from(new Set([...Fd(e.supportingPoints),...Fd(e.bullets),...Fd(e.keyPoints)])),c=[],u=(g,m)=>{const p=xs(m);p&&c.push({label:g,value:p})};u("Hook",e.hook),u("Subheadline",e.subheadline),u("Description",e.description&&e.description!==a?e.description:""),u("Angle",n&&!n.startsWith("Variation")?n:"");const d=[];return r&&d.push(`Headline: ${r}`),a&&d.push(a),l.length>0&&d.push(["Key Points:",...l.map(g=>` ${g}`)].join(`
`)),o&&d.push(`CTA: ${o}`),d.length===0&&d.push(JSON.stringify(e,null,2)),{id:`ad-copy-variation-${t+1}`,label:n?`Ad Variation ${t+1} - ${n}`:`Ad Variation ${t+1}`,headline:r,primaryText:a,supportingPoints:l,cta:o,extraFields:c,copyPayload:d.join(`

`)}},Fx=e=>e instanceof Error&&e.message?e.message:typeof e=="string"&&e?e:"Something went wrong. Please try again.",vD=()=>{var R,L;const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState([]),[m,p]=i.useState([]),[f,w]=i.useState([]),h="adCopy",[v,x]=ct(h,"selectedAvaSessionId",""),[y,b]=ct(h,"selectedMargoBriefId",""),[N,S]=ct(h,"platform",((R=Od[0])==null?void 0:R.value)??"facebook"),[j,k]=ct(h,"adFormat",((L=Ox[0])==null?void 0:L.value)??"image_ad"),[C,W]=ct(h,"campaignGoal",""),[B]=i.useState(mD),[U,Q]=i.useState("");yr(h);const V=e==null?void 0:e.id,P=i.useMemo(()=>d.length>0&&m.length>0,[d.length,m.length]),K=i.useMemo(()=>C.trim().length>=10,[C]),G=i.useCallback(async()=>{if(V){a(!0),u(null);try{const[I,_,$]=await Promise.all([Tn(V),qn(V),vr(V,"ad_copy")]),F=[...(I==null?void 0:I.completed)??[],...((I==null?void 0:I.active)??[]).filter(T=>fD(T))],M=(_??[]).filter(T=>hD(T));g(F),p(M),w($??[]),x(T=>{var ie;return T||((ie=F[0])==null?void 0:ie.id)||""}),b(T=>{var ie;return T||((ie=M[0])==null?void 0:ie.id)||""})}catch(I){console.error(I);const _=Fx(I);u(_),t({title:"Unable to load amplifier data",description:_,variant:"destructive"})}finally{a(!1)}}},[t,V]);i.useEffect(()=>{G()},[G]);const q=i.useCallback(async I=>{if(I.preventDefault(),!V){t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!P){t({title:"Profiles required",description:"Complete an AVA session and a MARGO product brief to power this amplifier.",variant:"destructive"});return}if(!v){t({title:"Select an AVA profile",description:"Choose which AVA profile should inform the ad copy.",variant:"destructive"});return}if(!y){t({title:"Select a product brief",description:"Choose which product brief should inform the ad copy.",variant:"destructive"});return}const _=C.trim();if(!_){t({title:"Campaign goal required",description:"Describe the goal of this campaign so the AI can focus the messaging.",variant:"destructive"});return}l(!0);try{const $=await U$({workspaceId:V,avaSessionId:v,margoProfileId:y,cta:B,platform:N,adFormat:j,campaignGoal:_});w(F=>[$,...F]),W(""),t({title:"Ad copy generated",description:"Scroll down to review the new ad variations."})}catch($){console.error($),t({title:"Generation failed",description:Fx($),variant:"destructive"})}finally{l(!1)}},[V,t,P,v,y,C,B,N,j]),A=i.useCallback(async(I,_)=>{try{if(!navigator.clipboard||!navigator.clipboard.writeText)throw new Error("Clipboard API unavailable");await navigator.clipboard.writeText(I),Q(_),setTimeout(()=>Q(""),2e3),t({title:"Copied to clipboard",description:"The ad copy is ready to paste."})}catch($){console.error($),t({title:"Copy failed",description:"Unable to copy to clipboard. Please copy manually.",variant:"destructive"})}},[t]),E=i.useMemo(()=>new Map(Od.map(I=>[I.value,I.label])),[]);return V?s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-pink/20 bg-white text-foreground hover:bg-pink/10 hover:text-[#ff1f6c] hover:border-pink/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-pink/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(Mw,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground",children:"Ad Copy Generator"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Create high-converting ad variations for your chosen platform."})]})]})}),s.jsxs(qe,{className:"rounded-2xl border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"pb-2",children:[s.jsx(pt,{className:"text-xl",children:"Configure Ad Copy"}),s.jsx(gt,{children:"Generate ads across platforms and formats"})]}),s.jsx(Xe,{children:s.jsxs("form",{className:"space-y-6",onSubmit:q,children:[s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Client Profile"}),s.jsxs($t,{value:v,onValueChange:x,disabled:d.length===0||o,children:[s.jsx(Et,{className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:d.map(I=>s.jsxs(Tt,{value:I.id,children:[ps([I.userName,I.sessionName],"Client Profile")," "," ",Ht(new Date(I.completedAt??I.createdAt),{addSuffix:!0})]},I.id))})]}),!r&&d.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete an AVA session to activate this amplifier."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Product Profile"}),s.jsxs($t,{value:y,onValueChange:b,disabled:m.length===0||o,children:[s.jsx(Et,{className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:m.map(I=>s.jsxs(Tt,{value:I.id,children:[ps([I.userName,I.productName,I.sessionName],"Product Profile")," ",""," ",Ht(new Date(I.updatedAt??I.createdAt),{addSuffix:!0})]},I.id))})]}),!r&&m.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete a MARGO product brief to activate this amplifier."})]})]}),s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Platform"}),s.jsxs($t,{value:N,onValueChange:S,disabled:o||!P,children:[s.jsx(Et,{className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select platform"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:Od.map(I=>s.jsx(Tt,{value:I.value,children:I.label},I.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Ad Format"}),s.jsxs($t,{value:j,onValueChange:k,disabled:o||!P,children:[s.jsx(Et,{className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select ad format"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:Ox.map(I=>s.jsx(Tt,{value:I.value,children:I.label},I.value))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{children:"Campaign Goal"}),s.jsx(fs,{placeholder:"What's the goal of this ad campaign?",minLength:10,rows:4,value:C,onChange:I=>W(I.target.value),disabled:o||!P,className:"rounded-2xl border border-pink/20 bg-white resize-none focus:border-[#ff1f6c]"}),C.trim().length<10&&s.jsxs("p",{className:"text-xs text-destructive",children:[C.trim().length," / 10 characters minimum required"]})]}),!P&&s.jsx("p",{className:"text-sm text-amber-600",children:"Complete an AVA profile and a MARGO product brief to enable ad copy generation."}),s.jsx(Ie,{type:"submit",disabled:o||!P||!K,className:"h-12 w-full rounded-full bg-[#ff1f6c] text-base font-semibold text-white shadow-sm transition hover:bg-[#e51860]",children:o?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin"}),"Generating..."]}):"Generate Ad Copy"})]})})]}),s.jsxs("section",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Generated Ad Variations"}),f.length>0&&s.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",f.length," ",f.length===1?"run":"runs"]})]}),r?s.jsx(qe,{className:"flex items-center justify-center rounded-2xl border border-pink/20 bg-white py-16",children:s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(Qe,{className:"h-5 w-5 animate-spin"}),s.jsx("span",{children:"Loading previous ad copy runs..."})]})}):c?s.jsx(qe,{className:"rounded-2xl border border-red-200 bg-red-50 py-10 text-center",children:s.jsxs(Xe,{className:"space-y-2",children:[s.jsx("p",{className:"font-medium text-red-700",children:"Failed to load ad copy runs"}),s.jsx("p",{className:"text-sm text-red-600",children:c}),s.jsx(Ie,{variant:"outline",className:"mt-2 rounded-xl border-pink/20 hover:bg-pink/10",onClick:()=>{G()},children:"Retry"})]})}):f.length===0?s.jsx(qe,{className:"rounded-2xl border border-dashed border-pink/20 bg-white py-16 text-center",children:s.jsxs(Xe,{className:"space-y-2",children:[s.jsx("p",{className:"font-medium text-foreground",children:"No ad copy yet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure the form above to generate your first set of ad variations."})]})}):f.map(I=>{var T,ie,Z,le,oe,z,ee,ne,me,ve,D,ue;const _=gD((T=I.output)==null?void 0:T.content).map((O,H)=>xD(O,H)),$=I.createdAt?Ht(new Date(I.createdAt),{addSuffix:!0}):null,F=E.get(((ie=I.inputs)==null?void 0:ie.platform)||"")||xs((Z=I.inputs)==null?void 0:Z.platform)||"Ad Campaign",M=Array.isArray((oe=(le=I.output)==null?void 0:le.metadata)==null?void 0:oe.sections)?((ee=(z=I.output)==null?void 0:z.metadata)==null?void 0:ee.sections).map(xs).filter(Boolean):[];return s.jsxs(qe,{className:"space-y-6 rounded-2xl border border-pink/20 bg-white p-6 shadow-sm",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:((ne=I.output)==null?void 0:ne.title)||I.title||`${F} Campaign`}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[F,"  ",xs((me=I.inputs)==null?void 0:me.adFormat)||"Format selected",$?`  ${$}`:""]})]}),M.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:M.map(O=>s.jsx(b0,{variant:"secondary",className:"rounded-full bg-pink/10 text-[#ff1f6c] border-pink/20 px-3 py-1 text-xs",children:O},O))})]}),s.jsx("div",{className:"space-y-4",children:_.length===0?s.jsxs(qe,{className:"rounded-2xl border border-dashed border-pink/20 bg-white p-6",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Unable to parse structured variations. Raw output:"}),s.jsx("pre",{className:"mt-3 max-h-72 overflow-auto rounded-xl bg-white border border-pink/20 p-4 text-xs text-muted-foreground",children:typeof((ve=I.output)==null?void 0:ve.content)=="string"?(D=I.output)==null?void 0:D.content:JSON.stringify((ue=I.output)==null?void 0:ue.content,null,2)})]}):_.map(O=>s.jsxs(qe,{className:"rounded-2xl border border-pink/20 bg-white p-5 shadow-sm",children:[s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[s.jsx("div",{children:s.jsx("h4",{className:"text-base font-semibold text-foreground",children:O.label})}),s.jsx(Ie,{variant:"outline",size:"sm",className:"rounded-xl border-pink/30 bg-white hover:bg-pink/10",onClick:()=>{A(O.copyPayload,O.id)},children:U===O.id?s.jsxs("span",{className:"flex items-center gap-1 text-green-600",children:[s.jsx(ns,{className:"h-4 w-4"}),"Copied"]}):s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(RP,{className:"h-4 w-4"}),"Copy"]})})]}),s.jsxs("div",{className:"mt-4 space-y-3",children:[O.headline&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase text-[#ff1f6c]",children:"Headline"}),s.jsx("p",{className:"mt-1 text-base font-semibold text-foreground",children:O.headline})]}),O.primaryText&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase text-[#ff1f6c]",children:"Primary Text"}),s.jsx("p",{className:"mt-1 whitespace-pre-line text-sm leading-relaxed text-muted-foreground",children:O.primaryText})]}),O.supportingPoints.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase text-[#ff1f6c]",children:"Key Points"}),s.jsx("ul",{className:"mt-1 list-disc space-y-1 pl-5 text-sm text-muted-foreground",children:O.supportingPoints.map((H,ae)=>s.jsx("li",{children:H},`${O.id}-point-${ae}`))})]}),O.cta&&s.jsxs("div",{children:[s.jsx("p",{className:"text-xs font-semibold uppercase text-[#ff1f6c]",children:"CTA"}),s.jsx("p",{className:"mt-1 text-sm font-semibold text-[#ff1f6c]",children:O.cta})]}),O.extraFields.length>0&&s.jsx("div",{className:"grid gap-3 md:grid-cols-2",children:O.extraFields.map(H=>s.jsxs("div",{className:"rounded-xl bg-pink/5 border border-pink/10 p-3",children:[s.jsx("p",{className:"text-xs font-semibold uppercase text-[#ff1f6c]",children:H.label}),s.jsx("p",{className:"mt-1 text-sm leading-relaxed text-foreground",children:H.value})]},`${O.id}-${H.label}`))})]})]},O.id))})]},I.id)})]})]}):s.jsx("div",{className:"mx-auto max-w-4xl",children:s.jsx(qe,{className:"rounded-2xl",children:s.jsxs(vt,{children:[s.jsx(pt,{children:"Select a workspace"}),s.jsx(gt,{children:"Choose a workspace to access Amplifiers and generate tailored ad copy."})]})})})},_x=[{value:"60-90 seconds",label:"Short (60-90 seconds)"},{value:"90-120 seconds",label:"Medium (1.5-2 minutes)"},{value:"2-3 minutes",label:"Extended (2-3 minutes)"},{value:"3-5 minutes",label:"Long-form (3-5 minutes)"}],Lx=[{value:"Educational and engaging",label:"Educational & Engaging"},{value:"High-energy promotional",label:"High-Energy Promotional"},{value:"Story-driven narrative",label:"Story-Driven Narrative"},{value:"Conversational tutorial",label:"Conversational Tutorial"},{value:"Case study spotlight",label:"Case Study Spotlight"}],yD="Subscribe for more insights",Vx=e=>e instanceof Error&&e.message?e.message:typeof e=="string"&&e?e:"Something went wrong. Please try again.",wD=e=>{var o;if(typeof e!="string")return[];const t=[],n=e.split(/\r?\n/);let r=null;const a=()=>{if(!r)return;const l=[];let c=[];const u=()=>{c.length>0&&(l.push(c.join(" ")),c=[])};for(const d of r.lines){const g=d.trim();if(!g){u();continue}c.push(g)}u(),(l.length>0||r.visualCue)&&t.push({title:r.title,timeRange:r.timeRange,paragraphs:l,visualCue:r.visualCue}),r=null};for(const l of n){const c=l.trim();if(/^\*\*(.+)\*\*$/.test(c)){const u=c.match(/^\*\*(.+)\*\*$/);if(a(),u){const d=u[1].trim(),g=d.match(/\(([^)]+)\)/);r={title:d.replace(/\s*\([^)]*\)\s*$/,"").trim()||"Section",timeRange:(o=g==null?void 0:g[1])==null?void 0:o.trim(),lines:[]}}continue}if(!r){if(!c)continue;r={title:"Overview",lines:[]}}if(/^\[Visual:\s*(.+)\]$/i.test(c)){const u=c.match(/^\[Visual:\s*(.+)\]$/i);u!=null&&u[1]&&(r.visualCue=u[1].trim());continue}r.lines.push(l)}return a(),t};let bD=0;const Bx=e=>{const t=()=>`video-inline-${bD++}`,n=c=>{const u=[],d=/\*\*([^*]+)\*\*/g;let g=0,m;for(;(m=d.exec(c))!==null;)m.index>g&&u.push(c.slice(g,m.index)),u.push(s.jsx("span",{className:"font-semibold text-foreground",children:m[1]},t())),g=m.index+m[0].length;return g<c.length&&u.push(c.slice(g)),u},r=[],a=/\[([^\]]+)\]\(([^)]+)\)/g;let o=0,l;for(;(l=a.exec(e))!==null;){l.index>o&&r.push(...n(e.slice(o,l.index)));const c=l[1]??"",u=(l[2]??"").trim(),d=n(c);r.push(s.jsx("a",{href:u||void 0,target:u?"_blank":void 0,rel:u?"noopener noreferrer":void 0,className:"font-semibold text-[#ff1f6c] underline decoration-2 underline-offset-4 hover:text-[#e51860]",children:d},t())),o=l.index+l[0].length}return o<e.length&&r.push(...n(e.slice(o))),r},ND=()=>{var _,$;const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState([]),[m,p]=i.useState([]),[f,w]=i.useState([]),[h,v]=i.useState(null),x="videoScript",[y,b]=ct(x,"selectedAvaSessionId",""),[N,S]=ct(x,"selectedMargoBriefId",""),[j,k]=ct(x,"videoTopic",""),[C,W]=ct(x,"videoDuration",((_=_x[2])==null?void 0:_.value)??"2-3 minutes"),[B,U]=ct(x,"videoStyle",(($=Lx[0])==null?void 0:$.value)??"Educational and engaging"),[Q,V]=ct(x,"cta",yD);yr(x);const P=e==null?void 0:e.id,K=i.useMemo(()=>d.length>0&&m.length>0,[d.length,m.length]),G=i.useMemo(()=>Q.trim().length>=10,[Q]),q=i.useMemo(()=>j.trim().length>=10,[j]),A=i.useCallback(async()=>{if(P){a(!0),u(null);try{const[F,M,T]=await Promise.all([Tn(P),qn(P),vr(P,"video_script")]),ie=[...(F==null?void 0:F.completed)??[],...((F==null?void 0:F.active)??[]).filter(le=>le.status==="completed"||le.currentPhase==="completed")],Z=(M??[]).filter(le=>["completed","ready_for_export"].includes((le.status||"").toLowerCase()));g(ie),p(Z),w(T??[]),b(le=>{var oe;return le||((oe=ie[0])==null?void 0:oe.id)||""}),S(le=>{var oe;return le||((oe=Z[0])==null?void 0:oe.id)||""})}catch(F){console.error(F);const M=Vx(F);u(M),t({title:"Unable to load video script data",description:M,variant:"destructive"})}finally{a(!1)}}},[t,P]);i.useEffect(()=>{A()},[A]);const E=i.useCallback(async F=>{if(F.preventDefault(),!P){t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!y){t({title:"Select an AVA profile",description:"Complete an AVA session and select it to power the amplifier.",variant:"destructive"});return}if(!N){t({title:"Select a MARGO product brief",description:"Complete a MARGO product brief and select it to power the amplifier.",variant:"destructive"});return}const M=j.trim();if(!q){t({title:"Video topic required",description:"Please provide a video topic with at least 10 characters.",variant:"destructive"});return}if(!G){t({title:"Call-to-action required",description:"Please provide a call-to-action with at least 10 characters.",variant:"destructive"});return}l(!0);try{const T=await L$({workspaceId:P,avaSessionId:y,margoProfileId:N,videoTopic:M,videoDuration:C,videoStyle:B,cta:Q});w(ie=>[T,...ie]),t({title:"Video script generated",description:"Scroll down to review the generated script."}),k("")}catch(T){console.error(T),t({title:"Generation failed",description:Vx(T),variant:"destructive"})}finally{l(!1)}},[P,t,y,N,j,C,B,Q,G,q]),R=i.useCallback(async(F,M)=>{try{await navigator.clipboard.writeText(F),v(M),setTimeout(()=>{v(null)},2e3),t({title:"Script copied",description:"The video script is ready to paste."})}catch(T){console.error(T),t({title:"Unable to copy",description:"Please copy the script manually.",variant:"destructive"})}},[t]),L=i.useMemo(()=>{const F=d.find(M=>M.id===y);return F?ps([F.userName,F.sessionName],"Client Profile"):"Client Profile"},[d,y]),I=i.useMemo(()=>{const F=m.find(M=>M.id===N);return F?ps([F.userName,F.productName,F.sessionName],"Product Profile"):"Product Profile"},[m,N]);return P?s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-[#ff1f6c]/20 bg-white text-foreground hover:bg-[#ffe8f1] hover:text-[#ff1f6c] hover:border-[#ff1f6c]/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-[#ff1f6c]/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(IP,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground",children:"Video Script Generator"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Create engaging scripts ready for filming."})]})]})}),s.jsxs(qe,{className:"rounded-2xl",children:[s.jsxs(vt,{className:"pb-2",children:[s.jsx(pt,{className:"text-xl",children:"Configure Video Script"}),s.jsx(gt,{children:"Generate scripts for your video content"})]}),s.jsx(Xe,{children:s.jsxs("form",{className:"space-y-6",onSubmit:E,children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"video-topic",children:"Video Topic"}),s.jsx(fs,{id:"video-topic",value:j,onChange:F=>k(F.target.value),placeholder:"What is your video about?",rows:4,disabled:o||!K,className:"rounded-2xl border-border/70 bg-white resize-none"}),j.trim().length<10&&s.jsxs("p",{className:"text-xs text-destructive",children:[j.trim().length," / 10 characters minimum required"]})]}),s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"video-duration",children:"Video Duration"}),s.jsxs($t,{value:C,onValueChange:W,disabled:o||!K,children:[s.jsx(Et,{id:"video-duration",className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select duration"})}),s.jsx(It,{children:_x.map(F=>s.jsx(Tt,{value:F.value,children:F.label},F.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"video-style",children:"Video Style"}),s.jsxs($t,{value:B,onValueChange:U,disabled:o||!K,children:[s.jsx(Et,{id:"video-style",className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select style"})}),s.jsx(It,{children:Lx.map(F=>s.jsx(Tt,{value:F.value,children:F.label},F.value))})]})]})]}),s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"ava-profile",children:"Client Profile"}),s.jsxs($t,{value:y,onValueChange:b,disabled:d.length===0||o,children:[s.jsx(Et,{id:"ava-profile",className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{children:d.map(F=>s.jsxs(Tt,{value:F.id,children:[ps([F.userName,F.sessionName],"Client Profile")," "," ",Ht(new Date(F.completedAt??F.createdAt),{addSuffix:!0})]},F.id))})]}),!r&&d.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete an AVA session to activate this amplifier."})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"product-brief",children:"Product Profile"}),s.jsxs($t,{value:N,onValueChange:S,disabled:m.length===0||o,children:[s.jsx(Et,{id:"product-brief",className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{children:m.map(F=>s.jsxs(Tt,{value:F.id,children:[ps([F.userName,F.productName,F.sessionName],"Product Profile")," ",""," ",Ht(new Date(F.updatedAt??F.createdAt),{addSuffix:!0})]},F.id))})]}),!r&&m.length===0&&s.jsx("p",{className:"text-xs text-amber-600",children:"Complete a MARGO product brief to activate this amplifier."})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"cta-text",children:"Call-To-Action (used in the script)"}),s.jsx(Ft,{id:"cta-text",value:Q,onChange:F=>V(F.target.value),placeholder:"Subscribe for more insights",disabled:o||!K,className:"h-12 rounded-xl border-border/80 bg-white"}),Q.trim().length<10&&s.jsxs("p",{className:"text-xs text-destructive",children:[Q.trim().length," / 10 characters minimum required"]})]}),s.jsxs("div",{className:"rounded-xl bg-[#f5f7f9] px-4 py-3 text-xs text-muted-foreground",children:["Using ",s.jsx("span",{className:"font-medium text-foreground",children:L})," with"," ",s.jsx("span",{className:"font-medium text-foreground",children:I})," to personalize this script."]}),s.jsx(Ie,{type:"submit",disabled:!K||!q||!G||o,className:"h-12 rounded-xl bg-[#ff1f6c] text-base font-semibold text-white transition hover:bg-[#e51860]",children:o?s.jsxs("span",{className:"flex items-center gap-2",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin"}),"Generating Script"]}):"Generate Script"})]})})]}),s.jsxs(qe,{className:"rounded-2xl",children:[s.jsxs(vt,{className:"pb-2",children:[s.jsx(pt,{className:"text-xl",children:"Video Script"}),s.jsx(gt,{children:"Complete script with timing and visual cues"})]}),s.jsx(Xe,{className:"space-y-6",children:r?s.jsx("div",{className:"flex items-center justify-center py-14",children:s.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):c?s.jsx("div",{className:"rounded-xl border border-destructive/40 bg-destructive/10 px-5 py-6 text-destructive",children:c}):f.length===0?s.jsx("div",{className:"rounded-xl border border-dashed border-border/60 px-6 py-12 text-center text-sm text-muted-foreground",children:"Your generated video scripts will appear here once ready."}):f.map(F=>{var ve,D,ue,O,H,ae,de,re;const M=((ve=F.output)==null?void 0:ve.content)??"",T=wD(M),ie=Array.isArray((ue=(D=F.output)==null?void 0:D.metadata)==null?void 0:ue.sections)?(H=(O=F.output)==null?void 0:O.metadata)==null?void 0:H.sections:[],Z=F.inputs??{},le=typeof Z.videoDuration=="string"?Z.videoDuration:null,oe=typeof Z.videoStyle=="string"?Z.videoStyle:null,z=typeof Z.videoTopic=="string"?Z.videoTopic:null,ee=le??(typeof((de=(ae=F.output)==null?void 0:ae.metadata)==null?void 0:de.wordCount)=="number"?`Approx. ${Math.ceil(F.output.metadata.wordCount/150*60)} seconds`:"Runtime unavailable"),ne=oe??"Style unavailable",me=z??"";return s.jsxs(qe,{className:"rounded-xl border border-border/70 bg-white shadow-sm",children:[s.jsxs(vt,{className:"space-y-2",children:[s.jsxs("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:ie.length>0&&ie.map(fe=>s.jsx("span",{className:"rounded-full bg-[#fff3f9] px-3 py-1 text-xs font-medium text-[#ff1f6c]",children:fe},`${F.id}-section-${fe}`))}),s.jsx(pt,{className:"text-lg font-semibold",children:F.title||((re=F.output)==null?void 0:re.title)||"Video Script"}),s.jsxs(gt,{className:"text-xs uppercase tracking-wide text-muted-foreground",children:["Generated ",Ht(new Date(F.createdAt),{addSuffix:!0})]})]}),typeof M=="string"&&M&&s.jsx(Ie,{variant:"outline",className:"h-9 rounded-lg border-[#ffd1e4] text-sm font-semibold text-[#ff1f6c] hover:border-[#ff1f6c] flex items-center gap-2 shrink-0",onClick:()=>{typeof M=="string"&&R(M,F.id)},children:h===F.id?s.jsxs(s.Fragment,{children:[s.jsx(ns,{className:"h-4 w-4"}),"Copied!"]}):"Copy Script"})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-muted-foreground",children:[s.jsxs("span",{className:"rounded-full bg-[#f7f8fa] px-3 py-1",children:["Total runtime: ",s.jsx("span",{className:"font-medium text-foreground",children:ee})]}),s.jsxs("span",{className:"rounded-full bg-[#f7f8fa] px-3 py-1",children:["Style: ",s.jsx("span",{className:"font-medium text-foreground",children:ne})]}),me&&s.jsxs("span",{className:"rounded-full bg-[#f7f8fa] px-3 py-1",children:["Topic: ",s.jsx("span",{className:"font-medium text-foreground",children:me})]})]})]}),s.jsx(Xe,{className:"space-y-5",children:T.length>0?T.map((fe,Se)=>s.jsxs("section",{className:"space-y-3 rounded-3xl border border-border/60 bg-[#fcfdfd] px-6 py-6 shadow-sm",children:[s.jsxs("div",{className:"flex flex-wrap items-start gap-3",children:[fe.timeRange&&s.jsx("span",{className:"inline-flex h-7 items-center rounded-full bg-[#ffeff6] px-3 text-xs font-semibold text-[#ff1f6c]",children:fe.timeRange}),s.jsx("h3",{className:"text-lg font-semibold uppercase tracking-wide text-foreground",children:Bx(fe.title)})]}),s.jsx("div",{className:"space-y-3",children:fe.paragraphs.map((he,se)=>s.jsx("p",{className:"text-sm text-muted-foreground",children:Bx(he)},`${F.id}-paragraph-${Se}-${se}`))}),fe.visualCue&&s.jsxs("div",{className:"rounded-xl bg-[#fff6fb] px-4 py-3 text-xs font-medium text-[#ff1f6c]",children:["Visual: ",fe.visualCue]})]},`${F.id}-segment-${Se}`)):typeof M=="string"?s.jsx("div",{className:"whitespace-pre-line rounded-xl bg-muted px-4 py-4 text-sm leading-relaxed text-muted-foreground",children:M}):s.jsx("div",{className:"rounded-xl border border-dashed border-border px-4 py-4 text-sm text-muted-foreground",children:"The amplifier returned an unexpected format. Please regenerate the video script."})})]},F.id)})})]})]}):s.jsx("div",{className:"mx-auto max-w-4xl",children:s.jsx(qe,{children:s.jsxs(vt,{children:[s.jsx(pt,{children:"Select a workspace"}),s.jsx(gt,{children:"Choose a workspace to access Amplifiers and generate marketing content."})]})})})},_d=[{value:"30 minutes",label:"30 minutes"},{value:"45 minutes",label:"45 minutes"},{value:"60 minutes",label:"60 minutes"},{value:"90 minutes",label:"90 minutes"}],jD=[{value:"true",label:"Yes - Include an offer"},{value:"false",label:"No - Focus on value only"}],SD="Register for our next webinar",Yo=5,Jo=10,Ko=5,Wx=e=>e instanceof Error&&e.message?e.message:typeof e=="string"&&e.trim()?e:"Something went wrong. Please try again.";let kD=0;const Dl=e=>{const t=()=>`webinar-inline-${kD++}`,n=c=>{const u=[],d=/\*\*([^*]+)\*\*/g;let g=0,m;for(;(m=d.exec(c))!==null;)m.index>g&&u.push(c.slice(g,m.index)),u.push(s.jsx("span",{className:"font-semibold text-foreground",children:m[1]},t())),g=m.index+m[0].length;return g<c.length&&u.push(c.slice(g)),u},r=[],a=/\[([^\]]+)\]\(([^)]+)\)/g;let o=0,l;for(;(l=a.exec(e))!==null;){l.index>o&&r.push(...n(e.slice(o,l.index)));const c=l[1]??"",u=(l[2]??"").trim(),d=n(c);r.push(s.jsx("a",{href:u||void 0,target:u?"_blank":void 0,rel:u?"noopener noreferrer":void 0,className:"font-semibold text-[#ff1f6c] underline decoration-2 underline-offset-4 hover:text-[#e51860]",children:d},t())),o=l.index+l[0].length}return o<e.length&&r.push(...n(e.slice(o))),r},PD=e=>{if(!e)return;const t=e.match(/(\d+(?:\.\d+)?)/);if(!t)return;const n=Number.parseFloat(t[1]);if(!Number.isNaN(n))return n},Ux=e=>{if(e===void 0||Number.isNaN(e))return"";const t=Math.max(0,Math.round(e)),n=Math.floor(t/60),r=t%60;return n>0?`${n}:${r.toString().padStart(2,"0")}:00`:`${t}:00`},AD=e=>{if(typeof e!="string"||!e.trim())return{title:"",sections:[]};const t=e.split(/\r?\n/);let n="";const r=[];let a=null,o=[],l=null;const c=()=>{if(o.length===0)return;const m=o.join(" ").replace(/\s+/g," ").trim();o=[],!(!m||!a)&&a.blocks.push({type:"paragraph",content:m})},u=()=>{if(!l||l.length===0||!a){l=null;return}a.blocks.push({type:"list",items:l}),l=null},d=()=>{c(),u()};for(const m of t){const p=m.trim();if(!p){d();continue}if(/^#\s+/.test(p)){d(),n=p.replace(/^#\s*/,"").trim();continue}if(/^##\s+/.test(p)){d();const f=p.replace(/^##\s*/,"").trim(),w=f.match(/\(([^)]+)\)\s*$/),h=w!=null&&w[1]?w[1].trim():void 0;a={title:w?f.replace(/\([^)]*\)\s*$/,"").trim():f,durationLabel:h,durationMinutes:PD(h),blocks:[]},r.push(a);continue}if(/^\*\*(.+)\*\*$/.test(p)){d(),a&&a.blocks.push({type:"subheading",content:p.replace(/^\*\*(.+)\*\*$/,"$1").trim()});continue}if(/^\[(.+)\]$/.test(p)){d(),a&&a.blocks.push({type:"note",content:p.replace(/^\[(.+)\]$/,"$1").trim()});continue}if(/^[-*]\s+/.test(p)){c();const f=p.replace(/^[-*]\s+/,"").trim();l||(l=[]),l.push(f);continue}o.push(p)}d();let g=0;for(const m of r){const p=m.durationMinutes??0;m.startMinute=g,m.endMinute=g+p,g+=p}return{title:n,sections:r}},CD=e=>e.status==="completed"||e.currentPhase==="completed",ED=e=>["completed","ready_for_export"].includes((e.status||"").toLowerCase()),ID=()=>{var ie,Z;const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState(!1),[m,p]=i.useState([]),[f,w]=i.useState([]),[h,v]=i.useState([]),x="webinarScript",[y,b]=ct(x,"selectedRunId",""),[N,S]=ct(x,"selectedAvaSessionId",""),[j,k]=ct(x,"selectedMargoBriefId",""),[C,W]=ct(x,"webinarTitle",""),[B,U]=ct(x,"webinarTopic",""),[Q,V]=ct(x,"duration",((ie=_d[1])==null?void 0:ie.value)??"45 minutes"),[P,K]=ct(x,"offerAtEnd","true"),[G,q]=ct(x,"cta",SD),A=i.useMemo(()=>C.trim().length>=Yo,[C]),E=i.useMemo(()=>B.trim().length>=Jo,[B]),R=i.useMemo(()=>G.trim().length>=Ko,[G]);yr(x);const L=e==null?void 0:e.id,I=i.useMemo(()=>m.length>0&&f.length>0,[m.length,f.length]),_=i.useMemo(()=>y?h.find(le=>le.id===y)??h[0]:h[0],[h,y]),$=i.useCallback(async()=>{if(L){a(!0),u(null);try{const[le,oe,z]=await Promise.all([Tn(L),qn(L),vr(L,"webinar_script")]),ee=[...(le==null?void 0:le.completed)??[],...((le==null?void 0:le.active)??[]).filter(CD)],ne=(oe??[]).filter(ED);p(ee),w(ne),v(z??[]),S(me=>{var ve;return me||((ve=ee[0])==null?void 0:ve.id)||""}),k(me=>{var ve;return me||((ve=ne[0])==null?void 0:ve.id)||""}),b(me=>{var ve;return me||((ve=z==null?void 0:z[0])==null?void 0:ve.id)||""})}catch(le){console.error(le);const oe=Wx(le);u(oe),t({title:"Unable to load webinar scripts",description:oe,variant:"destructive"})}finally{a(!1)}}},[t,L]);i.useEffect(()=>{$()},[$]);const F=i.useCallback(async le=>{if(le.preventDefault(),!L){t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!N){t({title:"Select an AVA profile",description:"Complete an AVA session and select it to power the amplifier.",variant:"destructive"});return}if(!j){t({title:"Select a MARGO product brief",description:"Complete a MARGO product brief and select it to power the amplifier.",variant:"destructive"});return}const oe=C.trim(),z=B.trim(),ee=G.trim();if(!A){t({title:"Webinar title required",description:`Provide a clear title of at least ${Yo} characters to anchor the webinar script.`,variant:"destructive"});return}if(!E){t({title:"Webinar topic required",description:`Describe the theme or promise of this webinar in at least ${Jo} characters.`,variant:"destructive"});return}if(!R){t({title:"Call to action required",description:`Provide a compelling CTA of at least ${Ko} characters.`,variant:"destructive"});return}l(!0);try{const ne=await B$({workspaceId:L,avaSessionId:N,margoProfileId:j,webinarTitle:oe,webinarTopic:z,duration:Q,offerAtEnd:P==="true",cta:ee});v(me=>[ne,...me]),b(ne.id),t({title:"Webinar script generated",description:"Scroll down to review the complete webinar outline."})}catch(ne){console.error(ne),t({title:"Generation failed",description:Wx(ne),variant:"destructive"})}finally{l(!1)}},[L,t,N,j,C,B,Q,P,G]),M=i.useCallback(async le=>{try{await navigator.clipboard.writeText(le),g(!0),setTimeout(()=>{g(!1)},2e3),t({title:"Script copied",description:"The webinar script is ready to paste."})}catch(oe){console.error(oe),t({title:"Unable to copy",description:"Copying to clipboard failed. Please try again.",variant:"destructive"})}},[t]),T=(le,oe)=>{const z=le.startMinute!==void 0&&le.endMinute!==void 0?`${Ux(le.startMinute)}-${Ux(le.endMinute)}`:le.durationLabel??"";return s.jsxs("div",{className:"rounded-2xl border border-pink/20 bg-white p-6 shadow-sm",children:[s.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-start sm:justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"inline-flex rounded-full bg-pink/10 border border-pink/20 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-[#ff1f6c]",children:z||"Section"}),s.jsx("h3",{className:"mt-3 text-xl font-semibold text-foreground",children:le.title})]}),le.durationLabel&&s.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Duration: ",le.durationLabel]})]}),s.jsx("div",{className:"mt-4 space-y-3 text-base leading-relaxed text-muted-foreground",children:le.blocks.map((ee,ne)=>ee.type==="subheading"&&ee.content?s.jsx("p",{className:"font-semibold text-foreground",children:Dl(ee.content)},`subheading-${ne}`):ee.type==="note"&&ee.content?s.jsx("p",{className:"rounded-lg bg-pink/10 border border-pink/20 px-4 py-3 text-sm font-medium text-[#ff1f6c]",children:Dl(ee.content)},`note-${ne}`):ee.type==="list"&&ee.items?s.jsx("ul",{className:"list-disc space-y-2 pl-6 text-muted-foreground",children:ee.items.map((me,ve)=>s.jsx("li",{children:Dl(me)},`item-${ve}`))},`list-${ne}`):ee.type==="paragraph"&&ee.content?s.jsx("p",{className:"text-muted-foreground",children:Dl(ee.content)},`paragraph-${ne}`):null)})]},`${le.title}-${oe}`)};return s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-pink/20 bg-white text-foreground hover:bg-pink/10 hover:text-[#ff1f6c] hover:border-pink/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-pink/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(xh,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground md:text-4xl",children:"Webinar Script Generator"}),s.jsx("p",{className:"text-base text-muted-foreground",children:"Create complete webinar presentations with timing, talking points, and slide prompts."})]})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(qe,{className:"rounded-3xl border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{children:[s.jsx(pt,{className:"text-xl",children:"Configure Webinar Script"}),s.jsx(gt,{children:"Generate a detailed webinar outline tailored to your offer."})]}),s.jsx(Xe,{children:s.jsxs("form",{className:"space-y-5",onSubmit:F,children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"ava-session",children:"Client Profile"}),s.jsxs($t,{value:N,onValueChange:S,disabled:r||!m.length,children:[s.jsx(Et,{id:"ava-session",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:m.map(le=>{const oe=ps([le.userName,le.sessionName,le.id],"Client Profile"),z=le.completedAt??le.createdAt??null,ee=z!==null?Ht(new Date(z),{addSuffix:!0}):null;return s.jsxs(Tt,{value:le.id,children:[oe,ee?`  ${ee}`:""]},le.id)})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"margo-brief",children:"Product Profile"}),s.jsxs($t,{value:j,onValueChange:k,disabled:r||!f.length,children:[s.jsx(Et,{id:"margo-brief",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:f.map(le=>{const oe=ps([le.userName,le.productName,le.sessionName,le.id],"Product Profile"),z=le.updatedAt??le.completedAt??le.createdAt??null,ee=z!==null?Ht(new Date(z),{addSuffix:!0}):null;return s.jsxs(Tt,{value:le.id,children:[oe,ee?`  ${ee}`:""]},le.id)})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"webinar-title",children:"Webinar Title"}),s.jsx(Ft,{id:"webinar-title",value:C,onChange:le=>W(le.target.value),minLength:Yo,placeholder:"Enter your webinar title",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]"}),C.trim().length<Yo&&s.jsxs("p",{className:"text-xs text-destructive",children:[C.trim().length," / ",Yo," characters minimum required"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"webinar-topic",children:"Webinar Topic"}),s.jsx(fs,{id:"webinar-topic",value:B,onChange:le=>U(le.target.value),placeholder:"What will you teach in this webinar?",rows:4,className:"resize-none rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c]",minLength:Jo}),B.trim().length<Jo&&s.jsxs("p",{className:"text-xs text-destructive",children:[B.trim().length," / ",Jo," characters minimum required"]})]}),s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"webinar-duration",children:"Duration"}),s.jsxs($t,{value:Q,onValueChange:V,disabled:r,children:[s.jsx(Et,{id:"webinar-duration",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select duration"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:_d.map(le=>s.jsx(Tt,{value:le.value,children:le.label},le.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"webinar-offer",children:"Offer at End?"}),s.jsxs($t,{value:P,onValueChange:le=>K(le==="true"?"true":"false"),disabled:r,children:[s.jsx(Et,{id:"webinar-offer",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select option"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:jD.map(le=>s.jsx(Tt,{value:le.value,children:le.label},le.value))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"webinar-cta",children:"Primary Call to Action"}),s.jsx(Ft,{id:"webinar-cta",value:G,onChange:le=>q(le.target.value),placeholder:"Register for our next webinar",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",minLength:Ko}),G.trim().length<Ko&&s.jsxs("p",{className:"text-xs text-destructive",children:[G.trim().length," / ",Ko," characters minimum required"]})]}),s.jsx(Ie,{type:"submit",className:"w-full rounded-full bg-[#ff1f6c] text-base font-semibold text-white shadow-sm transition hover:bg-[#e51860]",disabled:o||!I||!A||!E||!R,children:o?s.jsxs("span",{className:"flex items-center justify-center gap-2",children:[s.jsx(Qe,{className:"h-4 w-4 animate-spin"}),"Generating Webinar Script..."]}):"Generate Webinar Script"})]})})]}),s.jsxs(qe,{className:"rounded-3xl border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{children:[s.jsx(pt,{className:"text-xl",children:"Recent Webinar Scripts"}),s.jsx(gt,{children:"Review your latest runs and revisit earlier scripts."})]}),s.jsx(Xe,{children:r?s.jsx("div",{className:"flex items-center justify-center py-10 text-muted-foreground",children:s.jsx(Qe,{className:"h-5 w-5 animate-spin"})}):h.length===0?s.jsx("div",{className:"rounded-2xl border border-dashed border-pink/20 bg-white p-6 text-sm text-muted-foreground",children:"Generate your first webinar script to see it listed here."}):s.jsx("div",{className:"space-y-3",children:h.map(le=>{var ee,ne,me;const oe=le.id===((_==null?void 0:_.id)??""),z=typeof((ee=le.inputs)==null?void 0:ee.duration)=="string"?le.inputs.duration:void 0;return s.jsx("button",{type:"button",onClick:()=>b(le.id),className:`w-full rounded-2xl border px-4 py-3 text-left transition ${oe?"border-[#ff1f6c] bg-pink/10":"border-pink/20 bg-white hover:border-[#ff1f6c] hover:bg-pink/5"}`,children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold text-foreground",children:((ne=le.output)==null?void 0:ne.title)||le.title||"Webinar Script"}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Generated ",Ht(new Date(le.createdAt),{addSuffix:!0})]})]}),s.jsx("span",{className:"rounded-full bg-pink/10 border border-pink/20 px-3 py-1 text-xs font-semibold uppercase tracking-wide text-[#ff1f6c]",children:z||((me=_d[1])==null?void 0:me.label)})]})},le.id)})})})]})]}),s.jsxs("section",{className:"space-y-6",children:[c&&s.jsx("div",{className:"rounded-2xl border border-destructive/30 bg-destructive/10 px-4 py-3 text-destructive",children:c}),!r&&I===!1&&s.jsx("div",{className:"rounded-2xl border border-dashed border-pink/20 bg-white p-6 text-sm text-muted-foreground",children:"Complete an AVA profile and a MARGO product brief to generate your first webinar script."}),_&&((Z=_.output)!=null&&Z.content)?(()=>{var me,ve,D;const le=AD((me=_.output)==null?void 0:me.content),oe=((ve=_.output)==null?void 0:ve.metadata)??{},z=typeof oe.contentType=="string"?oe.contentType:void 0,ee=typeof oe.generatedAt=="string"?oe.generatedAt:void 0,ne=le.title||((D=_.output)==null?void 0:D.title)||_.title||"Webinar Script";return s.jsxs(qe,{className:"rounded-3xl border border-pink/20 bg-white shadow-md",children:[s.jsx(vt,{className:"border-b border-pink/20",children:s.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:items-center lg:justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium uppercase tracking-wide text-[#ff1f6c]",children:"Complete Webinar Script"}),s.jsx(pt,{className:"mt-2 text-2xl font-semibold text-foreground",children:ne}),z&&s.jsx(gt,{children:z==="webinar_script"?"Full presentation with timing and slide suggestions.":z}),ee&&s.jsxs("p",{className:"mt-2 text-xs text-muted-foreground",children:["Generated ",Ht(new Date(ee),{addSuffix:!0})]})]}),s.jsx("div",{className:"flex flex-col gap-3 sm:flex-row",children:s.jsx(Ie,{type:"button",onClick:()=>{var ue;return M(((ue=_.output)==null?void 0:ue.content)||"")},className:"grow rounded-xl border border-pink/30 bg-white text-[#ff1f6c] shadow-sm hover:bg-pink/10",children:d?"Copied!":"Copy Script"})})]})}),s.jsx(Xe,{className:"space-y-5 bg-white py-8",children:le.sections.map((ue,O)=>T(ue,O))})]})})():h.length>0?s.jsx("div",{className:"rounded-2xl border border-dashed border-pink/20 bg-white p-6 text-sm text-muted-foreground",children:"The latest run does not have any content to display."}):null]})]})},TD="Learn more",zx=[{value:"all_formats",label:"All formats"}],Ld=e=>e instanceof Error&&e.message?e.message:typeof e=="string"&&e?e:"Something went wrong. Please try again.",RD=e=>!!e&&typeof e=="object"&&!Array.isArray(e),MD=e=>!e||typeof e!="string"?[]:e.split(/[\n.]+/).map(n=>n.replace(/^[\s-]+/,"").trim()).filter(Boolean).slice(0,4),$D=e=>{const t=[];return Array.isArray(e.benefits)&&t.push(...e.benefits.filter(n=>typeof n=="string"&&n.trim())),e.uniqueAdvantage&&typeof e.uniqueAdvantage=="string"&&t.push(e.uniqueAdvantage),e.guarantee&&typeof e.guarantee=="string"&&t.push(e.guarantee),e.callToAction&&typeof e.callToAction=="string"&&t.push(e.callToAction),t.slice(0,4)},DD=()=>{var _;const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState(null),[m,p]=i.useState([]),[f,w]=i.useState([]),[h,v]=i.useState([]),x="valueProposition",[y,b]=ct(x,"selectedRunId",""),[N,S]=ct(x,"selectedAvaSessionId",""),[j,k]=ct(x,"selectedMargoBriefId",""),[C,W]=ct(x,"selectedFormat",((_=zx[0])==null?void 0:_.value)??"all_formats"),[B,U]=ct(x,"cta",TD);yr(x);const Q=e==null?void 0:e.id,V=i.useMemo(()=>m.length>0&&f.length>0,[m.length,f.length]),P=i.useMemo(()=>B.trim().length>=3,[B]),K=i.useCallback(async()=>{if(Q){a(!0),u(null);try{const[$,F,M]=await Promise.all([Tn(Q),qn(Q),vr(Q,"value_proposition")]),T=[...($==null?void 0:$.completed)??[],...(($==null?void 0:$.active)??[]).filter(Z=>Z.status==="completed"||Z.currentPhase==="completed")],ie=(F??[]).filter(Z=>["completed","ready_for_export"].includes((Z.status||"").toLowerCase()));p(T),w(ie),v(M??[]),S(Z=>{var le;return Z||((le=T[0])==null?void 0:le.id)||""}),k(Z=>{var le;return Z||((le=ie[0])==null?void 0:le.id)||""}),b(Z=>{var le;return Z||((le=M==null?void 0:M[0])==null?void 0:le.id)||""})}catch($){console.error($);const F=Ld($);u(F),t({title:"Unable to load value proposition data",description:F,variant:"destructive"})}finally{a(!1)}}},[t,Q]);i.useEffect(()=>{K()},[K]);const G=i.useCallback(async $=>{if($.preventDefault(),!Q){t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!N){t({title:"Select an AVA profile",description:"Complete an AVA session and select it to power the amplifier.",variant:"destructive"});return}if(!j){t({title:"Select a product brief",description:"Complete a product brief and select it to power the amplifier.",variant:"destructive"});return}const F=B.trim();if(!F||F.length<3){t({title:"Call to action required",description:"Please enter a call to action with at least 3 characters.",variant:"destructive"});return}l(!0);try{const M=await Q$({workspaceId:Q,avaSessionId:N,margoProfileId:j,format:C,cta:F});v(T=>[M,...T]),b(M.id),t({title:"Value proposition generated",description:"Scroll down to review the generated messaging."})}catch(M){console.error(M),t({title:"Generation failed",description:Ld(M),variant:"destructive"})}finally{l(!1)}},[Q,t,N,j,C,B]),q=i.useMemo(()=>y?h.find($=>$.id===y)??null:h[0]??null,[h,y]),A=i.useMemo(()=>{if(!(q!=null&&q.output))return null;const $=q.output.content;return RD($)?$:typeof $=="string"?{solution:$}:null},[q]),E=i.useMemo(()=>{if(!(q!=null&&q.output))return[];const $=[];return q.output.title&&typeof q.output.title=="string"&&$.push(q.output.title),A!=null&&A.headline&&typeof A.headline=="string"&&$.push(A.headline),A!=null&&A.subheadline&&typeof A.subheadline=="string"&&$.push(A.subheadline),$},[q,A]),R=i.useMemo(()=>MD(A==null?void 0:A.problemStatement),[A]),L=i.useMemo(()=>A?$D(A):[],[A]),I=i.useCallback(async($,F)=>{try{await navigator.clipboard.writeText($),F&&(g(F),setTimeout(()=>{g(null)},2e3)),t({title:"Copied",description:"Content copied to clipboard."})}catch(M){console.error(M),t({title:"Unable to copy",description:Ld(M),variant:"destructive"})}},[t]);return s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-[#ff1f6c]/20 bg-white text-foreground hover:bg-[#ffe8f1] hover:text-[#ff1f6c] hover:border-[#ff1f6c]/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-[#ff1f6c]/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(FP,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground md:text-4xl",children:"Value Proposition Generator"}),s.jsx("p",{className:"text-base text-muted-foreground",children:"Craft compelling value statements tailored to your ideal clients."})]})]})}),s.jsx("section",{children:s.jsxs(qe,{className:"border border-border/60 shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-2xl font-semibold text-foreground",children:"Generate Value Proposition"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Create clear, compelling value statements."})]}),s.jsx(Xe,{children:s.jsxs("form",{className:"space-y-6",onSubmit:G,children:[s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"ava-profile",children:"Client Profile"}),s.jsxs($t,{value:N,onValueChange:S,children:[s.jsx(Et,{id:"ava-profile",className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{children:m.map($=>{const F=$.completedAt??$.createdAt,M=F?new Date(F):null,T=M&&!Number.isNaN(M.getTime())?Ht(M,{addSuffix:!0}):null,ie=ps([$.userName,$.sessionName,$.id],"Client Profile"),Z=T?`${ie}  ${T}`:ie;return s.jsx(Tt,{value:$.id,children:Z},$.id)})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"product-brief",children:"Product Profile"}),s.jsxs($t,{value:j,onValueChange:k,children:[s.jsx(Et,{id:"product-brief",className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{children:f.map($=>{const F=$.updatedAt??$.createdAt,M=F?new Date(F):null,T=M&&!Number.isNaN(M.getTime())?Ht(M,{addSuffix:!0}):null,Z=ps([$.userName,$.productName,$.sessionName,$.id],"Product Profile")||"Product Profile",le=T?`${Z}  ${T}`:Z;return s.jsx(Tt,{value:$.id,children:le},$.id)})})]})]})]}),s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"format",children:"Format"}),s.jsxs($t,{value:C,onValueChange:W,children:[s.jsx(Et,{id:"format",className:"h-12 rounded-xl border-border/80 bg-white",children:s.jsx(Dt,{placeholder:"Select format"})}),s.jsx(It,{children:zx.map($=>s.jsx(Tt,{value:$.value,children:$.label},$.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"cta",children:"Call to action"}),s.jsx(Ft,{id:"cta",value:B,onChange:$=>U($.target.value),placeholder:"Enter CTA",disabled:o||!V,className:"h-12 rounded-xl border-border/80 bg-white"}),B.trim().length>0&&B.trim().length<3&&s.jsxs("p",{className:"text-xs text-destructive",children:[B.trim().length," / 3 characters minimum required"]})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:V?"Select your profiles and generate a tailored value proposition.":"Complete an AVA profile and a product brief to use this amplifier."}),s.jsx(Ie,{type:"submit",disabled:!V||!P||o,className:"h-12 rounded-xl bg-[#ff1f6c] px-8 text-base font-semibold text-white hover:bg-[#e51860]",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-5 w-5 animate-spin"}),"Generating..."]}):"Generate Value Proposition"})]})]})})]})}),s.jsxs("section",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Generated Value Propositions"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Multiple formats ready to plug into landing pages, ads, and outreach."})]}),r&&s.jsx(Qe,{className:"h-5 w-5 animate-spin text-muted-foreground"})]}),c&&s.jsx(qe,{className:"border border-destructive/20 bg-destructive/5",children:s.jsx(Xe,{className:"py-6 text-destructive",children:s.jsx("p",{children:c})})}),!r&&h.length===0&&s.jsx(qe,{className:"border border-dashed border-border/60 bg-muted/30",children:s.jsxs(Xe,{className:"flex flex-col items-center gap-3 py-12 text-center",children:[s.jsx(Zs,{className:"h-10 w-10 text-[#ff1f6c]"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"No value propositions yet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate your first value proposition to see ready-to-use messaging formats here."})]})]})}),h.length>0&&q&&s.jsxs("div",{className:"grid gap-6 lg:grid-cols-[2fr,1fr]",children:[s.jsxs("div",{className:"space-y-6",children:[E.length>0&&s.jsxs(qe,{className:"border border-border/60 shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-xl font-semibold text-foreground",children:"Headline Format"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"High-impact headlines for landing pages, ads, and hero sections."})]}),s.jsx(Xe,{className:"space-y-3",children:E.map($=>s.jsxs("button",{type:"button",onClick:()=>I($,$),className:"flex w-full items-center justify-between rounded-xl border border-border/60 bg-white px-4 py-3 text-left text-base font-semibold text-foreground transition hover:-translate-y-[1px] hover:border-[#ff1f6c] hover:shadow-md",children:[s.jsx("span",{className:"pr-3",children:$}),s.jsx("span",{className:"text-xs font-medium uppercase text-[#ff1f6c]",children:d===$?"Copied!":"Copy"})]},$))})]}),(A==null?void 0:A.solution)&&s.jsxs(qe,{className:"border border-border/60 shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-xl font-semibold text-foreground",children:"Paragraph Format"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Use this narrative in emails, sales pages, or social captions."})]}),s.jsxs(Xe,{className:"space-y-4",children:[A.problemStatement&&s.jsx("p",{className:"rounded-xl bg-muted/40 p-4 text-sm text-muted-foreground",children:A.problemStatement}),s.jsx("p",{className:"rounded-xl bg-white p-4 text-base leading-relaxed text-foreground shadow-sm",children:A.solution}),A.guarantee&&s.jsx("p",{className:"rounded-xl bg-white p-4 text-sm font-medium text-foreground shadow-sm",children:A.guarantee}),A.callToAction&&s.jsx(Ie,{type:"button",onClick:()=>I(A.callToAction??""),className:"w-full rounded-xl bg-[#ff1f6c] text-base font-semibold text-white hover:bg-[#e51860]",children:A.callToAction})]})]}),(A==null?void 0:A.benefits)&&A.benefits.length>0&&s.jsxs(qe,{className:"border border-border/60 shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-xl font-semibold text-foreground",children:"Bullet Point Format"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Spotlight the core benefits in decks, webinars, or pitch scripts."})]}),s.jsxs(Xe,{className:"space-y-3",children:[A.socialProof&&s.jsx("div",{className:"rounded-xl bg-white p-4 text-sm font-medium text-foreground shadow-sm",children:A.socialProof}),s.jsx("ul",{className:"space-y-3",children:A.benefits.map(($,F)=>s.jsxs("li",{className:"flex items-start gap-3 rounded-xl bg-white p-4 text-sm text-foreground shadow-sm",children:[s.jsx("span",{className:"mt-1 h-2.5 w-2.5 rounded-full bg-[#ff1f6c]"}),s.jsx("span",{children:$})]},`${$}-${F}`))})]})]}),(R.length>0||L.length>0)&&s.jsxs(qe,{className:"border border-border/60 shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-xl font-semibold text-foreground",children:"Before / After Format"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Paint a vivid transformation for case studies or webinar intros."})]}),s.jsxs(Xe,{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-3 rounded-xl bg-white p-4 shadow-sm",children:[s.jsx("p",{className:"text-sm font-semibold uppercase text-muted-foreground",children:"Before"}),s.jsx("ul",{className:"space-y-2",children:R.map(($,F)=>s.jsxs("li",{className:"text-sm text-foreground",children:[" ",$]},`${$}-${F}`))})]}),s.jsxs("div",{className:"space-y-3 rounded-xl bg-[#ffe8f1] p-4 shadow-sm",children:[s.jsx("p",{className:"text-sm font-semibold uppercase text-[#ff1f6c]",children:"After"}),s.jsx("ul",{className:"space-y-2",children:L.map(($,F)=>s.jsxs("li",{className:"text-sm text-foreground",children:[" ",$]},`${$}-${F}`))})]})]})]})]}),s.jsxs("aside",{className:"space-y-4",children:[s.jsxs(qe,{className:"border border-border/60 shadow-sm",children:[s.jsxs(vt,{className:"pb-4",children:[s.jsx(pt,{className:"text-lg font-semibold text-foreground",children:"Recent Generations"}),s.jsx(gt,{className:"text-xs text-muted-foreground",children:"Tap a run to review its value proposition formats."})]}),s.jsx(Xe,{className:"space-y-3",children:h.map($=>{var T;const F=$.id===(q==null?void 0:q.id),M=$.createdAt?Ht(new Date($.createdAt),{addSuffix:!0}):"Unknown time";return s.jsxs("button",{type:"button",onClick:()=>b($.id),className:`w-full rounded-xl border px-4 py-3 text-left transition ${F?"border-[#ff1f6c] bg-[#ffe8f1] text-foreground":"border-border/60 bg-white text-foreground hover:-translate-y-[1px] hover:border-[#ff1f6c] hover:shadow-md"}`,children:[s.jsx("p",{className:"text-sm font-semibold",children:((T=$.output)==null?void 0:T.title)||"Value Proposition"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:M})]},$.id)})})]}),s.jsx(qe,{className:"border border-dashed border-border/60 bg-muted/20 shadow-none",children:s.jsxs(Xe,{className:"space-y-3 py-6 text-sm text-muted-foreground",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold text-foreground",children:"Tip:"})," Highlight the top headline and bullet points in your hero section, then weave the paragraph format through your narrative."]}),s.jsx("p",{children:"Save different generations to test messaging angles, or copy individual sections to your team workspace."})]})})]})]})]})]})},Hx=[{value:"800",label:"Short (800 words)"},{value:"1200",label:"Standard (1,200 words)"},{value:"1500",label:"In-depth (1,500 words)"},{value:"2000",label:"Comprehensive (2,000 words)"}],Qx="Download our free guide",Kn=10,Vd=e=>e instanceof Error&&e.message?e.message:typeof e=="string"&&e.trim()?e:"Something went wrong. Please try again.",Bd=e=>e.split(/[\r\n,]+/).map(t=>t.replace(/^[\s*-]+/,"").trim()).filter(Boolean),OD=e=>{if(!e||typeof e!="string")return{intro:[],sections:[]};const t=e.split(/\r?\n/),n=[],r=[];let a=null,o=[],l;const c=()=>{if(o.length===0)return;const u=o.join(" ").replace(/\s+/g," ").trim();o=[],u&&(a?a.paragraphs.push(u):n.push(u))};for(const u of t){const d=u.trim();if(!d){c();continue}if(/^#{2,6}\s+/.test(d)){c(),a={heading:d.replace(/^#{2,6}\s*/,"").trim(),paragraphs:[],bullets:[]},r.push(a);continue}if(/^[-*]\s+/.test(d)){c();const g=d.replace(/^[-*]\s+/,"").replace(/\*\*/g,"").trim();a?a.bullets.push(g):g&&n.push(g);continue}if(/^\*\*(.+)\*\*$/.test(d)&&!l){c(),l=d.replace(/^\*\*(.+)\*\*$/,"$1").trim();continue}o.push(d.replace(/\*\*/g,""))}return c(),{intro:n,sections:r,cta:l}},FD=e=>e.status==="completed"||e.currentPhase==="completed",_D=e=>["completed","ready_for_export"].includes((e.status||"").toLowerCase()),LD=()=>{var re,fe,Se;const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState([]),[m,p]=i.useState([]),[f,w]=i.useState([]),[h,v]=i.useState([]),x="blogPost",[y,b]=ct(x,"selectedRunId",""),[N,S]=ct(x,"selectedAvaSessionId",""),[j,k]=ct(x,"selectedMargoBriefId",""),[C,W]=ct(x,"blogTopic",""),[B,U]=ct(x,"keyPoints",""),[Q,V]=ct(x,"wordCount",((re=Hx[2])==null?void 0:re.value)??"1500"),[P,K]=ct(x,"cta",Qx),[G,q]=ct(x,"selectedVoiceProfileId","");yr(x);const A=e==null?void 0:e.id,E=i.useMemo(()=>d.length>0&&m.length>0,[d.length,m.length]),R=i.useMemo(()=>h.filter(he=>he.isComplete&&!!he.finalProfile).map(he=>{var se;return{value:he.id,label:((se=he.name)==null?void 0:se.trim())||"Untitled voice profile"}}),[h]),L=R.length>0,I=i.useMemo(()=>C.trim().length,[C]),_=i.useMemo(()=>B.trim().length,[B]),$=i.useMemo(()=>P.trim().length,[P]),F=I>=Kn,M=_>=Kn,T=$>=Kn,ie=i.useCallback(async()=>{if(A){a(!0),u(null);try{const[he,se,J]=await Promise.all([Tn(A),qn(A),vr(A,"blog_post")]),Pe=[...(he==null?void 0:he.completed)??[],...((he==null?void 0:he.active)??[]).filter(Ae=>FD(Ae))],$e=(se??[]).filter(Ae=>_D(Ae));g(Pe),p($e),w(J??[]),S(Ae=>{var Ee;return Ae||((Ee=Pe[0])==null?void 0:Ee.id)||""}),k(Ae=>{var Ee;return Ae||((Ee=$e[0])==null?void 0:Ee.id)||""}),b(Ae=>{var Ee;return Ae||((Ee=J==null?void 0:J[0])==null?void 0:Ee.id)||""})}catch(he){console.error(he);const se=Vd(he);u(se),t({title:"Unable to load blog post data",description:se,variant:"destructive"})}finally{a(!1)}}},[t,A]);i.useEffect(()=>{ie()},[ie]),i.useEffect(()=>{if(!A){v([]),q("");return}let he=!0;return(async()=>{try{const J=await Yi(A);if(!he)return;const Pe=((J==null?void 0:J.data)??[]).filter($e=>$e.isComplete&&!!$e.finalProfile);v(Pe),q($e=>{var Ae;return $e||((Ae=Pe[0])==null?void 0:Ae.id)||""})}catch(J){if(!he)return;console.error("[BlogPostGenerator] Failed to load voice profiles",J),t({title:"Could not load voice profiles",description:Vd(J),variant:"destructive"}),v([])}})(),()=>{he=!1}},[A,q,t]);const Z=i.useCallback(async()=>{var Pe;if(console.log("[BlogPostGenerator] Attempting blog post generation"),!A){console.warn("[BlogPostGenerator] Aborted: no workspace selected"),t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!N){console.warn("[BlogPostGenerator] Aborted: AVA profile missing"),t({title:"Select an AVA profile",description:"Complete an AVA session and select it to power the amplifier.",variant:"destructive"});return}if(!j){console.warn("[BlogPostGenerator] Aborted: MARGO brief missing"),t({title:"Select a product brief",description:"Complete a MARGO product brief and select it to power the amplifier.",variant:"destructive"});return}if(!C.trim()){console.warn("[BlogPostGenerator] Aborted: blog topic missing"),t({title:"Blog topic required",description:"Enter the blog topic you want to generate.",variant:"destructive"});return}let he=Bd(B);he.length===0&&(console.warn("[BlogPostGenerator] No key points provided, falling back to topic headline"),he=[C.trim()]);const se=P.trim()||Qx,J=Number(Q)||1500;l(!0);try{console.log("[BlogPostGenerator]  Sending amplifier request",{workspaceId:A,avaSessionId:N,margoProfileId:j,blogTopic:C.trim(),keyPoints:he,wordCount:J,cta:se});const $e=await z$({workspaceId:A,avaSessionId:N,margoProfileId:j,blogTopic:C.trim(),keyPointsToCover:he,wordCount:J,cta:se});w(Ae=>[$e,...Ae]),b($e.id),console.log("[BlogPostGenerator]  Received blog post run",{runId:$e.id,title:(Pe=$e.output)==null?void 0:Pe.title,createdAt:$e.createdAt}),t({title:"Blog post generated",description:"Scroll down to review the generated content."})}catch($e){console.error("[BlogPostGenerator]  Generation failed",$e),t({title:"Generation failed",description:Vd($e),variant:"destructive"})}finally{l(!1)}},[A,t,N,j,C,B,P,Q]),le=i.useCallback(he=>{he.preventDefault(),!(!F||!M||!T)&&Z()},[Z,F,M,T]),oe=i.useMemo(()=>y?f.find(he=>he.id===y)??f[0]??null:f[0]??null,[f,y]),z=i.useMemo(()=>{var J,Pe;const he=((J=oe==null?void 0:oe.output)==null?void 0:J.content)??"",se=OD(he);return oe&&(console.groupCollapsed("[BlogPostGenerator]  Parsed blog post content"),console.info("[BlogPostGenerator] Run ID:",oe.id),console.info("[BlogPostGenerator] Title:",(Pe=oe.output)==null?void 0:Pe.title),console.info("[BlogPostGenerator] Sections:",se.sections.map($e=>$e.heading)),console.groupEnd()),se},[oe]),ee=(oe==null?void 0:oe.inputs)??{},ne=((fe=oe==null?void 0:oe.output)==null?void 0:fe.metadata)??{},me=typeof ee.blogTopic=="string"&&ee.blogTopic?ee.blogTopic:C.trim(),ve=i.useMemo(()=>Array.isArray(ee.keyPointsToCover)?ee.keyPointsToCover.map(he=>typeof he=="string"?he.trim():"").filter(Boolean):typeof ee.keyPointsToCover=="string"?Bd(ee.keyPointsToCover):Bd(B),[ee.keyPointsToCover,B]),D=ne.wordCount,O=(typeof D=="number"?D:typeof D=="string"?Number(D):0)||(typeof ee.wordCount=="number"?ee.wordCount:typeof ee.wordCount=="string"?Number(ee.wordCount):Number(Q)||1500),H=i.useMemo(()=>Array.isArray(ne.sections)?ne.sections.map(he=>typeof he=="string"?he.trim():"").filter(Boolean):[],[ne.sections]),ae=Math.max(1,Math.round(O/200)),de=oe!=null&&oe.createdAt?new Date(oe.createdAt):null;return s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-pink/20 bg-white text-foreground hover:bg-pink/10 hover:text-[#ff1f6c] hover:border-pink/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-pink/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(zm,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground md:text-4xl",children:"Blog Post Generator"}),s.jsx("p",{className:"text-base text-muted-foreground",children:"Generate engaging, SEO-optimized blog articles powered by your AVA and MARGO insights."})]})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsx("section",{children:s.jsxs(qe,{className:"border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-xl font-semibold text-foreground",children:"Configure Blog Post"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Select your profiles and define the outline to generate tailored blog content."})]}),s.jsx(Xe,{className:"space-y-6",children:s.jsxs("form",{className:"space-y-6",onSubmit:le,children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"avaSession",children:"Client Profile"}),s.jsxs($t,{value:N,onValueChange:S,disabled:d.length===0,children:[s.jsx(Et,{id:"avaSession",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:d.length>0?"Select client profile":"No completed client profiles yet"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:d.map(he=>{const se=new Date(he.completedAt??he.createdAt),J=Ht(se,{addSuffix:!0}),Pe=ps([he.userName,he.sessionName,he.id],"Client Profile");return s.jsx(Tt,{value:he.id,children:`${Pe}  ${J}`},he.id)})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"margoBrief",children:"Product Profile"}),s.jsxs($t,{value:j,onValueChange:k,disabled:m.length===0,children:[s.jsx(Et,{id:"margoBrief",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:m.length>0?"Select product profile":"No completed product profiles yet"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:m.map(he=>{const se=new Date(he.updatedAt??he.createdAt),J=Ht(se,{addSuffix:!0}),Pe=ps([he.userName,he.productName,he.sessionName,he.id],"Product Profile");return s.jsx(Tt,{value:he.id,children:`${Pe}  ${J}`},he.id)})})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"blogTopic",children:"Blog topic"}),s.jsx(Ft,{id:"blogTopic",value:C,onChange:he=>W(he.target.value),placeholder:"Enter your blog post topic",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",minLength:Kn}),!F&&s.jsxs("p",{className:"text-xs text-destructive",children:[I," / ",Kn," characters minimum required"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"keyPoints",children:"Key points to cover"}),s.jsx(fs,{id:"keyPoints",value:B,onChange:he=>U(he.target.value),placeholder:"List the main points or sections you want to include",minLength:Kn,className:"min-h-[120px] resize-none rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c]"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Separate each key point with a new line or comma."}),!M&&s.jsxs("p",{className:"text-xs text-destructive",children:[_," / ",Kn," characters minimum required"]})]})]}),s.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"wordCount",children:"Word count"}),s.jsxs($t,{value:Q,onValueChange:V,children:[s.jsx(Et,{id:"wordCount",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select length"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:Hx.map(he=>s.jsx(Tt,{value:he.value,children:he.label},he.value))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"voiceProfile",children:"Voice profile (optional)"}),s.jsxs($t,{value:G,onValueChange:q,disabled:!L,children:[s.jsx(Et,{id:"voiceProfile",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:L?"Select voice":"No voice profiles available yet"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:R.map(he=>s.jsx(Tt,{value:he.value,children:he.label},he.value))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"cta",children:"Call to action"}),s.jsx(Ft,{id:"cta",value:P,onChange:he=>K(he.target.value),placeholder:"Download our free guide",minLength:Kn,className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]"}),!T&&s.jsxs("p",{className:"text-xs text-destructive",children:[$," / ",Kn," characters minimum required"]})]}),s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:E?"Complete the form to generate a ready-to-publish blog article.":"Complete an AVA profile and a product brief to use this amplifier."}),s.jsx(Ie,{type:"submit",disabled:!E||o||!F||!M||!T,onClick:()=>{!o&&F&&M&&T&&Z()},className:"h-12 w-full md:w-auto rounded-full bg-[#ff1f6c] px-6 text-base font-semibold text-white shadow-sm hover:bg-[#e51860]",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-5 w-5 animate-spin"}),"Generating..."]}):"Generate Blog Post"})]})]})})]})}),s.jsxs("section",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h2",{className:"text-2xl font-semibold text-foreground",children:"Generated Blog Posts"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Review and refine AI-generated drafts tailored to your audience insights."})]}),r&&s.jsx(Qe,{className:"h-5 w-5 animate-spin text-muted-foreground"})]}),c&&s.jsx(qe,{className:"border border-red-200 bg-red-50",children:s.jsx(Xe,{className:"py-6 text-destructive",children:s.jsx("p",{children:c})})}),!r&&f.length===0&&s.jsx(qe,{className:"border border-dashed border-pink/20 bg-white",children:s.jsxs(Xe,{className:"flex flex-col items-center gap-3 py-12 text-center",children:[s.jsx(zm,{className:"h-10 w-10 text-black"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"No blog posts yet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate your first blog post to see rich, structured content appear here."})]})]})}),f.length>0&&oe&&s.jsxs("div",{className:"grid gap-6 xl:grid-cols-[2fr,1fr]",children:[s.jsx(qe,{className:"border border-pink/20 bg-white shadow-sm",children:s.jsxs(Xe,{className:"space-y-6 p-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-sm font-semibold uppercase tracking-wide text-[#ff1f6c]",children:"Generated Blog Post"}),s.jsx("h3",{className:"text-2xl font-semibold text-foreground",children:((Se=oe.output)==null?void 0:Se.title)||me||"Untitled blog post"}),s.jsxs("div",{className:"flex flex-wrap items-center gap-3 text-sm text-muted-foreground",children:[de&&s.jsxs("span",{children:["Published on ",M$(de,"MMMM d, yyyy")]}),s.jsx("span",{children:""}),s.jsxs("span",{children:[ae," min read"]}),oe.createdAt&&s.jsxs(s.Fragment,{children:[s.jsx("span",{children:""}),s.jsx("span",{children:Ht(new Date(oe.createdAt),{addSuffix:!0})})]})]})]}),z.intro.length>0&&s.jsx("div",{className:"space-y-4",children:z.intro.map((he,se)=>s.jsx("p",{className:"text-base leading-relaxed text-foreground",children:he},`intro-${se}`))}),z.sections.map((he,se)=>s.jsxs("div",{className:"space-y-3",children:[s.jsx("h4",{className:"text-xl font-semibold text-foreground",children:he.heading}),he.paragraphs.map((J,Pe)=>s.jsx("p",{className:"text-base leading-relaxed text-foreground",children:J},`${he.heading}-paragraph-${Pe}`)),he.bullets.length>0&&s.jsx("ul",{className:"space-y-2 rounded-xl bg-pink/5 border border-pink/10 p-4 text-sm leading-relaxed text-foreground",children:he.bullets.map((J,Pe)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-[#ff1f6c]"}),s.jsx("span",{children:J})]},`${he.heading}-bullet-${Pe}`))})]},`${he.heading}-${se}`)),z.cta&&s.jsx("div",{className:"rounded-xl bg-pink/10 border border-pink/20 p-6 text-center",children:s.jsx("p",{className:"text-base font-semibold text-[#ff1f6c]",children:z.cta})})]})}),s.jsxs("aside",{className:"space-y-4",children:[s.jsxs(qe,{className:"border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"pb-4",children:[s.jsx(pt,{className:"text-lg font-semibold text-foreground",children:"Recent Generations"}),s.jsx(gt,{className:"text-xs text-muted-foreground",children:"Select a run to review its generated content."})]}),s.jsx(Xe,{className:"space-y-3",children:f.map(he=>{var Ee;const se=he.id===oe.id,J=he.createdAt?new Date(he.createdAt):null,Pe=J?Ht(J,{addSuffix:!0}):"Unknown time",$e=he.inputs??{},Ae=typeof((Ee=he.output)==null?void 0:Ee.title)=="string"&&he.output.title?he.output.title:typeof $e.blogTopic=="string"?$e.blogTopic:"Blog Post";return s.jsxs("button",{type:"button",onClick:()=>b(he.id),className:`w-full rounded-xl border px-4 py-3 text-left transition ${se?"border-[#ff1f6c] bg-pink/10 text-foreground":"border-pink/20 bg-white text-foreground hover:-translate-y-[1px] hover:border-[#ff1f6c] hover:shadow-md"}`,children:[s.jsx("p",{className:"text-sm font-semibold",children:Ae}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Pe})]},he.id)})})]}),s.jsx(qe,{className:"border border-dashed border-pink/20 bg-white shadow-none",children:s.jsxs(Xe,{className:"space-y-4 py-6 text-sm text-muted-foreground",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Blog topic"}),s.jsx("p",{children:me||""})]}),ve.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Key points included"}),s.jsx("ul",{className:"mt-2 space-y-2",children:ve.map((he,se)=>s.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-[#ff1f6c]"}),s.jsx("span",{children:he})]},`${he}-${se}`))})]}),z.cta&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Call to action"}),s.jsx("p",{children:z.cta})]}),H.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Sections included"}),s.jsx("ul",{className:"mt-2 space-y-2",children:H.map((he,se)=>s.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-[#ff1f6c]"}),s.jsx("span",{children:he})]},`${he}-${se}`))})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Approximate word count"}),s.jsx("p",{children:O?`${O.toLocaleString()} words`:""})]})]})})]})]})]})]})]})},Wd="See how we can help you",Ol=2,Dn=10,Fl=4,Ud=[{value:"full_case_study",label:"Full case study"},{value:"executive_summary",label:"Executive summary"},{value:"social_proof_card",label:"Social proof spotlight"}],Xo=e=>e.replace(/\*\*(.*?)\*\*/g,"$1").replace(/__(.*?)__/g,"$1").replace(/_(.*?)_/g,"$1").replace(/`(.*?)`/g,"$1").replace(/\[(.*?)\]\((.*?)\)/g,"$1").replace(/\\n/g," ").replace(/\s+/g," ").trim(),VD=e=>{if(!e||typeof e!="string")return{sections:[]};const t=[...e.matchAll(/\*\*(.+?)\*\*/g)];if(t.length===0){const a=e.split(/\n{2,}/).map(o=>Xo(o)).filter(Boolean);return{sections:a.length?[{heading:"Case Study",paragraphs:a,bullets:[]}]:[]}}const n=[];t.forEach((a,o)=>{const l=Xo(a[1]).replace(/:+$/,"").trim(),c=(a.index??0)+a[0].length,u=o+1<t.length?t[o+1].index??e.length:e.length,d=e.slice(c,u).trim();if(!d){n.push({heading:l,paragraphs:[],bullets:[]});return}const g=d.split(`
`),m=[],p=[];let f=[];const w=()=>{if(f.length){const h=Xo(f.join(" ").trim());h&&m.push(h),f=[]}};g.forEach(h=>{const v=h.trim();if(!v){w();return}if(v.startsWith("- ")){w();const x=v.slice(2).trim(),y=x.match(/^\*\*(.+?)\*\*\s*(.*)$/),b=y?Xo(y[1]):void 0;p.push({text:Xo(x),emphasis:b})}else f.push(v)}),w(),n.push({heading:l,paragraphs:m,bullets:p})});let r;if(n.length>0){const a=n[n.length-1];/(ready|next steps|call to action|cta)/i.test(a.heading)&&(r=a,n.pop())}return{sections:n,callout:r}},Gx=e=>e instanceof Error&&e.message?e.message:typeof e=="string"&&e?e:"Something went wrong. Please try again.",La=e=>{if(!e)return null;const t=new Date(e);return Number.isNaN(t.getTime())?null:Ht(t,{addSuffix:!0})},BD=()=>{var he,se,J,Pe,$e,Ae,Ee;const{currentWorkspace:e}=ls(),{toast:t}=yt(),n=Lt(),[r,a]=i.useState(!0),[o,l]=i.useState(!1),[c,u]=i.useState(null),[d,g]=i.useState([]),[m,p]=i.useState([]),[f,w]=i.useState([]),h="caseStudy",[v,x]=ct(h,"selectedRunId",""),[y,b]=ct(h,"selectedAvaSessionId",""),[N,S]=ct(h,"selectedMargoBriefId",""),[j,k]=ct(h,"clientName",""),[C,W]=ct(h,"challenge",""),[B,U]=ct(h,"solution",""),[Q,V]=ct(h,"results",""),[P,K]=ct(h,"cta",Wd),[G,q]=ct(h,"selectedFormat",((he=Ud[0])==null?void 0:he.value)??"full_case_study");yr(h);const A=e==null?void 0:e.id,E=i.useMemo(()=>d.length>0&&m.length>0,[d.length,m.length]),R=j.trim(),L=C.trim(),I=B.trim(),_=Q.trim(),$=P.trim(),F=R.length>=Ol,M=L.length>=Dn,T=I.length>=Dn,ie=_.length>=Dn,Z=$.length>=Fl,le=E&&F&&M&&T&&ie&&Z,oe=i.useCallback(async()=>{if(A){a(!0),u(null);try{const[ce,we,Te]=await Promise.all([Tn(A),qn(A),vr(A,"case_study")]),Ue=[...(ce==null?void 0:ce.completed)??[],...((ce==null?void 0:ce.active)??[]).filter(Ze=>Ze.status==="completed"||Ze.currentPhase==="completed")],lt=(we??[]).filter(Ze=>["completed","ready_for_export"].includes((Ze.status||"").toLowerCase()));g(Ue),p(lt),w(Te??[]),b(Ze=>{var ge;return Ze||((ge=Ue[0])==null?void 0:ge.id)||""}),S(Ze=>{var ge;return Ze||((ge=lt[0])==null?void 0:ge.id)||""}),x(Ze=>{var ge;return Ze||((ge=Te==null?void 0:Te[0])==null?void 0:ge.id)||""})}catch(ce){console.error(ce);const we=Gx(ce);u(we),t({title:"Unable to load case study data",description:we,variant:"destructive"})}finally{a(!1)}}},[A,t]);i.useEffect(()=>{oe()},[oe]);const z=i.useCallback(async()=>{if(!A){t({title:"No workspace selected",description:"Please select or create a workspace before generating content.",variant:"destructive"});return}if(!y){t({title:"Select an AVA profile",description:"Complete an AVA session and select it to power the amplifier.",variant:"destructive"});return}if(!N){t({title:"Select a product brief",description:"Complete a product brief and select it to power the amplifier.",variant:"destructive"});return}const ce=j.trim(),we=C.trim(),Te=B.trim(),Ue=Q.trim(),lt=P.trim();if(ce.length<Ol){t({title:"Client name required",description:`Enter at least ${Ol} characters for the client name.`,variant:"destructive"});return}if(we.length<Dn||Te.length<Dn||Ue.length<Dn){t({title:"Add more detail",description:`Challenge, solution, and results must be at least ${Dn} characters each.`,variant:"destructive"});return}if(lt.length<Fl){t({title:"Call to action required",description:`Provide a call to action of at least ${Fl} characters.`,variant:"destructive"});return}l(!0);try{const Ze=await q$({workspaceId:A,avaSessionId:y,margoProfileId:N,clientName:ce,challenge:we,solution:Te,results:Ue,format:G,cta:lt||Wd});w(ge=>[Ze,...ge]),x(Ze.id),t({title:"Case study generated",description:"Scroll down to review the generated story."})}catch(Ze){console.error(Ze),t({title:"Generation failed",description:Gx(Ze),variant:"destructive"})}finally{l(!1)}},[A,y,N,j,C,B,Q,G,P,t]),ee=i.useCallback(ce=>{ce.preventDefault(),z()},[z]),ne=i.useMemo(()=>v?f.find(ce=>ce.id===v)??null:f[0]??null,[f,v]),me=i.useMemo(()=>{var ce;return VD((ce=ne==null?void 0:ne.output)==null?void 0:ce.content)},[ne]),ve=i.useMemo(()=>{var we;if(!((we=ne==null?void 0:ne.output)!=null&&we.metadata)||typeof ne.output.metadata!="object")return[];const{sections:ce}=ne.output.metadata;return Array.isArray(ce)?ce.filter(Te=>typeof Te=="string"):[]},[ne]),D=i.useMemo(()=>(ne==null?void 0:ne.inputs)??{},[ne]),ue=typeof D.clientName=="string"&&D.clientName.trim()?D.clientName.trim():void 0,O=typeof D.cta=="string"&&D.cta.trim()?D.cta.trim():Wd,H=typeof D.results=="string"&&D.results.trim()?D.results.trim():void 0,ae=typeof D.format=="string"&&D.format?((se=Ud.find(ce=>ce.value===D.format))==null?void 0:se.label)??D.format:void 0,de=i.useMemo(()=>me.sections.find(ce=>/result/i.test(ce.heading))??null,[me]),re=i.useMemo(()=>de?de.bullets.slice(0,3):[],[de]),fe=i.useCallback(ce=>{const we=ce.text.trim();return ce.emphasis&&we.toLowerCase().startsWith(ce.emphasis.toLowerCase())?we.slice(ce.emphasis.length).trim()||void 0:we||void 0},[]),Se=i.useMemo(()=>{var Te,Ue;const ce=((Te=me.callout)==null?void 0:Te.paragraphs.length)??0,we=((Ue=me.callout)==null?void 0:Ue.bullets.length)??0;return ce+we>0},[me.callout]);return s.jsxs("div",{className:"mx-auto max-w-6xl space-y-8",children:[s.jsx("header",{className:"flex flex-col gap-3",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(Ie,{variant:"outline",onClick:()=>n("/amplifiers"),className:"border-pink/20 bg-white text-foreground hover:bg-pink/10 hover:text-[#ff1f6c] hover:border-pink/40 transition-all duration-300 ease-in-out hover:shadow-md hover:shadow-pink/10 hover:scale-[1.02] hover:-translate-y-0.5 active:scale-100",children:[s.jsx(Os,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-2xl bg-black",children:s.jsx(Pn,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-foreground md:text-4xl",children:"Case Study Generator"}),s.jsx("p",{className:"text-base text-muted-foreground",children:"Turn client wins into persuasive, proof-driven success stories."})]})]})}),s.jsx("section",{children:s.jsxs(qe,{className:"border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"space-y-1",children:[s.jsx(pt,{className:"text-2xl font-semibold text-foreground",children:"Configure Case Study"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Generate client success stories tailored to your offer."})]}),s.jsx(Xe,{children:s.jsxs("form",{className:"space-y-6",onSubmit:ee,children:[s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"ava-profile",children:"Client Profile"}),s.jsxs($t,{value:y,onValueChange:b,children:[s.jsx(Et,{id:"ava-profile",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select client profile"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:d.map(ce=>s.jsx(Tt,{value:ce.id,children:(()=>{const we=ps([ce.userName,ce.sessionName,ce.id],"Client Profile"),Te=La(ce.completedAt)??La(ce.updatedAt)??La(ce.createdAt);return Te?`${we}  ${Te}`:we})()},ce.id))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"product-brief",children:"Product Profile"}),s.jsxs($t,{value:N,onValueChange:S,children:[s.jsx(Et,{id:"product-brief",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select product profile"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:m.map(ce=>s.jsx(Tt,{value:ce.id,children:(()=>{const we=ps([ce.userName,ce.productName,ce.sessionName,ce.id],"Product Profile"),Te=La(ce.updatedAt)??La(ce.completedAt)??La(ce.createdAt);return Te?`${we}  ${Te}`:we})()},ce.id))})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"client-name",children:"Client name or company"}),s.jsx(Ft,{id:"client-name",value:j,onChange:ce=>k(ce.target.value),placeholder:"Enter client name or company",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]","aria-invalid":!F}),!F&&s.jsxs("p",{className:"text-xs text-destructive",children:[R.length," / ",Ol," characters minimum required"]})]}),s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"challenge",children:"Challenge or problem"}),s.jsx(fs,{id:"challenge",value:C,onChange:ce=>W(ce.target.value),placeholder:"What problem did the client face before working with you?",className:"min-h-[120px] rounded-xl border border-pink/20 bg-white resize-none overflow-y-auto focus:border-[#ff1f6c]","aria-invalid":!M}),!M&&s.jsxs("p",{className:"text-xs text-destructive",children:[L.length," / ",Dn," characters minimum required"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"solution",children:"Solution provided"}),s.jsx(fs,{id:"solution",value:B,onChange:ce=>U(ce.target.value),placeholder:"How did you help solve their problem?",className:"min-h-[120px] rounded-xl border border-pink/20 bg-white resize-none overflow-y-auto focus:border-[#ff1f6c]","aria-invalid":!T}),!T&&s.jsxs("p",{className:"text-xs text-destructive",children:[I.length," / ",Dn," characters minimum required"]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"results",children:"Results achieved"}),s.jsx(fs,{id:"results",value:Q,onChange:ce=>V(ce.target.value),placeholder:"What specific results did they achieve? Include metrics if possible.",className:"min-h-[120px] rounded-xl border border-pink/20 bg-white resize-none overflow-y-auto focus:border-[#ff1f6c]","aria-invalid":!ie}),!ie&&s.jsxs("p",{className:"text-xs text-destructive",children:[_.length," / ",Dn," characters minimum required"]})]}),s.jsxs("div",{className:"grid gap-5 md:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"cta",children:"Call to action"}),s.jsx(Ft,{id:"cta",value:P,onChange:ce=>K(ce.target.value),placeholder:"Enter CTA",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]","aria-invalid":!Z}),!Z&&s.jsxs("p",{className:"text-xs text-destructive",children:[$.length," / ",Fl," characters minimum required"]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(st,{htmlFor:"format",children:"Format"}),s.jsxs($t,{value:G,onValueChange:q,children:[s.jsx(Et,{id:"format",className:"h-12 rounded-xl border border-pink/20 bg-white focus:border-[#ff1f6c] focus:ring-[#ff1f6c]",children:s.jsx(Dt,{placeholder:"Select format"})}),s.jsx(It,{className:"rounded-xl border border-pink/20 bg-white shadow-lg",children:Ud.map(ce=>s.jsx(Tt,{value:ce.value,children:ce.label},ce.value))})]})]})]}),s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:E?"Select your profiles, describe the win, and generate a polished case study.":"Complete an AVA profile and a product brief to use this amplifier."}),s.jsx(Ie,{type:"submit",disabled:!le||o,className:"h-12 w-full md:w-auto rounded-full bg-[#ff1f6c] px-8 text-base font-semibold text-white shadow-sm hover:bg-[#e51860]",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Qe,{className:"mr-2 h-5 w-5 animate-spin"}),"Generating..."]}):"Generate Case Study"})]})]})})]})}),s.jsx("section",{className:"space-y-6",children:r?s.jsx(qe,{className:"border border-pink/20 bg-white shadow-sm",children:s.jsxs(Xe,{className:"flex items-center gap-3 py-10",children:[s.jsx(Qe,{className:"h-5 w-5 animate-spin text-muted-foreground"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading case study runs..."})]})}):c?s.jsx(qe,{className:"border border-red-200 bg-red-50 shadow-sm",children:s.jsxs(Xe,{className:"space-y-2 py-8 text-center",children:[s.jsx("p",{className:"text-sm font-semibold text-destructive",children:"Unable to load previous generations"}),s.jsx("p",{className:"text-sm text-destructive/80",children:c}),s.jsx(Ie,{type:"button",variant:"outline",onClick:()=>{oe()},className:"mt-2 h-11 rounded-xl border-pink/20 text-destructive hover:bg-pink/10",children:"Try again"})]})}):f.length===0?s.jsx(qe,{className:"border border-dashed border-pink/20 bg-white shadow-none",children:s.jsxs(Xe,{className:"flex flex-col items-center gap-3 py-12 text-center",children:[s.jsx(Zs,{className:"h-6 w-6 text-[#ff1f6c]"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("p",{className:"text-base font-semibold text-foreground",children:"No case studies generated yet"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Fill in the details above to generate your first success story."})]})]})}):s.jsxs("div",{className:"grid gap-6 lg:grid-cols-[minmax(0,2fr)_minmax(0,1fr)]",children:[s.jsxs(qe,{className:"border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"pb-4",children:[s.jsx(pt,{className:"text-2xl font-semibold text-foreground",children:"Generated Case Study"}),s.jsx(gt,{className:"text-sm text-muted-foreground",children:"Complete client success story ready to publish."})]}),s.jsxs(Xe,{className:"space-y-8",children:[s.jsxs("div",{className:"rounded-2xl border border-pink/20 bg-pink/5 p-8 space-y-3",children:[s.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-[#ff1f6c]",children:ae||"Success Story"}),s.jsx("h2",{className:"text-2xl font-semibold text-foreground md:text-3xl",children:((J=ne==null?void 0:ne.output)==null?void 0:J.title)||`How ${ue??"your client"} succeeded`}),ue&&s.jsxs("p",{className:"text-base text-muted-foreground",children:["A customer success story featuring ",ue]}),H&&s.jsx("p",{className:"text-sm font-semibold text-[#ff1f6c]",children:H})]}),re.length>0&&s.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:re.map((ce,we)=>{const Te=ce.emphasis?fe(ce):ce.text.trim();return s.jsxs("div",{className:"rounded-2xl border border-pink/20 bg-pink/5 p-5",children:[ce.emphasis&&s.jsx("p",{className:"text-2xl font-semibold text-[#ff1f6c]",children:ce.emphasis}),Te&&s.jsx("p",{className:"text-sm text-muted-foreground",children:Te})]},`${ce.text}-${we}`)})}),s.jsx("div",{className:"space-y-8",children:me.sections.map((ce,we)=>s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("h3",{className:"text-xl font-semibold text-foreground",children:ce.heading}),s.jsx("span",{className:"block h-1 w-12 rounded-full bg-[#ff1f6c]/40"})]}),s.jsxs("div",{className:"space-y-4",children:[ce.paragraphs.map((Te,Ue)=>s.jsx("p",{className:"text-base leading-relaxed text-foreground",children:Te},`${ce.heading}-paragraph-${Ue}`)),ce.bullets.length>0&&s.jsx("ul",{className:"space-y-3 rounded-xl bg-pink/5 border border-pink/10 p-5 text-sm leading-relaxed text-foreground",children:ce.bullets.map((Te,Ue)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-[#ff1f6c]"}),s.jsx("span",{children:Te.text})]},`${ce.heading}-bullet-${Ue}`))})]})]},`${ce.heading}-${we}`))}),Se&&s.jsxs("div",{className:"rounded-2xl border border-pink/20 bg-pink/10 p-7 text-center space-y-3",children:[s.jsx("p",{className:"text-base font-semibold text-foreground",children:((Pe=me.callout)==null?void 0:Pe.heading)||"Ready for the next step?"}),($e=me.callout)==null?void 0:$e.paragraphs.map((ce,we)=>s.jsx("p",{className:"text-sm text-muted-foreground",children:ce},`callout-paragraph-${we}`)),(Ae=me.callout)==null?void 0:Ae.bullets.map((ce,we)=>s.jsx("p",{className:"text-sm text-muted-foreground",children:ce.text},`callout-bullet-${we}`)),O&&s.jsx(Ie,{type:"button",className:"mt-2 h-11 rounded-xl bg-[#ff1f6c] px-6 text-sm font-semibold text-white hover:bg-[#e51860]",children:O})]})]})]}),s.jsxs("aside",{className:"space-y-4",children:[s.jsxs(qe,{className:"border border-pink/20 bg-white shadow-sm",children:[s.jsxs(vt,{className:"pb-4",children:[s.jsx(pt,{className:"text-lg font-semibold text-foreground",children:"Recent Generations"}),s.jsx(gt,{className:"text-xs text-muted-foreground",children:"Select a run to review its generated story."})]}),s.jsx(Xe,{className:"space-y-3",children:f.map(ce=>{var ge;const we=ce.id===(ne==null?void 0:ne.id),Te=ce.createdAt?new Date(ce.createdAt):null,Ue=Te?Ht(Te,{addSuffix:!0}):"Unknown time",lt=ce.inputs??{},Ze=typeof((ge=ce.output)==null?void 0:ge.title)=="string"&&ce.output.title?ce.output.title:typeof lt.clientName=="string"&&lt.clientName?`Case study for ${lt.clientName}`:"Case study";return s.jsxs("button",{type:"button",onClick:()=>x(ce.id),className:`w-full rounded-xl border px-4 py-3 text-left transition ${we?"border-[#ff1f6c] bg-pink/10 text-foreground":"border-pink/20 bg-white text-foreground hover:-translate-y-[1px] hover:border-[#ff1f6c] hover:shadow-md"}`,children:[s.jsx("p",{className:"text-sm font-semibold",children:Ze}),s.jsx("p",{className:"text-xs text-muted-foreground",children:Ue})]},ce.id)})})]}),s.jsx(qe,{className:"border border-dashed border-pink/20 bg-white shadow-none",children:s.jsxs(Xe,{className:"space-y-4 py-6 text-sm text-muted-foreground",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Client"}),s.jsx("p",{children:ue||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Format"}),s.jsx("p",{children:ae||""})]}),H&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Headline result"}),s.jsx("p",{children:H})]}),ve.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Sections included"}),s.jsx("ul",{className:"mt-2 space-y-2",children:ve.map((ce,we)=>s.jsxs("li",{className:"flex items-start gap-2 text-sm",children:[s.jsx("span",{className:"mt-1 h-1.5 w-1.5 rounded-full bg-[#ff1f6c]"}),s.jsx("span",{children:ce})]},`${ce}-${we}`))})]}),((Ee=ne==null?void 0:ne.output)==null?void 0:Ee.metadata)&&"wordCount"in ne.output.metadata&&s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-foreground",children:"Approximate word count"}),s.jsx("p",{children:typeof ne.output.metadata.wordCount=="number"?`${ne.output.metadata.wordCount.toLocaleString()} words`:""})]})]})})]})]})})]})};function WD(){return s.jsx($2,{children:s.jsx(D2,{children:s.jsx(w2,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:s.jsxs(m2,{children:[s.jsx(jt,{path:"/",element:s.jsx(RR,{})}),s.jsx(jt,{path:"/features",element:s.jsx(MR,{})}),s.jsx(jt,{path:"/pricing",element:s.jsx(DR,{})}),s.jsx(jt,{path:"/contact",element:s.jsx(VR,{})}),s.jsx(jt,{path:"/login",element:s.jsx(BR,{})}),s.jsx(jt,{path:"/register",element:s.jsx(WR,{})}),s.jsx(jt,{path:"/forgot-password",element:s.jsx(UR,{})}),s.jsx(jt,{path:"/reset-password",element:s.jsx(zR,{})}),s.jsx(jt,{path:"/create-workspace",element:s.jsx(zt,{children:s.jsx(RM,{})})}),s.jsx(jt,{path:"/dashboard",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(MM,{})})})}),s.jsx(jt,{path:"/tools/ava",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(JM,{})})})}),s.jsx(jt,{path:"/tools/ava/previous-profiles",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(KM,{})})})}),s.jsx(jt,{path:"/tools/products",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(XM,{})})})}),s.jsx(jt,{path:"/tools/margo",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(h5,{})})})}),s.jsx(jt,{path:"/tools/margo/previous-briefs",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(p5,{})})})}),s.jsx(jt,{path:"/tools/product-refiner",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(Q5,{})})})}),s.jsx(jt,{path:"/tools/product-refiner/previous-sessions",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(G5,{})})})}),s.jsx(jt,{path:"/tools/vera",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(x3,{})})})}),s.jsx(jt,{path:"/tools/vera/previous-profiles",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(v3,{})})})}),s.jsx(jt,{path:"/tools/:slug",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sa,{})})})}),s.jsx(jt,{path:"/outputs",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sa,{})})})}),s.jsx(jt,{path:"/amplifiers",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(w3,{})})})}),s.jsx(jt,{path:"/amplifiers/email-sequence",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sD,{})})})}),s.jsx(jt,{path:"/amplifiers/sales-page",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(aD,{})})})}),s.jsx(jt,{path:"/amplifiers/social-media",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(dD,{})})})}),s.jsx(jt,{path:"/amplifiers/ad-copy",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(vD,{})})})}),s.jsx(jt,{path:"/amplifiers/blog-post",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(LD,{})})})}),s.jsx(jt,{path:"/amplifiers/case-study",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(BD,{})})})}),s.jsx(jt,{path:"/amplifiers/video-script",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(ND,{})})})}),s.jsx(jt,{path:"/amplifiers/webinar-script",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(ID,{})})})}),s.jsx(jt,{path:"/amplifiers/value-proposition",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(DD,{})})})}),s.jsx(jt,{path:"/profiles",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sa,{})})})}),s.jsx(jt,{path:"/templates",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sa,{})})})}),s.jsx(jt,{path:"/team",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sa,{})})})}),s.jsx(jt,{path:"/billing",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sa,{})})})}),s.jsx(jt,{path:"/workspace/settings",element:s.jsx(zt,{children:s.jsx(Gt,{children:s.jsx(sa,{})})})}),s.jsx(jt,{path:"/thank-you",element:s.jsx(DM,{})}),s.jsx(jt,{path:"/cancel",element:s.jsx(OM,{})})]})})})})}lw(document.getElementById("root")).render(s.jsx(i.StrictMode,{children:s.jsx(WD,{})}));
